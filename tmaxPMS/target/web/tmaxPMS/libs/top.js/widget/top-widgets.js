TopElementBehavior={properties:{onDetach:String,onAttach:String},factoryImpl:function(){},created:function(){this.currentData={};this.dataObj={}},ready:function(){if(!this.id){this.id=Top.Util.guid()}if(typeof this.initializeChildRoot==="function")this.childRoot=this.initializeChildRoot();this.updateStyle()},attached:function(){this.__attachedImpl()},__attachedImpl:function(){if(this.__isAttached===true)return;this.__isAttached=true;if(typeof this.__initBoundData==="function")this.__initBoundData();if(typeof this.__widgetAttached==="function")this.__widgetAttached();if(typeof this.__layoutAttached==="function")this.__layoutAttached();if(typeof this.__attached2==="function")this.__attached2();if(this.__redrawChild!==undefined){for(var i=0;i<this.__redrawChild.length;i++){this.__redrawChild[i]()}}if(typeof this.onAttach==="string"){this.onAttach=Top.Util.namespace(this.onAttach)}if(typeof this.onAttach==="function"){this.onAttach()}if(Top.events.onWidgetAttach[this.id]){Top.App.__callEvent(Top.events.onWidgetAttach[this.id],Top.Dom.selectById(this.id));delete Top.events.onWidgetAttach[this.id]}if(this.parentNode&&this.parentNode.tagName==="BODY"||this.layoutParent){if(this.layoutParent){if(this.layoutParent.tagName==="TOP-PAGE"||this.layoutParent.isCustomType===true){var p=this.layoutParent.children}else{var p=this.layoutParent.childRoot.children}var n=[];for(var i=0;i<p.length;i++){if(topWidgets[p[i].tagName.toLowerCase()]!==undefined&&p[i].tagName!=="TOP-CONTEXTMENU")n.push(p[i])}if(n[0]!==this)return;if(this.layoutParent.parentNode){var layouts=this.layoutParent.parentNode.querySelectorAll('top-linearlayout:not([orientation="vertical"])')}else{if(this.layoutParent.orientation!=="vertical"){var layouts=[this.layoutParent]}}var textfields=this.layoutParent.querySelectorAll("top-textfield");var checkboxes=this.layoutParent.querySelectorAll("top-checkbox");var textviews=this.layoutParent.querySelectorAll("top-textview")}else{var p=this.parentNode.children;var layouts=document.querySelectorAll('top-linearlayout:not([orientation="vertical"])');var textfields=document.querySelectorAll("top-textfield");var checkboxes=document.querySelectorAll("top-checkbox");var textviews=document.querySelectorAll("top-textview")}if(layouts){for(var i=0;i<layouts.length;i++){if(layouts[i].__isAttached&&typeof layouts[i].__setLineHeight==="function"&&layouts[i].id){layouts[i].__setLineHeight()}}}if(textfields){for(var i=0;i<textfields.length;i++){if(textfields[i].__isAttached&&textfields[i].__initialized&&typeof textfields[i].__setVerticalAlignment==="function"){textfields[i].__setVerticalAlignment()}}}if(checkboxes){for(var i=0;i<checkboxes.length;i++){if(checkboxes[i].__isAttached&&checkboxes[i].__initialized&&typeof checkboxes[i].__setVerticalAlignment==="function"){checkboxes[i].__setVerticalAlignment()}}}if(textviews){for(var i=0;i<textviews.length;i++){if(textviews[i].__isAttached&&textviews[i].__initialized&&typeof textviews[i].__updateVerticalAlignmentForMatchparent==="function"){textviews[i].__updateVerticalAlignmentForMatchparent()}}}}},detached:function(){if(this.__isDetachable()){this.__detachedImpl();if(typeof this.__detached==="function")this.__detached()}},__detachedImpl:function(){this.__isAttached=false;this.adjusted=undefined;this.__clearEvents();this.__clearBindingInfo();if(typeof this.__clearTimer==="function"){this.__clearTimer()}if(typeof this.onDetach==="string"){this.onDetach=Top.Util.namespace(this.onDetach)}if(typeof this.onDetach==="function"){this.onDetach()}if(Top.events.onWidgetDetach[this.id]){Top.App.__callEvent(Top.events.onWidgetDetach[this.id],this.id);delete Top.events.onWidgetDetach[this.id]}if(this.srcLoadListeners!==undefined){delete this.srcLoadListeners}if(this.layoutParent!==undefined||this.layoutParent!==null){this.layoutParent=null}if(this.tagName!=="TOP-TABLEVIEW"){this.childRoot=null}this.__boundController=null},__isDetachable:function(){return this.__isAttached===true&&document.getElementById(this.id)===null},__isAccordionChild:function(){return this.parentNode&&this.parentNode.classList.contains("top-accordionlayout-content")},getElement:function(selector){var element;if(selector){return this.querySelectorAll(selector)}else{if(this.__isCustomWidget){return undefined}else if(this.tagName==="TOP-SWITCH"){return this.querySelector(".top-switch-background")}else{return this.firstElementChild}}}};TopDataBehavior={properties:{data:String,dataModel:Object,__boundData:Object},ready:function(){if(this.parentNode&&(this.parentNode.tagName==="TOP-COLUMNITEM"||this.parentNode.tagName==="TOP-WIDGETITEM"))return;if(Top.App.isLoaded()){this.__initBoundData();if(typeof this.__ready==="function")this.__ready();this.__initialized=true;if(typeof this.__isReadied==="function")this.__isReadied()}else{var _this=this;Top.App.onBeforeLoad(function(){_this.__initBoundData();if(typeof _this.__ready==="function")_this.__ready();this.__initialized=true;if(typeof _this.__isReadied==="function")_this.__isReadied()})}},__initBoundData:function(fromController,widgetId){if(typeof this.data==="string")this.dataModel=JSON.parse(this.data);if(typeof this.dataModel==="string")this.dataModel=JSON.parse(this.dataModel);if(this.dataModel===undefined||this.dataModel==="")return;var resourcePattern=/^@(string|color|dimen|raw|drawable|style|theme)(\/[a-zA-Z0-9]+)+$/gm;this.__boundData={};for(var prop in this.dataModel){var valuePath=this.dataModel[prop];var dataName=Top.Util.getDataName(valuePath,this);var data=Top.Util.namespace(dataName,this);valuePath=valuePath.split(dataName+".")[1];if(data===undefined||!data.hasOwnProperty("id"))return;this.__addBoundData(prop,dataName,valuePath);if(valuePath.includes("+")){var converter=Top.Util.namespace(valuePath.split("+")[1],this);this.__boundData["DataConverter"]=converter}if(prop==="items"){this[prop]=this.dataModel[prop].split("+")[0]}else{var originValue=data.getValue(valuePath.split("+")[0]);originValue=this.__getValueByDataConverter(originValue);if(resourcePattern.test(originValue)){var modifiedValue;var resourceType=originValue.split("/")[0];var resourceId=originValue.substr(originValue.indexOf("/")+1);switch(resourceType){case"@drawable":{modifiedValue=Top.DrawableManager.get(resourceId);break}case"@raw":{modifiedValue=Top.RawManager.get(resourceId);break}default:{resourceId=resourceId.substr(0,resourceId.lastIndexOf("/"));var resourceName=originValue.split("/");resourceName=resourceName[resourceName.length-1];switch(resourceType){case"@string":{modifiedValue=Top.ValuesManager.get("strings",resourceId)[resourceName];break}case"@color":{modifiedValue=Top.ValuesManager.get("colors",resourceId)[resourceName];break}case"@dimen":{modifiedValue=Top.ValuesManager.get("dimen",resourceId)[resourceName];break}}}}this[prop]=modifiedValue}else this[prop]=originValue}if(this.__isBoundData===undefined)this.__isBoundData={};if(this.__isBoundData[prop]!==true){data.__addBoundWidget(valuePath,this.id,prop);this.__isBoundData[prop]=true}if(fromController===true){data.__updateBoundWidgets(valuePath,null,widgetId)}}},__addBoundData:function(prop,dataName,valuePath){var bindingInfo={};bindingInfo.dataName=dataName;bindingInfo.valuePath=valuePath;this.__boundData[prop]=this.__boundData[prop]||[];this.__boundData[prop].push(bindingInfo)},__updateBoundData:function(key,__widgetId){if(typeof key==="object"){for(var i=0,len=key.length;i<len;i++){this.__updateBoundDataImpl(key[i],__widgetId)}}else{this.__updateBoundDataImpl(key,__widgetId)}},__updateBoundDataImpl:function(key,__widgetId){if(this.__boundData&&this.__boundData[key]){var bindingInfoList=this.__boundData[key];for(var i=0,len=bindingInfoList.length;i<len;i++){var data=Top.Util.namespace(bindingInfoList[i].dataName,this);var valuePath=bindingInfoList[i].valuePath;if(valuePath.includes("+")){valuePath=valuePath.split("+")[0]}if(key==="items"){if(typeof this[key]==="string"){data.setValue(valuePath,Top.Util.namespace(this[key],this),__widgetId)}else{data.setValue(valuePath,this[key],__widgetId)}}else{var convertedValue=this[key];if(this.__boundData["DataConverter"]){var fnConvert=typeof this.__boundData["DataConverter"].convertBack==="function"?this.__boundData["DataConverter"].convertBack:this.__boundData["DataConverter"].convert;convertedValue=fnConvert(this[key])}data.setValue(valuePath,convertedValue,__widgetId)}}}},updateData:function(key){if(this.__boundData){if(key){this.__updateBoundData(key,this.id)}else{var keys=Object.keys(this.__boundData);this.__updateBoundData(keys,this.id)}}},__clearBindingInfo:function(){if(typeof this.__boundData==="object"){var keys=Object.keys(this.__boundData);for(var i=0,len=keys.length;i<len;i++){this.__isBoundData[keys[i]]=false;var bindingInfoList=this.__boundData[keys[i]];for(var j=0,len=bindingInfoList.length;j<len;j++){var data=Top.Util.namespace(bindingInfoList[j].dataName,this);var valuePath=bindingInfoList[j].valuePath;if(typeof data==="object"&&typeof data.__clearBindingInfo==="function")data.__clearBindingInfo(valuePath,this.id)}}}},__updateData:function(){if(typeof this.data==="string")this.dataModel=JSON.parse(this.data);if(typeof this.dataModel==="string")this.dataModel=JSON.parse(this.dataModel);if(this.__isBoundData===undefined)this.__isBoundData={};for(var prop in this.dataModel){this.__isBoundData[prop]=undefined}this.__initBoundData(true)},__updateDataModel:function(){if(typeof this.dataModel==="string")this.dataModel=JSON.parse(this.dataModel);if(this.__isBoundData===undefined)this.__isBoundData={};for(var prop in this.dataModel){this.__isBoundData[prop]=undefined}this.__initBoundData(true)}};TopDeviceBehavior={properties:{deviceModel:Object,__boundDevices:Object},ready:function(){if(this.deviceModel){this.__initBoundDevice()}},__initBoundDevice:function(){this.__boundDevices={};for(var prop in this.deviceModel){var valuePath=this.deviceModel[prop];var parts=valuePath.split(".");for(var i=0;i<parts.length;i++){if(Top.Util.namespace(parts[i])instanceof Top.Device){var device=Top.Util.namespace(parts[i]);var valuePath=valuePath.split(parts[i]+".")[1];break}}device.__addBoundWidget(valuePath,this.id,prop);this.__addBoundDevice(prop,device,valuePath);this[prop]=device.getValue(valuePath)}},__addBoundDevice:function(prop,device,valuePath){var bindingInfo={};bindingInfo.device=device;bindingInfo.valuePath=valuePath;this.__boundDevices[prop]=this.__boundDevices[prop]||[];this.__boundDevices[prop].push(bindingInfo)},__updateBoundDevices:function(key){if(typeof key==="object"){for(var i=0,len=key.length;i<len;i++){this.__updateBoundDevicesImpl(key[i])}}else{this.__updateBoundDevicesImpl(key)}},__updateBoundDevicesImpl:function(key){if(this.__boundDevices&&this.__boundDevices[key]){var bindingInfoList=this.__boundDevices[key];for(var i=0,len=bindingInfoList.length;i<len;i++){var device=bindingInfoList[i].device;var valuePath=bindingInfoList[i].valuePath;device.setValue(valuePath,this[key])}}},updateDevice:function(key){if(this.__boundDevices){if(key){this.__updateBoundDevices(key)}else{var keys=Object.keys(this.__boundDevices);this.__updateBoundDevices(keys)}}}};TopControlBehavior={properties:{controller:Object,controllerPath:String,__boundController:Object},ready:function(){if(Top.App.__compatibleWithTOP()){var _this=this;Top.App.onLoadUserLogic(function(){_this.__initController()})}else{this.__initController()}},__initController:function(){if(this.controller){this.__boundController=Top.Controller.get(this.controller);if(this.__boundController===undefined){console.error(this.controller+" is not defined.")}}if(Top.App.isLoaded()){this.__initControllerImpl()}else{var _this=this;Top.App.onLoad(function(){_this.__initControllerImpl()})}},__initControllerImpl:function(){if(this.__boundController&&this.__alreadyBound!==true){var _this=this;Top.App.onWidgetAttach(this.id,function(){if(typeof _this.__boundController.__setBoundWidget==="function")_this.__boundController.__setBoundWidget(_this.id)})}else{var controller=Top.Util.__searchController(this);if(controller!==undefined){this.__boundController=controller;if(controller instanceof Top.Controller===false||controller instanceof Top.Controller===true&&controller.isLoaded()===true){this.__initEvent()}else{var _this=this;Top.Controller.onLoad(controller,function(){_this.__initEvent()})}}this.__alreadyBound=true}},setController:function(controller){this.__boundController=controller},getController:function(){return this.__boundController}};TopI18nBehavior={__initI18n:function(prop){if(prop==="column"){if(Top.i18n.isLoaded()){this.__initI18nColumn(prop)}else{var _this=this;Top.i18n.onLoad(function(){this.__initI18nColumn(prop)})}return}if(typeof this[prop]==="string"){if(this.__i18nProps&&this.__i18nProps.hasOwnProperty(prop)){this[prop]=this.__i18nProps[prop]}var matches=this[prop].match(/\{\{(.*?)\}\}/);if(matches){if(this.__i18nProps===undefined)this.__i18nProps={};if(!this.__i18nProps.hasOwnProperty(prop))this.__i18nProps[prop]=this[prop];if(Top.i18n.isLoaded()){this[prop]=eval(matches[1]);if(typeof this.__updateProperties==="function")this.__updateProperties(prop);Top.i18n.__addBoundWidget(this)}else{var _this=this;Top.i18n.onLoad(function(){_this[prop]=eval(matches[1]);if(typeof _this.__updateProperties==="function")_this.__updateProperties(prop);Top.i18n.__addBoundWidget(_this)})}}}},__i18n:function(str){if(typeof str!=="string"||str==="")return str;var matches=str.match(/\{\{(.*?)\}\}/);if(matches!=null){return eval(matches[1])}else{return str}},__initI18nColumn:function(prop){if(this.__i18nProps&&this.__i18nProps.hasOwnProperty(prop)){this[prop]=this.__i18nProps[prop]}if(this.__i18nProps===undefined)this.__i18nProps={};if(typeof this[prop]==="object"){if(!this.__i18nProps.hasOwnProperty(prop)){this.__i18nProps[prop]=this[prop]}this[prop]=this.__i18nColumn(this[prop]);this.updateData(prop);if(typeof this.__updateProperties==="function")this.__updateProperties(prop);Top.i18n.__addBoundWidget(this)}else if(typeof this[prop]==="string"){if(!this.__i18nProps.hasOwnProperty(prop)){this.__i18nProps[prop]=Top.Util.namespace(this[prop],this)}this[prop]=this.__i18nColumn(Top.Util.namespace(this[prop],this));this.updateData(prop);if(typeof this.__updateProperties==="function")this.__updateProperties(prop);Top.i18n.__addBoundWidget(this)}},__i18nColumn:function(origCols){var keys=Object.keys(origCols);var cols=JSON.parse(JSON.stringify(keys));for(var i=0,len=keys.length;i<len;i++){var matches=keys[i].match(/\{\{(.*?)\}\}/);if(matches){cols[i]=eval(matches[1])}}return this.__renameColumns(JSON.parse(JSON.stringify(origCols)),keys,cols)},__renameColumns:function(colObj,oldCols,newCols){for(var i=0,len=oldCols.length;i<len;i++){if(oldCols[i]!==newCols[i]){Object.defineProperty(colObj,newCols[i],Object.getOwnPropertyDescriptor(colObj,oldCols[i]));delete colObj[oldCols[i]]}}return colObj},__updateI18n:function(){var props=Object.keys(this.__i18nProps);for(var i=0,len=props.length;i<len;i++){this.__initI18n(props[i])}if(props.length===0&&this.tagName==="TOP-TABLEVIEW"&&this.isIDETableview){this.__loadI18nForTable()}}};TopCommonStyleBehavior={properties:{disabled:{value:"false"},__derivedDisabled:String,opacity:String,background:String,backgroundColor:String,backgroundImage:String,tileMode:String,maxWidth:String,minWidth:String,maxHeight:String,minHeight:String,lineHeight:String,padding:String,margin:String,visible:String,display:String,zIndex:String,float:String,position:String,horizontalAlignment:{type:String,reflectToAttribute:true},verticalAlignment:{type:String,reflectToAttribute:true},layoutHorizontalAlignment:{type:String,reflectToAttribute:true},layoutVerticalAlignment:{type:String,reflectToAttribute:true},layoutHeight:{type:String,reflectToAttribute:true},layoutWidth:{type:String,reflectToAttribute:true},layoutAlignParent:{type:String,reflectToAttribute:true},layoutRow:{type:String,reflectToAttribute:true},layoutColumn:{type:String,reflectToAttribute:true},layoutRowSpan:{type:String,reflectToAttribute:true},layoutColumnSpan:{type:String,reflectToAttribute:true},layoutTop:{type:String,reflectToAttribute:true},layoutLeft:{type:String,reflectToAttribute:true},layoutRight:{type:String,reflectToAttribute:true},layoutBottom:{type:String,reflectToAttribute:true},layoutTabName:{type:String,reflectToAttribute:true},layoutTabIcon:{type:String,reflectToAttribute:true},layoutTabDisabled:{type:Boolean,reflectToAttribute:true,value:false},layoutWeight:{type:String,reflectToAttribute:true},layoutSplitLocation:String,borderWidth:{type:String,reflectToAttribute:true},borderBottomWidth:String,borderLeftWidth:String,borderRightWidth:String,borderTopWidth:String,borderStyle:String,borderColor:String,borderTopColor:String,borderRightColor:String,borderBottomColor:String,borderLeftColor:String,borderRadius:String,verticalScroll:String,horizontalScroll:String,topstyle:{type:String,value:""},width:String,height:String,top:String,left:String,bottom:String,right:String,marginTop:String,marginRight:String,marginBottom:String,marginLeft:String,resize:String,cursor:String},ready:function(){this.__initI18n("layoutTabName")},updateStyle:function(keys){var layoutRenderFlag=false;if(keys!=null&&typeof keys==="object"){for(var i=0;i<keys.length;i++){if(!layoutRenderFlag){if(keys[i]==="layoutAlignParent"||keys[i]==="layoutRow"||keys[i]==="layoutColumn"||keys[i]==="layoutRowSpan"||keys[i]==="layoutColumnSpan"||keys[i]==="layoutTop"||keys[i]==="layoutLeft"||keys[i]==="layoutRight"||keys[i]==="layoutBottom"||keys[i]==="layoutTabName"||keys[i]==="layoutTabIcon"||keys[i]==="layoutTabDisabled"||keys[i]==="layoutWeight"||keys[i]==="layoutHorizontalAlignment"||keys[i]==="layoutVerticalAlignment"){layoutRenderFlag=true;break}}}if(layoutRenderFlag){this.layoutParent.renderLayout()}}else if(typeof keys==="string"){stylekey=keys.replace(/[A-Z]/g,function(match){return"-"+match.toLowerCase()});var stylekeyMap=[["b-image","backgroundImage"],["tile-mode","background-repeat"],["text-color","color"],["horizontal-alignment","text-align"],["layout-vertical-alignment","vertical-align"],["horizontal-scroll","overflow-x"],["vertical-scroll","overflow-y"]];for(var j=0;j<stylekeyMap.length;j++){if(stylekey===stylekeyMap[j][0]){stylekey=stylekeyMap[j][1];if(stylekey==="overflow-x"||stylekey==="overflow-y"){if(this[keys]==="true"||this[keys]===true)this[keys]="auto";else if(this[keys]==="false"||this[keys]===false)this[keys]="hidden"}this.removeTopStyle(stylekey);this.setTopStyle(stylekey,this[keys]);return}}this.removeTopStyle(stylekey);this.setTopStyle(stylekey,this[keys]);if((stylekey==="margin"||stylekey==="padding")&&typeof this.__updateHighlightConfig==="function"){this.__updateHighlightConfig()}return}this.topstyle="";this.setAllTopStyle();var bImage=this.backgroundImage;this.updatePositionValue(true);if(this.backgroundImage!=null){if(!this.backgroundImage.includes("url(")){if(this.backgroundImage.includes("@drawable")){bImage=Top.DrawableManager.get(this.backgroundImage.replace("@drawable/",""))}bImage="url("+bImage+")"}if(this.tileMode==null||this.tileMode==="")this.tileMode="stretch";if(this.tileMode==="stretch")this.setTopStyle("background-size","cover");else{this.setTopStyle("background-repeat",this.tileMode)}}if(this.verticalAlignment==null){this.verticalAlignment="middle"}if(this.verticalScroll==="true"||this.verticalScroll===true)this.verticalScroll="auto";if((this.horizontalScroll==="true"||this.horizontalScroll===true)&&this.tagName!=="TOP-TABLEVIEW")this.horizontalScroll="auto";if(this.verticalScroll==="false"||this.verticalScroll===false)this.verticalScroll="hidden";if(this.horizontalScroll==="false"||this.horizontalScroll===false)this.horizontalScroll="hidden";if(this.borderWidth!=null||this.borderColor!=null){if(this.borderStyle==null){this.borderStyle="solid"}}this.__updateDisplay();this.__updateVisible();this.__updateLayoutWidth();this.__updateLayoutHeight();this.__updateLayoutTop();this.__updateLayoutLeft();this.__updateLayoutRight();this.__updateLayoutBottom();this.__updateTextStyle();this.setTopStyle("max-width",this.maxWidth);this.setTopStyle("min-width",this.minWidth);this.setTopStyle("max-height",this.maxHeight);this.setTopStyle("min-height",this.minHeight);this.setTopStyle("line-height",this.lineHeight);this.setTopStyle("background-color",this.backgroundColor);this.setTopStyle("background-image",bImage);this.setTopStyle("background-repeat",this.tileMode);this.setTopStyle("background",this.background);this.setTopStyle("opacity",this.opacity);this.setTopStyle("margin",this.margin);this.setTopStyle("padding",this.padding);this.setTopStyle("color",this.textColor);this.setTopStyle("font-size",this.textSize);this.setTopStyle("border-width",this.borderWidth);this.setTopStyle("border-bottom-width",this.borderBottomWidth);this.setTopStyle("border-left-width",this.borderLeftWidth);this.setTopStyle("border-right-width",this.borderRightWidth);this.setTopStyle("border-top-width",this.borderTopWidth);this.setTopStyle("border-style",this.borderStyle);this.setTopStyle("border-color",this.borderColor);this.setTopStyle("border-top-color",this.borderTopColor);this.setTopStyle("border-right-color",this.borderRightColor);this.setTopStyle("border-bottom-color",this.borderBottomColor);this.setTopStyle("border-left-color",this.borderLeftColor);this.setTopStyle("border-radius",this.borderRadius);this.setTopStyle("z-index",this.zIndex);this.setTopStyle("position",this.position);this.setTopStyle("float",this.float);this.setTopStyle("cursor",this.cursor);this.setTopStyle("text-align",this.horizontalAlignment);this.setTopStyle("vertical-align",this.layoutVerticalAlignment);this.setTopStyle("overflow-x",this.horizontalScroll);this.setTopStyle("overflow-y",this.verticalScroll);if(this.tagName==="TOP-TABLEVIEW"&&this.dataTable){this.dataTable.draw(false)}if(this.resize!==undefined){this.setTopStyle("resize",this.resize)}},setTopStyle:function(key,value){if(value){this.topstyle+=key+":"+value+";"}this.setAllTopStyle()},removeTopStyle:function(key){var checkStyle=new RegExp("^("+key+")[ ]*:[-+*/(),.%a-z0-9 ]+;|[ ]+("+key+")[ ]*:[-+*/(),.%a-z0-9 ]+;","g");var checkStyle2=new RegExp(";("+key+")[ ]*:[-+*/(),.%a-z0-9 ]+;","g");this.topstyle=this.getTopStyle().replace(checkStyle,"");this.topstyle=this.topstyle.replace(checkStyle2,";");if(this.topstyle.startsWith(";"))this.topstyle=this.topstyle.replace(";","");this.setAllTopStyle()},getTopStyle:function(){return this.topstyle},updatePositionValue:function(__isfromUpdateStyle){if(__isfromUpdateStyle){this.splitMargin();this.splitPadding();this.splitBorder();this.splitBorderColor()}},splitMargin:function(){if(this.margin){var temp=this.margin.split(" ");if(temp.length==1){this.marginTop=this.marginRight=this.marginBottom=this.marginLeft=temp[0]}else if(temp.length==2){this.marginTop=this.marginBottom=temp[0];this.marginRight=this.marginLeft=temp[1]}else if(temp.length==4){this.marginTop=temp[0];this.marginRight=temp[1];this.marginBottom=temp[2];this.marginLeft=temp[3]}}else{this.marginTop=this.marginRight=this.marginBottom=this.marginLeft=0}},splitPadding:function(){if(this.padding){var temp=this.padding.split(" ");if(temp.length==1){this.paddingTop=this.paddingRight=this.paddingBottom=this.paddingLeft=temp[0]}else if(temp.length==2){this.paddingTop=this.paddingBottom=temp[0];this.paddingRight=this.paddingLeft=temp[1]}else if(temp.length==4){this.paddingTop=temp[0];this.paddingRight=temp[1];this.paddingBottom=temp[2];this.paddingLeft=temp[3]}}else{this.paddingTop=this.paddingRight=this.paddingBottom=this.paddingLeft=0}},splitBorder:function(){if(this.borderWidth){var tmpBorderWidth=this.borderWidth.split(" ");if(tmpBorderWidth.length==1){this.borderTopWidth=this.borderRightWidth=this.borderBottomWidth=this.borderLeftWidth=tmpBorderWidth[0]}else if(tmpBorderWidth.length==2){this.borderTopWidth=this.borderBottomWidth=tmpBorderWidth[0];this.borderRightWidth=this.borderLeftWidth=tmpBorderWidth[1]}else if(tmpBorderWidth.length==4){this.borderTopWidth=tmpBorderWidth[0];this.borderRightWidth=tmpBorderWidth[1];this.borderBottomWidth=tmpBorderWidth[2];this.borderLeftWidth=tmpBorderWidth[3]}}},splitBorderColor:function(){if(this.borderColor){var tmpBorderColor=this.borderColor.split(" ");if(tmpBorderColor.length==1){this.borderTopColor=this.borderRightColor=this.borderBottomColor=this.borderLeftColor=tmpBorderColor[0]}else if(tmpBorderColor.length==2){this.borderTopColor=this.borderBottomColor=tmpBorderColor[0];this.borderRightColor=this.borderLeftColor=tmpBorderColor[1]}else if(tmpBorderColor.length==4){this.borderTopColor=tmpBorderColor[0];this.borderRightColor=tmpBorderColor[1];this.borderBottomColor=tmpBorderColor[2];this.borderLeftColor=tmpBorderColor[3]}}},__updateVisible:function(){if(typeof this.__updateVisibleInternal==="function")this.__updateVisibleInternal();this.removeTopStyle("visibility");if(this.visible===true||this.visible==="true")this.visible="visible";if(this.visible===false||this.visible==="false")this.visible="hidden";if(this.display!=="none")this.prevDisplay=this.display;if(this.visible=="none"){this.display="none";this.__updateDisplay();return}else if((this.visible==="visible"||this.visible==="hidden")&&this.display==="none"){this.display=this.prevDisplay;this.removeTopStyle("display");this.setTopStyle("display",this.display)}this.setTopStyle("visibility",this.visible);if(this.layoutParent&&typeof this.layoutParent.__reRenderChildDisplay==="function")this.layoutParent.__reRenderChildDisplay(this)},__updateDisplay:function(){this.removeTopStyle("display");if(this.display==null){if(this.tagName==="TOP-SELECTBOX"){this.display="inline-flex"}else{this.display="inline-block"}}this.setTopStyle("display",this.display);if(this.layoutParent&&typeof this.layoutParent.__reRenderChildDisplay==="function")this.layoutParent.__reRenderChildDisplay(this)},__updateLayoutWidth:function(){var borderRightWidth=this.borderRightWidth||0;var borderLeftWidth=this.borderLeftWidth||0;var layoutWidth=this.layoutWidth;if(this.tagName==="TOP-PANEL"||this.tagName==="TOP-TABLEVIEW"){if(this.layoutWidth==null){layoutWidth="calc(100% - "+(parseInt(this.marginRight)+parseInt(this.marginLeft)+parseInt(this.paddingRight)+parseInt(this.paddingLeft)+parseInt(borderRightWidth)+parseInt(borderLeftWidth))+"px)"}}if(this.tagName!=="TOP-CHART"&&this.layoutWidth&&this.layoutWidth.endsWith("%")){layoutWidth="calc("+this.layoutWidth+" - "+(parseInt(this.marginRight)+parseInt(this.marginLeft)+parseInt(this.paddingRight)+parseInt(this.paddingLeft)+parseInt(borderRightWidth)+parseInt(borderLeftWidth))+"px)"}if((this.tagName==="TOP-SWITCH"||this.tagName==="TOP-DATEPICKER")&&this.layoutWidth==="auto")return;if(this.layoutWidth==="match_parent")return;this.removeTopStyle("width");this.setTopStyle("width",layoutWidth);this.updatePositionValue(false);if(typeof this.__initTooltip==="function")this.__initTooltip()},__updateLayoutHeight:function(){if(this.tagName==="TOP-PANEL"||this.tagName==="TOP-TABLEVIEW"){if(this.tagName==="TOP-PANEL"&&this.layoutHeight==null){this.layoutHeight="auto"}}if(!this.layoutHeight)return;var layoutHeight=this.layoutHeight;if(layoutHeight.indexOf("%")!==-1){if(this.parentNode!==null){var parentlinear=this.parentNode.parentNode;if(parentlinear&&parentlinear.tagName==="TOP-LINEARLAYOUT"&&parentlinear.getAttribute("orientation")==="vertical"){this.style.height=this.layoutHeight;layoutHeight="100%"}}}if(this.tagName!=="TOP-CHART"&&layoutHeight.endsWith("%")){var boxing=parseInt(this.marginTop)+parseInt(this.marginBottom)+parseInt(this.paddingTop)+parseInt(this.paddingBottom)+parseInt(this.borderTopWidth)+parseInt(this.borderBottomWidth);if(boxing>0){layoutHeight="calc("+layoutHeight+" - "+boxing+"px)"}}if((this.tagName==="TOP-SWITCH"||this.tagName==="TOP-DATEPICKER")&&this.layoutHeight==="auto")return;if(this.layoutHeight==="match_parent")return;this.removeTopStyle("height");this.setTopStyle("height",layoutHeight);this.updatePositionValue(false);if(this.tagName==="TOP-CHECKBOX")this.__updateVirticalAlignment()},__updateLayoutTop:function(){if(!this.layoutParent||this.layoutParent&&this.layoutParent.tagName!="TOP-ABSOLUTELAYOUT"){this.removeTopStyle("top");this.setTopStyle("top",this.layoutTop)}else if(this.layoutParent&&this.layoutParent.tagName==="TOP-ABSOLUTELAYOUT"){var pPaddingTop=this.paddingTop||0;var layoutTop=parseInt(this.layoutTop)+pPaddingTop+"px";this.style.top=layoutTop}},__updateLayoutLeft:function(){if(!this.layoutParent||this.layoutParent&&this.layoutParent.tagName!="TOP-ABSOLUTELAYOUT"){this.removeTopStyle("left");this.setTopStyle("left",this.layoutLeft)}else if(this.layoutParent&&this.layoutParent.tagName==="TOP-ABSOLUTELAYOUT"){var pPaddingLeft=this.paddingLeft||0;var layoutLeft=parseInt(this.layoutLeft)+pPaddingLeft+"px";this.style.left=layoutLeft}},__updateLayoutRight:function(){if(!this.layoutParent||this.layoutParent&&this.layoutParent.tagName!="TOP-ABSOLUTELAYOUT"){this.removeTopStyle("right");this.setTopStyle("right",this.layoutRight)}},__updateLayoutBottom:function(){if(!this.layoutParent||this.layoutParent&&this.layoutParent.tagName!="TOP-ABSOLUTELAYOUT"){this.removeTopStyle("bottom");this.setTopStyle("bottom",this.layoutBottom)}},__updateTextStyle:function(){if(this.textStyle===undefined)return;if(this.textStyle==="none"||this.textStyle===""){this.removeTopStyle("font-weight");this.removeTopStyle("font-style");this.removeTopStyle("text-decoration");return}var textStyleArray=this.textStyle.split("|");for(var i=0;i<textStyleArray.length;i++){textStyleArray[i]=textStyleArray[i].replace(/ /g,"");if(textStyleArray[i]==="bold"){this.removeTopStyle("font-weight");this.setTopStyle("font-weight","bold")}if(textStyleArray[i]==="italic"){this.removeTopStyle("font-style");this.setTopStyle("font-style","italic")}if(textStyleArray[i]==="underline"){this.removeTopStyle("text-decoration");this.setTopStyle("text-decoration","underline")}}},__updateTextColor:function(){this.removeTopStyle("color");this.setTopStyle("color",this.textColor)},__updateTextSize:function(){this.removeTopStyle("font-size");this.setTopStyle("font-size",this.textSize)},__updateDisabled:function(){},__updateLayoutTabName:function(){if(this.layoutParent&&typeof this.layoutParent.refresh==="function"){this.layoutParent.refresh(true)}},calculateDerivedDisabled:function(){return this.__derivedDisabled==="true"||this.__derivedDisabled===true?"true":this.disabled},setThisWidgetWidth:function(parentWidth,parentElement){var borderRightWidth=this.borderRightWidth||0;var borderLeftWidth=this.borderLeftWidth||0;if(typeof this.getElement==="function"&&this.getElement()&&this.getElement().style.boxSizing==="border-box"){var layoutWidth=parseInt(this.marginRight)+parseInt(this.marginLeft)}else{var layoutWidth=parseInt(this.marginRight)+parseInt(this.marginLeft)+parseInt(this.paddingRight)+parseInt(this.paddingLeft)+parseInt(borderRightWidth)+parseInt(borderLeftWidth)}if(layoutWidth>0)layoutWidth="calc("+parentWidth+" - "+layoutWidth+"px)";else if(parentWidth.includes("-"))layoutWidth="calc("+parentWidth+")";else layoutWidth=parentWidth;this.removeTopStyle("width");this.setTopStyle("width",layoutWidth);if(this.tagName==="TOP-ABSOLUTELAYOUT"||this.layoutParent&&this.layoutParent.tagName==="TOP-ABSOLUTELAYOUT"){this.style.width=layoutWidth}if(this.childs){if(this.tagName==="TOP-GRIDLAYOUT")this.__setCellSize()}return layoutWidth},setThisWidgetHeight:function(parentHeight){var checkWeightValue;var borderTopWidth=this.borderTopWidth||0;var borderBottomWidth=this.borderBottomWidth||0;if(typeof this.getElement==="function"&&this.getElement()&&this.getElement().style.boxSizing==="border-box"){var layoutHeight=parseInt(this.marginTop)+parseInt(this.marginBottom)}else{var layoutHeight=parseInt(this.marginTop)+parseInt(this.marginBottom)+parseInt(this.paddingTop)+parseInt(this.paddingBottom)+parseInt(borderTopWidth)+parseInt(borderBottomWidth)}if(layoutHeight>0)layoutHeight="calc("+parentHeight+" - "+layoutHeight+"px)";else if(parentHeight.includes("-"))layoutHeight="calc("+parentHeight+")";else layoutHeight=parentHeight;
this.removeTopStyle("height");this.setTopStyle("height",layoutHeight);if(this.tagName==="TOP-ABSOLUTELAYOUT"||this.layoutParent&&this.layoutParent.tagName==="TOP-ABSOLUTELAYOUT"){this.style.height=layoutHeight}if(this.childs){if(this.tagName==="TOP-GRIDLAYOUT")this.__setCellSize()}return layoutHeight}};TopEventBehavior={properties:{eventMouseClick:String,eventMouseEnter:String,eventMouseExit:String,eventMouseMove:String,eventMousePressed:String,eventMouseReleased:String,eventMouseDblclick:String,eventKeyPressed:String,eventKeyReleased:String,eventKeyTyped:String,eventFocused:String,eventLostFocused:String,eventChanged:String,eventSecondaryClick:String,eventDrag:String,eventDragend:String,eventDragenter:String,eventDragexit:String,eventDragleave:String,eventDragover:String,eventDragstart:String,eventDrop:String,__initEventList:Array,__eventMap:Object,__coreEventMap:Object,onKeydown:String,onKeypress:String,onKeyup:String,onMouseenter:String,onMouseover:String,onMousemove:String,onMousedown:String,onMouseup:String,onClick:String,onDblclick:String,onContextmenu:String,onWheel:String,onMouseleave:String,onPointerlockchange:String,onPointerlockerror:String,onDragstart:String,onDrag:String,onDragend:String,onDragenter:String,onDragover:String,onDragleave:String,onDrop:String,onFocus:String,onBlur:String},__initEvent:function(){this.__clearEvents();this.__createUserFn("eventMouseClick");this.__createUserFn("eventMouseEnter");this.__createUserFn("eventMouseExit");this.__createUserFn("eventMouseMove");this.__createUserFn("eventMousePressed");this.__createUserFn("eventMouseReleased");this.__createUserFn("eventMouseDblclick");this.__createUserFn("eventKeyPressed");this.__createUserFn("eventKeyReleased");this.__createUserFn("eventKeyTyped");this.__createUserFn("eventFocused");this.__createUserFn("eventLostFocused");this.__createUserFn("eventChanged");this.__createUserFn("eventSecondaryClick");this.__initDragAndDrop();this.__addEventByAttr("keydown");this.__addEventByAttr("keypress");this.__addEventByAttr("keyup");this.__addEventByAttr("mouseenter");this.__addEventByAttr("mouseover");this.__addEventByAttr("mousemove");this.__addEventByAttr("mousedown");this.__addEventByAttr("mouseup");this.__addEventByAttr("click");this.__addEventByAttr("dblclick");this.__addEventByAttr("contextmenu");this.__addEventByAttr("wheel");this.__addEventByAttr("mouseleave");this.__addEventByAttr("pointerlockchange");this.__addEventByAttr("pointerlockerror");this.__addEventByAttr("dragstart");this.__addEventByAttr("drag");this.__addEventByAttr("dragend");this.__addEventByAttr("dragenter");this.__addEventByAttr("dragover");this.__addEventByAttr("dragleave");this.__addEventByAttr("drop");this.__addEventByAttr("focus");this.__addEventByAttr("blur");if(typeof this.__initEventInternal==="function")this.__initEventInternal()},__createUserFn:function(name,args){if(Top.App.__compatibleWithTOP()){this.__createUserFnWithTOP(name);return}if(typeof this[name]==="string"){var fn=Top.Util.namespace(this[name],this);var controller=this.getController();var _this=this;this.__addEventFn(name,function(event){if(typeof fn==="function"){if(typeof args==="object"){fn.apply(controller,args)}else{fn.call(controller,event,Top.Dom.selectById(_this.id))}}else if(_this[name]!==""){console.warn(_this[name]+" is not defined.")}})}},__createUserFnWithTOP:function(name){if(typeof this[name]==="string"&&this[name]!==""){var fn=Top.Util.namespace(this[name],this);var _this=this;this.__addEventFn(name,function(event){if(typeof fn==="function"){fn(event,Top.Dom.selectById(_this.id))}else if(typeof fn==="object"){if(fn.type==="device"){fn.device[fn.fn]()}else{fn.fn(event,Top.Dom.selectById(_this.id))}}else{console.warn(_this[name]+" is not defined.")}})}},__updateEventFn:function(name){if(this.__eventMap===undefined)this.__eventMap={};if(this.__eventMap[name]===undefined)this.__eventMap[name]=[];if(typeof this.__coreEventMap==="object"&&typeof this.__coreEventMap[name]==="object"){var events=this.__eventMap[name].concat(this.__coreEventMap[name])}else{var events=this.__eventMap[name]}var len=events.length;if(len>0){var _this=this;this["__".concat(name)]=function(event){for(var i=0;i<len;i++){if(typeof events[i]==="function")events[i](event,Top.Dom.selectById(_this.id))}};if(typeof this.__eventBindingList==="function"){var list=this.__eventBindingList();if(typeof list["__".concat(name)]==="function")list["__".concat(name)](this["__".concat(name)])}}},__addEventFn:function(name,fn){if(this.__eventMap===undefined)this.__eventMap={};if(this.__eventMap[name]===undefined)this.__eventMap[name]=[];this.__eventMap[name].push(fn);this.__updateEventFn(name)},__addEventFnByCore:function(name,fn){if(this.__coreEventMap===undefined)this.__coreEventMap={};if(this.__coreEventMap[name]===undefined)this.__coreEventMap[name]=[];this.__coreEventMap[name].push(fn);this.__updateEventFn(name)},__removeEventFn:function(name){if(typeof this.__eventMap==="object"&&typeof this.__eventMap[name]==="object"){delete this.__eventMap[name]}this.__updateEventFn(name)},__clearEvents:function(){if(typeof this.__eventMap==="object"){var keys=Object.keys(this.__eventMap);for(var i=0,len=keys.length;i<len;i++){delete this.__eventMap[keys[i]]}delete this.__eventMap}},__initDragAndDrop:function(){var __fnDrag=Top.Util.namespace(this.eventDrag,this);if(typeof __fnDrag==="function"){this.addEventListener("drag",function(event){__fnDrag(event)})}var __fnDragend=Top.Util.namespace(this.eventDragend,this);if(typeof __fnDragend==="function"){this.addEventListener("dragend",function(event){__fnDragend(event)})}var __fnDragenter=Top.Util.namespace(this.eventDragenter,this);if(typeof __fnDragenter==="function"){this.addEventListener("dragenter",function(event){__fnDragenter(event)})}var __fnDragexit=Top.Util.namespace(this.eventDragexit,this);if(typeof __fnDragexit==="function"){this.addEventListener("dragexit",function(event){__fnDragexit(event)})}var __fnDragleave=Top.Util.namespace(this.eventDragleave,this);if(typeof __fnDragleave==="function"){this.addEventListener("dragleave",function(event){__fnDragleave(event)})}var __fnDragover=Top.Util.namespace(this.eventDragover,this);if(typeof __fnDragover==="function"){this.addEventListener("dragover",function(event){__fnDragover(event)})}var __fnDragstart=Top.Util.namespace(this.eventDragstart,this);if(typeof __fnDragstart==="function"){this.addEventListener("dragstart",function(event){__fnDragstart(event)})}var __fnDrop=Top.Util.namespace(this.eventDrop,this);if(typeof __fnDrop==="function"){this.addEventListener("drop",function(event){__fnDrop(event)})}},__updateEventMouseClick:function(){this.__removeEventFn("eventMouseClick");this.__createUserFn("eventMouseClick")},__updateEventMouseEnter:function(){this.__removeEventFn("eventMouseEnter");this.__createUserFn("eventMouseEnter")},__updateEventMouseExit:function(){this.__removeEventFn("eventMouseExit");this.__createUserFn("eventMouseExit")},__updateEventMouseMove:function(){this.__removeEventFn("eventMouseMove");this.__createUserFn("eventMouseMove")},__updateEventMousePressed:function(){this.__removeEventFn("eventMousePressed");this.__createUserFn("eventMousePressed")},__updateEventMouseReleased:function(){this.__removeEventFn("eventMouseReleased");this.__createUserFn("eventMouseReleased")},__updateEventMouseDblclick:function(){this.__removeEventFn("eventMouseDblclick");this.__createUserFn("eventMouseDblclick")},__updateEventKeyPressed:function(){this.__removeEventFn("eventKeyPressed");this.__createUserFn("eventKeyPressed")},__updateEventKeyReleased:function(){this.__removeEventFn("eventKeyReleased");this.__createUserFn("eventKeyReleased")},__updateEventKeyTyped:function(){this.__removeEventFn("eventKeyTyped");this.__createUserFn("eventKeyTyped")},__updateEventFocused:function(){this.__removeEventFn("eventFocused");this.__createUserFn("eventFocused")},__updateEventLostFocused:function(){this.__removeEventFn("eventLostFocused");this.__createUserFn("eventLostFocused")},__updateEventChanged:function(){this.__removeEventFn("eventChanged");this.__createUserFn("eventChanged")},__updateEventSecondaryClick:function(){this.__removeEventFn("eventSecondaryClick");this.__createUserFn("eventSecondaryClick")},__addEventByAttr:function(type){var attrName="on".concat(Top.Util.capitalizeFirstLetter(type));if(!this[attrName])return;if(typeof this[attrName]==="string"){var _this=this;var fnName=type.concat("_anonymous");this.__removeEventListener(type,fnName);this[fnName]=function(event){var fn=Top.Util.namespace(_this[attrName],_this);if(typeof fn==="function"){if(typeof event.detail==="object"){fn.call(_this.getController(),event,Top.Dom.selectById(_this.id),event.detail)}else{fn.call(_this.getController(),event,Top.Dom.selectById(_this.id))}}else if(typeof fn==="object"){if(fn.type==="device"){fn.device[fn.fn]()}else{fn.fn(event,Top.Dom.selectById(_this.id))}}else{console.warn(_this[attrName]+" is not defined.")}};this.__addEventListener(type,this[fnName])}else if(typeof this[attrName]==="function"){var _this=this;var fnName=type.concat("_anonymous");this.__removeEventListener(type,fnName);this[fnName]=function(event){var fn=_this[attrName];if(typeof fn==="function"){if(typeof event.detail==="object"){fn.call(_this.getController(),event,Top.Dom.selectById(_this.id),event.detail)}else{fn.call(_this.getController(),event,Top.Dom.selectById(_this.id))}}else if(typeof fn==="object"){if(fn.type==="device"){fn.device[fn.fn]()}else{fn.fn(event,Top.Dom.selectById(_this.id))}}else{console.warn(_this[attrName]+" is not defined.")}};this.__addEventListener(type,this[fnName])}},__removeEventByAttr:function(type){var attrName="on".concat(Top.Util.capitalizeFirstLetter(type));if(!this[attrName])return;var _this=this;var fnName=type.concat("_anonymous");this.__removeEventListener(type,fnName)},__addEventListener:function(type,listener,options){if(type==="focus"||type==="blur"||(type==="keydown"||type==="keyup")&&(this.tagName==="TOP-TEXTFIELD"||this.tagName==="TOP-TEXTAREA")){var element=this.__getFocusableElement()}else{var element=this.getElement()}if(element!==undefined&&element!==null){if(typeof listener==="string"){element.addEventListener(type,Top.Util.namespace(listener),options)}else if(typeof listener==="function"){element.addEventListener(type,listener,options)}}},__removeEventListener:function(type,listener,options){if(type==="focus"||type==="blur"||(type==="keydown"||type==="keyup")&&(this.tagName==="TOP-TEXTFIELD"||this.tagName==="TOP-TEXTAREA")){var element=this.__getFocusableElement()}else{var element=this.getElement()}if(element!=null){if(typeof listener==="string"){element.removeEventListener(type,this[listener],options);element.removeEventListener(type,Top.Util.namespace(listener),options)}else if(typeof listener==="function"){element.removeEventListener(type,listener,options)}}},__dispatchEvent:function(event){if(this.getElement()!==null){this.getElement().dispatchEvent(event)}},__getFocusableElement:function(){if(this.tagName==="TOP-DATEPICKER"){return this.getElement()}else if(this.tagName==="TOP-TEXTFIELD"){return this.getElement("input")[0]}else if(this.tagName==="TOP-TEXTAREA"){return this.getElement("textarea")[0]}else{return null}},__updateOnKeydown:function(){this.__addEventByAttr("keydown")},__updateOnKeypress:function(){this.__addEventByAttr("keypress")},__updateOnKeyup:function(){this.__addEventByAttr("keyup")},__updateOnMouseenter:function(){this.__addEventByAttr("mouseenter")},__updateOnMouseover:function(){this.__addEventByAttr("mouseover")},__updateOnMousemove:function(){this.__addEventByAttr("mousemove")},__updateOnMousedown:function(){this.__addEventByAttr("mousedown")},__updateOnMouseup:function(){this.__addEventByAttr("mouseup")},__updateOnClick:function(){this.__addEventByAttr("click")},__updateOnDblclick:function(){this.__addEventByAttr("dblclick")},__updateOnContextmenu:function(){this.__addEventByAttr("contextmenu")},__updateOnWheel:function(){this.__addEventByAttr("wheel")},__updateOnMouseleave:function(){this.__addEventByAttr("mouseleave")},__updateOnPointerlockchange:function(){this.__addEventByAttr("pointerlockchange")},__updateOnPointerlockerror:function(){this.__addEventByAttr("pointerlockerror")},__updateOnDragstart:function(){this.__addEventByAttr("dragstart")},__updateOnDrag:function(){this.__addEventByAttr("drag")},__updateOnDragend:function(){this.__addEventByAttr("dragend")},__updateOnDragenter:function(){this.__addEventByAttr("dragenter")},__updateOnDragover:function(){this.__addEventByAttr("dragover")},__updateOnDragleave:function(){this.__addEventByAttr("dragleave")},__updateOnDrop:function(){this.__addEventByAttr("drop")},__updateOnFocus:function(){this.__addEventByAttr("focus")},__updateOnBlur:function(){this.__addEventByAttr("blur")}};TopWidgetBehaviorImpl={properties:{id:{type:String,reflectToAttribute:true},name:{type:String,reflectToAttribute:true},class:{type:String,value:""},description:String,value:{type:String,reflectToAttribute:true},tooltip:String,tooltipTop:{type:String,reflectToAttribute:true},tooltipBottom:{type:String,reflectToAttribute:true},tooltipLeft:{type:String,reflectToAttribute:true},tooltipRight:{type:String,reflectToAttribute:true},menu:{type:String,reflectToAttribute:true},popover:{type:String,reflectToAttribute:true},placement:{type:String,reflectToAttribute:true},title:{type:String,reflectToAttribute:true,value:""},layoutParent:{type:String,reflectToAttribute:true},actionParameter:{type:Object,reflectToAttribute:true},index:{type:String,reflectToAttribute:true}},__updateProperties:function(key){if(this.tagName==="TOP-TREEVIEW"&&!this.__needsImpl(key)){this.__reRender();return}if(typeof key==="object"){for(var i=0,len=key.length;i<len;i++){this.__updatePropertiesImpl(key[i])}}else if(typeof key==="string"){this.__updatePropertiesImpl(key)}if(this.tagName==="TOP-TABLEVIEW"&&Top.__isPrivate()===true){if(key=="items"){}return}if(!this.__needsImpl(key)){this.__reRender();return}if(this.__shouldReRender===true){return}},__needsImpl:function(key){var funcName;var ret=true;if(typeof key==="object"){for(var i=0,len=key.length;i<len;i++){funcName="__update"+Top.Util.capitalizeFirstLetter(key[i]);if(this[funcName]===undefined&&typeof this.__reRender==="function"&&!Top.Util.__isStyleProperty(key[i])){ret=false}if(ret===false&&this[funcName]===undefined&&Top.Util.__isStyleProperty(key[i])){this.updateStyle(key[i])}}}else if(typeof key==="string"){funcName="__update"+Top.Util.capitalizeFirstLetter(key);if(this[funcName]===undefined&&typeof this.__reRender==="function"&&!Top.Util.__isStyleProperty(key)){ret=false}if(ret===false&&this[funcName]===undefined&&Top.Util.__isStyleProperty(key)){this.updateStyle(key)}}return ret},__updatePropertiesImpl:function(key){var customFnName=this[key.concat("Changed")];var resourcePattern=/^@(string|color|dimen|raw|drawable|style|theme)(\/[a-zA-Z0-9]+)+$/gm;if(typeof customFnName==="function"&&this.__intialized===true){customFnName.call(Top.Dom.selectById(this.id));return}var funcName="__update"+Top.Util.capitalizeFirstLetter(key);if(this.__initialized===true){var originValue=this[key];if(resourcePattern.test(this[key])){var modifiedValue;var resourceType=originValue.split("/")[0];var resourceId=originValue.substr(originValue.indexOf("/")+1);switch(resourceType){case"@drawable":{modifiedValue=Top.DrawableManager.get(resourceId);break}case"@raw":{modifiedValue=Top.RawManager.get(resourceId);break}default:{resourceId=resourceId.substr(0,resourceId.lastIndexOf("/"));var resourceName=originValue.split("/");resourceName=resourceName[resourceName.length-1];switch(resourceType){case"@string":{modifiedValue=Top.ValuesManager.get("strings",resourceId)[resourceName];break}case"@color":{modifiedValue=Top.ValuesManager.get("colors",resourceId)[resourceName];break}case"@dimen":{modifiedValue=Top.ValuesManager.get("dimen",resourceId)[resourceName];break}}}}this[key]=modifiedValue}this[key]=this.__getValueByDataConverter(this[key]);if(typeof this[funcName]==="function"){this[funcName]()}else if(Top.Util.__isStyleProperty(key)){this.updateStyle(key)}else if(typeof this.__reRender==="function"){this.__shouldReRender=true}else{}}},__widgetAttached:function(){if(this.tooltip)this.__updateTooltip();else if(this.tooltipTop)this.__updateTooltipTop();else if(this.tooltipBottom)this.__updateTooltipBottom();else if(this.tooltipLeft)this.__updateTooltipLeft();else if(this.tooltipRight)this.__updateTooltipTopRight();if(this.menu)this.__updateMenu()},__updateTooltip:function(){var thisPageId=Top.App.getCurrentPage().id;var _this=this;function setTooltipPosition(e){if(!Top.App.isWidgetAttached(_this.id)||!_this.tooltip){document.querySelector("#"+thisPageId+" .top-tooltip-text").style.display="none";window.removeEventListener("mousemove",setTooltipPosition);return}var tooltipText=document.querySelector("#"+thisPageId+" .top-tooltip-text");var x=e.clientX+window.pageXOffset+20,y=e.clientY+window.pageYOffset+20;tooltipText.innerHTML=_this.__i18n(_this.tooltip);tooltipText.style.top=y+"px";tooltipText.style.left=x+"px";e.preventDefault()}this.__addEventFnByCore("eventMouseEnter",function(){if(_this.tooltip===""){document.querySelector("#"+thisPageId+" .top-tooltip-text").style.display="none";return}window.addEventListener("mousemove",setTooltipPosition);document.querySelector("#"+thisPageId+" .top-tooltip-text").style.display="inline-block"});this.__addEventFnByCore("eventMouseExit",function(){document.querySelector("#"+thisPageId+" .top-tooltip-text").style.display="none";window.removeEventListener("mousemove",setTooltipPosition)});Top.App.onWidgetDetach(this.id,function(){document.querySelector("#"+thisPageId+" .top-tooltip-text").style.display="none";window.removeEventListener("mousemove",setTooltipPosition)})},__updateTooltipTop:function(){var thisPageId=Top.App.getCurrentPage().id;var _this=this;var caller=this.getElement();if(this.tagName==="TOP-RADIOBUTTON"){caller=this.getElement(".top-radiobutton-text")[0]}else if(this.tagName==="TOP-CHECKBOX"){caller=this.getElement(".top-checkbox-text")[0]}this.__addEventFnByCore("eventMouseEnter",function(){var $tooltipText=$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=$("#"+thisPageId+" .top-tooltip-arrow");var $thispage=$("#"+thisPageId);$tooltipText.addClass("top");$tooltipArrow.addClass("top");$tooltipText.text(_this.__i18n(_this.tooltipTop));var arrowTop=_this.getOffsetTop(caller)-$tooltipArrow.height()-2;var arrowLeft=_this.getOffsetLeft(caller)+caller.offsetWidth/2-4;var textTop=arrowTop-10-$tooltipText.height();var textWidth=$tooltipText.width();var textLeft=arrowLeft-textWidth/2-4;if(textLeft+textWidth>$thispage.width()){textLeft=$thispage.width()-textWidth}if(textLeft<=0){textLeft=0}if(textTop<=0){textTop=0}$tooltipText.css("top",textTop);$tooltipText.css("left",textLeft);$tooltipArrow.css("top",arrowTop);$tooltipArrow.css("left",arrowLeft);$tooltipText.css("display","inline-block");$tooltipArrow.css("display","inline-block")});this.__addEventFnByCore("eventMouseExit",function(){var $tooltipText=$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=$("#"+thisPageId+" .top-tooltip-arrow");$tooltipText.removeClass("top");$tooltipArrow.removeClass("top");$tooltipText.css("top","auto");$tooltipText.css("left","auto");$tooltipText.css("display","none");$tooltipArrow.css("display","none")})},__updateTooltipBottom:function(){var thisPageId=Top.App.getCurrentPage().id;var _this=this;var caller=this.getElement();if(this.tagName==="TOP-RADIOBUTTON"){caller=this.getElement(".top-radiobutton-text")[0]}else if(this.tagName==="TOP-CHECKBOX"){caller=this.getElement(".top-checkbox-text")[0]}this.__addEventFnByCore("eventMouseEnter",function(){var $tooltipText=$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=$("#"+thisPageId+" .top-tooltip-arrow");$tooltipText.addClass("bottom");$tooltipArrow.addClass("bottom");$tooltipText.text(_this.__i18n(_this.tooltipBottom));var arrowTop=_this.getOffsetTop(caller)+caller.offsetHeight+$tooltipArrow.height()-4;var arrowLeft=_this.getOffsetLeft(caller)+caller.offsetWidth/2-4;var textTop=arrowTop+3;var textWidth=$tooltipText.width();var textLeft=arrowLeft-textWidth/2;-4;if(textLeft<=0){textLeft=0}if(textTop<=0){textTop=0}$tooltipText.css("top",textTop);$tooltipText.css("left",textLeft);$tooltipArrow.css("top",arrowTop);$tooltipArrow.css("left",arrowLeft);$tooltipText.css("display","inline-block");$tooltipArrow.css("display","inline-block")});this.__addEventFnByCore("eventMouseExit",function(){var $tooltipText=$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=$("#"+thisPageId+" .top-tooltip-arrow");$tooltipText.removeClass("bottom");$tooltipArrow.removeClass("bottom");$tooltipText.css("top","auto");$tooltipText.css("left","auto");$tooltipText.css("display","none");$tooltipArrow.css("display","none")})},__updateTooltipLeft:function(){var thisPageId=Top.App.getCurrentPage().id;var _this=this;var caller=this.getElement();if(this.tagName==="TOP-RADIOBUTTON"){caller=this.getElement(".top-radiobutton-text")[0]}else if(this.tagName==="TOP-CHECKBOX"){caller=this.getElement(".top-checkbox-text")[0]}this.__addEventFnByCore("eventMouseEnter",function(){var $tooltipText=$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=$("#"+thisPageId+" .top-tooltip-arrow");$tooltipText.addClass("left");$tooltipArrow.addClass("left");$tooltipText.text(_this.__i18n(_this.tooltipLeft));var arrowTop=_this.getOffsetTop(caller)+caller.offsetHeight/2-4;var arrowLeft=_this.getOffsetLeft(caller)-9;var textTop=arrowTop-$tooltipText.height()/2-3;var textWidth=$tooltipText.width();var textLeft=arrowLeft-textWidth-12;if(textLeft<=0){textLeft=0}if(textTop<=0){textTop=0}$tooltipText.css("top",textTop);$tooltipText.css("left",textLeft);$tooltipArrow.css("top",arrowTop);$tooltipArrow.css("left",arrowLeft);$tooltipText.css("display","inline-block");$tooltipArrow.css("display","inline-block")});this.__addEventFnByCore("eventMouseExit",function(){var $tooltipText=$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=$("#"+thisPageId+" .top-tooltip-arrow");$tooltipText.removeClass("left");$tooltipArrow.removeClass("left");$tooltipText.css("top","auto");$tooltipText.css("left","auto");$tooltipText.css("display","none");$tooltipArrow.css("display","none")})},__updateTooltipTopRight:function(){var thisPageId=Top.App.getCurrentPage().id;var _this=this;var caller=this.getElement();if(this.tagName==="TOP-RADIOBUTTON"){caller=this.getElement(".top-radiobutton-text")[0]}else if(this.tagName==="TOP-CHECKBOX"){caller=this.getElement(".top-checkbox-text")[0]}this.__addEventFnByCore("eventMouseEnter",function(){var $tooltipText=$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=$("#"+thisPageId+" .top-tooltip-arrow");$tooltipText.addClass("right");$tooltipArrow.addClass("right");$tooltipText.text(_this.__i18n(_this.tooltipRight));var arrowTop=_this.getOffsetTop(caller)+caller.offsetHeight/2-4;var arrowLeft=_this.getOffsetLeft(caller)+caller.offsetWidth+4;var textTop=arrowTop-$tooltipText.height()/2-3;var textWidth=$tooltipText.width();var textLeft=arrowLeft+3;if(textLeft<=0){textLeft=0}if(textTop<=0){textTop=0}$tooltipText.css("top",textTop);$tooltipText.css("left",textLeft);$tooltipArrow.css("top",arrowTop);$tooltipArrow.css("left",arrowLeft);$tooltipText.css("display","inline-block");$tooltipArrow.css("display","inline-block")});this.__addEventFnByCore("eventMouseExit",function(){var $tooltipText=$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=$("#"+thisPageId+" .top-tooltip-arrow");$tooltipText.removeClass("right");$tooltipArrow.removeClass("right");$tooltipText.css("top","auto");$tooltipText.css("left","auto");$tooltipText.css("display","none");$tooltipArrow.css("display","none")})},__updateMenu:function(){var _this=this;this.addEventListener("contextmenu",function(e){if(_this.tagName==="TOP-TREEVIEW"&&(e.target.tagName==="TOP-TREEVIEW"||e.target.tagName==="UL"||e.target.tagName==="LI")){Top.ContextMenu.getDom().close();e.preventDefault();e.stopPropagation()}else{var contextMenu=document.querySelectorAll("top-contextmenu .top-contextmenu-container.open");if(contextMenu){for(var i=0;i<contextMenu.length;i++){var menuId=contextMenu[i].parentNode.parentNode.id;if(menuId){Top.Dom.selectById(menuId).close()}}}Top.Dom.selectById(this.menu).open(e);e.preventDefault();e.stopPropagation()}},false)},__initialClassname:function(){var classTest;switch(this.tagName){case"TOP-TABLEVIEW":{classTest=/(table_02)|(table_03)|(table_01)|(white)|(normal)/g;if(!classTest.test(this.class)){$(this).addClass("table_01")}break}case"TOP-TABLAYOUT":{classTest=/(light)|(dark)|(tab_01)|(tab_02)|(tab_03)|(tab_04)/g;if(!classTest.test(this.class)){$(this).addClass("tab_01")}break}case"TOP-MENU":{classTest=/(menu_01)|(menu_02)/g;if(this.type==="side"&&!classTest.test(this.class)){$(this).addClass("menu_01")}break}case"TOP-ALARMBADGE":{classTest=/(badge_01)|(badge_02)/g;if(!classTest.test(this.class)){$(this).addClass("badge_01")}break}case"TOP-TEXTFIELD":{classTest=/(in_textfield)|(out_textfield)/g;if(!classTest.test(this.class)){$(this).addClass("in_textfield")}break}case"TOP-ACCORDION":{classTest=/(accordion_01)|(accordion_02)/g;if(!classTest.test(this.class)){$(this).addClass("accordion_01")}break}case"TOP-DIALOG":{classTest=/(popup_01)|(popup_02)/g;if(!classTest.test(this.class)){$(this).addClass("popup_01")}break}}},getParent:function(){if(this.layoutParent===undefined){var element=this;while(element.parentNode){element=element.parentNode;if(Top.Util.__isTopWidget(element.tagName)===true){return element}}return undefined}else{return this.layoutParent}},getOffsetLeft:function(elem){var offsetLeft=0;do{if(!isNaN(elem.offsetLeft)){offsetLeft+=elem.offsetLeft}}while(elem=elem.offsetParent);return offsetLeft},getOffsetTop:function(elem){var offsetTop=0;do{if(!isNaN(elem.offsetTop)){offsetTop+=elem.offsetTop}}while(elem=elem.offsetParent);return offsetTop},__getValueByDataConverter:function(value,params){if(!this.__boundData||this.__boundData&&!this.__boundData["DataConverter"])return value;return this.__boundData["DataConverter"].convert(value,params)},__setValueByDataConverter:function(value,params){if(!this.__boundData||this.__boundData&&!this.__boundData["DataConverter"])return value;return this.__boundData["DataConverter"].convertBack(value,params)},__updateMenuId:function(){this.menu=this.menuId},expectedTemplateClassName:function(){return this.nodeName.toLowerCase()+"-root"},isTemplateAppended:function(){var innerStr=this.innerHTML.trim();if(this.__isCustomWidget){if(!this.__isTemplateAppended||innerStr===""||innerStr===undefined){return false}else{return true}}if(!(typeof this.appendTemplate==="function")){return true}if(this.nodeName==="TOP-TABLEVIEW"||this.nodeName==="TOP-MENU"){if(this.firstElementChild&&this.firstElementChild.nodeName==="DIV"){return true}}if(this.firstElementChild&&this.firstElementChild.classList.contains(this.expectedTemplateClassName())){return true}if(this.__isTemplateAppended){return true}return false}};TopWidgetBehavior=[TopWidgetBehaviorImpl,TopElementBehavior,TopControlBehavior,TopDataBehavior,TopDeviceBehavior,TopI18nBehavior,TopCommonStyleBehavior,TopEventBehavior];Top.Widget=function(){Widget.prototype=Object.create(Top.prototype);Widget.prototype.constructor=Widget;function Widget(){}Widget.create=function(tagName,props,__element){var type=this.getType(tagName);var parentType=this.getParentType(type);if(parentType!==null){var creator=Top.Widget[parentType][type]}else{var creator=Top.Widget[type]}if(typeof creator==="function"){var widget=creator.create(__element);if(props){var keys=Object.keys(props);for(var i=0,len=keys.length;i<len;i++){var attrName=keys[i];widget.template.setAttribute(Top.Util.toDash(keys[i]),props[attrName])}}if(!__element){var topWidget=topWidgets[widget.template.tagName.toLowerCase()];_initProperties(topWidget,widget.template);_prepAllBehaviors(topWidget,widget.template);if(Top.App.isLoaded()){_callCallback(widget.template,"created");_callCallback(widget.template,"ready");createdNodes.push(widget.template)}}widget.id=widget.template.id}else{var customType=Top.Util.capitalizeFirstLetter(Top.Util.toCamelCase(tagName));if(Top.Widget[customType]!==undefined){var widget=Top.Widget[customType].create(__element)}else{console.error("Type error: "+tagName+" is not defined.");return undefined}}return widget};Widget.getType=function(tagName){if(tagName==="top-graph-navigator"){return"GraphNavigator"}else if(topWidgets[tagName].isCustomType){return Top.Util.capitalizeFirstLetter(Top.Util.toCamelCase(tagName))}else if(tagName.startsWith("top-")){return Top.Util.capitalizeFirstLetter(tagName.split("-")[1])}else{return null}};Widget.getParentType=function(type){var layouts=["Absolutelayout","Linearlayout","Framelayout","Docklayout","Gridlayout","Tablayout","Accordionlayout","Scrolllayout","Form","Foldinglayout","Layout","Splitterlayout"];var containers=["Listview","Tableview","Panel"];var groups=["Imageslider","Selectbox","Treeview","Widgetitem","Accordiontab"];var menu=["Drawermenu","Contextmenu"];if(layouts.includes(type)){return"Layout"}else if(containers.includes(type)){return"Container"}else if(groups.includes(type)){return"Group"}else if(menu.includes(type)){return"Menu"}else{return null}};Widget.prototype.updateData=function(){this.template.updateData()};Widget.prototype.updateDevice=function(){this.template.updateDevice()};Widget.prototype.__initProperties=function(properties){var keys=Object.keys(properties);for(var i=0,len=keys.length;i<len;i++){this.template[keys[i]]=properties[keys[i]]}};Widget.prototype.setProperties=function(properties,__isFromData,__isFromDevice){var keys=Object.keys(properties);for(var i=0,len=keys.length;i<len;i++){if(this.template.__isCustomWidget){if(topWidgets[this.template.tagName.toLowerCase()].customProps.indexOf(keys[i])>=0){var customPropChild=this.template.customPropChild[keys[i]];var customPropAttr=this.template.customPropAttr[keys[i]];for(var j=0;j<customPropChild.length;j++){customPropChild[j].setAttribute(customPropAttr[j].name,properties[keys[i]]);customPropChild[j][Top.Util.toCamelCase(customPropAttr[j].name)]=properties[keys[i]]}}}if(keys[i]==="id")this.id=this.template.id;if(keys[i]==="class")this.addClass(properties[keys[i]]);if(keys[i].includes("-")){var attrName=keys[i];keys[i]=keys[i].replace(/-([a-z])/g,function(g){return g[1].toUpperCase()});if(this.template.tagName==="TOP-TABLEVIEW"&&attrName==="scroll-height"){keys[i]="scrollBodyHeight"}if(properties[attrName]==="true")properties[attrName]=true;if(properties[attrName]==="false")properties[attrName]=false;if(topWidgets[this.template.tagName.toLowerCase()].reflectToAttributeList.indexOf(keys[i])>=0){this.template.setAttribute(Top.Util.toDash(keys[i]),properties[attrName])}this.template[keys[i]]=properties[attrName]}else{if(properties[keys[i]]==="true")properties[keys[i]]=true;if(properties[keys[i]]==="false")properties[keys[i]]=false;if(topWidgets[this.template.tagName.toLowerCase()].reflectToAttributeList.indexOf(keys[i])>=0){this.template.setAttribute(keys[i],properties[keys[i]])}this.template[keys[i]]=properties[keys[i]]}}if(this.isAttached()||this.template.tagName==="TOP-POPOVER"){this.template.__updateProperties(keys);if(!__isFromData)this.template.updateData(keys);if(!__isFromDevice)this.template.__updateBoundDevices(keys);if(this.template.__isCustomWidget){for(var i=0,len=keys.length;i<len;i++){var dashedKey=Top.Util.toDash(keys[i]);if(topWidgets[this.template.tagName.toLowerCase()].customProps.indexOf(dashedKey)>=0){for(var j=0;j<this.template.customPropAttr[dashedKey].length;j++){var camelName=Top.Util.toCamelCase(this.template.customPropAttr[dashedKey][j].name);this.template.customPropChild[dashedKey][j].__updateProperties(camelName)}}}}}else{var _this=this;Top.App.onWidgetAttach(this.template.id,function(){if(typeof _this.template.__updateProperties==="function")_this.template.__updateProperties(keys);if(!__isFromData&&typeof _this.template.updateData==="function")_this.template.updateData(keys);
if(!__isFromDevice&&typeof _this.template.__updateBoundDevices==="function")_this.template.__updateBoundDevices(keys);if(_this.template.__isCustomWidget){for(var i=0,len=keys.length;i<len;i++){var dashedKey=Top.Util.toDash(keys[i]);if(topWidgets[_this.template.tagName.toLowerCase()].customProps.indexOf(dashedKey)>=0){for(var j=0;j<_this.template.customPropAttr[dashedKey].length;j++){var camelName=Top.Util.toCamelCase(_this.template.customPropAttr[dashedKey][j].name);_this.template.customPropChild[dashedKey][j].__updateProperties(camelName)}}}}})}};Widget.prototype.setChecked=function(checked){this.setProperties({checked:checked})};Widget.prototype.setText=function(text){this.setProperties({text:text})};Widget.prototype.setDisabled=function(disabled){this.setProperties({disabled:disabled})};Widget.prototype.setVisible=function(visible){this.setProperties({visible:visible})};Widget.prototype.setSrc=function(src){this.setProperties({src:src})};Widget.prototype.setHref=function(href){this.setProperties({href:href})};Widget.prototype.getElement=function(selector){return this.template.getElement(selector)};Widget.prototype.getProperties=function(key){if(key.includes("-")){key=key.replace(/-([a-z])/g,function(g){return g[1].toUpperCase()})}if(key==="data"&&this.template.tagName==="TOP-TABLEVIEW")return this.getItems();if(key==="title"&&(this.template.tagName==="TOP-SELECTBOX"||this.template.tagName==="TOP-TEXTFIELD"))return this.template["originTitle"];if(this.template[key]!==undefined)return this.template[key];else if(this.template.attributes[key])return this.template.attributes[key].value;else return undefined};Widget.prototype.getChecked=function(checked){return this.template["checked"]};Widget.prototype.getText=function(){return this.template["text"]};Widget.prototype.getValue=function(){return this.template["value"]};Widget.prototype.getDisabled=function(){return this.template["disabled"]};Widget.prototype.getVisible=function(){return this.template["visible"]};Widget.prototype.getSrc=function(){return this.template["src"]};Widget.prototype.getHref=function(){return this.template["href"]};Widget.prototype.onEvent=function(type,functionObj){var eventType="event".concat(Top.Util.capitalizeFirstLetter(type));if(typeof this.template.__removeEventFn==="function")this.template.__removeEventFn(eventType);if(functionObj===""){this.template[eventType]=""}else{if(typeof this.template.__addEventFn==="function")this.template.__addEventFn(eventType,functionObj)}};Widget.prototype.offEvent=function(type){var eventType="event".concat(Top.Util.capitalizeFirstLetter(type));this.template.__removeEventFn(eventType)};Widget.prototype.addClass=function(className){this.template.className+=" "+className};Widget.prototype.removeClass=function(className){var classCheck=new RegExp("(\\s|^)"+className+"(\\s|$)");this.template.className=this.template.className.replace(classCheck," ").trim()};Widget.prototype.toggleClass=function(className){var classCheck=new RegExp("(\\s|^)"+className+"(\\s|$)");if(classCheck.test(this.template.className)){this.template.className=this.template.className.replace(classCheck," ").trim()}else{this.template.className+=" "+className}};Widget.prototype.hasClass=function(className){var classLength=this.template.classList.length;for(var i=0;i<classLength;i++){if(className===this.template.classList[i])return true}return false};Widget.prototype.getParent=function(){return Top.Dom.selectById(this.template.getParent().id)};Widget.prototype.getController=function(){return this.template.getController()};Widget.prototype.isAttached=function(){return!!this.template.__isAttached};Widget.prototype.focus=function(){this.template.focus()};Widget.prototype.blur=function(){this.template.blur()};Widget.prototype.style=function(propertyName,value){if(typeof propertyName==="object"){var names=Object.keys(propertyName);for(var i=0,len=names.length;i<len;i++){var value=propertyName[names[i]];this.__getElementForStyle().style[names[i]]=value}}else if(typeof propertyName==="string"){this.__getElementForStyle().style[propertyName]=value}};Widget.prototype.__getElementForStyle=function(){if(this.template.tagName==="TOP-TEXTFIELD"){return this.template.getElement("input")[0]}else if(this.template.tagName==="TOP-TEXTAREA"){return this.template.getElement("textarea")[0]}else{return this.template.getElement()}};Widget.prototype.getWidth=function(){return this.getElement().offsetWidth};Widget.prototype.getHeight=function(){return this.getElement().offsetHeight};Widget.prototype.addEventListener=function(type,listener,options){this.template.__addEventListener(type,listener,options)};Widget.prototype.removeEventListener=function(type,listener,options){this.template.__removeEventByAttr(type);this.template.__removeEventListener(type,listener,options)};Widget.prototype.dispatchEvent=function(event){this.template.__dispatchEvent(event)};Widget.prototype.getIndex=function(){if(this.template.index>-1){return this.template.index}else if(this.template.dataIndex>-1){return this.template.dataIndex}};Widget.prototype.bindData=function(data){this.template.dataModel=data;this.template.__initBoundData(true)};return Widget}();Top.CustomWidget=function(){function CustomWidget(){}CustomWidget.propsList={};CustomWidget.templates={};CustomWidget.create=function(name,settings){if(typeof name==="string"&&typeof settings==="object"){this.propsList[name]=settings;this.__createWidgetObject(name)}else{console.error("Type error: Top.CustomWidget.create(string, object)")}};CustomWidget.__createWidgetObject=function(name){var pascalName=Top.Util.capitalizeFirstLetter(Top.Util.toCamelCase(name));Top.Widget[pascalName]=function(){eval(pascalName+".prototype = Object.create(Top.Widget.prototype);"+pascalName+".prototype.constructor = "+pascalName+"; function "+pascalName+'(element) { if(element instanceof Element) { this.template = element; } else { this.template = document.createElement("'+name+'"); } this.id = this.template.id; var props = Top.CustomWidget.getProps("'+name+'"); var keys = Object.keys(props); for (var i = 0, len = keys.length; i < len; i++) { if (keys[i] !== "template" && keys[i] !== "init") { if(keys[i].endsWith("Changed")) { this.template[keys[i]] = props[keys[i]]; } else { this[keys[i]] = props[keys[i]]; } } } }');eval(pascalName+".create = function(obj) { return new "+pascalName+"(obj); };");eval(pascalName+'.prototype.getChildren = function(selector) { var widgets = []; if (typeof selector === "string") { var elements = this.template.querySelectorAll(selector); } else { var elements = this.template.childNodes; } for (var i = 0, len = elements.length; i < len; i++) { if(Top.Util.__isTopWidget(elements[i].tagName)) { widgets.push(Top.Dom.__selectImpl(elements[i])); } } return widgets; };');return eval(pascalName)}();topWidgets[name]={is:name,isCustomType:true,customProps:[],behaviors:[TopWidgetBehavior,TopLayoutBehavior],__ready:function(){if(!this.__initialized){var template=Top.CustomWidget.getProps(name).template;this.__initTemplate(template);_insertedNodesCallback()}this.__initProps();this.__isCustomWidget=true},appendTemplate:function(){var template=Top.CustomWidget.getProps(name).template;if(Top.Util.getFileExtension(template)==="html"){if(Top.CustomWidget.templates[name]){this.__initTemplate(Top.CustomWidget.templates[name])}else{var _this=this;Top.Ajax.execute(template,{async:false,success:function(data,textStatus,jqXHR){Top.CustomWidget.templates[name]=data;_this.__initTemplate(data)}})}}else{this.__initTemplate(template)}this.__isTemplateAppended=true},__initProps:function(){var _this=this;Array.prototype.slice.call(this.attributes).forEach(function(item){_this[item.name]=item.value})},__initTemplate:function(template){this.customPropChild=[];this.customPropAttr=[];var inner=this.innerHTML.trim();var props=Top.CustomWidget.getProps(name);var matches=template.match(/\{\{([a-zA-Z0-9_-]+)\}\}/g);if(matches){for(var i=0,len=matches.length;i<len;i++){var re=new RegExp(matches[i],"gi");var prop=matches[i].replace("{{","").replace("}}","");if(topWidgets[name].customProps.indexOf(prop)===-1){topWidgets[name].customProps.push(prop)}if(props[prop]!==undefined){var value=props[prop]}else{var value=this.getAttribute(prop)||this[Top.Util.toCamelCase(prop)]}}}this.innerHTML=template;var keys=Object.keys(props);for(var i=0,len=keys.length;i<len;i++){this[keys[i]]=props[keys[i]]}this.__initChildren();this.initializeHtmlObjects(this);this.__findCustomProps(this);if(typeof props.init==="function"){var widget=Top.Dom.__selectImpl(this);widget.innerHTML=inner;props.init.call(widget)}this.__initialized=true},__findCustomProps:function(child){if(!child.children)return;for(var i=0;i<child.children.length;i++){for(var j=0;j<child.children[i].attributes.length;j++){for(var k=0;k<topWidgets[name].customProps.length;k++){if(child.children[i].attributes[j].value==="{{"+topWidgets[name].customProps[k]+"}}"){if(!this.customPropChild[topWidgets[name].customProps[k]]){this.customPropChild[topWidgets[name].customProps[k]]=[]}this.customPropChild[topWidgets[name].customProps[k]].push(child.children[i]);if(!this.customPropAttr[topWidgets[name].customProps[k]]){this.customPropAttr[topWidgets[name].customProps[k]]=[]}this.customPropAttr[topWidgets[name].customProps[k]].push(child.children[i].attributes[j]);for(var l=0;l<this.customPropChild[topWidgets[name].customProps[k]].length;l++){this.customPropChild[topWidgets[name].customProps[k]][l][Top.Util.toCamelCase(this.customPropAttr[topWidgets[name].customProps[k]][l].name)]=this.getAttribute(topWidgets[name].customProps[k]);this.customPropChild[topWidgets[name].customProps[k]][l].setAttribute(this.customPropAttr[topWidgets[name].customProps[k]][l].name,this.getAttribute(topWidgets[name].customProps[k]))}}var data=child.children[i].dataModel||child.children[i].data;if(data){var dataObj=JSON.parse(data);var keys=Object.keys(dataObj);for(var l=0,len=keys.length;l<len;l++){if(dataObj[keys[l]].includes("{{"+topWidgets[name].customProps[k]+"}}")){dataObj[keys[l]]=dataObj[keys[l]].replace("{{"+topWidgets[name].customProps[k]+"}}",this.getAttribute(topWidgets[name].customProps[k]));child.children[i].data=JSON.stringify(dataObj)}}}}}this.__findCustomProps(child.children[i])}},__initChildren:function(){if(this.childRoot)var root=this.childRoot;else var root=this;for(var i=0,len=root.childNodes.length;i<len;i++){root.childNodes[i].layoutParent=this}},setAllTopStyle:function(){}};_prepBehaviors(topWidgets[name])};CustomWidget.getProps=function(name){return this.propsList[name]};return CustomWidget}();TopCheckBehavior={properties:{checked:{type:String,value:false},groupId:String},ready:function(){this.__initCheck()},__initCheck:function(){if(this.checked==="true")this.checked=true;if(this.checked==="false")this.checked=false;if(this.localName==="top-toggle"){if(this.checked===true){this.on()}else{this.off()}}}};TopContainerBehavior={properties:{items:{type:String},itemField:String,itemBinding:String,itemLayout:String,itemLayoutDom:Object,arrModelRef:Object,itemSwitchLogic:String,separatorVisible:String,separatorColor:String,separatorSize:String,itemClicktype:{type:String,value:"click"},__isContainer:{type:Boolean,value:true}},initialLayout:function(){this.itemLayout=$(this.childRoot).html();this.itemLayoutDom=$(this.childRoot).children();if(this.itemSwitchLogic){if(this.itemSwitchLogic.startsWith("{")){this.itemSwitchField=this.itemSwitchLogic.substring(1,this.itemSwitchLogic.indexOf("}"))}else this.itemSwitchFunc=Top.Util.namespace(this.itemSwitchLogic,this)}},initialChilds:function(){this.childs=$(this.childRoot).children();var len=this.childs.length;for(var i=0;i<len;i++){this.childs[i].layoutParent=this}},clearLayout:function(){var myNode=this.childRoot;while(myNode.firstChild){this.clearDeepChilds(myNode.firstChild);myNode.removeChild(myNode.firstChild)}},clearDeepChilds:function(parentNode){while(parentNode.firstChild){while(parentNode.firstChild.firstChild){this.clearDeepChilds(parentNode.firstChild)}parentNode.removeChild(parentNode.firstChild)}},getSwitchedItem:function(){var switchedItem=[];var defaultItem;var regex1=/^.*\>+.*|.*\<+.*|.*\=+.*$/;var regex2=/^[-+.]?[0-9,]*[.]?[0-9]+$/;var bool;if(this.items&&typeof this.items==="string")var items=Top.Util.namespace(this.items,this);else if(typeof this.items==="object")var items=this.items;if(this.itemSwitchField){for(var i=0;i<items.length;i++){for(var j=0;j<this.itemLayoutDom.length;j++){if(!this.itemLayoutDom[j].attributes["item-switch-case"]){if(defaultItem===undefined)defaultItem=this.itemLayoutDom[j];break}var caseValue=this.itemLayoutDom[j].attributes["item-switch-case"].value;var itemCase;var fieldValue=items[i][this.itemSwitchField];bool=regex2.test(fieldValue);if(bool===true||typeof fieldValue==="number"){if(caseValue.startsWith("lt"))caseValue=caseValue.replace("lt","<");if(caseValue.startsWith("gt"))caseValue=caseValue.replace("gt",">");if(caseValue.startsWith("le"))caseValue=caseValue.replace("le","<=");if(caseValue.startsWith("ge"))caseValue=caseValue.replace("ge",">=");if(caseValue.startsWith("eq"))caseValue=caseValue.replace("eq","==");if(caseValue.startsWith("ne"))caseValue=caseValue.replace("ne","!=");itemCase=fieldValue+caseValue}else if(bool===false){if(caseValue.startsWith("ne")){caseValue=caseValue.replace("ne ","").replace("ne","");itemCase='"'+caseValue+'"';itemCase+=' != "'+fieldValue+'"'}else{caseValue=caseValue.replace("eq ","").replace("eq","");itemCase='"'+caseValue+'"';itemCase+=' == "'+fieldValue+'"'}}if(eval(itemCase)){switchedItem[i]=this.itemLayoutDom[j]}}if(switchedItem[i]===undefined)switchedItem[i]=defaultItem}}else if(this.itemSwitchFunc){for(var i=0;i<items.length;i++){var ret=this.itemSwitchFunc(items[i]);for(var j=0;j<this.itemLayoutDom.length;j++){if(!this.itemLayoutDom[j].attributes["item-switch-case"]){if(defaultItem===undefined)defaultItem=this.itemLayoutDom[j];break}if(this.itemLayoutDom[j].attributes["item-switch-case"].value==ret){switchedItem[i]=this.itemLayoutDom[j]}}if(switchedItem[i]===undefined)switchedItem[i]=defaultItem}}return switchedItem},createHtmlObjects:function(child,addNodes){if(topWidgets[child.tagName.toLowerCase()]!==undefined){var topWidget=topWidgets[child.tagName.toLowerCase()];_initProperties(topWidget,child);_prepAllBehaviors(topWidget,child);if(!child.isTemplateAppended())child.appendTemplate();if(Top.App.isLoaded()){_callCallback(child,"created");_callCallback(child,"ready");if(addNodes!==false)createdNodes.push(child);if(this.createdItemWidgets===undefined||!Array.isArray(this.createdItemWidgets)){this.createdItemWidgets=[]}this.createdItemWidgets.push(child)}}if(!child.children)return;for(var i=0;i<child.children.length;i++){this.createHtmlObjects(child.children[i],addNodes)}},createdItemWidgetAttachedCallback:function(){if(this.createdItemWidgets){for(var i=this.createdItemWidgets.length-1;i>=0;i--){_callCallback(this.createdItemWidgets[i],"attached")}this.createdItemWidgets=[]}}};Top.Widget.Container=function(){Container.prototype=Object.create(Top.Widget.prototype);Container.prototype.constructor=Container;function Container(){}Container.prototype.complete=function(){this.template.renderLayout()};Container.prototype.setItems=function(items){};Container.prototype.getItems=function(){var items;if(typeof this.template["items"]==="string")items=Top.Util.namespace(this.template["items"],this.template);else items=this.template["items"];return items};return Container}();TopGroupBehavior={properties:{widgetItems:[]},initItems:function(){if(this.tagName==="TOP-TREEVIEW"&&this.childRoot.children.length>0){this.widgetItems=[];for(var i=0;i<this.childRoot.children.length;i++){var tmp=this.childRoot.children[i];if(tmp.tagName.toLowerCase()==="top-widgetitem"){this.widgetItems.push(tmp)}}}else{this.widgetItems=this.querySelectorAll("top-widgetitem")}if(this.tagName==="TOP-LISTVIEW"||this.tagName==="TOP-TREEVIEW"){this.headerItem=this.tagName==="TOP-LISTVIEW"?$(this.childRoot).children("top-listheader"):$(this.childRoot).children("top-treeheader")}for(var i=0;i<this.widgetItems.length;i++){this.widgetItems[i].parentWidget=this}},clearItems:function(){var myNode=this.childRoot;while(myNode.firstChild){this.clearDeepChilds(myNode.firstChild);myNode.removeChild(myNode.firstChild)}},clearDeepChilds:function(parentNode){while(parentNode.firstChild){while(parentNode.firstChild.firstChild){this.clearDeepChilds(parentNode.firstChild)}parentNode.removeChild(parentNode.firstChild)}}};Top.Widget.Group=function(){Group.prototype=Object.create(Top.Widget.prototype);Group.prototype.constructor=Group;function Group(){}Group.prototype.is="top-groupbehavior";Group.prototype.template=TopGroupBehavior;Group.prototype.addItem=function(widget){this.template.widgetItems.push(widget.template)};Group.prototype.removeItem=function(widget){var childsArray=this.template.widgetItems;for(var i=0;i<childsArray.length;i++){if(widget.id==childsArray[i].id){this.template.widgetItems.splice(i,1)}}};Group.prototype.complete=function(){if(typeof this.template.__updateNodes==="function"){this.template.__updateNodes()}};return Group}();TopLayoutBehavior={properties:{childs:[],src:String,srcLoad:String,srcLoadListeners:[]},ready:function(){if(this.getElement()){this.getElement().addEventListener("scroll",function(e){$(".top-selectbox-container.active").click();var dropdownMenu=document.querySelectorAll('top-menu[type="dropdown"] .top-menu_btn.top-menu_open');if(dropdownMenu){for(var i=0;i<dropdownMenu.length;i++){dropdownMenu[i].parentNode.parentNode.parentNode.setDropdownPosition()}}var contextMenu=document.querySelectorAll("top-contextmenu .top-contextmenu-container.open");if(contextMenu){for(var i=0;i<contextMenu.length;i++){var menuId=contextMenu[i].parentNode.id;Top.Dom.selectById(menuId).close()}}$('[data-toggle="popover"],[data-original-title]').each(function(){if(!$(this).is(e.target)&&$(this).has(e.target).length===0&&$(".top-popover").has(e.target).length===0){(($(this).popover("hide").data("bs.popover")||{}).inState||{}).click=false}});Top.App.closeAutoCompleteContainers()})}},initialChilds:function(){if(this.childRoot){for(var i=0,len=this.childRoot.children.length;i<len;i++){this.childRoot.children[i].layoutParent=this}this.childs=$(this.childRoot).children()}else{for(var i=0,len=this.children.length;i<len;i++){this.children[i].layoutParent=this}this.childs=$(this).children()}},initialAppendedChilds:function(){this.childs=$(this).children();for(var i=0,len=this.childs.length;i<len;i++){if(this.childs[i].tagName==="DIV"){this.childs[i]=this.childs[i].childNodes[0]}this.childs[i].layoutParent=this}},clearChilds:function(directDetach){if(this.childRoot)var myNode=this.childRoot;else var myNode=this;while(myNode.firstChild){this.clearDeepChilds(myNode.firstChild,directDetach);if(directDetach===true&&myNode.firstChild.tagName&&topWidgets[myNode.firstChild.tagName.toLowerCase()]!==undefined)directDetachedNodes.push(myNode.firstChild);myNode.removeChild(myNode.firstChild)}if(directDetach===true)_directDetachNodesDetachedCallback()},clearDeepChilds:function(parentNode,directDetach){while(parentNode.firstChild){while(parentNode.firstChild.firstChild){this.clearDeepChilds(parentNode.firstChild)}if(directDetach===true&&parentNode.firstChild.tagName&&topWidgets[parentNode.firstChild.tagName.toLowerCase()]!==undefined)directDetachedNodes.push(parentNode.firstChild);parentNode.removeChild(parentNode.firstChild)}},__layoutAttached:function(){this.__initCursor();if(this.tagName!=="TOP-PAGE"){this.__initSrc()}},__initSrc:function(){if(typeof this.src==="string"){var _this=this;this.src=Top.Util.__getRawValue(this.src);Top.Ajax.execute(this.src,{success:function(data){var controllerPaths=Top.Util.__getControllerPaths(data);if(Top.App.__useCommonLogic()===true&&controllerPaths!==undefined){Top.App.__loadControllerFile(controllerPaths,function(_data){_this.__onSuccessSrcLoad(_data)},data)}else{_this.__onSuccessSrcLoad(data)}data=null}})}},__onSuccessSrcLoad:function(data,callback){this.clearChilds(true);this.appendHtmlString(data);_insertedNodesCallback();this.initialChilds();if(typeof this.srcLoad==="string"){this.srcLoad=Top.Util.namespace(this.srcLoad)}if(typeof this.srcLoad==="function")this.srcLoad();if(typeof callback==="function")callback();if(this.srcLoadListeners!==undefined){for(var i=0,len=this.srcLoadListeners.length;i<len;i++){if(typeof this.srcLoadListeners[i]==="function")this.srcLoadListeners[i]()}this.srcLoadListeners=[]}_srcRootNodesAttachedCallback()},__loadScript:function(url,callback){var script=document.createElement("script");script.src=url;script.onload=callback;document.getElementsByTagName("head")[0].appendChild(script)},updateStyle:function(keys){var layoutRenderFlag=false;if(keys!=null&&typeof keys==="object"){for(var i=0;i<keys.length;i++){if(!layoutRenderFlag){if(keys[i]==="layoutAlignParent"||keys[i]==="layoutRow"||keys[i]==="layoutColumn"||keys[i]==="layoutRowSpan"||keys[i]==="layoutColumnSpan"||keys[i]==="layoutTop"||keys[i]==="layoutLeft"||keys[i]==="layoutRight"||keys[i]==="layoutBottom"||keys[i]==="layoutTabName"||keys[i]==="layoutTabIcon"||keys[i]==="layoutTabDisabled"||keys[i]==="layoutWeight"||keys[i]==="layoutHorizontalAlignment"||keys[i]==="layoutVerticalAlignment"){layoutRenderFlag=true;break}}}if(layoutRenderFlag&&this.layoutParent){this.layoutParent.renderLayout()}}else if(typeof keys==="string"){stylekey=keys.replace(/[A-Z]/g,function(match){return"-"+match.toLowerCase()});var stylekeyMap=[["b-image","backgroundImage"],["tile-mode","background-repeat"],["text-color","color"],["horizontal-alignment","text-align"],["layout-vertical-alignment","vertical-align"],["horizontal-scroll","overflow-x"],["vertical-scroll","overflow-y"]];for(var j=0;j<stylekeyMap.length;j++){if(stylekey===stylekeyMap[j][0]){stylekey=stylekeyMap[j][1];if(stylekey==="overflow-x"||stylekey==="overflow-y"){if(this[keys]==="true"||this[keys]===true)this[keys]="auto";else if(this[keys]==="false"||this[keys]===false)this[keys]="hidden"}this.removeTopStyle(stylekey);this.setTopStyle(stylekey,this[keys]);return}}this.removeTopStyle(stylekey);this.setTopStyle(stylekey,this[keys]);return}this.topstyle="";this.setAllTopStyle();var bImage=this.backgroundImage;this.updatePositionValue(true);if(this.backgroundImage!=null){if(!this.backgroundImage.includes("url(")){if(this.backgroundImage.includes("@drawable")){bImage=Top.DrawableManager.get(this.backgroundImage.replace("@drawable/",""))}bImage="url("+bImage+")";this.__updateTileMode()}}if(this.verticalAlignment==null){this.verticalAlignment="middle"}if(this.verticalScroll==="true"||this.verticalScroll===true)this.verticalScroll="auto";if(this.horizontalScroll==="true"||this.horizontalScroll===true)this.horizontalScroll="auto";if(this.verticalScroll==="false"||this.verticalScroll===false)this.verticalScroll="hidden";if(this.horizontalScroll==="false"||this.horizontalScroll===false)this.horizontalScroll="hidden";if(this.borderWidth!=null||this.borderColor!=null){if(this.borderStyle==null){this.borderStyle="solid"}}if(this.layoutVerticalAlignment==null){this.layoutVerticalAlignment="top"}this.__updateDisabled();this.__updateDisplay();this.__updateVisible();this.__updateLayoutWidth();this.__updateLayoutHeight();this.__updateLayoutTop();this.__updateLayoutLeft();this.__updateLayoutRight();this.__updateLayoutBottom();this.setTopStyle("max-width",this.maxWidth);this.setTopStyle("min-width",this.minWidth);this.setTopStyle("max-height",this.maxHeight);this.setTopStyle("min-height",this.minHeight);this.setTopStyle("line-height",this.lineHeight);this.setTopStyle("background-color",this.backgroundColor);this.setTopStyle("background-image",bImage);this.setTopStyle("background-repeat",this.tileMode);this.setTopStyle("background",this.background);this.setTopStyle("opacity",this.opacity);this.setTopStyle("margin",this.margin);this.setTopStyle("padding",this.padding);this.setTopStyle("color",this.textColor);this.setTopStyle("border-width",this.borderWidth);this.setTopStyle("border-bottom-width",this.borderBottomWidth);this.setTopStyle("border-left-width",this.borderLeftWidth);this.setTopStyle("border-right-width",this.borderRightWidth);this.setTopStyle("border-top-width",this.borderTopWidth);this.setTopStyle("border-style",this.borderStyle);this.setTopStyle("border-color",this.borderColor);this.setTopStyle("border-radius",this.borderRadius);this.setTopStyle("z-index",this.zIndex);this.setTopStyle("position",this.position);this.setTopStyle("float",this.float);this.setTopStyle("cursor",this.cursor);this.setTopStyle("text-align",this.horizontalAlignment);this.setTopStyle("vertical-align",this.layoutVerticalAlignment);this.setTopStyle("overflow-x",this.horizontalScroll);this.setTopStyle("overflow-y",this.verticalScroll);this.setTopStyle("font-size","0");this.__initCursor()},__updateDisabled:function(){if(this.childRoot){var children=this.childRoot.children}else{var children=this.children}if(children!==undefined){var disabled=this.__calculateDerivedDisabled();if(this.childRoot){var firstTopChild=findTopTag(this.childRoot)}else{var firstTopChild=findTopTag(this)}if(firstTopChild===null)return;for(var i=0,len=firstTopChild.parentNode.children.length;i<len;i++){firstTopChild.parentNode.children[i].__derivedDisabled=disabled;if(typeof firstTopChild.parentNode.children[i].__updateDisabled==="function"){firstTopChild.parentNode.children[i].__updateDisabled()}}}function findTopTag(node){for(var i=0;i<node.children.length;i++){if(Top.Util.__isTopWidget(node.children[i].tagName)){return node.children[i]}return findTopTag(node.children[i])}return null}},__calculateDerivedDisabled:function(){return this.__derivedDisabled==="true"||this.__derivedDisabled===true?"true":Top.Util.Browser.isIE()?this.getAttribute("disabled"):this.disabled},__updateVisible:function(){this.removeTopStyle("visibility");if(this.visible===true||this.visible==="true")this.visible="visible";if(this.display!=="none")this.prevDisplay=this.display;if(this.parentNode)var parentLinear=this.parentNode.parentNode;if(this.visible=="none"){this.display="none";this.__updateDisplay();return}else if((this.visible==="visible"||this.visible==="hidden")&&this.display==="none"){this.display=this.prevDisplay;this.removeTopStyle("display");this.setTopStyle("display",this.display)}this.setTopStyle("visibility",this.visible);if(this.layoutParent&&typeof this.layoutParent.__reRenderChildDisplay==="function")this.layoutParent.__reRenderChildDisplay(this);if(this.visible==="visible"){var textfields=this.getElementsByTagName("top-textfield");if(Top.App.isLoaded()){Top.App.onWidgetAttach(this.id,function(){for(var i=0,len=textfields.len;i<len;i++){var item=textfields[i];if(item.__isAttached===true){item.setTitlePosition();item.setIconPosition()}}})}else{Top.App.onLoad(function(){for(var i=0,len=textfields.len;i<len;i++){var item=textfields[i];item.setTitlePosition();item.setIconPosition()}})}var tableviews=this.getElementsByTagName("top-tableview");for(var i=0;i<tableviews.length;i++){tableviews[i].__adjustBytablayout()}}this.__initCursor();if(this.__isAttached===true)this.adjustSize()},__updateDisplay:function(){this.removeTopStyle("display");if(this.display==null){this.display="inline-block"}this.setTopStyle("display",this.display);if(this.layoutParent&&typeof this.layoutParent.__reRenderChildDisplay==="function")this.layoutParent.__reRenderChildDisplay(this)},__updateLayoutWidth:function(){var borderRightWidth,borderLeftWidth;var layoutWidth=this.layoutWidth;if(this.borderWidth){borderRightWidth=this.borderRightWidth;borderLeftWidth=this.borderLeftWidth}else{borderRightWidth=borderLeftWidth=1}if(this.layoutWidth==null&&this.tagName!=="TOP-FOLDINGLAYOUT"){this.layoutWidth="100%"}if(this.layoutWidth&&this.layoutWidth.endsWith("%")){layoutWidth="calc("+this.layoutWidth+" - "+(parseInt(this.marginRight)+parseInt(this.marginLeft)+parseInt(this.paddingRight)+parseInt(this.paddingLeft)+parseInt(borderRightWidth)+parseInt(borderLeftWidth))+"px)"}if(this.layoutWidth==="match_parent")return;this.removeTopStyle("width");this.setTopStyle("width",layoutWidth);this.updatePositionValue(false)},__updateLayoutHeight:function(){if(!this.layoutHeight){return}var layoutHeight=this.layoutHeight;if(layoutHeight.indexOf("%")!==-1){if(this.parentNode&&this.parentNode.parentNode&&this.parentNode.parentNode.nodeName==="TOP-LINEARLAYOUT"&&this.parentNode.parentNode.getAttribute("orientation")==="vertical"){this.style.height=this.layoutHeight;layoutHeight="100%"}}if(layoutHeight.endsWith("%")){var boxing=parseInt(this.marginTop)+parseInt(this.marginBottom)+parseInt(this.paddingTop)+parseInt(this.paddingBottom)+parseInt(this.borderTopWidth)+parseInt(this.borderBottomWidth);layoutHeight="calc("+layoutHeight+" - "+boxing+"px)"}if(this.layoutHeight==="match_parent")return;this.removeTopStyle("height");this.setTopStyle("height",layoutHeight);this.updatePositionValue(false)},__initCursor:function(){if(this.__eventMouseClick&&typeof this.__eventMouseClick==="function"){if(this.childRoot)this.childRoot.style.cursor="pointer"}},appendHtmlString:function(htmlString){this.adjusted=false;var wrapper=document.createElement("div");wrapper.innerHTML=htmlString;this.initializeHtmlObjects(wrapper);while(wrapper.firstChild){if(wrapper.firstChild.tagName&&topWidgets[wrapper.firstChild.tagName.toLowerCase()]!==undefined)srcRootNode.push(wrapper.firstChild);if(this.childRoot)this.childRoot.appendChild(wrapper.firstChild);else this.appendChild(wrapper.firstChild)}},initializeHtmlObjects:function(child){if(!child.children)return;if(child.tagName==="TOP-TABLEVIEW"||child.tagName==="TOP-LISTVIEW"||child.tagName==="TOP-TREEVIEW"||child.tagName==="TOP-GRIDLAYOUT")return;for(var i=0;i<child.children.length;i++){if(child.children[i].tagName&&topWidgets[child.children[i].tagName.toLowerCase()]!==undefined){var topWidget=topWidgets[child.children[i].tagName.toLowerCase()];_initProperties(topWidget,child.children[i]);_prepAllBehaviors(topWidget,child.children[i]);if(!child.children[i].isTemplateAppended())child.children[i].appendTemplate();insertedNodes.push(child.children[i])}this.initializeHtmlObjects(child.children[i])}},createHtmlObjects:function(child,addNodes){if(topWidgets[child.tagName.toLowerCase()]!==undefined){var topWidget=topWidgets[child.tagName.toLowerCase()];_initProperties(topWidget,child);_prepAllBehaviors(topWidget,child);if(!child.isTemplateAppended())child.appendTemplate();if(Top.App.isLoaded()){_callCallback(child,"created");_callCallback(child,"ready");if(addNodes!==false)createdNodes.push(child);if(this.createdItemWidgets===undefined||!Array.isArray(this.createdItemWidgets)){this.createdItemWidgets=[]}this.createdItemWidgets.push(child)}}if(!child.children)return;for(var i=0;i<child.children.length;i++){this.createHtmlObjects(child.children[i],addNodes)}},createdItemWidgetAttachedCallback:function(){if(this.createdItemWidgets){for(var i=this.createdItemWidgets.length-1;i>=0;i--){_callCallback(this.createdItemWidgets[i],"attached")}this.createdItemWidgets=[]}},splitBorder:function(){if(this.borderWidth){var tmpBorderWidth=this.borderWidth.split(" ");if(tmpBorderWidth.length==1){this.borderTopWidth=this.borderRightWidth=this.borderBottomWidth=this.borderLeftWidth=tmpBorderWidth[0]}else if(tmpBorderWidth.length==2){this.borderTopWidth=this.borderBottomWidth=tmpBorderWidth[0];this.borderRightWidth=this.borderLeftWidth=tmpBorderWidth[1]}else if(tmpBorderWidth.length==4){this.borderTopWidth=tmpBorderWidth[0];this.borderRightWidth=tmpBorderWidth[1];this.borderBottomWidth=tmpBorderWidth[2];this.borderLeftWidth=tmpBorderWidth[3]}}else{this.borderTopWidth=this.borderRightWidth=this.borderBottomWidth=this.borderLeftWidth="1px"}},__updateTileMode:function(){if(this.tileMode==null||this.tileMode==="")this.tileMode="stretch";if(this.tileMode==="stretch"){this.setTopStyle("background-size","cover")}else{this.setTopStyle("background-repeat",this.tileMode)}},__updateWidgets:function(){},__adjustWidgets:function(){if(this.tagName==="TOP-GRIDLAYOUT")this.__setCellSize();
if(typeof this.__setWidgetSize==="function")this.__setWidgetSize();if(this.tagName==="TOP-LINEARLAYOUT")this.__setWidgetWeight()},__adjustLineHeight:function(){if(this.layoutHeight&&(this.layoutHeight.includes("%")||this.layoutHeight==="match_parent")){this.childs.forEach(function(child){if(typeof child.__adjustLineHeight==="function")child.__adjustLineHeight()})}else{return}},addWidget:function(widget){this.childs.push(widget.template);this.adjusted=false},removeWidget:function(widget){var widgetId=typeof widget==="string"?widget:widget.id;this.adjusted=false;if(this.childRoot)var root=this.childRoot;else var root=this;for(var i=0;i<root.children.length;i++){var child=root.children[i];if(widgetId==child.id){this.clearDeepChilds(child);root.removeChild(child);break}}this.childs=$(root).children()},getChildren:function(selector){var topElements=[];if(selector){var elements=this.querySelectorAll(selector)}else{if(this.childs===undefined)this.initialChilds();var elements=this.childs.toArray()}var len=elements.length;for(var i=0;i<len;i++){topElements[i]=Top.Dom.__selectImpl(elements[i])}return topElements},hasChild:function(child){if(typeof child=="string"){var childId=child}else{var childId=child.id}var len=this.template.childs.length;for(var i=0;i<len;i++){if(childId==this.template.childs[i].id){return true}}return false},clear:function(){this.adjusted=false;if(this.childs){this.childs.splice(0,this.template.childs.length);this.complete()}},complete:function(){this.renderLayout(true)},adjustSize:function(){if(this.adjusted===true){if(this.childRoot)var root=this.childRoot;else var root=this;for(var i=0;i<root.children.length;i++){if(typeof root.children[i].adjustSize==="function")root.children[i].adjustSize()}return}if(this.childRoot){var isVisible=!!(this.childRoot.offsetWidth||this.childRoot.offsetHeight||this.childRoot.getClientRects().length)}else{var isVisible=!!(this.offsetWidth||this.offsetHeight||this.getClientRects().length)}if(isVisible===true){this.adjusted=true;if(this.tagName==="TOP-GRIDLAYOUT")this.__setCellSize();if(typeof this.__setWidgetSize==="function")this.__setWidgetSize(true)}}};Top.Widget.Layout=function(){Layout.prototype=Object.create(Top.Widget.prototype);Layout.prototype.constructor=Layout;function Layout(obj){Object.assign(this,obj);if(this.template==null){this.template=new TopLayout;this.template.id=this.id}}Layout.create=function(obj){return new Layout(obj)};Layout.prototype.append=function(htmlString,callback){if(Top.Util.getFileExtension(htmlString)==="html"){var _this=this;Top.Ajax.execute(htmlString,{success:function(data){_this.template.appendHtmlString(data);_this.template.initialChilds();_insertedNodesCallback();if(typeof callback==="function")callback();_srcRootNodesAttachedCallback();data=null}})}else{this.template.appendHtmlString(htmlString);this.template.initialChilds();_insertedNodesCallback();_srcRootNodesAttachedCallback()}};Layout.prototype.html=function(htmlString){this.template.clearChilds();if(!htmlString||htmlString===""){return}this.template.appendHtmlString(htmlString);this.template.initialChilds();_insertedNodesCallback();_srcRootNodesAttachedCallback()};Layout.prototype.load=function(name,callback){if(typeof Top.configs.jsPath==="string"){this.src(name+".html",Top.configs.jsPath+"/"+name+".js",callback)}else{this.src(name+".html",name+".js",callback)}};Layout.prototype.src=function(htmlFile,jsFile,callback){if(Top.Util.getFileExtension(htmlFile)!="html")return;if(typeof jsFile==="function"&&callback===undefined)callback=jsFile;var _this=this;loadHtml=function(){Top.Ajax.execute(htmlFile,{success:function(data,textStatus,jqXHR){var controllerPaths=Top.Util.__getControllerPaths(data);if(Top.App.__useCommonLogic()===true&&controllerPaths!==undefined){Top.App.__loadControllerFile(controllerPaths,function(){_this.template.__onSuccessSrcLoad(data,callback);data=null})}else{_this.template.__onSuccessSrcLoad(data,callback);data=null}}})};if(typeof jsFile==="string"){this.template.__loadScript(jsFile,loadHtml)}else{loadHtml()}};Layout.prototype.addWidget=function(widget){widget.template.layoutParent=this.template;this.template.addWidget(widget)};Layout.prototype.removeWidget=function(widget){this.template.removeWidget(widget)};Layout.prototype.getChildren=function(selector){return this.template.getChildren(selector)};Layout.prototype.hasChild=function(child){return this.template.hasChild(child)};Layout.prototype.clear=function(){this.template.clear()};Layout.prototype.complete=function(){this.getChildren().forEach(function(child){if(createdNodes.includes(child.template)){_callCallback(child.template,"attached")}});this.template.complete()};Layout.prototype.adjustWidgets=function(){this.template.__adjustWidgets()};Layout.prototype.selectById=function(id){var element=this.template.querySelector("#"+id);if(element==null)return null;return Top.Dom.__selectImpl(element)};Layout.prototype.select=function(selector){var element=this.template.querySelectorAll(selector);var len=element.length;var widgets=[];for(var i=0;i<len;i++){var selected=Top.Dom.__selectImpl(element[i]);if(selected)widgets.push(selected)}return widgets};Layout.prototype.onSrcLoad=function(fn){if(this.template.srcLoadListeners===undefined){this.template.srcLoadListeners=[]}this.template.srcLoadListeners.push(fn)};return Layout}();TopMenuBehavior={properties:{id:{type:String,reflectToAttribute:true},menuItems:[]},ready:function(){if(!this.id){this.id=Top.Util.guid()}},initMenuItems:function(){this.menuItems=$(this.childRoot).children("top-menuitem");for(var i=0;i<this.menuItems.length;i++){this.menuItems[i].menuWidget=this}if(this.items&&this.menuItems&&this.menuItems.length===1){this.menuLayout=this.menuItems[0].innerHTML}},clearMenuItems:function(){if(this.tagName==="TOP-MENU")var myNode=this.childRoot.firstElementChild;else var myNode=this.childRoot;while(myNode&&myNode.firstChild){myNode.removeChild(myNode.firstChild)}}};Top.Widget.Menu=function(){Menu.prototype=Object.create(Top.Widget.prototype);Menu.prototype.constructor=Menu;function Menu(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-menu");this.template.innerHTML='<div class="top-menu-root"></div>'}this.id=this.template.id}Menu.create=function(element){return new Menu(element)};Menu.prototype.addMenu=function(widget){this.template.menuItems.push(widget.template)};Menu.prototype.removeMenu=function(widget,destroy){var child_len=this.template.menuItems.length;for(var i=0;i<child_len;i++){if(this.template.menuItems[i].id==widget.id){this.template.menuItems.splice(i,1);break}}};Menu.prototype.complete=function(){this.template.__updateItems()};Menu.prototype.open=function(menuId,animate){this.template.open(menuId,animate)};Menu.prototype.close=function(menuId){this.template.close(menuId)};Menu.prototype.toggle=function(menuId){this.template.toggle(menuId)};Menu.prototype.getSelectedMenuId=function(){return this.template.selectedMenuId};Menu.prototype.getSelectedMenuData=function(){return this.template.__getSelectedMenuDataById(this.template.selectedMenuId)};Menu.prototype.setMenuLayout=function(selector,layout){this.template.setMenuLayout(selector,layout)};Menu.prototype.deSelect=function(){this.template.deSelect()};Menu.prototype.sideOpen=function(){this.template.sideOpen(this.template.selectedNode)};return Menu}();TopRangeBehavior={properties:{progress:{type:Number,value:.5},max:{type:Number,value:100},min:{type:Number,value:0},number:{type:String,value:1},step:{type:Number,value:1}},ready:function(){this.__updateProgress();this.__updateNumber()},__updateProgress:function(){if(this.progress>1){this.progress=1}else if(this.progress<0){this.progress=0}},__updateNumber:function(){if(this.number<=this.max){this.number=Math.round(this.number/this.step)*this.step;this.value=this.number}if(this.number<this.min){this.number=Math.round(this.min/this.step)*this.step;this.value=this.number}}};TopResourceBehavior={properties:{src:String}};TopTextBehavior={properties:{text:{type:String,reflectToAttribute:true},textSize:String,textColor:String,textStyle:String,textWeight:String,autoComplete:String,autoCompleteOption:String,autoCompleteAlign:String,chip:String,chipItems:String,supportEmpty:{type:String,value:false},onSelect:String},ready:function(){this.__initI18n("text")},__initEventInternal:function(){this.__addEventByAttr("select")},__updateAutoComplete:function(){var _this=this;Top.App.onWidgetAttach(this.id,function(){_this.__renderAutoComplete()})},__updateAutoCompleteOption:function(){var _this=this;Top.App.onWidgetAttach(this.id,function(){_this.__renderAutoComplete()})},__updateAutoCompleteAlign:function(){var _this=this;Top.App.onWidgetAttach(this.id,function(){_this.__renderAutoComplete()})},__updateChip:function(){},__renderAutoComplete:function(){if(this.tagName==="TOP-TEXTFIELD"){var inputClassName="top-textfield-text"}else if(this.tagName==="TOP-TEXTAREA"){var inputClassName="top-textarea-root"}else{return}if(this.autoCompleteOption!==undefined){if(typeof this.autoCompleteOption==="string"){var option=Top.Util.namespace(this.autoCompleteOption,this)}else if(typeof this.autoCompleteOption==="object"){var option=this.autoCompleteOption}if(typeof option.result==="function"){var result=option.result;var menuTemplate='<ul class="typeahead dropdown-menu" style="padding:0px; margin:0px; border:0px; box-shadow:none;"></ul>'}if(typeof option.sources==="object"){var sources=option.sources}else if(typeof option.sources==="function"){var sources=option.sources()}}else if(typeof this.autoComplete==="string"){var sources=this.autoComplete.split(",")}else{return}var sourceArray=[];var tempObj={};var i=0;var sourceLength=sources.length;while(i<sourceLength){tempObj={};tempObj["id"]=i;tempObj["name"]=sources[i];sourceArray[i]=tempObj;i++}if(this.supportEmpty==="true"||this.supportEmpty===true){this.supportEmpty=true}else{this.supportEmpty=false}var shadowInput=this.querySelector("."+inputClassName);var _this=this;this.typeahead=$(shadowInput).typeahead({items:sourceArray.length,source:sourceArray,result:result,shadowRoot:shadowInput,supportEmpty:this.supportEmpty,menu:menuTemplate,align:_this.autoCompleteAlign,itemSelected:function(selectedItem,value,text){_this.text=text;shadowInput.value=text;_this.updateData("text");_this.updateDevice("text");if(typeof _this.__eventKeyReleased==="function")_this.__eventKeyReleased();if(typeof option==="object"){if(typeof option.onSelect==="string"){option.onSelect=Top.Util.namespace(option.onSelect,_this)}if(typeof option.onSelect==="function")option.onSelect(text)}else if(_this.onSelect){if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("select"))}else{_this.__dispatchEvent(new Event("select"))}}}});Top.App.addAutoCompleteContainer(this.typeahead)},openAutoComplete:function(){this.typeahead.data("open")()},closeAutoComplete:function(){this.typeahead.data("close")()},__updateText:function(){this.text=this.__i18n(this.text)},__updateOnSelect:function(){this.__addEventByAttr("select")},__setTimer:function(element){if(this.__timerInterval)clearInterval(this.__timerInterval);if(!element)return;element.innerText=this.timer;var pattern=new RegExp(this.__format.replace("mm","([0-9]+)").replace("ss","([0-9]+)"));var _this=this;this.__timerInterval=setInterval(function(){var result=pattern.exec(element.innerText);if(result===null){clearInterval(_this.__timerInterval);return}var time=parseInt(result[1]*60)+parseInt(result[2]);time--;var minutes=_this.__leadingZeros(parseInt(time/60),2);var seconds=_this.__leadingZeros(parseInt(time%60),2);element.innerText=_this.__format.replace("mm",minutes).replace("ss",seconds);if(time<=0){clearInterval(_this.__timerInterval);if(typeof _this.onEndtimer==="string")_this.onEndtimer=Top.Util.namespace(_this.onEndtimer,_this);if(typeof _this.onEndtimer==="function")_this.onEndtimer()}},1e3)},__leadingZeros:function(n,digits){var zero="";n=n.toString();if(n.length<digits){for(var i=0;i<digits-n.length;i++)zero+="0"}return zero+n},__stopTimer:function(element){if(this.__timerInterval)clearInterval(this.__timerInterval);element.innerText=this.__format.replace("mm","00").replace("ss","00")},__pauseTimer:function(element){if(this.__timerInterval)clearInterval(this.__timerInterval);this.timer=element.innerText},__clearTimer:function(){if(this.__timerInterval)clearInterval(this.__timerInterval)}};TopMaskBehavior={properties:{preventKey:String,format:String,mask:String,maskOption:String,pattern:Object},ready:function(){this.__initFormat()},__initFormat:function(){this.__updatePreventKey()},__updatePreventKey:function(){this.__updateFormat()},__updateFormat:function(){var _this=this;var re=undefined;var mask=undefined;if(!this.pattern){switch(this.format){case"number":mask={mask:"numeric",option:{autoGroup:true,groupSeparator:",",digits:2}};break;case"en":case"english":re=/^[a-zA-Z\s]*$/;break;case"enNum":re=/^[a-zA-Z0-9\s]*$/;break;case"ko":case"korean":re=/^[ㄱ-ㅎㅏ-ㅣ가-힣\s]*$/;break;case"enKo":re=/^[ㄱ-ㅎㅏ-ㅣ가-힣a-zA-Z\s]*$/;break;case"enKoNum":re=/^[ㄱ-ㅎㅏ-ㅣ가-힣a-zA-Z0-9\s]*$/;break;case"upper":re=/^[A-Z\s]*$/;break;case"lower":re=/^[a-z\s]*$/;break;case"date":mask={mask:"datetime",option:{inputFormat:"yyyy-mm-dd"}};"datetime";break;case"currency":mask={mask:"currency",option:{prefix:"￦ ",digits:2,placeholder:""}};break;case"email":mask={mask:"email",option:{placeholder:"_",showMaskOnHover:false,showMaskOnFocus:false}};break;case"credit":mask={mask:"9999 9999 9999 9999",option:{placeholder:" ",showMaskOnHover:false,showMaskOnFocus:false}};break;case"metric":mask={mask:"numeric",option:{suffix:" kg",numericInput:true,autoGroup:true,groupSeparator:","}};break;case"percentage":mask="percentage";break;case"url":mask="url";break;case"ip":mask="url";break;case"mac":mask="mac";break;default:re=mask=undefined}}this.__updateMaskOption();this.__updateMask(mask);this.__updatePattern(re)},__updateMask:function(mask){if(typeof mask==="object"){this.maskData=mask.mask;this._maskOptionData=mask.option}else{this.maskData=mask}if(this.mask){this.maskData=this.mask}if(this.maskOptionData){this._maskOptionData=this.maskOptionData}this.shadowText().style.removeProperty("text-align");if(this.maskData!==undefined&&this.maskData!==""){$(this.shadowText()).inputmask(this.maskData,this._maskOptionData);this.removeEventListener("keyup",this.validation);this.shadowText().removeEventListener("keyup",this.validation)}else{$(this.shadowText()).inputmask("remove")}},__updateMaskOption:function(){if(typeof this.maskOption=="string"){this.maskOptionData=Top.Util.namespace(this.maskOption,this);if(!this.maskOptionData){this.maskOptionData=eval("("+this.maskOption+")")}}else if(typeof this.maskOption=="object"){this.maskOptionData=this.maskOption}else{return}this.__updateMask()},__updatePattern:function(re){var _this=this;var _pattern=re;if(this.pattern){_pattern=this.pattern}if(_pattern){if(this.preventKey===true||this.preventKey==="true"){$(this.shadowText()).off("keydown").on("keydown",function(event){var key=event.key;var code=event.keyCode;var regex=new RegExp(_pattern);if(regex.test(key)===true)return;if(event.ctrlKey||event.altKey)return;if(code==8||code==9||code==46)return;if(code>=35&&code<=40)return;event.preventDefault()});$(this.shadowText()).off("keyup").on("keyup",function(event){if(_this.format!=="ko"&&_this.format!=="enko"){event.target.value=event.target.value.replace(/[\ㄱ-ㅎㅏ-ㅣ가-힣]/g,"");_this.text=event.target.value}})}else{$(this.shadowText()).off("keydown")}}this.validation=function(){if(_this.text&&!_this.text.match(_pattern)){_this.setError();return false}else{_this.removeError();return true}};this.removeEventListener("keyup",this.validation);if(this.pattern&&typeof this.pattern==="string")this.pattern=new RegExp(this.pattern);if(_pattern&&typeof _pattern==="string")_pattern=new RegExp(_pattern);if(_pattern){this.addEventListener("keyup",this.validation);this.validation()}},getUnmaskedText:function(){if(this.shadowText().inputmask){return this.shadowText().inputmask.unmaskedvalue()}else{return this.shadowText().value}}};TopAbsolutelayout={is:"top-absolutelayout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],__ready:function(){this.initialChilds();this.__updateId();this.renderLayout()},__updateId:function(){if(this.id){this.childRoot.id=this.id}},appendTemplate:function(){this.innerHTML='<div class="top-absolutelayout-root">'+this.innerHTML+"</div>";this.__isTemplateAppended=true},__attached2:function(){this.adjustSize()},initializeChildRoot:function(){return this.querySelector(".top-absolutelayout-root")},renderLayout:function(){var layoutRoot=this.childRoot;var pPaddingTop=layoutRoot.style.paddingTop||0;var pPaddingLeft=layoutRoot.style.paddingLeft||0;for(var i=0;i<layoutRoot.children.length;i++){var child=layoutRoot.children[i];this.__setWrapperStyle(child,pPaddingTop,pPaddingLeft)}},__setWrapperStyle:function(child,pPaddingTop,pPaddingLeft){var layoutTop="0px";var layoutLeft="0px";if(child.getAttribute("layout-top")){layoutTop=parseInt(child.getAttribute("layout-top"))+pPaddingTop+"px"}else{layoutTop=pPaddingTop+"px";child.setAttribute("layout-top",pPaddingTop+"px");child.layoutTop=pPaddingTop+"px"}if(child.getAttribute("layout-left")){layoutLeft=parseInt(child.getAttribute("layout-left"))+pPaddingLeft+"px"}else{layoutLeft=pPaddingLeft+"px";child.setAttribute("layout-left",pPaddingLeft+"px");child.layoutLeft=layoutLeft}child.style.cssText="position: absolute; display:inline-block; top: "+layoutTop+"; left: "+layoutLeft+"; vertical-align:top;"},initialChilds:function(){this.childs=[];for(var i=0;i<this.childRoot.children.length;i++){this.childRoot.children[i].layoutParent=this;if(Top.Util.__isTopWidget(this.childRoot.children[i].tagName))this.childs.push(this.childRoot.children[i])}},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-absolutelayout-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__setWidgetSize:function(){var layoutRoot=this.childRoot;var root=layoutRoot;if(this.layoutWidth==="auto"){layoutRoot.style.width=layoutRoot.scrollWidth}if(this.layoutHeight==="auto"){layoutRoot.style.height=layoutRoot.scrollHeight}for(var i=0,len=root.children.length;i<len;i++){var item=root.children[i];if(item.tagName==="DIV")item=item.firstElementChild;var pWrapWidth=!this.getAttribute("layout-width")||this.getAttribute("layout-width")==="auto",pWrapHeight=!this.getAttribute("layout-height")||this.getAttribute("layout-height")==="auto";var pPaddingWidth=layoutRoot.style.paddingRight||0+layoutRoot.style.paddingLeft||0,pPaddingHeight=layoutRoot.style.paddingTop||0+layoutRoot.style.paddingBottom||0;if(item.layoutWidth==="match_parent"){if(pWrapWidth){item.setThisWidgetWidth(parseInt(item.marginRight)+parseInt(item.marginLeft)+"px")}else{if(!isNaN(parseInt(this.layoutWidth))){item.setThisWidgetWidth(parseInt(this.layoutWidth)-pPaddingWidth+"px")}else{item.setThisWidgetWidth("100% - "+pPaddingWidth+"px")}}}if(item.layoutHeight==="match_parent"){if(pWrapHeight){item.setThisWidgetHeight(parseInt(item.marginTop)+parseInt(item.marginBottom)+"px")}else{if(!isNaN(parseInt(this.layoutHeight))){item.setThisWidgetHeight(parseInt(this.layoutHeight)-pPaddingHeight+"px")}else{item.setThisWidgetHeight("100% - "+pPaddingHeight+"px")}}}if(item.getAttribute("layout-top")!=null){item.removeTopStyle("top")}if(item.getAttribute("layout-left")!=null){item.removeTopStyle("left")}}},addWidget:function(widget){var layoutRoot=this.childRoot;var root=layoutRoot;var pPaddingTop=layoutRoot.style.paddingTop||0;var pPaddingLeft=layoutRoot.style.paddingLeft||0;widget.__isRendered=true;this.adjusted=false;root.appendChild(widget.template);this.__setWrapperStyle(widget.template,pPaddingTop,pPaddingLeft)},removeWidget:function(widget){var widgetId=typeof widget==="string"?widget:widget.id;var root=this.childRoot;this.adjusted=false;for(var i=0;i<root.children.length;i++){var child=root.children[i];if(widgetId==child.id){this.clearDeepChilds(child);root.removeChild(child);break}}},getChildren:function(selector){var topElements=[];if(selector){var elements=this.childRoot.querySelectorAll(selector)}else{var elements=this.childRoot.children}var len=elements.length;for(var i=0;i<len;i++){var item=elements[i];if(item.tagName==="DIV")item=item.firstElementChild;topElements[i]=Top.Dom.__selectImpl(item)}return topElements},hasChild:function(child){if(typeof child=="string"){var childId=child}else{var childId=child.id}if(this.childRoot.querySelector("#"+childId))return true;return false},clear:function(){this.adjusted=false;this.clearChilds()},complete:function(){this.adjustSize()},getTopStyle:function(){this.topstyle=this.childRoot.style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.childRoot.style[key]=value;this.topstyle=this.childRoot.style.cssText}},setAllTopStyle:function(){this.childRoot.style.cssText=this.topstyle}};Top.Widget.Layout.Absolutelayout=function(){Absolutelayout.prototype=Object.create(Top.Widget.Layout.prototype);Absolutelayout.prototype.constructor=Absolutelayout;function Absolutelayout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-absolutelayout");this.template.innerHTML='<div class="top-absolutelayout-root"></div>'}this.id=this.template.id}Absolutelayout.create=function(element){return new Absolutelayout(element)};return Absolutelayout}();TopAccordionlayout={is:"top-accordionlayout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],properties:{tabs:String,selected:String,onSelect:String,onClose:String,onInit:String,autoClose:{type:String,value:"true"}},__ready:function(){this.initialChilds();this.__initialClassname();if(typeof this.tabs==="string"){this.tabs=Top.Util.namespace(this.tabs)}if(typeof this.onSelect=="string"){this.select=Top.Util.namespace(this.onSelect,this)}if(typeof this.onClose=="string"){this.close=Top.Util.namespace(this.onClose,this)}this.renderLayout();this.__updateId();this.__updateName();this.__onInit()},appendTemplate:function(){this.innerHTML='<div class="top-accordionlayout-root">'+this.innerHTML+"</div>";this.__isTemplateAppended=true},__addChildrenLoadEvent:function(fn){Top.App.onWidgetAttach(this.id,fn);var textfields=Array.prototype.slice.call(this.childRoot.querySelectorAll("top-textfield"));textfields.forEach(function(item){item.setIconPosition()})},__updateId:function(){if(this.id){this.childRoot.id=this.id}},__updateName:function(){if(this.name){this.childRoot.name=this.name}},__attached2:function(){this.renderTitle();this.__updateSelected();this.attachEventHandler()},initializeChildRoot:function(){return this.querySelector(".top-accordionlayout-root")},renderLayout:function(){},renderTitle:function(){var tabs=this.tabs;var len=tabs.length;for(var i=0;i<len;i++){for(var j=0;j<this.childRoot.children.length;j++){if(this.childRoot.children[j].id===tabs[i].id){this.childRoot.children[j].querySelector("div.top-accordionlayout-container").id="top-accordionlayout_"+tabs[i].id;var layout=tabs[i].text||tabs[i].layout;var titleNode=document.createElement("div");titleNode.innerHTML=layout;var title=this.childRoot.children[j].querySelector("a.top-accordionlayout-title");for(var k=0;k<title.childNodes.length;k++){if(!(title.childNodes[k].tagName==="I"&&title.childNodes[k].classList.contains("top-accordionlayout-icon"))){title.removeChild(title.childNodes[k])}}while(titleNode.firstChild){title.appendChild(titleNode.firstChild)}break}}}},attachEventHandler:function(){var _this=this;$(this).off("click"," .top-accordionlayout-title:not(.active)").on("click"," .top-accordionlayout-title:not(.active)",function(){if(_this.autoClose=="true"){$(_this.querySelector(" .top-accordionlayout-title.active")).click()}$(this).addClass("active");$(this.nextElementSibling).slideDown();_this.selected=this.parentNode.id.substring(20);_this.updateData("selected");_this.__addChildrenLoadEvent(function(){if(typeof _this.select==="function")_this.select(_this.selected)})});$(this).off("click"," .top-accordionlayout-title.active").on("click"," .top-accordionlayout-title.active",function(){$(this).removeClass("active");$(this.nextElementSibling).slideUp();var closed=this.parentNode.id.substring(20);_this.__addChildrenLoadEvent(function(){if(typeof _this.close==="function")_this.close(closed)})})},__onInit:function(){var _this=this;Top.App.onWidgetAttach(this.id,function(){if(typeof _this.onInit==="function"){_this.onInit()}else if(typeof _this.onInit==="string"){Top.Util.namespace(_this.onInit)()}})},__updateSelected:function(){if(this.selected){var selectedTitle=this.childRoot.querySelector("#top-accordionlayout_"+this.selected+" .top-accordionlayout-title");$(selectedTitle).addClass("active");$(selectedTitle.nextElementSibling).slideDown();this.__addChildrenLoadEvent(function(){if(typeof this.select==="function")this.select(this.selected)})}},__updateTabs:function(){if(this.dataModel&&this.dataModel.tabs!==undefined&&this.dataModel.tabs!==null){var map=new Map;for(var j=0;j<this.childRoot.children.length;j++){map.set(this.childRoot.children[j].id,{text:this.childRoot.children[j].text,contents:this.childRoot.children[j].contents})}this.clearChilds();for(var i=0;i<this.tabs.length;i++){var accordionTab=document.createElement("top-accordiontab");accordionTab.id=this.tabs[i].id;this.childRoot.appendChild(accordionTab);if(map.has(this.tabs[i].id)){if(map.get(this.tabs[i].id).text!==undefined&&map.get(this.tabs[i].id).text!==null){Top.Dom.__selectImpl(accordionTab).setProperties("text",map.get(this.tabs[i].id).text)}if(map.get(this.tabs[i].id).contents!==undefined&&map.get(this.tabs[i].id).contents!==null){accordionTab.contents=map.get(this.tabs[i].id).contents;accordionTab.updateContent()}}}this.renderTitle()}this.renderLayout()},__setContentHtml:function(tabId,htmlString){if(this.childRoot.children.length===0)this.__updateTabs();var tabElement=this.childRoot.querySelector("#top-accordionlayout_"+tabId+" .top-accordionlayout-content");$(tabElement).empty();$(tabElement).append(htmlString);var accordionTab=this.childRoot.querySelector("#top-accordionlayout_"+tabId).parentNode;accordionTab.initContent()},__setContentSrc:function(tabId,htmlFile){if(this.childRoot.children.length===0)this.__updateTabs();var tabElement=this.childRoot.querySelector("#top-accordionlayout_"+tabId+" .top-accordionlayout-content");var accordionTab=this.childRoot.querySelector("#top-accordionlayout_"+tabId).parentNode;var htmlString;var _this=this;if(Top.Util.getFileExtension(htmlFile)!="html")return;loadHtml=function(){Top.Ajax.execute(htmlFile,{success:function(data){$(tabElement).empty();$(tabElement).append(data);htmlString=data;accordionTab.initContent()}});return htmlString};loadHtml()},getTopStyle:function(){this.topstyle=this.childRoot.style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.childRoot.style[key]=value;this.topstyle=this.childRoot.style.cssText}},setAllTopStyle:function(){this.childRoot.style.cssText=this.topstyle}};Top.Widget.Layout.Accordionlayout=function(){Accordionlayout.prototype=Object.create(Top.Widget.Layout.prototype);Accordionlayout.prototype.constructor=Accordionlayout;function Accordionlayout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-accordionlayout");this.template.innerHTML='<div class="top-accordionlayout-root"></div>'}this.id=this.template.id}Accordionlayout.create=function(element){return new Accordionlayout(element)};Accordionlayout.prototype.setContentHtml=function(tabId,htmlString){this.template.__setContentHtml(tabId,htmlString)};Accordionlayout.prototype.setContentSrc=function(tabId,htmlFile){this.template.__setContentSrc(tabId,htmlFile)};Accordionlayout.prototype.removeContent=function(tabId){var childs=this.template.childs;var tabElement=this.template.childRoot.querySelector("#top-accordionlayout_"+tabId+" .top-accordionlayout-content");$(tabElement.firstChild).remove();for(var i=0;i<childs.length;i++){if(childs[i].tagName==="TOP-ACCORDIONTAB"&&childs[i].id===tabId){childs.splice(i)}}};return Accordionlayout}();TopAccordionTab={is:"top-accordiontab",behaviors:[TopWidgetBehavior,TopLayoutBehavior],properties:{id:String,text:String},__ready:function(){this.initialChilds();this.__initI18n("text");this.renderLayout()},__attached2:function(){$(this.querySelector("div.top-accordionlayout-content")).hide()},appendTemplate:function(){this.innerHTML='<div class="top-accordionlayout-container"><a class="top-accordionlayout-title"><i class="top-accordionlayout-icon"></i></a><div class="top-accordionlayout-content">'+this.innerHTML+"</div></div>";this.__isTemplateAppended=true},expectedTemplateClassName:function(){return"top-accordionlayout-container"},initializeChildRoot:function(){return this.querySelector(".top-accordionlayout-content")},initContent:function(){this.contents=$(this).children();for(var i=0;i<this.contents.length;i++){this.contents[i].parentWidget=this.parentWidget}},renderLayout:function(){if(this.childs.length===0){if(this.text===undefined||this.text===null){this.querySelector("div.top-accordionlayout-content").innerText=""}else{this.querySelector("div.top-accordionlayout-content").innerText=this.text}}this.initContent()},initContent:function(){this.contents=$(this.querySelector("div.top-accordionlayout-content")).children()},getContent:function(){return this.contents},clearContent:function(){var myNode=this.querySelector("div.top-accordionlayout-content");while(myNode.firstChild){myNode.removeChild(myNode.firstChild)}},updateContent:function(){this.clearContent();for(var i=0;i<this.contents.length;i++){this.querySelector("div.top-accordionlayout-content").appendChild(this.contents[i])}},__updateText:function(){if(this.childs.length===0){if(this.text===undefined||this.text===null){this.querySelector("div.top-accordionlayout-content").innerText=""}else{this.querySelector("div.top-accordionlayout-content").innerText=this.text}}},getTopStyle:function(){return this.topstyle},setTopStyle:function(key,value){if(value){this.topstyle+=key+":"+value+";"}},setAllTopStyle:function(){}};Top.Widget.Group.Accordiontab=function(){Accordiontab.prototype=Object.create(Top.Widget.prototype);Accordiontab.prototype.constructor=Accordiontab;function Accordiontab(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-accordiontab")}this.id=this.template.id}Accordiontab.create=function(element){return new Accordiontab(element)};Accordiontab.prototype.addItem=function(widget){this.template.contents.push(widget.template)};Accordiontab.prototype.removeItem=function(widget){var childsArray=this.template.contents;for(var i=0;i<childsArray.length;i++){if(widget.id==childsArray[i].id){this.template.childs.splice(i,1)}}};Accordiontab.prototype.complete=function(){this.template.updateContent()};return Accordiontab}();TopAjax={is:"top-ajax",properties:{id:String,url:String,type:String,settings:Object,request:String,response:String,onSuccess:String,onFail:String},execute:function(){if(typeof this.settings==="undefined")this.settings={};this.settings.type=this.type;this.settings.data=this.request;this.settings.response=this.response;this.settings.success=this.onSuccess;
this.settings.error=this.onFail;Top.Ajax.execute(this.url,this.settings)}};TopAlarmbadge={is:"top-alarmbadge",behaviors:[TopWidgetBehavior,TopResourceBehavior,TopTextBehavior],properties:{icon:{type:String,value:""},type:{type:String,value:""},iconColor:String},__ready:function(){this.__initialize()},appendTemplate:function(){this.innerHTML='<div class="top-alarmbadge-root"><span></span><span class = "top-alarmbadge-text"></span></div>';this.__isTemplateAppended=true},__initialize:function(){this.__updateId();this.__initialClassname();this.__updateIcon();this.__updateText();this.__updateType();this.__updateAlt()},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-alarmbadge-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateId:function(){if(this.id){var shadowRoot=this.querySelector(".top-alarmbadge-root");shadowRoot.id=this.id}},__updateAlt:function(){if(this.description){var shadowRoot=this.querySelector(".top-alarmbadge-root");shadowRoot.alt=this.description}},__updateIcon:function(){var shadowIcon=this.querySelector("div > span");shadowIcon.classList.add("top-alarmbadge-icon");if(this.iconColor){shadowIcon.style.color=this.iconColor}if(this.textColor){shadowIcon.style.color=this.textColor}if(this.icon)shadowIcon.classList.add(this.icon)},__updateText:function(){var shadowText=this.querySelector(".top-alarmbadge-text");this.text=this.__i18n(this.text);if(this.text){shadowText.innerHTML=this.text}},__updateType:function(){var shadowText=this.querySelector(".top-alarmbadge-text");shadowText.classList.remove(this.curType);if(this.type!==""&&this.type!==undefined&&this.type!==null)shadowText.classList.add(this.type);this.curType=this.type},__updateIconColor:function(){var shadowIcon=this.querySelector("div > span");shadowIcon.style.color=this.iconColor},__updateTextColor:function(){var shadowText=this.querySelector(".top-alarmbadge-text");shadowText.style.color=this.textColor},getTopStyle:function(){this.topstyle=this.querySelector(".top-alarmbadge-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.querySelector(".top-alarmbadge-root").style[key]=value;this.topstyle=this.querySelector(".top-alarmbadge-root").style.cssText}},setAllTopStyle:function(){this.querySelector(".top-alarmbadge-root").style.cssText=this.topstyle}};Top.Widget.Alarmbadge=function(){Alarmbadge.prototype=Object.create(Top.Widget.prototype);Alarmbadge.prototype.constructor=Alarmbadge;function Alarmbadge(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-alarmbadge");this.template.innerHTML='<div class="top-alarmbadge-root"><span></span><span class = "top-alarmbadge-text"></span></div>'}this.id=this.template.id}Alarmbadge.create=function(element){return new Alarmbadge(element)};return Alarmbadge}();TopBreadcrumb={is:"top-breadcrumb",behaviors:[TopWidgetBehavior,TopTextBehavior],properties:{type:String,nodes:{type:Object},isReady:{type:Boolean,value:false},autoWidth:String,textMaxWidth:String,listLocation:String,listMaxHeight:String,onChange:String},__ready:function(){this.optValue=[];this.behindNodes=[];this.frontNodes=[];this.textMaxWidth=this.textMaxWidth||"";if(this.type==="2line"){this.__initBindingEvent();if(Top.Util.Browser.isIE())this.__updateOnChange()}else this.type="1line";this.isReady=true},__attached2:function(){var _this=this;if(_this.isReady===true){_this.__initialize();_this.__updateLineHeight()}else{setTimeout(function(){_this.__attached2()},0)}},appendTemplate:function(){this.innerHTML='<div class="top-breadcrumb-root"></div>';this.__isTemplateAppended=true},__initialize:function(){this.__updateId();this.__updateNodes()},__updateId:function(){if(this.id){var shadowRoot=this.querySelector(".top-breadcrumb-root");shadowRoot.id=this.id}},__updateNodes:function(){if(typeof this.nodes==="string"){var nodes=Top.Util.namespace(this.nodes,this)}else if(typeof this.nodes==="object"){var nodes=this.nodes}if(nodes===undefined)return;var shadowRoot=this.querySelector(".top-breadcrumb-root");if(!shadowRoot)return;$(shadowRoot).empty();var len=nodes.length;if(this.type==="2line"){var rootWidth=shadowRoot.getBoundingClientRect().width;var str='<div class="top-breadcrumb-button-container"></div><div class="top-breadcrumb-container doubleLine"';str+=this.textSize===undefined?'">':'style="font-size:'+this.textSize+'"></div>';shadowRoot.innerHTML=str;var container=this.querySelector(".top-breadcrumb-container");var i=0;var listCount=0;while(i<len){var str="";if(i!=0&&nodes[i].text){str+='<div class="top-breadcrumb-divider icon-arrows_right_thin"></div>'}nodes[i].subtext=nodes[i].subtext||"";if(nodes[i].selected){if(nodes[i].selected.startsWith("/")){if(i==len-1){str+='<a class="top-breadcrumb-text-container current index_'+i+'"href=javascript:Top.App.routeTo("'+nodes[i].selected+'")><div class="texts"><div class="top-breadcrumb-current text">'+nodes[i].text+'</div><div class="top-breadcrumb-current subtext">'+nodes[i].subtext+"</div></div></a>"}else{str+='<a class="top-breadcrumb-text-container default index_'+i+'"href=javascript:Top.App.routeTo("'+nodes[i].selected+'")><div class="texts"><div class="top-breadcrumb-default text">'+nodes[i].text+'</div><div class="top-breadcrumb-default subtext">'+nodes[i].subtext+"</div></div></a>"}}else{if(i==len-1){str+='<a class="top-breadcrumb-text-container current index_'+i+'" href='+nodes[i].selected+'><div class="texts"><div class="top-breadcrumb-current text">'+nodes[i].text+'</div><div class="top-breadcrumb-current subtext">'+nodes[i].subtext+"</div></div></a>"}else{str+='<a class="top-breadcrumb-text-container default index_'+i+'" href='+nodes[i].selected+'><div class="texts"><div class="top-breadcrumb-default text">'+nodes[i].text+'</div><div class="top-breadcrumb-default subtext">'+nodes[i].subtext+"</div></div></a>"}}}else{if(i==len-1){str+='<a class="top-breadcrumb-text-container current index_'+i+'"><div class="texts"><div class="top-breadcrumb-current text">'+nodes[i].text+'</div><div class="top-breadcrumb-current subtext">'+nodes[i].subtext+"</div></div></a>"}else{str+='<a class="top-breadcrumb-text-container default index_'+i+'"><div class="texts"><div class="top-breadcrumb-default text">'+nodes[i].text+'</div><div class="top-breadcrumb-default subtext">'+nodes[i].subtext+"</div></div></a>"}}$(container).append(str);if(this.layoutWidth){var containerWidth=container.getBoundingClientRect().width;var paddingRight=$(container).css("padding-right");paddingRight=paddingRight.split("px")[0];if(rootWidth-paddingRight<containerWidth){$(container).children().first().remove();$(container).children().first().remove();listCount++}}i++}this.frontNodes=nodes.slice(listCount,len);var behindNodes=[];for(var i=listCount;i>0;i--){behindNodes.push(nodes[i-1])}this.behindNodes=behindNodes;this.__updateTextMaxWidth();this.__updateButton();this.renderList()}else{var str='<div class="top-breadcrumb-container basic"';str+=this.textSize===undefined?'">':'style="font-size:'+this.textSize+'">';for(var i=0;i<len;i++){if(i!=0&&nodes[i].text){str+='<span class="top-breadcrumb-divider">></span>'}if(nodes[i].selected){if(nodes[i].selected.startsWith("/")){if(i==len-1){str+='<a href=javascript:Top.App.routeTo("'+nodes[i].selected+'")><span class="top-breadcrumb-current">'+nodes[i].text+"</span></a>"}else{str+='<a href=javascript:Top.App.routeTo("'+nodes[i].selected+'")><span class="top-breadcrumb-default">'+nodes[i].text+"</span></a>"}}else{if(i==len-1){str+="<a href="+nodes[i].selected+'><span class="top-breadcrumb-current">'+nodes[i].text+"</span></a>"}else{str+="<a href="+nodes[i].selected+'><span class="top-breadcrumb-default">'+nodes[i].text+"</span></a>"}}}else{if(i==len-1){str+='<span class="top-breadcrumb-current">'+nodes[i].text+"</span>"}else{str+='<span class="top-breadcrumb-default">'+nodes[i].text+"</span>"}}}str+="</div>";shadowRoot.innerHTML=str}},__updateButton:function(){var mainContainer=this.querySelector(".top-breadcrumb-container"),buttonContainer=this.querySelector(".top-breadcrumb-button-container"),button=buttonContainer.querySelector(".top-breadcrumb-button");var buttonFlag=true;if(this.behindNodes.length){if(!button){this.__addButton()}}else{if(this.button)this.__removeButton()}},__addButton:function(){var mainContainer=this.querySelector(".top-breadcrumb-container"),buttonContainer=this.querySelector(".top-breadcrumb-button-container");buttonContainer.style.display="";mainContainer.classList.add("withButton");buttonContainer.innerHTML='<ul class="top-breadcrumb-list-container"></ul><div class="top-breadcrumb-button"><span class="top-breadcrumb-button-icon icon-arrow_filled_down"></span></div>'},__removeButton:function(){var mainContainer=this.querySelector(".top-breadcrumb-container"),buttonContainer=this.querySelector(".top-breadcrumb-button-container");mainContainer.classList.remove("withButton");while(buttonContainer.firstChild){buttonContainer.removeChild(buttonContainer.firstChild)}},__updateTextMaxWidth:function(){var texts=this.querySelectorAll(".texts");for(var i=0;i<texts.length;i++){texts[i].style.maxWidth=this.textMaxWidth}},renderList:function(){var nodes=this.behindNodes;if(typeof this.nodes=="string"){this.nodes=Top.Util.namespace(this.nodes,this)}var listContainer=this.querySelector(".top-breadcrumb-list-container");if(listContainer){while(listContainer.firstChild){listContainer.removeChild(listContainer.firstChild)}}var nodeText=[];var nodeSubText=[];var nodeSelected=[];var buttonContainer=this.querySelector(".top-breadcrumb-button-container");if(!nodes)return;if(typeof nodes[0]==="object"){for(var i=0;i<nodes.length;i++){nodeText[i]=nodes[i]["text"];nodeSubText[i]=nodes[i]["subtext"]!==undefined?nodes[i]["subtext"]:"";nodes[i].subtext=nodes[i].subtext||"";nodeSelected[i]=nodes[i]["selected"]}}for(var i=0;i<nodes.length;i++){var str='<li class="top-breadcrumb-list list_'+i+'">';if(nodes[i].selected){if(nodes[i].selected.startsWith("/")){str+='<a class="top-breadcrumb-text-container'+" index_"+i+'" href=javascript:Top.App.routeTo("'+nodes[i].selected+'")><div class="top-breadcrumb-default text">'+nodes[i].text+'</div><div class="top-breadcrumb-default subtext">'+nodes[i].subtext+"</div></a>"}else{str+='<a class="top-breadcrumb-text-container'+" index_"+i+'" href='+nodes[i].selected+'><div class="top-breadcrumb-default text">'+nodes[i].text+'</div><div class="top-breadcrumb-default subtext">'+nodes[i].subtext+"</div></a>"}}else{str+='<a class="top-breadcrumb-text-container'+" index_"+i+'"><div class="top-breadcrumb-default text">'+nodes[i].text+'</div><div class="top-breadcrumb-default subtext">'+nodes[i].subtext+"</div></a>"}str+="</li>";$(listContainer).append(str)}this.attachEventHandler();this.__updateLineHeight()},__updateOnChange:function(){this.__addEventByAttr("change")},__updateLineHeight:function(){var buttonContainer=this.querySelector(".top-breadcrumb-button-container");if(!buttonContainer)return;if(buttonContainer.offsetHeight!==0){buttonContainer.style.lineHeight=70+"px"}},__detached:function(){$(document).off("click","#"+this.id+" .top-breadcrumb-button-container");$(document).off("click","#"+this.id+" .top-breadcrumb-list-container");$(this).unbind("keydown")},__initEventInternal:function(){this.__addEventByAttr("change");this.__addEventByAttr("close")},changeSelected:function(){if(typeof this.eventChanged==="string"){this.__eventChanged=Top.Util.namespace(this.eventChanged,this)}if(Top.App.__compatibleWithTOP()===true){if(typeof this.__eventChanged==="function"){this.__eventChanged(event,Top.Dom.selectById(this.id))}else if(typeof this.__eventChanged==="object"){fn.fn(event,Top.Dom.selectById(this.id))}}else if(typeof this.__eventChanged==="function"){var rowInfo={};rowInfo.index=this.dataIndex;this.dataObj[this.columnName]=this.selectedText;rowInfo.data=this.dataObj;this.__eventChanged(this.selectedText,rowInfo,this.value)}if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("change"))}else{this.__dispatchEvent(new Event("change"))}},attachEventHandler:function(){var _this=this;var button=this.querySelector(".top-breadcrumb-button-container");var listContainer=this.querySelector(".top-breadcrumb-list-container");$(button).off("click").on("click",function(){if($(this).hasClass("active")){listContainer.style.display="";$(this).removeClass("top-breadcrumb-list_open");$(this).addClass("top-breadcrumb-list_collapsed");$(this).removeClass("active");listContainer.style.top="";listContainer.style.left="";listContainer.style.width="";listContainer.style.right="";listContainer.style.bottom=""}else{$(".top-breadcrumb-button-container.active").click();listContainer.style.display="block";if(_this.listLocation){if(_this.listLocation.startsWith("b")){listContainer.style.top=this.getBoundingClientRect().top+this.getBoundingClientRect().height-1+"px"}else{listContainer.style.bottom=window.innerHeight-this.getBoundingClientRect().bottom+this.offsetHeight-1+"px"}if(_this.listLocation.endsWith("l")){listContainer.style.left=this.getBoundingClientRect().left+"px"}else{var calcedRight=Math.abs(this.getBoundingClientRect().right-$(document).width());listContainer.style.right=calcedRight+"px"}}listContainer.style.top=this.getBoundingClientRect().top+this.getBoundingClientRect().height+"px";listContainer.style.left=this.getBoundingClientRect().left+"px";var calcedRight=listContainer.getBoundingClientRect().right-$(document).width();if(calcedRight>0){calcedRight=Math.abs(this.getBoundingClientRect().right-$(document).width());listContainer.style.left="";listContainer.style.right=calcedRight+"px"}if(_this.listMaxHeight){_this.querySelector(".top-breadcrumb-list-container").style.maxHeight=_this.listMaxHeight;_this.querySelector(".top-breadcrumb-list-container").style.overflowY="auto"}$(this).removeClass("top-breadcrumb-list_collapsed");$(this).addClass("top-breadcrumb-list_open");$(this).addClass("active")}});$(this).find(".top-breadcrumb-text-container").off("click").on("click",function(){var containerElement=this.parentNode.nextSibling;var text=this.querySelector(".text").innerText;var subtext=this.querySelector(".subtext").innerText;var selectedText=[];var classList=this.classList;for(var i=0;i<classList.length;i++){var index=classList[i].split("index_");if(index.length===2){_this.selectedIndex=index[1]}}_this.selectedNode=_this.nodes[_this.selectedIndex];_this.selectedId=_this.selectedNode.id;selectedText.push(text);if(subtext!=="")selectedText.push(subtext);_this.selectedText=selectedText;_this.updateData("selectedText");_this.updateData("value");var siblingArray=this.parentNode.childNodes;for(var i=0;i<siblingArray.length;i++){if($(siblingArray[i]).hasClass("active"))$(siblingArray[i]).removeClass("active")}$(this).addClass("active");$(_this.querySelector(".top-breadcrumb-button-container.top-breadcrumb-list_open")).click();_this.changeSelected()});$(this.querySelector(".top-breadcrumb-button-container")).add(this.querySelector(".top-breadcrumb-list-container")).on("mousedown click",function(e){e.stopPropagation()})},close:function(){$(this).find(" .top-breadcrumb-list_open").click()},__initBindingEvent:function(){var _this=this;$(this).bind("keydown",function(e){var len=_this.allValues.length;if($(_this).attr("disabled")!==undefined){e.preventDefault();return}if(e.keyCode===39||e.keyCode===40){if(_this.selectedIndex===undefined){_this.selectByIndex(0)}else if(_this.selectedIndex>=0&&_this.selectedIndex<len-1){_this.selectByIndex(_this.selectedIndex+1)}e.preventDefault()}else if(e.keyCode===37||e.keyCode===38){if(_this.selectedIndex>0&&_this.selectedIndex<len){_this.selectByIndex(_this.selectedIndex-1)}e.preventDefault()}})},getTopStyle:function(){this.topstyle=this.querySelector(".top-breadcrumb-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-breadcrumb-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-breadcrumb-root").style.cssText=this.topstyle}};Top.Widget.Breadcrumb=function(){Breadcrumb.prototype=Object.create(Top.Widget.prototype);Breadcrumb.prototype.constructor=Breadcrumb;function Breadcrumb(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-breadcrumb");this.template.innerHTML='<div class="top-breadcrumb-root"></div>'}this.id=this.template.id}Breadcrumb.create=function(element){return new Breadcrumb(element)};Breadcrumb.prototype.getSelectedText=function(){return this.template.selectedText};Breadcrumb.prototype.getSelectedNode=function(){return this.template.selectedNode};Breadcrumb.prototype.getSelectedId=function(){return this.template.selectedId};Breadcrumb.prototype.getSelectedIndex=function(){return this.template.selectedIndex};Breadcrumb.prototype.getList=function(){var _this=this.template;if(typeof _this.nodes==="string"){var nodes=Top.Util.namespace(_this.nodes)}else if(typeof _this.nodes==="object"){var nodes=_this.nodes}return nodes};Breadcrumb.prototype.addNodes=function(nodeArray){var _this=this.template;if(typeof _this.nodes==="string"){var nodes=Top.Util.namespace(_this.nodes)}else if(typeof _this.nodes==="object"){var nodes=_this.nodes}var tempNode=nodes.concat(nodeArray);_this.nodes=tempNode;_this.__updateNodes()};Breadcrumb.prototype.removeNode=function(id){var _this=this.template;var nodeId=id;if(typeof _this.nodes==="string"){var nodes=Top.Util.namespace(_this.nodes)}else if(typeof _this.nodes==="object"){var nodes=_this.nodes}_this.nodes=nodes;if(nodeId)for(var i=0;i<_this.nodes.length;i++){if(_this.nodes[i].id===nodeId){_this.nodes.splice(i,1)}}else{_this.nodes.pop()}_this.__updateNodes()};Breadcrumb.prototype.close=function(){var _this=this.template;return _this.close()};return Breadcrumb}();TopButton={is:"top-button",behaviors:[TopWidgetBehavior,TopTextBehavior],properties:{icon:String,text:String,image:String},__ready:function(){this.__initialize()},appendTemplate:function(){this.innerHTML='<button class="top-button-root" type="button"><span></span>'+this.innerHTML+'<div class="top-button-tooltip-wrapper"></div></button>';this.__isTemplateAppended=true},__initialize:function(){this.__updateId();this.__updateImage();this.__updateIcon();this.__updateDisabled();this.__updateText()},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-button-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateId:function(){if(this.id){var shadowRoot=this.querySelector(".top-button-root");shadowRoot.id=this.id}},__updateDisabled:function(){if(this.disabled===null)this.disabled=this.getAttribute("disabled");var disabled=this.calculateDerivedDisabled();var shadowInput=this.querySelector("button");if(disabled==="true"||disabled===true){shadowInput.setAttribute("disabled",true);this.classList.add("disabled")}else{shadowInput.removeAttribute("disabled");this.classList.remove("disabled")}},__updateImage:function(){var shadowIcon=this.querySelector("span");if(this.image){shadowIcon.classList.add("top-button-image");if(this.icon)shadowIcon.classList.remove(this.icon);if(this.image.includes("@drawable")){this.image=Top.DrawableManager.get(this.image.replace("@drawable/",""))}shadowIcon.style.backgroundImage="url("+this.image+")"}else{shadowIcon.classList.remove("top-button-image")}},__updateIcon:function(){var shadowIcon=this.querySelector("span");shadowIcon.classList.add("top-button-icon");if(this.icon){shadowIcon.style.backgroundImage="";shadowIcon.classList.add(this.icon);shadowIcon.classList.add("icon-set")}else{shadowIcon.classList.remove("icon-set")}},__updateText:function(){if(this.text){var shadowInput=this.querySelector("button");var shadowIcon=this.querySelector("span");var tooltipWrapper=this.querySelector("div");while(shadowIcon.nextSibling!==tooltipWrapper){shadowInput.removeChild(shadowIcon.nextSibling)}shadowIcon.insertAdjacentHTML("afterend",this.text)}},focus:function(){this.querySelector(".top-button-root").focus()},blur:function(){this.querySelector(".top-button-root").blur()},getTopStyle:function(){this.topstyle=this.querySelector("button").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector("button");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector("button").style.cssText=this.topstyle}};Top.Widget.Button=function(){Button.prototype=Object.create(Top.Widget.prototype);Button.prototype.constructor=Button;function Button(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-button");this.template.innerHTML='<button class="top-button-root" type="button"><span></span></button>'}this.id=this.template.id}Button.create=function(element){return new Button(element)};return Button}();TopChart={is:"top-chart",behaviors:[TopWidgetBehavior],properties:{type:{type:String,value:"line"},title:String,series:Object,option:{type:String,value:null},chart:{type:Object,value:null},curSeries:Object,priorData:Array,tickAmount:{type:Number,value:1}},appendTemplate:function(){this.innerHTML='<div class="top-chart"></div>';this.__isTemplateAppended=true},expectedTemplateClassName:function(){return"top-chart"},__attached2:function(){this.__initialize();var _this=this;if(Top.App.isLoaded()){if(this.layoutParent===undefined){var p=this.getNotInitializedParentRoot();if(p.__redrawChild===undefined)p.__redrawChild=[];var f=function(){_this.renderChart()};p.__redrawChild.push(f)}else{this.renderChart()}}else{Top.App.onBeforeLoad(function(){if(_this.layoutParent===undefined){var p=_this.getNotInitializedParentRoot();if(p.__redrawChild===undefined)p.__redrawChild=[];var f=function(){_this.renderChart()};p.__redrawChild.push(f)}else{_this.renderChart()}})}},getNotInitializedParentRoot:function(){var parent=this.getParent();while(parent.getParent().__initialized===undefined){parent=parent.getParent()}return parent},__detached:function(){},__initialize:function(){this.chart=null;if(this.layoutWidth==null){this.layoutWidth="100%";this.setTopStyle("width",this.layoutWidth)}if(this.layoutHeight==null){this.layoutHeight="100%";this.setTopStyle("height",this.layoutHeight)}var chartRoot=document.createElement("div");chartRoot.classList.add("top-chart-root");chartRoot.setAttribute("id",this.id);chartRoot.style.cssText="width:inherit; height:inherit;";this.querySelector(".top-chart").appendChild(chartRoot)},renderChart:function(){var styleScope=this.querySelector(".top-chart-root");var width=styleScope.offsetWidth;var height=styleScope.offsetHeight;if(typeof this.option==="string"){this.option=Top.Util.namespace(this.option,this)}if(typeof this.series==="string"){this.series=Top.Util.namespace(this.series,this)}if(typeof this.series==="object"){var series=$.extend(true,[],this.series)}if(!series||series.length<1){}else{this.curSeries=series.slice();this.priorData=[];for(var i=0;i<this.curSeries.length;i++){this.priorData[i]=[];for(var j=0;j<this.tickAmount;j++){this.priorData[i][j]=null}if(this.curSeries[i].data.constructor===Array){if(this.curSeries[i].data.length<this.tickAmount){var arrayIndex=0;for(var e=this.tickAmount-this.curSeries[i].data.length;e<this.tickAmount;e++){this.priorData[i][e]=this.curSeries[i].data[arrayIndex];arrayIndex++}this.curSeries[i].data=this.priorData[i]}else{this.priorData[i]=this.curSeries[i].data}}}}var default_option={chart:{type:this.type,width:width,height:height},title:{text:this.title},series:series};if(this.option!=null){this.__mergeOption(default_option,this.option)}if(!this.querySelector("#"+this.id+".top-chart-root"))this.__initialize();this.chart=$(this.querySelector("#"+this.id+".top-chart-root")).topcharts(default_option)},__mergeOption:function(base,extend){for(var key in extend){if(typeof extend[key]==="object"&&!Array.isArray(extend[key])){if(!base[key]){base[key]={}}this.__mergeOption(base[key],extend[key])}else{base[key]=extend[key]}}},__updateSeries:function(){if(this.chart&&this.series&&this.curSeries){if(typeof this.series=="string"){var newSeries=Top.Util.namespace(this.series,this)}else if(typeof this.series=="object"){var newSeries=this.series}var chart=this.chart;var seriesLen=this.curSeries.length;var newSeriesLen=newSeries.length;if(seriesLen>0&&seriesLen==newSeriesLen){for(var i=0;i<seriesLen;i++){var dataLen=0;var newDataLen=newSeries[i].data.length;if(this.priorData[i].constructor===Array){dataLen=this.priorData[i].length}chart.updateSeries(i,newSeries[i],true);this.curSeries[i]=Object.assign(newSeries[i]);this.priorData[i]=this.curSeries[i].data}}else if(seriesLen<newSeriesLen){var isRedraw=false;for(var i=seriesLen;i<newSeriesLen;i++){if(i===newSeriesLen-1){isRedraw=true}chart.addSeries(newSeries[i],isRedraw)}}else if(seriesLen>newSeriesLen){}}else if(this.series&&!this.curSeries){var chart=this.chart,newSeries=this.series,newSeriesLen=newSeries.length,isRedraw=false;this.priorData=[];for(var i=0;i<newSeriesLen;i++){if(i===newSeriesLen-1){isRedraw=true}chart.addSeries(newSeries[i],isRedraw);this.priorData.push(newSeries[i].data)}this.curSeries=Object.assign(newSeries)}else{this.renderChart()}},__updateOption:function(){if(typeof this.option==="string"){this.option=Top.Util.namespace(this.option,this)}if(this.chart)this.chart.setOption(this.option)},__updateVisible:function(){if(this.chart)this.chart.flush()},getTopStyle:function(){this.topstyle=this.querySelector("div").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector("div");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector("div").style.cssText=this.topstyle}};Top.Widget.Chart=function(){Chart.prototype=Object.create(Top.Widget.prototype);Chart.prototype.constructor=Chart;function Chart(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-chart");this.template.innerHTML='<div class="top-chart"></div>'}this.id=this.template.id}Chart.create=function(element){return new Chart(element)};Chart.prototype.topcharts=function(){return this.template.chart};return Chart}();TopCheckbox={is:"top-checkbox",behaviors:[TopWidgetBehavior,TopTextBehavior,TopCheckBehavior],properties:{onChange:String,checkPosition:{type:String,value:"left"},trueValue:String,falseValue:String},__ready:function(){if(this.trueValue===undefined)this.trueValue=true;if(this.falseValue===undefined)this.falseValue=false;this.__initI18n("text");this.__initialize()},appendTemplate:function(){this.innerHTML='<input class="top-checkbox-check" type="checkbox" id="checkbox" size="width:300px;"><label class="top-checkbox-text" for="checkbox"></label>';this.__isTemplateAppended=true},expectedTemplateClassName:function(){return"top-checkbox-check"},__initialize:function(){this.__updateDisabled();this.__updateText();this.__updateGroupId();this.__updateChecked();this.__initBindingEvent();this.__updatePosition()},__attached2:function(){this.__updateVirticalAlignment()},__eventBindingList:function(){var shadowInput=this.querySelector("input");var shadowLabel=this.querySelector("label");return{__eventMouseClick:function(func){shadowInput.onclick=func},__eventMousePressed:function(func){shadowInput.onmousedown=func},__eventMouseReleased:function(func){shadowInput.onmouseup=func},__eventMouseDblclick:function(func){shadowInput.ondblclick=func},__eventKeyPressed:function(func){shadowInput.onkeydown=func},__eventKeyTyped:function(func){shadowInput.onkeypress=func},__eventKeyReleased:function(func){shadowInput.onkeyup=func},__eventFocused:function(func){shadowInput.onfocus=func},__eventLostFocused:function(func){shadowInput.onblur=func},__eventMouseEnter:function(func){shadowLabel.onmouseenter=func},__eventMouseExit:function(func){shadowLabel.onmouseleave=func},__eventMouseMove:function(func){shadowLabel.onmousemove=func},__eventSecondaryClick:function(func){shadowLabel.oncontextmenu=func}}},__initEventInternal:function(){this.__addEventByAttr("change")},__updateDisabled:function(){if(this.disabled===null)this.disabled=this.getAttribute("disabled");var disabled=this.calculateDerivedDisabled();var shadowInput=this.querySelector("input");var shadowLabel=this.querySelector("label");if(disabled=="true"||disabled==true){this.setAttribute("disabled",true);shadowInput.setAttribute("disabled",true);shadowLabel.setAttribute("disabled",true)}else{this.removeAttribute("disabled");shadowInput.removeAttribute("disabled");shadowLabel.removeAttribute("disabled");this.__attachEventHandler()}},__attachEventHandler:function(){var shadowLabel=this.querySelector("label");var shadowInput=this.querySelector("input");var _this=this;$(shadowLabel).off("keydown").on("keydown",function(e){if(e.which===32){_this.checked=shadowInput.checked===true?_this.falseValue:_this.trueValue;_this.__updateChecked()}})},__updateText:function(){var shadowText=this.querySelector("label");var shadowInput=this.querySelector("input");this.text=this.__i18n(this.text);if(this.text||this.text===0){shadowText.innerHTML=this.text;shadowInput.value=this.text}},__updateGroupId:function(){if(this.groupId){var shadowInput=this.querySelector("input");shadowInput.name=this.groupId}},__initBindingEvent:function(){var _this=this;var shadowInput=this.querySelector("input");var shadowLabel=this.querySelector("label");if(this.labelClickEvent===undefined){this.labelClickEvent=function(e){e.stopPropagation();e.preventDefault();shadowInput.click();_this.checked=shadowInput.checked===true?_this.trueValue:_this.falseValue;_this.callEventChanged(shadowInput.checked);_this.updateData("checked");_this.updateDevice("checked")}}shadowLabel.removeEventListener("click",this.labelClickEvent);shadowLabel.addEventListener("click",this.labelClickEvent)},__updatePosition:function(){if(this.checkPosition==="right"){this.querySelector(".top-checkbox-text").classList.add("right");this.querySelector(".top-checkbox-check").classList.add("right")}else{this.querySelector(".top-checkbox-text").classList.add("left")}},__updateChecked:function(){var shadowInput=this.querySelector("input");if(this.checked===this.trueValue||this.checked===this.trueValue.toString()){shadowInput.checked=true}else{shadowInput.checked=false;this.checked=this.falseValue}this.callEventChanged(this.checked);this.updateData("checked");this.updateDevice("checked")},__updateVisibleInternal:function(){var shadowInput=this.querySelector("input");
if(this.visible=="none"){shadowInput.style.display="none"}else{shadowInput.style.display="inline-block"}},__updateVirticalAlignment:function(){if(this.__isAttached!==true)return;var label=this.querySelector("label");if(!(this.layoutHeight==="wrap_content"||this.layoutHeight==="auto"||this.layoutHeight==="match_parent"||this.layoutHeight!==undefined&&this.layoutHeight!==null&&this.layoutHeight.includes("%"))){if(this.verticalAlignment==="top"){label.style.paddingTop=this.paddingTop}else if(this.verticalAlignment==="bottom"){var computedStyle=getComputedStyle(label);var padding=label.offsetHeight-parseFloat(computedStyle.fontSize)-parseFloat(computedStyle.paddingBottom);label.style.paddingTop=padding+"px"}else{var computedStyle=getComputedStyle(label);var fontSize=this.textSize?this.textSize:computedStyle.fontSize;var height=label.offsetHeight===0?parseFloat(this.layoutHeight):label.offsetHeight;var paddingTop=parseFloat(computedStyle.paddingTop)||0;var paddingBottom=parseFloat(computedStyle.paddingBottom)||0;var padding=height-parseFloat(fontSize)+paddingTop-paddingBottom;label.style.paddingTop=padding/2+"px"}}else{label.style.paddingTop=this.paddingTop}},__setVerticalAlignment:function(){var label=this.querySelector("label");if(this.layoutHeight==="match_parent"||this.layoutHeight!==undefined&&this.layoutHeight!==null&&this.layoutHeight.includes("%")){if(this.verticalAlignment==="top"){label.style.paddingTop=this.paddingTop}else if(this.verticalAlignment==="bottom"){var computedStyle=getComputedStyle(label);var padding=label.offsetHeight-parseFloat(computedStyle.fontSize)-parseFloat(computedStyle.paddingBottom);label.style.paddingTop=padding+"px"}else{var computedStyle=getComputedStyle(label);var padding=label.offsetHeight-parseFloat(computedStyle.fontSize)+parseFloat(computedStyle.paddingTop)-parseFloat(computedStyle.paddingBottom);label.style.paddingTop=padding/2+"px"}}},callEventChanged:function(checked){if(typeof this.eventChanged==="string")this.__eventChanged=Top.Util.namespace(this.eventChanged,this);if(typeof this.__eventChanged==="function"){var widget=Top.Dom.selectById(this.id);this.__eventChanged(checked,this.value,widget.template.dataIndex)}},isChecked:function(){var shadowInput=this.querySelector("input");return shadowInput.checked===true?this.trueValue:this.falseValue},focus:function(){this.querySelector(".top-checkbox-check").focus()},blur:function(){this.querySelector(".top-checkbox-check").blur()},__updateOnChange:function(){this.__addEventByAttr("change")},getTopStyle:function(){this.topstyle=this.querySelector(".top-checkbox-text").style.cssText;return this.topstyle},setTopStyle:function(key,value){var text=this.querySelector(".top-checkbox-text");if(value){text.style[key]=value;this.topstyle=text.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-checkbox-text").style.cssText=this.topstyle}};Top.Widget.Checkbox=function(){Checkbox.prototype=Object.create(Top.Widget.prototype);Checkbox.prototype.constructor=Checkbox;function Checkbox(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-checkbox");this.template.innerHTML='<input class="top-checkbox-check" type="checkbox" id="checkbox" size="width:300px;"><label class="top-checkbox-text" for="checkbox"></label>'}this.id=this.template.id}Checkbox.create=function(element){return new Checkbox(element)};Checkbox.prototype.isChecked=function(){return this.template.isChecked()};return Checkbox}();TopChip={is:"top-chip",behaviors:[TopWidgetBehavior,TopTextBehavior],properties:{visible:String,maxLength:Number,readonly:String,icon:String,onIconclick:String,clear:String,chipItems:String,onAdd:String,keyCode:String,onClose:String},__ready:function(){this.__updateAutoComplete();this.__updateDisabled();this.__updateMaxLength();this.__updateVisible();this.__updateIcon();this.__updateClear();this.__updateReadonly();this.__initBindingEvent();this.__updateId();this.__initialClassname();this.__initI18n("hint");this.__updateChip()},appendTemplate:function(){this.innerHTML='<div class="top-chip-root"><form autocomplete="off" onsubmit="return false;"><input class="top-chip-text" type="text"><span class="top-chip-icon"></span></form></div>';this.__isTemplateAppended=true},__attached2:function(){},__updateId:function(){if(this.id){var input=this.querySelector("input");input.id=this.id}},__updateChip:function(){var _this=this;Top.App.onWidgetAttach(this.id,function(){_this.__createChip();_this.__renderChip()})},__updateChipItems:function(){if(this.__initialized===true){this.__renderChip()}},__createChip:function(){if(this.keyCode!==undefined)this.keyCode=this.keyCode.replace("{","").replace("[","").replace("}","").replace("]","").replace(" ","").split(",");var inputClassName="";var _this=this;if(_this.onAdd&&typeof _this.onAdd==="string"){var fnAdd=Top.Util.namespace(_this.onAdd,_this)}else if(typeof _this.onAdd==="function"){var fnAdd=_this.onAdd}var shadowInput=this.querySelector(".top-chip-root").querySelector(".top-chip-text");$(shadowInput).on("keydown",function(e){if(_this.keyCode!==undefined){for(var i=0;i<_this.keyCode.length;i++){if(e.which===parseInt(_this.keyCode[i])){_this.__addChip(shadowInput.value);if(typeof fnAdd==="function"){fnAdd(e.originalEvent,shadowInput.value,_this.chipItems)}shadowInput.value="";break}}}else{if(e.which==13||e.which==32){_this.__addChip(shadowInput.value);if(typeof fnAdd==="function"){fnAdd(e.originalEvent,shadowInput.value,_this.chipItems)}shadowInput.value=""}}});return inputClassName},__addChip:function(text){var _this=this;if(this.chipItems===undefined){this.chipItems=new Array}var shadowInput=this.querySelector(".top-chip-root").querySelector(".top-chip-text");var shadowRoot=this.querySelector(".top-chip-root").querySelector(".top-chip-root");var chip={};chip.text=text;var chipBox=document.createElement("div");chipBox.classList.add("top-chip-box");if(_this.draggable==="true"||_this.draggable===true)chipBox.setAttribute("draggable","true");var chipContent=document.createElement("div");chipContent.classList.add("top-chip-content");var chipText=document.createElement("span");chipText.innerText=text;chipContent.appendChild(chipText);var chipClose=document.createElement("i");chipClose.classList.add("top-chip-close");chipContent.appendChild(chipClose);chipBox.appendChild(chipContent);shadowInput.insertAdjacentElement("beforebegin",chipBox);if(_this.onClose&&typeof _this.onClose==="string"){var fnClose=Top.Util.namespace(_this.onClose,_this)}else if(typeof _this.onClose==="function"){var fnClose=_this.onClose}$(chipClose).on("click",function(e){var data;for(var i=0;i<_this.chipItems.length;i++){if(_this.chipItems[i].text===this.parentNode.innerText){data=_this.chipItems[i];_this.chipItems.splice(i,1);fnClose(e.originalEvent,_this,data);break}}this.parentNode.parentNode.remove()});this.chipItems.push(chip);$(chipBox).on("dblclick",function(e){var newEditWidget;var thisText=chipBox.innerText;newEditWidget=Top.Widget.create("top-textfield");$(chipBox).after(newEditWidget.template);newEditWidget.setText(thisText);newEditWidget.template.childNodes[0].style.width=chipBox.offsetWidth+"px";newEditWidget.template.childNodes[0].style.height=chipBox.offsetHeight+"px";newEditWidget.template.childNodes[0].style.float="left";$(chipBox).hide();$(newEditWidget).focus();$(newEditWidget).on("blur",function(e){var textContentValue="";if(this.template.tagName==="TOP-TEXTFIELD"){if(!(e.type==="blur"||e.keyCode===13))return;textContentValue=this.template.text}if(this.tagName==="TOP-TEXTFIELD"){if(typeof this.validation==="function"){if(!this.validation())return}}chipText.innerText=textContentValue;$("#"+e.target.id).remove();$(chipBox).show()})});this.chipItems.push(chip)},__renderChip:function(text){var _this=this;var shadowInput="";var shadowRoot="";var inputClassName="";var inputRootName="";shadowInput=this.querySelector(".top-chip-root").querySelector(".top-chip-text");if(_this.disabled===true||_this.disabled==="true")shadowInput.style.display="none";shadowRoot=this.querySelector(".top-chip-root");var chip=new Array;if(this.chipItems!=undefined){if(typeof this.chipItems==="string")this.chipItems=Top.Util.namespace(this.chipItems,this);for(var i=0;i<Object.keys(this.chipItems).length;i++){chip[i]=new Array(4);if(this.chipItems[i].text!=undefined)chip[i][0]=this.chipItems[i].text;else chip[i][0]=this.chipItems[i].value;if(this.chipItems[i].icon!=undefined)chip[i][1]=this.chipItems[i].icon;else chip[i][1]=undefined;if(this.chipItems[i].edit!=undefined)chip[i][2]=this.chipItems[i].edit;else if(this.chipItems[i].edit===false)chip[i][2]="false";else chip[i][2]="textfield";if(this.chipItems[i].editProperties!=undefined)chip[i][3]=this.chipItems[i].editProperties}}else return false;if(_this.onClose&&typeof _this.onClose==="string"){var fnClose=Top.Util.namespace(_this.onClose,_this)}else if(typeof _this.onClose==="function"){var fnClose=_this.onClose}for(var i=0;i<chip.length;i++){(function(currentChip){var chipBox=document.createElement("div");chipBox.classList.add("top-chip-box");if(_this.draggable==="true"||_this.draggable===true)chipBox.setAttribute("draggable","true");var chipContent=document.createElement("div");chipContent.classList.add("top-chip-content");if(currentChip[1]!=undefined){var chipIcon=document.createElement("i");chipIcon.classList.add("top-chip-icon");chipIcon.classList.add(currentChip[1]);chipContent.appendChild(chipIcon)}var chipText=document.createElement("span");chipText.innerText=currentChip[0];chipContent.appendChild(chipText);var chipClose=document.createElement("i");chipClose.classList.add("top-chip-close");chipContent.appendChild(chipClose);chipBox.appendChild(chipContent);shadowInput.insertAdjacentElement("beforebegin",chipBox);var data;$(chipClose).on("click",function(e){for(var i=0;i<_this.chipItems.length;i++){if(_this.chipItems[i].text===this.parentNode.innerText){data=_this.chipItems[i];_this.chipItems.splice(i,1);if(fnClose!==undefined)fnClose(e.originalEvent,_this,data);break}}this.parentNode.parentNode.remove()});if(_this.draggable==="true"||_this.draggable===true){function changeTarget(widget){if(widget.tagName!=="DIV"){return widget.parentNode.parentNode}else if(widget.classList.value==="top-chip-content"){return widget.parentNode}else{return widget}}$(chipBox).on("dragover",function(e){if(e.originalEvent.preventDefault){e.originalEvent.preventDefault()}e.originalEvent.dataTransfer.dropEffect="move";var targetNode=changeTarget(e.target);if(e.originalEvent.offsetX<$(targetNode).width()/2){targetNode.classList.remove("over_right");targetNode.classList.add("over_left")}else{targetNode.classList.remove("over_left");targetNode.classList.add("over_right")}e.stopPropagation()});$(chipBox).on("dragleave",function(e){e.stopPropagation();var targetNode=changeTarget(e.target);targetNode.classList.remove("over_left");targetNode.classList.remove("over_right")});function _createDropline(){var tmp_dropline=document.createElement("span");tmp_dropline.classList.add("top-chip-dropline");return tmp_dropline}var lock=false;$(chipBox).on("dragstart",function(e){lock=false;this.ondragend=_destroy;this.ondrag=$.throttle(300,_renderghost);selected=this;function _renderghost(e){if(lock===true)return;if(document.querySelector(".top-chip-dropline")!==null){var dropLines=document.querySelectorAll(".top-chip-dropline");for(var j=0;j<dropLines.length;j++){$(dropLines[j]).remove()}}var right=document.querySelector(".over_right");var left=document.querySelector(".over_left");if(right!==null){right.insertAdjacentElement("afterend",_createDropline())}else if(left!==null){left.insertAdjacentElement("beforebegin",_createDropline())}else{shadowInput.insertAdjacentElement("beforebegin",_createDropline())}}function _destroy(e){var dropLine=document.querySelector(".top-chip-dropline");dropLine.insertAdjacentElement("afterend",this);$(dropLine).remove();lock=true}})}if(currentChip[2]!==undefined&&currentChip[2]!=="false"){$(chipBox).on("dblclick",function(e){var newEditWidget;var thisText=chipBox.innerText;var editProperties=currentChip[3];switch(currentChip[2]){case"selectbox":{newEditWidget=Top.Widget.create("top-selectbox");$(chipBox).after(newEditWidget.template);newEditWidget.setProperties({"selected-text":thisText});break}case"textfield":{newEditWidget=Top.Widget.create("top-textfield");$(chipBox).after(newEditWidget.template);newEditWidget.setText(thisText);break}default:{newEditWidget=eval("Top.Widget.create('top-"+editType+"')");$(chipBox).after(newEditWidget.template)}}newEditWidget.template.childNodes[0].style.width=chipBox.offsetWidth+"px";newEditWidget.template.childNodes[0].style.height=chipBox.offsetHeight+"px";newEditWidget.template.childNodes[0].style.float="left";if(editProperties){newEditWidget.setProperties(editProperties)}$(chipBox).hide();$(newEditWidget).focus();if(currentChip[2]==="selectbox")newEditWidget.open();$(newEditWidget).on("blur close change select",function(e){var textContentValue="";if(this.template.tagName==="TOP-TEXTFIELD"){if(!(e.type==="blur"||e.keyCode===13))return;textContentValue=this.template.text}else if(this.template.tagName==="TOP-TEXTAREA"){if(!(e.type==="blur"))return;textContentValue=this.template.text}else if(this.template.tagName==="TOP-SELECTBOX"){if(!(e.type==="change"||e.type==="close"))return;textContentValue=this.template.selectedText}else if(this.template.tagName==="TOP-DATEPICKER"){if(e.type!=="select")return;textContentValue=this.template.date}if(this.tagName==="TOP-TEXTFIELD"){if(typeof this.validation==="function"){if(!this.validation())return}}chipText.innerText=textContentValue;$("#"+e.target.id).remove();$(chipBox).show()})})}})(chip[i])}},__initBindingEvent:function(){var _this=this;this.__addEventFnByCore("eventKeyReleased",function(){_this.updateData("text");_this.updateDevice("text")});this.__addEventFnByCore("eventLostFocused",function(){_this.updateData("text");_this.updateDevice("text")})},__updateDisabled:function(){if(this.disabled===null)this.disabled=this.getAttribute("disabled");var disabled=this.calculateDerivedDisabled();var shadowInput=this.querySelector(".top-chip-root").querySelector("div input");if(disabled=="true"||disabled==true){shadowInput.setAttribute("disabled",true)}else{shadowInput.removeAttribute("disabled")}},__updateMaxLength:function(){var shadowInput=this.querySelector(".top-chip-root").querySelector("div input");if(this.maxLength!=null)$(shadowInput).attr("maxlength",this.maxLength)},__updateReadonly:function(){var shadowInput=this.querySelector(".top-chip-root").querySelector("div input");if(this.readonly=="true"||this.readonly==true){shadowInput.setAttribute("readonly","")}else{shadowInput.removeAttribute("readonly")}},__updateVisible:function(){if(this.visible!=="none"){if(this.title)this.setTitlePosition()}var checkVisibility=/visibility:[a-z]+;/g;var checkDisplay=/display:[a-z-]+;/g;var temp=this.topstyle;temp=temp.replace(checkVisibility,"");temp=temp.replace(checkDisplay,"");this.topstyle=temp;if(this.display!=="none")this.prevDisplay=this.display;if(this.visible=="none"){this.display="none"}else if(this.visible==="visible"&&this.display==="none"){this.display=this.prevDisplay}if(this.display==null){this.display="inline-block"}this.setTopStyle("visibility",this.visible);this.setTopStyle("display",this.display);if(this.borderWidth!==undefined){var shadowInput=this.querySelector(".top-chip-root").querySelector("div input");shadowInput.style.borderWidth=this.borderWidth}},__updateIcon:function(){var _this=this;var shadowInput=this.querySelector(".top-chip-root").querySelector("div input");var shadowIcon=this.querySelector(".top-chip-root").querySelector("div span");if(this.icon!==null&&this.icon!==""&&this.icon!==undefined){shadowIcon.classList.add(this.icon);Top.App.onWidgetAttach(this.id,function(){var fontSize=$(shadowInput).css("font-size");var inputHeight=shadowInput.offsetHeight;shadowIcon.style.lineHeight=inputHeight+"px";shadowIcon.style.display="inline"});if(this.onIconclick&&typeof this.onIconclick==="string"){var fnIconClick=Top.Util.namespace(this.onIconclick,this);if(typeof fnIconClick==="function"){shadowIcon.style.cursor="pointer";$(shadowIcon).off("click").on("click",function(e){fnIconClick(e,Top.Dom.selectById(_this.id))})}}}},__updateClear:function(){var shadowForm=this.querySelector(".top-chip-root").querySelector("div form");var shadowInput=this.querySelector(".top-chip-root").querySelector("div input");var shadowIcon=this.querySelector(".top-chip-root").querySelector("div .top-chip-icon");var _this=this;if(this.clear===true||this.clear==="true"){$(shadowForm).append('<button class="top-chip-clear" type="reset"></button>');Top.App.onWidgetAttach(this.id,function(){var inputHeight=shadowInput.offsetHeight;var shadowClear=shadowForm.querySelector(".top-chip-clear");shadowClear.style.lineHeight=inputHeight+"px";if(shadowIcon&&shadowIcon.style.display!=="none"){shadowClear.style.right="30px"}})}},focus:function(){this.querySelector(".top-chip-root").querySelector(".top-chip-text").focus()},blur:function(){this.querySelector(".top-chip-root").querySelector(".top-chip-text").blur()},getTopStyle:function(){this.topstyle=this.querySelector(".top-chip-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-chip-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-chip-root").style.cssText=this.topstyle}};Top.Widget.Chip=function(){Chip.prototype=Object.create(Top.Widget.prototype);Chip.prototype.constructor=Chip;function Chip(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-chip");this.template.innerHTML='<div class="top-chip-root"><form autocomplete="off" onsubmit="return false;"><input class="top-chip-text" type="text"><span class="top-chip-icon"></span></form></div>'}this.id=this.template.id}Chip.create=function(obj){return new Chip(obj)};Chip.prototype.template=null;Chip.prototype.is="top-chip";Chip.prototype.openAutoComplete=function(){this.template.openAutoComplete()};Chip.prototype.closeAutoComplete=function(){this.template.closeAutoComplete()};Chip.prototype.sync=function(){this.template.__clearChip();this.template.__updateChip()};return Chip}();TopCodeEditor={is:"top-codeeditor",behaviors:[TopWidgetBehavior],properties:{text:String,lineNumber:{type:Boolean,value:false},firstLineNumber:{type:Number,value:1},lineWrapping:{type:Boolean,value:false},mode:{type:String,value:"javascript"},customizedMode:String,autocomplete:{type:Boolean,value:false},readOnly:{type:Boolean,value:false},onChange:String},__ready:function(){this.__updateId();this.renderLayout();this.__initBindingEvent();this.__updateText()},appendTemplate:function(){this.innerHTML='<div class="top-codeeditor-root"></div>';this.__isTemplateAppended=true},__attached2:function(){},initializeChildRoot:function(){return this.querySelector(".top-codeeditor-root")},renderLayout:function(){if(typeof this.customizedMode==="string"){this.customizedMode=Top.Util.namespace(this.customizedMode,this)}if(this.autocomplete===true||this.autocomplete==="true"){var extraKeyMap={"Ctrl-Space":"autocomplete"}}else{var extraKeyMap=null}if(typeof this.customizedMode==="object"||typeof this.customizedMode==="string"&&this.customizedMode!==""){this.codemirror=CodeMirror(this.childRoot,{mode:this.customizedMode,lineNumbers:this.lineNumber,firstLineNumber:this.firstLineNumber,lineWrapping:this.lineWrapping,extraKeys:extraKeyMap,readOnly:this.readOnly})}else{this.codemirror=CodeMirror(this.childRoot,{mode:this.mode,lineNumbers:this.lineNumber,firstLineNumber:this.firstLineNumber,lineWrapping:this.lineWrapping,extraKeys:extraKeyMap,readOnly:this.readOnly})}},__initBindingEvent:function(){var _this=this;this.codemirror.doc.on("change",function(Doc,changedInfo){_this.text=Doc.getValue();_this.setAttribute("text",_this.text);_this.updateData("text");_this.updateDevice("text");if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("change"),changedInfo)}else{_this.__dispatchEvent(new Event("change"),changedInfo)}})},__initEventInternal:function(){this.__addEventByAttr("change")},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-codeeditor-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateId:function(){if(this.id){this.childRoot.id=this.id}},__updateText:function(){this.__initI18n("text");if(typeof this.text==="string"){this.codemirror.setValue(this.text)}},__updateLineNumber:function(){this.codemirror.setOption("lineNumbers",this.lineNumber)},__updateFirstLineNumber:function(){this.codemirror.setOption("firstLineNumber",this.firstLineNumber)},__updateLineWrapping:function(){this.codemirror.setOption("lineWrapping",this.lineWrapping)},__updateMode:function(){this.codemirror.setOption("mode",this.mode)},__updateCustomizedMode:function(){this.codemirror.setOption("mode",this.customizedMode)},__updateAutocomplete:function(){if(this.autocomplete===true||this.autocomplete==="true"){var extraKeyMap={"Ctrl-Space":"autocomplete"}}else{var extraKeyMap=null}this.codemirror.setOption("extraKeys",extraKeyMap)},__updateReadOnly:function(){this.codemirror.setOption("readOnly",this.readOnly)},__updateOnChange:function(){this.__addEventByAttr("change")},getTopStyle:function(){this.topstyle=this.childRoot.style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.childRoot.style[key]=value;this.topstyle=this.childRoot.style.cssText}},setAllTopStyle:function(){this.childRoot.style.cssText=this.topstyle}};Top.Widget.Codeeditor=function(){Codeeditor.prototype=Object.create(Top.Widget.prototype);Codeeditor.prototype.constructor=Codeeditor;function Codeeditor(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-codeeditor");this.template.innerHTML='<div class="top-codeeditor-root"></div>'}this.id=this.template.id}Codeeditor.create=function(element){return new Codeeditor(element)};return Codeeditor}();TopColorpicker={is:"top-colorpicker",behaviors:[TopWidgetBehavior],properties:{hex:String,rgb:{r:String,g:String,b:String},hsv:{h:String,s:String,v:String},onSelect:String},__ready:function(){this.__initialize();this.__updateId()},appendTemplate:function(){this.innerHTML='<button class="top-colorpicker-button" type="button"></button><div class = "top-colorpicker-popup"><canvas class = "top-colorpicker-canvas" width = "480" height = "320"></canvas><div class = "top-colorpicker-aim"></div><div><div class="top-colorpicker-container"><div class = "top-colorpicker-preview"></div><span> R: </span><input type = "text" class = "top-colorpicker-r"></input><span> G: </span><input type = "text" class = "top-colorpicker-g"></input><span> B: </span><input type = "text" class = "top-colorpicker-b"></input><span> H: </span><input type = "text" class = "top-colorpicker-h"></input><span> S: </span><input type = "text" class = "top-colorpicker-s"></input><span> V: </span><input type = "text" class = "top-colorpicker-v"></input><span> #: </span><input type = "text" class = "top-colorpicker-hex"></input></div><div class="top-colorpicker-container"><button class = "top-colorpicker-ok" type = "button"> OK </button><button class = "top-colorpicker-cancel" type = "button"> Cancel </button></div></div></div>';this.__isTemplateAppended=true},expectedTemplateClassName:function(){return"top-colorpicker-button"},__initEventInternal:function(){this.__addEventByAttr("select")},__updateOnSelect:function(){this.__addEventByAttr("select")},__updateId:function(){if(this.id){var button=this.querySelector("button");button.id=this.id}},__initialize:function(){var _this=this;if(_this.hex!==undefined){_this.rgb=_this.__HexToRgb(_this.hex);_this.hsv=_this.__rgbToHsv(_this.rgb.r,_this.rgb.g,_this.rgb.b)}else if(_this.rgb!==undefined){_this.hex=_this.__rgbToHex(_this.rgb.r,_this.rgb.g,_this.rgb.b);_this.hsv=_this.__rgbToHsv(_this.rgb.r,_this.rgb.g,_this.rgb.b)}else if(_this.hsv!==undefined){_this.rgb=_this.__hsvToRgb(_this.hsv.h,_this.hsv.s,_this.hsv.v);_this.hex=_this.__rgbToHex(_this.rgb.r,_this.rgb.g,_this.rgb.b)}var _this=this;var canvas=this.querySelector(".top-colorpicker-popup").querySelector(".top-colorpicker-canvas").getContext("2d");var img=new Image;img.src=Top.libsPath+"css/images/colorpicker.png";$(img).load(function(){canvas.drawImage(img,0,0)});var shadowBtn=this.querySelector(".top-colorpicker-button");var shadowPopup=this.querySelector(".top-colorpicker-popup");var shadowOk=this.querySelector(".top-colorpicker-ok");var shadowCancel=this.querySelector(".top-colorpicker-cancel");var shadowCanvas=this.querySelector(".top-colorpicker-canvas");var shadowR=this.querySelector(".top-colorpicker-r");var shadowG=this.querySelector(".top-colorpicker-g");var shadowB=this.querySelector(".top-colorpicker-b");var shadowH=this.querySelector(".top-colorpicker-h");var shadowS=this.querySelector(".top-colorpicker-s");var shadowV=this.querySelector(".top-colorpicker-v");var shadowHex=this.querySelector(".top-colorpicker-hex");var shadowAim=this.querySelector(".top-colorpicker-aim");var shadowPreview=this.querySelector(".top-colorpicker-preview");_this.__addCanvasEvent(canvas,shadowCanvas,shadowR,shadowG,shadowB,shadowHex,shadowH,shadowS,shadowV,shadowAim,shadowPreview);var rgbArray=[shadowR,shadowG,shadowB];var hsvArray=[shadowH,shadowS,shadowV];_this.__addRgbEvent(shadowCanvas.width,shadowCanvas.height,canvas,rgbArray,shadowAim,shadowPreview,hsvArray,shadowHex);_this.__addHsvEvent(shadowCanvas.width,shadowCanvas.height,canvas,rgbArray,shadowAim,shadowPreview,hsvArray,shadowHex);_this.__addHexEvent(shadowCanvas.width,shadowCanvas.height,canvas,rgbArray,shadowAim,shadowPreview,hsvArray,shadowHex);_this.__addBtnEvent(shadowBtn,shadowPopup,shadowHex,shadowOk,shadowCancel)},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-colorpicker-button");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateData:function(value){if(value==="hex"){this.hex=this.hex.replace("#","");this.rgb=this.__HexToRgb(this.hex);this.hsv=this.__rgbToHsv(this.rgb.r,this.rgb.g,this.rgb.b)}else if(value==="rgb"){this.hex=this.__rgbToHex(this.rgb.r,this.rgb.g,this.rgb.b);this.hsv=this.__rgbToHsv(this.rgb.r,this.rgb.g,this.rgb.b)}else if(value==="hsv"){this.rgb=this.__hsvToRgb(this.hsv.h,this.hsv.s,this.hsv.v);this.hex=this.__rgbToHex(this.rgb.r,this.rgb.g,this.rgb.b)}this.querySelector(".top-colorpicker-button").style.backgroundColor="#"+this.hex;this.querySelector(".top-colorpicker-preview").style.backgroundColor="#"+this.hex;this.querySelector(".top-colorpicker-hex").value=this.hex;var shadowR=this.querySelector(".top-colorpicker-r");shadowR.value=this.rgb.r;var shadowG=this.querySelector(".top-colorpicker-g");shadowG.value=this.rgb.g;var shadowB=this.querySelector(".top-colorpicker-b");shadowB.value=this.rgb.b;this.querySelector(".top-colorpicker-h").value=this.hsv.h;this.querySelector(".top-colorpicker-s").value=this.hsv.s;this.querySelector(".top-colorpicker-v").value=this.hsv.v;var canvas=this.querySelector(".top-colorpicker-popup").querySelector(".top-colorpicker-canvas").getContext("2d");var shadowCanvas=this.querySelector(".top-colorpicker-popup").querySelector(".top-colorpicker-canvas");var shadowAim=this.querySelector(".top-colorpicker-aim");var rgbArray=[shadowR,shadowG,shadowB];this.__changeAim(shadowCanvas.width,shadowCanvas.height,canvas,shadowAim,rgbArray)},__addBtnEvent:function(shadowBtn,shadowPopup,shadowHex,shadowOk,shadowCancel){var _this=this;$(shadowBtn).off("click").on("click",function(){shadowPopup.style.display="block"});if(_this.onSelect&&typeof _this.onSelect==="string"){var fnSelect=Top.Util.namespace(_this.onSelect,_this)}else if(typeof _this.onSelect==="function"){var fnSelect=_this.onSelect}$(shadowOk).click(function(event){shadowBtn.style.backgroundColor="#"+_this.hex;shadowPopup.style.display="none";_this.updateData("rgb");_this.updateData("hsv");_this.updateData("hex");_this.updateDevice("rgb");_this.updateDevice("hsv");_this.updateDevice("hex");if(typeof fnSelect==="function"){fnSelect(event.originalEvent,Top.Dom.selectById(_this.id))}_this.__dispatchEvent(new CustomEvent("select"))});$(shadowCancel).click(function(event){shadowPopup.style.display="none"})},__addCanvasEvent:function(canvas,shadowCanvas,shadowR,shadowG,shadowB,shadowHex,shadowH,shadowS,shadowV,shadowAim,shadowPreview){var _this=this;$(shadowCanvas).click(function(event){var rect=shadowCanvas.getBoundingClientRect();var x=event.clientX-rect.left;var y=event.clientY-rect.top;var offsetLeft=shadowCanvas.offsetLeft;var offsetTop=shadowCanvas.offsetTop;var imgData=canvas.getImageData(x,y,1,1).data;_this.rgb={r:imgData[0],g:imgData[1],b:imgData[2]};_this.hex=_this.__rgbToHex(imgData[0],imgData[1],imgData[2]);_this.hsv=_this.__rgbToHsv(imgData[0],imgData[1],imgData[2]);shadowR.value=imgData[0];shadowG.value=imgData[1];shadowB.value=imgData[2];shadowHex.value=_this.hex;shadowH.value=_this.hsv.h;shadowS.value=_this.hsv.s;shadowV.value=_this.hsv.v;shadowAim.style.display="block";shadowAim.style.left=x-10+offsetLeft+"px";shadowAim.style.top=y-10+offsetTop+"px";shadowPreview.style.backgroundColor="#"+_this.hex})},__addRgbEvent:function(width,height,canvas,rgbArray,shadowAim,shadowPreview,hsvArray,shadowHex){var _this=this;for(var k=0;k<rgbArray.length;k++){$(rgbArray[k]).change(function(event){_this.hex=_this.__rgbToHex(rgbArray[0].value,rgbArray[1].value,rgbArray[2].value);_this.hsv=_this.__rgbToHsv(rgbArray[0].value,rgbArray[1].value,rgbArray[2].value);_this.rgb=_this.__HexToRgb(_this.hex);hsvArray[0].value=_this.hsv.h;hsvArray[1].value=_this.hsv.s;hsvArray[2].value=_this.hsv.v;shadowHex.value=_this.hex;shadowPreview.style.backgroundColor="#"+_this.hex;_this.__changeAim(width,height,canvas,shadowAim,rgbArray)})}},__addHsvEvent:function(width,height,canvas,rgbArray,shadowAim,shadowPreview,hsvArray,shadowHex){var _this=this;for(var k=0;k<hsvArray.length;k++){$(hsvArray[k]).change(function(event){var rgb=_this.__hsvToRgb(hsvArray[0].value,hsvArray[1].value,hsvArray[2].value);rgbArray[0].value=rgb[0];rgbArray[1].value=rgb[1];rgbArray[2].value=rgb[2];_this.hex=_this.__rgbToHex(rgbArray[0].value,rgbArray[1].value,rgbArray[2].value);_this.hsv=_this.__rgbToHsv(rgbArray[0].value,rgbArray[1].value,rgbArray[2].value);_this.rgb=rgb;shadowHex.value=_this.hex;shadowPreview.style.backgroundColor="#"+_this.hex;_this.__changeAim(width,height,canvas,shadowAim,rgbArray);
})}},__addHexEvent:function(width,height,canvas,rgbArray,shadowAim,shadowPreview,hsvArray,shadowHex){var _this=this;$(shadowHex).change(function(event){var rgb=_this.__HexToRgb(shadowHex.value);rgbArray[0].value=rgb.r;rgbArray[1].value=rgb.g;rgbArray[2].value=rgb.b;_this.hex=_this.__rgbToHex(rgbArray[0].value,rgbArray[1].value,rgbArray[2].value);_this.hsv=_this.__rgbToHsv(rgbArray[0].value,rgbArray[1].value,rgbArray[2].value);hsvArray[0].value=_this.hsv.h;hsvArray[1].value=_this.hsv.s;hsvArray[2].value=_this.hsv.v;shadowHex.value=_this.hex;shadowPreview.style.backgroundColor="#"+_this.hex;_this.__changeAim(width,height,canvas,shadowAim,rgbArray)})},__changeAim:function(width,height,canvas,shadowAim,rgbArray){shadowAim.style.display="none"},__rgbToHex:function(R,G,B){return this.__toHex(R)+this.__toHex(G)+this.__toHex(B)},__toHex:function(n){n=parseInt(n,10);if(isNaN(n))return"00";n=Math.max(0,Math.min(n,255));return"0123456789ABCDEF".charAt((n-n%16)/16)+"0123456789ABCDEF".charAt(n%16)},__HexToRgb:function(hex){hex=hex.replace("#","");var value=hex.match(/[a-f\d]/gi);if(value.length==3)hex=value[0]+value[0]+value[1]+value[1]+value[2]+value[2];value=hex.match(/[a-f\d]{2}/gi);if(value===null){return{r:0,g:0,b:0}}var r=parseInt(value[0],16);var g=parseInt(value[1],16);var b=parseInt(value[2],16);return{r:r,g:g,b:b}},__rgbToHsv:function(R,G,B){var rr,gg,bb,r=R/255,g=G/255,b=B/255,h,s,v=Math.max(r,g,b),diff=v-Math.min(r,g,b),diffc=function(c){return(v-c)/6/diff+1/2};if(diff==0){h=s=0}else{s=diff/v;rr=diffc(r);gg=diffc(g);bb=diffc(b);if(r===v){h=bb-gg}else if(g===v){h=1/3+rr-bb}else if(b===v){h=2/3+gg-rr}if(h<0){h+=1}else if(h>1){h-=1}}return{h:Math.round(h*360),s:Math.round(s*100),v:Math.round(v*100)}},__hsvToRgb:function(h,s,v){var r,g,b;var i;var f,p,q,t;h=Math.max(0,Math.min(360,h));s=Math.max(0,Math.min(100,s));v=Math.max(0,Math.min(100,v));s/=100;v/=100;if(s==0){r=g=b=v;return[Math.round(r*255),Math.round(g*255),Math.round(b*255)]}h/=60;i=Math.floor(h);f=h-i;p=v*(1-s);q=v*(1-s*f);t=v*(1-s*(1-f));switch(i){case 0:r=v;g=t;b=p;break;case 1:r=q;g=v;b=p;break;case 2:r=p;g=v;b=t;break;case 3:r=p;g=q;b=v;break;case 4:r=t;g=p;b=v;break;default:r=v;g=p;b=q}return{r:Math.round(r*255),g:Math.round(g*255),b:Math.round(b*255)}},getTopStyle:function(){this.topstyle=this.querySelector(".top-colorpicker-button").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-colorpicker-button");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-colorpicker-button").style.cssText=this.topstyle}};Top.Widget.Colorpicker=function(){Colorpicker.prototype=Object.create(Top.Widget.prototype);Colorpicker.prototype.constructor=Colorpicker;function Colorpicker(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-colorpicker");this.template.innerHTML='<button class="top-colorpicker-button" type="button"></button><div class = "top-colorpicker-popup"><canvas class = "top-colorpicker-canvas" width = "480" height = "320"></canvas><div class = "top-colorpicker-aim"></div><div><div class = "top-colorpicker-preview"></div><span> R: </span><input type = "text" class = "top-colorpicker-r"></input><span> G: </span><input type = "text" class = "top-colorpicker-g"></input><span> B: </span><input type = "text" class = "top-colorpicker-b"></input><span> H: </span><input type = "text" class = "top-colorpicker-h"></input><span> S: </span><input type = "text" class = "top-colorpicker-s"></input><span> V: </span><input type = "text" class = "top-colorpicker-v"></input><span> #: </span><input type = "text" class = "top-colorpicker-hex"></input><button class = "top-colorpicker-ok" type = "button"> OK </button><button class = "top-colorpicker-cancel" type = "button"> Cancel </button></div></div>'}this.id=this.template.id}Colorpicker.create=function(obj){return new Colorpicker(obj)};Colorpicker.prototype.getHex=function(){return this.template.hex};Colorpicker.prototype.getRgb=function(){return this.template.rgb};Colorpicker.prototype.getHsv=function(){return this.template.hsv};Colorpicker.prototype.setHex=function(hex){this.template.hex=hex;this.template.__updateData("hex")};Colorpicker.prototype.setRgb=function(rgb){this.template.rgb=rgb;this.template.__updateData("rgb")};Colorpicker.prototype.setHsv=function(hsv){this.template.hsv=hsv;this.template.__updateData("hsv")};return Colorpicker}();TopContextmenu={is:"top-contextmenu",behaviors:[TopMenuBehavior,TopWidgetBehavior],properties:{items:String,onOpen:String,onClose:String,onItemclick:String},__ready:function(){this.initMenuItems();this.renderMenu()},appendTemplate:function(){this.innerHTML='<div class="top-contextmenu-root"> '+this.innerHTML+"</div>";this.__isTemplateAppended=true},__attached2:function(){if(this.tooltip)this.__updateTooltip()},attached:function(){this.attachEventHandler()},renderMenu:function(){this.clearMenuItems();this.menuArray=[];if(this.items){if(typeof this.items==="string"){var items=Top.Util.namespace(this.items,this);if(!Array.isArray(items))return}else{var items=this.items}}else if(this.menuItems){var items=this.makeItems(this.menuItems)}if(items===undefined)return;this.objItems=items;var str="<div class='top-contextmenu-container close'><ul class='top-contextmenu_nav'>";str+=this.makeMenu(items);str+="</ul></div>";this.childRoot.innerHTML=str;var li=this.childRoot.querySelectorAll(".top-contextmenu_nav li");for(var i=0;i<li.length;i++){if(li[i].lastChild.tagName=="UL"){li[i].classList.add("top-contextmenu_parent");li[i].classList.add("top-contextmenu_collapsed");var item=document.createElement("i");item.classList.add("top-contextmenu_arrow");item.classList.add("icon-arrow_filled_left");li[i].insertBefore(item,li[i].querySelector("ul"))}}this.childRoot.style.border=null;if(this.borderWidth){this.border=this.borderStyle?this.borderStyle+" ":"solid ";this.border+=this.borderWidth.includes("px")?this.borderWidth:this.borderWidth+"px";this.border+=this.borderColor?" "+this.borderColor:""}this.attachEventHandler()},initializeChildRoot:function(){return this.querySelector(".top-contextmenu-root")},makeItems:function(parent){var len=parent.length;var item=[];for(var i=0;i<len;i++){var obj={};obj["text"]=parent[i].getAttribute("text");obj["selected"]=parent[i].getAttribute("selected");obj["divider"]=parent[i].getAttribute("divider");obj["id"]=parent[i].getAttribute("id");obj["icon"]=parent[i].getAttribute("icon");obj["image"]=parent[i].getAttribute("image");obj["onClick"]=parent[i].getAttribute("onClick");if(parent[i].children.length>0){obj["children"]=this.makeItems(parent[i].children)}item[i]=obj}return item},makeMenu:function(item){var str="",id="";var len=item.length;for(var i=0;i<len;i++){if(item[i].children){str+="<li class='top-contextmenu_item"+(item[i].divider===true||item[i].divider==="true"?" divider":"")+"'>"+this.getAnchor(item[i])+"<ul>";str+=this.makeMenu(item[i].children);str+="</ul></li>"}else{str+="<li class='top-contextmenu_item"+(item[i].divider===true||item[i].divider==="true"?" divider":"")+"'>"+this.getAnchor(item[i])+"</li>"}if(item[i].onClick){if(typeof item[i].onClick==="function")var fnOnClick=item[i].onClick;else if(typeof item[i].onClick==="string")var fnOnClick=Top.Util.namespace(item[i].onClick,this);if(typeof fnOnClick==="function"){if(this.itemOnClick===undefined)this.itemOnClick={};this.itemOnClick[item[i].id]=fnOnClick}}}return str},getAnchor:function(item){var a="<a class='top-contextmenu_item_inner";var id="";var selected="";var icon="";var text="";var img="";if(item.id)id=item.selected?" top-contextmenu_"+this.id+"_"+item.id:" top-contextmenu_"+this.id+"_"+item.id+"'>";if(item.selected)selected=item.selected.startsWith("/")?selected="' href = 'javascript:Top.App.routeTo(\""+item.selected+"\")'>":"' href='"+item.selected+"'>";if(!item.id&&!item.selected)a+="'>";if(item.icon)icon="<i class='top-contextmenu_icon "+item.icon+"'></i>";else if(item.image)img="<img class='top-contextmenu_image' src='"+item.image+"'/>";else icon="<i class='top-contextmenu_icon'></i>";if(item.text)text="<span class='top-contextmenu_text'>"+this.__valueToText(item.text)+"</span>";a=a+id+selected+icon+img+text+"</a>";return a},__valueToText:function(value){var pattern=/^@(string)\/([a-zA-Z0-9]+)\/([a-zA-Z0-9]+)$/;if(pattern.test(value)){var result=pattern.exec(value);return Top.ValuesManager.get("strings",result[2])[result[3]]}return value},attachEventHandler:function(){var _this=this;var shadowRoot=this.childRoot;var timer;var checkReg=new RegExp("^top-contextmenu_"+this.id+"_");if(this.onItemclick&&typeof this.onItemclick==="string"){var fnSelect=Top.Util.namespace(this.onItemclick,this)}else if(typeof this.onItemclick==="function"){var fnSelect=this.onItemclick}function closeMenuItem(menuElem){if(!menuElem)return;var childMenu_ul=menuElem.querySelector("ul");var arrowElem=menuElem.querySelector(".top-contextmenu_arrow");menuElem.classList.remove("selected");menuElem.classList.remove("top-contextmenu_open");menuElem.classList.add("top-contextmenu_collapsed");childMenu_ul.style.display="none";var childMenuItem_li=$(childMenu_ul).find("> .selected");if(childMenuItem_li.length>0&&childMenuItem_li.hasClass("top-contextmenu_parent")){for(var i=0;i<childMenuItem_li.length;i++)closeMenuItem(childMenuItem_li[i])}arrowElem.classList.remove("icon-arrow_filled_right");arrowElem.classList.add("icon-arrow_filled_left")}function openMenuItem(menuElem){if(!menuElem)return;var childMenu_ul=menuElem.querySelector("ul");var arrowElem=menuElem.querySelector(".top-contextmenu_arrow");menuElem.classList.add("selected");menuElem.classList.add("top-contextmenu_open");menuElem.classList.remove("top-contextmenu_collapsed");childMenu_ul.style.display="block";if(_this.border)childMenu_ul.style.border=_this.border;childMenu_ul.style.top=(shadowRoot.clientHeight-shadowRoot.offsetHeight)/2-childMenu_ul.clientTop+"px";childMenu_ul.style.left=menuElem.offsetLeft+menuElem.offsetWidth+childMenu_ul.clientLeft+"px";arrowElem.classList.remove("icon-arrow_filled_left");arrowElem.classList.add("icon-arrow_filled_right")}var root=this.childRoot;$(root).find(" .top-contextmenu_item.top-contextmenu_collapsed").off("click").on("click",function(e){var parent_ul=this.parentNode;var prevSelectedItem=$(parent_ul).find("> .selected");if(prevSelectedItem){if(prevSelectedItem.hasClass("top-contextmenu_parent"))closeMenuItem(prevSelectedItem[0]);else prevSelectedItem.removeClass("selected")}openMenuItem(this);e.stopPropagation()}).on("mousedown",function(e){e.stopPropagation()});$(root).find(" .top-contextmenu_item.top-contextmenu_collapsed").off("mouseenter").on("mouseenter",function(e){var thisItem=this;var parent_ul=this.parentNode;timer=setTimeout(function(){var prevSelectedItem=$(parent_ul).find("> .selected");if(prevSelectedItem){if(prevSelectedItem.hasClass("top-contextmenu_parent"))closeMenuItem(prevSelectedItem[0]);else prevSelectedItem.removeClass("selected")}openMenuItem(thisItem)},200);e.stopPropagation()});$(root).find(" .top-contextmenu_item:not(.top-contextmenu_parent)").off("click").on("click",function(e){var innerItem=this.querySelector(".top-contextmenu_item_inner");for(var i=0;i<innerItem.classList.length;i++){if(checkReg.test(innerItem.classList[i])){_this.selectedMenuId=innerItem.classList[i].replace("top-contextmenu_"+_this.id+"_","");break}}if(fnSelect){var selectedItem=_this.__findItemById(_this.objItems,_this.selectedMenuId);fnSelect(e.originalEvent,Top.Dom.selectById(_this.id),{selectedItem:selectedItem})}if(_this.selectedMenuId in _this.itemOnClick){var selectedItem=_this.__findItemById(_this.objItems,_this.selectedMenuId);_this.itemOnClick[_this.selectedMenuId](e.originalEvent,Top.Dom.selectById(_this.id),{selectedItem:selectedItem})}var parent_ul=this.parentNode;var prevSelectedItem=$(parent_ul).find("> .selected");if(prevSelectedItem){if(prevSelectedItem.hasClass("top-contextmenu_parent"))closeMenuItem(prevSelectedItem[0]);else prevSelectedItem.removeClass("selected")}this.classList.add("selected");_this.close();e.stopPropagation()}).on("mousedown",function(e){e.stopPropagation()});$(root).find(" .top-contextmenu_item:not(.top-contextmenu_parent)").off("mouseenter").on("mouseenter",function(e){var thisItem=this;var parent_ul=this.parentNode;timer=setTimeout(function(){var prevSelectedItem=$(parent_ul).find("> .selected");if(prevSelectedItem){if(prevSelectedItem.hasClass("top-contextmenu_parent"))closeMenuItem(prevSelectedItem[0])}},200);e.stopPropagation()})},open:function(e){if(this.disabled===true||this.disabled==="true")return;if(this.display==="none"||this.display==="hidden")return;var shadowRoot=this.childRoot;var contextContainer=this.childRoot.querySelector(".top-contextmenu-container");if(this.onOpen&&typeof this.onOpen==="string"){var fnOpen=Top.Util.namespace(this.onOpen,this)}if(e){shadowRoot.style.top=e.clientY+"px";shadowRoot.style.left=e.clientX+"px"}contextContainer.style.display="inline-block";if(this.border)this.childRoot.querySelector("ul").style.border=this.border;contextContainer.querySelector(".top-contextmenu_nav").style.display="block";contextContainer.classList.add("open");contextContainer.classList.remove("close");if(fnOpen)fnOpen(event,Top.Dom.selectById(this.id))},close:function(){var contextContainer=this.childRoot.querySelector(".top-contextmenu-container");if(this.onClose&&typeof this.onClose==="string"){var fnClose=Top.Util.namespace(this.onClose,this)}if(contextContainer===null){if(fnClose)fnClose(event,Top.Dom.selectById(this.id));return}contextContainer.style.display="none";contextContainer.classList.add("close");contextContainer.classList.remove("open");var ul=contextContainer.querySelectorAll("ul");for(var i=0;i<ul.length;i++){ul[i].style.display="none"}var cp=contextContainer.querySelectorAll(".top-contextmenu_parent");for(var i=0;i<cp.length;i++){cp[i].classList.remove("top-contextmenu_open");cp[i].classList.add("top-contextmenu_collapsed")}var sel=contextContainer.querySelectorAll(".selected");for(var i=0;i<sel.length;i++){sel[i].classList.remove("selected")}var arrow=contextContainer.querySelectorAll(".top-contextmenu_arrow.icon-arrow_filled_right");for(var i=0;i<arrow.length;i++){arrow[i].classList.remove("icon-arrow_filled_right");arrow[i].classList.add("icon-arrow_filled_left")}if(fnClose)fnClose(event,Top.Dom.selectById(this.id))},__updateItems:function(){this.renderMenu()},__findItemById:function(items,id){if(!items||!id)return;var selectedItem;for(var i=0,len=items.length;i<len;i++){if(items[i].id===id){return items[i]}if(typeof items[i].children==="object"&&items[i].children.length>0){selectedItem=this.__findItemById(items[i].children,id);if(selectedItem){return selectedItem}}}return selectedItem},__updateTooltip:function(){var root=this.childRoot;if(!root.querySelector("ul"))return;var thisPageId=Top.App.getCurrentPage()?Top.App.getCurrentPage().id:undefined;var _this=this;function setTooltipPosition(e){var x=e.clientX,y=e.clientY;var tooltipText=document.querySelector("#"+thisPageId+" .top-tooltip-text");tooltipText.style.top=y+20+"px";tooltipText.style.left=x+20+"px";e.preventDefault()}root.querySelector("ul").addEventListener("mouseover",function(e){window.addEventListener("mousemove",setTooltipPosition);if(!thisPageId)thisPageId=Top.App.getCurrentPage().id;var tooltipText=document.querySelector("#"+thisPageId+" .top-tooltip-text");tooltipText.textContent=_this.__i18n(_this.tooltip);tooltipText.style.display="inline-block"});root.querySelector("ul").addEventListener("mouseout",function(e){var tooltipText=document.querySelector("#"+thisPageId+" .top-tooltip-text");tooltipText.style.display="none";window.removeEventListener("mousemove",setTooltipPosition)})},__updateBorderWidth:function(){this.border="solid ";this.border+=this.borderWidth.includes("px")?this.borderWidth:this.borderWidth+"px";this.border+=this.borderColor?" "+this.borderColor:""},__updateBorderColor:function(){this.border="solid ";this.border+=this.borderWidth.includes("px")?this.borderWidth:this.borderWidth+"px";this.border+=this.borderColor?" "+this.borderColor:""},getTopStyle:function(){this.topstyle=this.querySelector(".top-contextmenu-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-contextmenu-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-contextmenu-root").style.cssText=this.topstyle}};Top.Widget.Menu.Contextmenu=function(){Contextmenu.prototype=Object.create(Top.Widget.Menu.prototype);Contextmenu.prototype.constructor=Contextmenu;function Contextmenu(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-contextmenu");this.template.innerHTML='<div class="top-contextmenu-root"></div>'}this.id=this.template.id}Contextmenu.create=function(element){return new Contextmenu(element)};Contextmenu.prototype.open=function(e){this.template.open(e)};Contextmenu.prototype.close=function(){this.template.close()};return Contextmenu}();TopDashboard={is:"top-dashboard",behaviors:[TopWidgetBehavior],properties:{headerTitle:{type:String},gridSize:{type:Number,value:12},gridColor:{type:Object,value:{verticalGrid:"#e1e1e1",verticalPointGrid:"#6ec8ed",horizontalGrid:"#e1e1e1",horizontalPointGrid:"#6ec8ed"}},cardList:{type:Object},showList:{type:Object},customizeEditmode:{type:Boolean,value:false},customizeOption:{type:Object},editType:{type:String,reflectToAttribute:true,value:"brick"},defaultCardSize:{type:Object,value:{width:4,height:4}},dupcardAllowed:{type:Boolean,value:false},editButtonText:{type:String,value:"edit Dashboard"},addButtonText:{type:String,value:"Add Card"},dashboardSaveButtonText:{type:String,value:"Save"},dashboardCancelButtonText:{type:String,value:"Cancel"},dialogSaveButtonText:{type:String,value:"Add"},dialogCancelButtonText:{type:String,value:"Cancel"},deletePopupOkButtonText:{type:String,value:"OK"},deletePopupCancelButtonText:{type:String,value:"Cancel"},deletePopupContentText:{type:String,value:"Are you sure you want to delete?"},deletePopupContentHtml:String,customEmptyLayout:String,customCardListDialog:{type:Boolean,value:false},onAddbuttonclick:String,onSavebuttonclick:String,onCancelbuttonclick:String,customCardContextMenu:Object},appendTemplate:function(){this.innerHTML='<div class="top-dashboard-root">'+this.innerHTML+'<div class="top-dashboard-content-layout"><div class="top-dashboard-content"></div><div class="top-dashboard-content-layout-custom"></div></div></div>';this.__isTemplateAppended=true},__ready:function(){this.__updateId();if(typeof this.gridColor==="string"){this.gridColor=Top.Util.namespace(this.gridColor,this)}if(typeof this.defaultCardSize==="string"){this.defaultCardSize=Top.Util.namespace(this.defaultCardSize,this)}if(typeof this.cardList==="string"){this.cardList=Top.Util.namespace(this.cardList,this)}if(this.cardList===undefined)this.cardList=[];this.cardMap=new Map;for(var i=0;i<this.cardList.length;i++){this.cardMap.set(this.cardList[i].id,this.cardList[i])}if(typeof this.showList==="string"){this.showList=Top.Util.namespace(this.showList,this)}if(this.showList===undefined)this.showList=[];this.showMap=new Map;for(var i=0;i<this.showList.length;i++){this.showMap.set(this.showList[i].id,this.showList[i])}if(typeof this.customizeOption==="string"){this.customizeOption=Top.Util.namespace(this.customizeOption,this)}if(typeof this.customCardContextMenu==="string"){this.customCardContextMenu=Top.Util.namespace(this.customCardContextMenu,this)}this.renderLayout()},__attached2:function(){},__updateId:function(){if(this.id){var shadowRoot=this.querySelector(".top-dashboard-root");shadowRoot.id=this.id}},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-dashboard-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__initEventInternal:function(){this.__addEventByAttr("addbuttonclick");this.__addEventByAttr("savebuttonclick");this.__addEventByAttr("cancelbuttonclick")},renderLayout:function(){var _this=this;this.__createEditMode();this.querySelector("div.top-dashboard-content-layout").style.width="100%";if(Top.Util.__isBooleanTrue(this.customizeEditmode)===false){var titleAreaHeight=this.querySelector("div.top-dashboard-edit-mode-header").offsetHeight;if(titleAreaHeight===0)titleAreaHeight=40;this.querySelector("div.top-dashboard-content-layout").style.height="calc(100% - "+titleAreaHeight+"px)"}else{this.querySelector("div.top-dashboard-content-layout").style.height="100%"}this.querySelector("div.top-dashboard-content").style.width="100%";this.querySelector("div.top-dashboard-content").style.height="100%";this.__updateCustomEmptyLayout();this.__renderCards(false)},__createEditMode:function(){var _this=this;if(Top.Util.__isBooleanTrue(this.customizeEditmode)===false){var root=this.querySelector(".top-dashboard-root");var content=root.querySelector(".top-dashboard-content-layout");var header=document.createElement("div");header.className="top-dashboard-edit-mode-header";header.innerHTML='<input type="text" read-only="true" class="top-dashboard-title"></input><button class="top-dashboard-edit-mode-button edit-button" type="button">'+this.editButtonText+'</button><button class="top-dashboard-edit-mode-button add-button" type="button">'+this.addButtonText+"</button>";root.insertBefore(header,content);this.titleTag=this.querySelector("input.top-dashboard-title");this.titleTag.addEventListener("change",function(){if(_this.titleTag.value.length>20){_this.titleTag.size=_this.titleTag.value.length}else{_this.titleTag.size=20}});this.__updateTitle();this.querySelector("button.top-dashboard-edit-mode-button.edit-button").addEventListener("click",function(){_this.__setEditModeOn()});this.querySelector("button.top-dashboard-edit-mode-button.add-button").addEventListener("click",function(){_this.__openCardListDialog()});var footer=document.createElement("div");footer.className="top-dashboard-edit-mode-footer";footer.innerHTML='<button class="top-dashboard-edit-mode-footer-button cancel-button" type="button">'+this.dashboardCancelButtonText+'</button><button class="top-dashboard-edit-mode-footer-button save-button" type="button">'+this.dashboardSaveButtonText+"</button>";root.appendChild(footer);this.querySelector("button.top-dashboard-edit-mode-footer-button.save-button").addEventListener("click",function(){_this.unSelectAllCards();_this.__editModeOn(false);_this.currentShowList=$.extend(true,[],_this.showList);_this.currentShowMap=new Map(_this.showMap);_this.headerTitle=_this.titleTag.value;if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("savebuttonclick"))}else{_this.__dispatchEvent(new Event("savebuttonclick"))}});this.querySelector("button.top-dashboard-edit-mode-footer-button.cancel-button").addEventListener("click",function(){_this.unSelectAllCards();_this.__editCancel();if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("cancelbuttonclick"))}else{_this.__dispatchEvent(new Event("cancelbuttonclick"))}})}window.addEventListener("resize",this.__drawGrid);this.__editModeOn(false)},__editCancel:function(){this.showList=$.extend(true,[],this.currentShowList);this.showMap=new Map(this.currentShowMap);this.__updateTitle();if(this.editModeIsOn)this.__editModeOn(false);this.__renderCards(true)},__setEditModeOn:function(){this.currentShowList=$.extend(true,[],this.showList);this.currentShowMap=new Map(this.showMap);this.__editModeOn(true)},__editModeOn:function(isOn){var _this=this;this.editModeIsOn=isOn;document.removeEventListener("mouseup",this.removeCardsEvent);document.removeEventListener("click",this.unSelectAllCards);if(isOn){document.addEventListener("mouseup",this.removeCardsEvent);document.addEventListener("click",this.unSelectAllCards)}if(isOn){if(Top.Util.__isBooleanTrue(this.customizeEditmode)===false){this.titleTag.readOnly=false;this.titleTag.classList.add("edit");this.querySelector("button.top-dashboard-edit-mode-button.edit-button").style.display="none";this.querySelector("button.top-dashboard-edit-mode-button.add-button").style.display="inline-block";this.querySelector("div.top-dashboard-edit-mode-footer").style.display="block"}this.querySelector("div.top-dashboard-content").classList.add("edit-mode-on");this.__drawGrid()}else{if(Top.Util.__isBooleanTrue(this.customizeEditmode)===false){this.titleTag.readOnly=true;this.titleTag.classList.remove("edit");this.querySelector("button.top-dashboard-edit-mode-button.edit-button").style.display="inline-block";this.querySelector("button.top-dashboard-edit-mode-button.add-button").style.display="none";this.querySelector("div.top-dashboard-edit-mode-footer").style.display="none"}this.querySelector("div.top-dashboard-content").classList.remove("edit-mode-on");$(this.querySelector(".top-dashboard-content-grid")).remove()}this.__showCustomEmptyLayout()},__drawGrid:function(){if(!this.editModeIsOn)return;if(this.editType==="top-align"){var table=this.querySelector("table.top-dashboard-content-grid");if(table){var trs=this.querySelectorAll("table.top-dashboard-content-grid tr");if(trs.length>this.renderTable.length){for(var i=this.renderTable.length;i<trs.length;i++){table.removeChild(trs[i])}}else if(trs.length<this.renderTable.length){for(var i=trs.length;i<this.renderTable.length;i++){var tr=document.createElement("tr");tr.className="top-dashboard-content-grid-row row_"+i;for(var j=0;j<this.gridSize;j++){var td=document.createElement("td");td.className="top-dashboard-content-grid-cell cell_"+j;td.innerHTML='<div class="top-dashboard-content-grid-tile"></div>';tr.appendChild(td)}table.appendChild(tr)}}}else{table=document.createElement("table");table.className="top-dashboard-content-grid";for(var i=0;i<this.renderTable.length;i++){var tr=document.createElement("tr");tr.className="top-dashboard-content-grid-row row_"+i;for(var j=0;j<this.gridSize;j++){var td=document.createElement("td");td.className="top-dashboard-content-grid-cell cell_"+j;td.innerHTML='<div class="top-dashboard-content-grid-tile"></div>';tr.appendChild(td)}table.appendChild(tr)}this.querySelector("div.top-dashboard-content").appendChild(table)}table.style.width="100%";table.style.height=this.renderTable.length/this.gridSize*100+"%"}else{if(this.querySelector("canvas.top-dashboard-content-grid")){var canvas=this.querySelector("canvas.top-dashboard-content-grid")}else{var canvas=document.createElement("canvas");canvas.className="top-dashboard-content-grid";this.querySelector("div.top-dashboard-content").appendChild(canvas)}canvas.style.width="100%";canvas.style.height=this.renderTable.length/this.gridSize*100+"%";canvas.width=this.querySelector("div.top-dashboard-content").offsetWidth;canvas.height=this.querySelector("div.top-dashboard-content").offsetHeight;var context=canvas.getContext("2d");var width=canvas.width;var height=canvas.height;var cellWidth=width/this.gridSize;var cellHeight=height/this.renderTable.length;context.clearRect(0,0,width,height);for(var x=1;x<this.gridSize;x++){if(x%(this.gridSize/3)!==0){context.stroke();context.beginPath();context.moveTo(x*cellWidth,0);context.lineTo(x*cellWidth,height);context.strokeStyle=this.gridColor.verticalGrid}else{context.stroke();context.beginPath();context.moveTo(x*cellWidth,0);context.lineTo(x*cellWidth,height);context.strokeStyle=this.gridColor.verticalPointGrid}}for(var x=1;x<this.renderTable.length;x++){if(x%(this.gridSize/3)!==0){context.stroke();context.beginPath();context.moveTo(0,x*cellHeight);context.lineTo(width,x*cellHeight);context.strokeStyle=this.gridColor.horizontalGrid}else{context.stroke();context.beginPath();context.moveTo(0,x*cellHeight);context.lineTo(width,x*cellHeight);context.strokeStyle=this.gridColor.horizontalPointGrid}}context.stroke()}},__openCardListDialog:function(){var _this=this;var curruntShowList=$.extend(true,[],this.showList);var currentShowMap=new Map(this.showMap);if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("addbuttonclick"))}else{this.__dispatchEvent(new Event("addbuttonclick"))}if(Top.Util.__isBooleanTrue(this.customCardListDialog)===true)return;var pageId=Top.App.getCurrentPage().id;var dialogOverlay=document.createElement("div");dialogOverlay.id="top-dialog-overlay_"+this.id;dialogOverlay.className="top-dialog-overlay";document.querySelector("#"+pageId).appendChild(dialogOverlay);var dialogRoot=document.createElement("div");dialogRoot.id="top-dashboard-dialog_"+this.id;dialogRoot.className="top-dashboard-dialog card-list-dialog";var dialogTitleLayout=document.createElement("div");dialogTitleLayout.className="top-dashboard-dialog-title-layout";var dialogTitle=document.createElement("span");dialogTitle.className="top-dashboard-dialog-title";dialogTitle.textContent="Card List";dialogTitleLayout.appendChild(dialogTitle);var dialogClose=document.createElement("button");dialogClose.className="top-dashboard-dialog-close";dialogClose.addEventListener("click",function(){Top.App.closeAutoCompleteContainers();_this.__closeCardListDialog()});dialogTitleLayout.appendChild(dialogClose);dialogRoot.appendChild(dialogTitleLayout);var dialogTab=document.createElement("table");dialogTab.className="top-dashboard-dialog-tab-layout";dialogTab.innerHTML="<tbody><tr><td class='top-dashboard-dialog-tab general-tab active'><div class='top-dashboard-dialog-tab general-tab active'><span>General</span></div></td><td class='top-dashboard-dialog-tab customize-tab'><div class='top-dashboard-dialog-tab customize-tab'><span>Customize</span></div></td><td style='width:100%'><div class='top-dashboard-dialog-tab last-tab'></div></td></tr></tbody>";dialogRoot.appendChild(dialogTab);if(this.customizeOption){dialogTab.rows[0].cells[0].firstElementChild.addEventListener("click",function(){this.parentNode.parentNode.cells[1].classList.remove("active");this.parentNode.parentNode.cells[1].firstElementChild.classList.remove("active");this.parentNode.classList.add("active");this.classList.add("active");dialogContent.removeChild(dialogContent.firstElementChild);setGeneralTabContents()});dialogTab.rows[0].cells[1].firstElementChild.addEventListener("click",function(){this.parentNode.parentNode.cells[0].classList.remove("active");this.parentNode.parentNode.cells[0].firstElementChild.classList.remove("active");this.parentNode.classList.add("active");this.classList.add("active");dialogContent.removeChild(dialogContent.firstElementChild);if(Top.Util.getFileExtension(_this.customizeOption.html)==="html"){Top.Ajax.execute(_this.customizeOption.html,{success:function(data){dialogContent.innerHTML=data}})}else if(_this.customizeOption.html!==undefined){dialogContent.innerHTML=_this.customizeOption.html}});if(typeof this.customizeOption.onTabChange==="string")this.customizeOption.onTabChange=Top.Util.namespace(this.customizeOption.onTabChange,this);if(typeof this.customizeOption.onTabChange==="function"){dialogTab.rows[0].cells[0].firstElementChild.addEventListener("click",this.customizeOption.onTabChange);dialogTab.rows[0].cells[1].firstElementChild.addEventListener("click",this.customizeOption.onTabChange)}}var dialogContent=document.createElement("div");dialogContent.className="top-dashboard-dialog-content";
setGeneralTabContents();function setGeneralTabContents(){var dialogContentTable=document.createElement("table");dialogContentTable.className="top-dashboard-dialog-content-table";var dialogContentTableBody=document.createElement("tbody");var length=_this.cardList.length;var row=Math.ceil(length/6);var lastRow=length%6;for(var i=0;i<row;i++){var dialogContentTableTr=document.createElement("tr");for(var j=0;j<6;j++){var index=6*i+j;var dialogContentTableTd=document.createElement("td");dialogContentTableTr.appendChild(dialogContentTableTd);if(index<length){var card=document.createElement("div");card.className="top-dashboard-content-card";var checkbox=document.createElement("input");checkbox.type="checkbox";checkbox.className="top-dashboard-content-check";checkbox.index=index;checkbox.addEventListener("change",cardListCheckboxChange);card.appendChild(checkbox);if(_this.showMap.has(_this.cardList[index].id)){card.classList.add("select");checkbox.checked=true}else{card.classList.add("unselect");checkbox.checked=false}var nameTag=document.createElement("div");nameTag.className="top-dashboard-content-card-name";nameTag.innerHTML="<span>"+_this.cardList[index].name+"</span>";dialogContentTableTd.appendChild(card);dialogContentTableTd.appendChild(nameTag);if(j===5){card.classList.add("last-card");nameTag.classList.add("last-card")}}}dialogContentTableBody.appendChild(dialogContentTableTr)}dialogContentTable.appendChild(dialogContentTableBody);dialogContent.appendChild(dialogContentTable)}dialogRoot.appendChild(dialogContent);var dialogBottom=document.createElement("div");dialogBottom.className="top-dashboard-dialog-footer";var dialogCancelButton=document.createElement("button");dialogCancelButton.className="top-dashboard-dialog-footer-button cancel-button";dialogCancelButton.innerText=this.dialogCancelButtonText;dialogCancelButton.addEventListener("click",function(){Top.App.closeAutoCompleteContainers();_this.__closeCardListDialog();_this.showList=$.extend(true,[],curruntShowList);_this.showMap=new Map(currentShowMap)});dialogBottom.appendChild(dialogCancelButton);var dialogAddButton=document.createElement("button");dialogAddButton.className="top-dashboard-dialog-footer-button add-button";dialogAddButton.innerText=this.dialogSaveButtonText;dialogAddButton.addEventListener("click",function(event){Top.App.closeAutoCompleteContainers();_this.__closeCardListDialog();_this.__renderCards(true)});dialogBottom.appendChild(dialogAddButton);dialogRoot.appendChild(dialogBottom);document.querySelector("#"+pageId).appendChild(dialogRoot);this.__setDialogPosition(dialogRoot);function cardListCheckboxChange(){if(this.checked){this.parentNode.classList.remove("unselect");this.parentNode.classList.add("select");var item={id:_this.cardList[this.index].id};_this.showList.push(item);_this.showMap.set(_this.cardList[this.index].id,item)}else{this.parentNode.classList.remove("select");this.parentNode.classList.add("unselect");var id=_this.cardList[this.index].id;_this.showList=_this.showList.filter(function(v){if(v.id===id)return false;return true});_this.showMap.delete(_this.cardList[this.index].id)}}},__closeCardListDialog:function(){$(document.querySelector("#top-dialog-overlay_"+this.id)).remove();$(document.querySelector("#top-dashboard-dialog_"+this.id)).remove()},__setDialogPosition:function(dialogRoot){var top=window.pageYOffset+window.innerHeight/2-dialogRoot.offsetHeight/2;var left=(window.innerWidth-dialogRoot.offsetWidth)/2;dialogRoot.style.left=left+"px";dialogRoot.style.top=top+"px"},__initRenderTable:function(){if(this.editType==="brick"){this.nextCell={x:0,y:0}}else if(this.editType==="top-align"){this.nextCell=[];for(var x=0;x<this.gridSize;x++){this.nextCell.push(0)}}this.renderTable=[];for(var i=0;i<this.gridSize;i++){this.renderTable.push([]);for(var j=0;j<this.gridSize;j++){this.renderTable[i].push([true,undefined])}}},__renderCards:function(reRender){var _this=this;var ajaxMap=[];var noPosition=[];this.isResize=false;this.__initRenderTable();if(reRender){var appendedCards=this.querySelectorAll(".top-dashboard-card-bound");for(var i=0;i<appendedCards.length;i++){if(!this.showMap.has(appendedCards[i].id)){if(this.editType==="grid")_emptyRenderTable(_getXCellPosition(appendedCards[i].offsetLeft),_getYCellPosition(appendedCards[i].offsetTop),_adjustWidth(appendedCards[i].offsetWidth),_adjustHeight(appendedCards[i].offsetHeight));appendedCards[i].parentNode.removeChild(appendedCards[i])}else if(Top.Util.__isBooleanTrue(this.dupcardAllowed)){if(appendedCards[i].index>=this.showList.length){appendedCards[i].parentNode.removeChild(appendedCards[i])}else{if(this.showList[appendedCards[i].index].id!==appendedCards[i].id){appendedCards[i].parentNode.removeChild(appendedCards[i])}}}}}for(var i=0;i<this.showList.length;i++){var id=this.showList[i].id;var cardInfo=this.cardMap.get(id);var cardBound;if(reRender){if(Top.Util.__isBooleanTrue(this.dupcardAllowed)){cardBound=this.querySelector("#"+id+".top-dashboard-card-bound.card_"+i)}else{cardBound=this.querySelector("#"+id+".top-dashboard-card-bound")}if(cardBound){cardBound.className="top-dashboard-card-bound card_"+i;if(this.selected===cardBound)cardBound.classList.add("select");cardBound.index=i;if(cardBound.titleText!==cardInfo.title)this.__setCardTitle(cardBound,cardInfo.title);if(cardBound.html!==cardInfo.html){if(cardInfo.html!==undefined){if(Top.Util.getFileExtension(cardInfo.html)==="html"){ajaxMap.push({url:cardInfo.html,node:cardBound});$.ajax(cardInfo.html,{success:function(data){var i=0;var url=this.url;ajaxMap.forEach(function(e){if(e.url===url){appendCardContents(data,e.node);ajaxMap.splice(i,1);return}i++})}})}else{appendCardContents(cardInfo.html,cardBound)}}}_setCardSize(cardBound,i,id)}else{cardBound=createCard(i);if(cardInfo.html!==undefined){if(Top.Util.getFileExtension(cardInfo.html)==="html"){ajaxMap.push({url:cardInfo.html,node:cardBound});$.ajax(cardInfo.html,{success:function(data){var i=0;var url=this.url;ajaxMap.forEach(function(e){if(e.url===url){appendCardContents(data,e.node);ajaxMap.splice(i,1);return}i++})}})}else{appendCardContents(cardInfo.html,cardBound)}}}}else{cardBound=createCard(i);if(cardInfo.html!==undefined){if(Top.Util.getFileExtension(cardInfo.html)==="html"){ajaxMap.push({url:cardInfo.html,node:cardBound});$.ajax(cardInfo.html,{success:function(data){var i=0;var url=this.url;ajaxMap.forEach(function(e){if(e.url===url){appendCardContents(data,e.node);ajaxMap.splice(i,1);return}i++})}})}else{appendCardContents(cardInfo.html,cardBound)}}}_setCardPosition(cardBound,i)}this.__showCustomEmptyLayout();if(this.editType==="grid"){noPosition.forEach(function(node){_setEmptyPosition(node)})}if(this.editType==="top-align"){_adjustIndex()}if(reRender){document.removeEventListener("mouseup",this.removeCardsEvent);document.removeEventListener("click",this.unSelectAllCards)}if(this.editModeIsOn){document.addEventListener("mouseup",this.removeCardsEvent);document.addEventListener("click",this.unSelectAllCards)}if(this.removeCardsEvent===undefined){this.removeCardsEvent=function(e){_this._resizeEnd();_this.removeEventListener("mousemove",_this._resizeMove);_this.removeEventListener("mouseup",_this._resizeEnd);_this._moveEnd();_this.removeEventListener("mousemove",_this._cardMove);_this.removeEventListener("mouseup",_this._moveEnd);_this._addedEnd();_this.removeEventListener("mousemove",_this._cardMove);_this.removeEventListener("mouseup",_this._addedEnd);e.preventDefault()}}if(this.unSelectAllCards===undefined){this.unSelectAllCards=function(){_this.selected=undefined;document.querySelectorAll("top-dashboard .top-dashboard-card-bound.select").forEach(function(card){card.classList.remove("select");card.querySelectorAll(".top-dashboard-card-resize").forEach(function(node){node.parentNode.removeChild(node)});$(card.querySelector(".top-dashboard-card-option")).remove();$(card.querySelector(".top-dashboard-card-option-contextMenu")).remove();card.removeEventListener("mousedown",_moveStart)})}}function createCard(index){var id=_this.showList[index].id;var cardInfo=_this.cardMap.get(id);var cardBound=document.createElement("div");cardBound.className="top-dashboard-card-bound card_"+index;cardBound.index=index;cardBound.id=id;cardBound.name=cardInfo.name;if(typeof cardInfo.title==="string")cardBound.titleText=cardInfo.title;cardBound.html=cardInfo.html;cardBound.cardArea=document.createElement("div");cardBound.cardArea.className="top-dashboard-card";cardBound.appendChild(cardBound.cardArea);if(_this.editType==="brick"){var cardPositionGuide_bef=document.createElement("div");cardPositionGuide_bef.className="top-dashboard-card-position-guide before";var cardPositionGuide_aft=document.createElement("div");cardPositionGuide_aft.className="top-dashboard-card-position-guide after";cardBound.appendChild(cardPositionGuide_bef);cardBound.appendChild(cardPositionGuide_aft)}else if(_this.editType==="grid"){var cardPositionGuide_top=document.createElement("div");cardPositionGuide_top.className="top-dashboard-card-position-guide top";var cardPositionGuide_left=document.createElement("div");cardPositionGuide_left.className="top-dashboard-card-position-guide left";var cardPositionGuide_right=document.createElement("div");cardPositionGuide_right.className="top-dashboard-card-position-guide right";var cardPositionGuide_bottom=document.createElement("div");cardPositionGuide_bottom.className="top-dashboard-card-position-guide bottom";cardBound.appendChild(cardPositionGuide_top);cardBound.appendChild(cardPositionGuide_left);cardBound.appendChild(cardPositionGuide_right);cardBound.appendChild(cardPositionGuide_bottom)}if(cardInfo.title){cardBound.titleArea=document.createElement("div");cardBound.titleArea.className="top-dashboard-card-title";cardBound.titleArea.innerHTML="<span>"+cardInfo.title+"</span>";cardBound.cardArea.appendChild(cardBound.titleArea)}cardBound.contentArea=document.createElement("div");cardBound.contentArea.className="top-dashboard-card-content";cardBound.cardArea.appendChild(cardBound.contentArea);_this.querySelector(".top-dashboard-content").appendChild(cardBound);_setCardSize(cardBound,index,id);cardBound.addEventListener("click",function(event){if(_this.editModeIsOn){document.querySelectorAll("top-dashboard .top-dashboard-card-option-contextMenu").forEach(function(menu){$(menu).remove()});if(_this.selected!==undefined&&_this.selected!==this){document.querySelectorAll("top-dashboard .top-dashboard-card-bound.select").forEach(function(card){cardBound.cardArea.classList.remove("select");cardBound.cardArea.querySelectorAll(".top-dashboard-card-resize").forEach(function(node){node.parentNode.removeChild(node)});$(cardBound.cardArea.querySelector(".top-dashboard-card-option")).remove();$(cardBound.cardArea.querySelector(".top-dashboard-card-option-contextMenu")).remove();cardBound.cardArea.removeEventListener("mousedown",_moveStart)})}if(_this.selected!==this){_this.selected=this;this.classList.add("select");var resize_right=document.createElement("div");resize_right.className="top-dashboard-card-resize resize-right";var resize_bottom=document.createElement("div");resize_bottom.className="top-dashboard-card-resize resize-bottom";var resize_right_bottom=document.createElement("div");resize_right_bottom.className="top-dashboard-card-resize resize-right-bottom";resize_right_bottom.innerHTML='<i class="top-dashboard-card-resize-icon"><img class="dashboard-svg resize-icon" src="'+Top.libsPath+'css/images/size-que.svg"><img/></i>';this.appendChild(resize_right);this.appendChild(resize_bottom);this.appendChild(resize_right_bottom);resize_right.addEventListener("mousedown",_resizeStart);resize_bottom.addEventListener("mousedown",_resizeStart);resize_right_bottom.addEventListener("mousedown",_resizeStart);this.addEventListener("mousedown",_moveStart);var option=document.createElement("button");option.className="top-dashboard-card-option";option.innerHTML='<i class="top-dashboard-card-option-icon"><img class="dashboard-svg option-icon" src="'+Top.libsPath+'css/images/option.svg"><img/></i>';this.appendChild(option);$(this).find("img.dashboard-svg").each(function(){var $img=jQuery(this);var imgID=$img.attr("id");var imgClass=$img.attr("class");var imgURL=$img.attr("src");jQuery.get(imgURL,function(data){var $svg=jQuery(data).find("svg");if(typeof imgID!=="undefined"){$svg=$svg.attr("id",imgID)}if(typeof imgClass!=="undefined"){$svg=$svg.attr("class",imgClass+" replaced-svg")}$svg=$svg.removeAttr("xmlns:a");$img.replaceWith($svg)},"xml")});option.addEventListener("click",function(e){if(cardBound.querySelector("div.top-dashboard-card-option-contextMenu")===null){var contextMenu=document.createElement("div");contextMenu.className="top-dashboard-card-option-contextMenu";var contextMenu_ul=document.createElement("ul");contextMenu_ul.className="top-dashboard-contextMenu-container";if(_this.customCardContextMenu){if(typeof _this.customCardContextMenu==="function"){var customCardContextMenuList=_this.customCardContextMenu(_this.showList[_this.selected.index])}else if(typeof _this.customCardContextMenu==="object"){var customCardContextMenuList=_this.customCardContextMenu}else{return}for(var i=0;i<customCardContextMenuList.length;i++){if(customCardContextMenuList[i].type==="delete"){var title="Delete from Dashboard";if(customCardContextMenuList[i].title)title=customCardContextMenuList[i].title;_createDeleteCardContextMenu(contextMenu_ul,title)}else if(customCardContextMenuList[i].type==="size"){if(customCardContextMenuList[i].title){_createChangeSizeContextMenu(customCardContextMenuList[i].width,customCardContextMenuList[i].height,contextMenu_ul,customCardContextMenu[i].title)}else{_createChangeSizeContextMenu(customCardContextMenuList[i].width,customCardContextMenuList[i].height,contextMenu_ul)}}else if(customCardContextMenuList[i].type==="custom"){_createContextMenu(contextMenu_ul,customCardContextMenuList[i].title,customCardContextMenuList[i].onClick)}}}else{_createDeleteCardContextMenu(contextMenu_ul,"Delete from Dashboard");if(_this.showList[_this.selected.index].size.width!==2||_this.showList[_this.selected.index].size.height!==2){_createChangeSizeContextMenu(2,2,contextMenu_ul)}if(_this.showList[_this.selected.index].size.width!==3||_this.showList[_this.selected.index].size.height!==3){_createChangeSizeContextMenu(3,3,contextMenu_ul)}if(_this.showList[_this.selected.index].size.width!==4||_this.showList[_this.selected.index].size.height!==4){_createChangeSizeContextMenu(4,4,contextMenu_ul)}}contextMenu.appendChild(contextMenu_ul);cardBound.appendChild(contextMenu)}else{$(cardBound.querySelector(".top-dashboard-card-option-contextMenu")).remove()}e.stopPropagation()});option.addEventListener("mousedown",function(e){e.stopPropagation()});option.addEventListener("mouseup",function(e){e.stopPropagation()})}event.stopPropagation()}});return cardBound}function _createDeleteCardContextMenu(contextMenu_ul,title){_createContextMenu(contextMenu_ul,title,function(e){var card=this.parentNode.parentNode.parentNode;var i=card.index;var pageId=Top.App.getCurrentPage().id;var dialogOverlay=document.createElement("div");dialogOverlay.id="top-dialog-overlay_"+_this.id;dialogOverlay.className="top-dialog-overlay";document.querySelector("#"+pageId).appendChild(dialogOverlay);var dialogRoot=document.createElement("div");dialogRoot.id="top-dashboard-dialog_"+_this.id;dialogRoot.className="top-dashboard-dialog card-delete-dialog";var dialogTitleLayout=document.createElement("div");dialogTitleLayout.className="top-dashboard-dialog-title-layout";var dialogTitle=document.createElement("span");dialogTitle.className="top-dashboard-dialog-title";dialogTitle.textContent="Delete";dialogTitleLayout.appendChild(dialogTitle);var dialogClose=document.createElement("button");dialogClose.className="top-dashboard-dialog-close";dialogClose.addEventListener("click",function(){Top.App.closeAutoCompleteContainers();_this.__closeCardListDialog()});dialogTitleLayout.appendChild(dialogClose);dialogRoot.appendChild(dialogTitleLayout);var dialogContentLayout=document.createElement("div");dialogContentLayout.className="top-dashboard-dialog-content";if(_this.deletePopupContentHtml){dialogContentLayout.innerHTML=_this.deletePopupContentHtml}else{var dialogContent=document.createElement("span");dialogContent.textContent=_this.deletePopupContentText;dialogContentLayout.appendChild(dialogContent)}dialogRoot.appendChild(dialogContentLayout);var dialogBottom=document.createElement("div");dialogBottom.className="top-dashboard-dialog-footer";var dialogCancelButton=document.createElement("button");dialogCancelButton.className="top-dashboard-dialog-footer-button cancel-button";dialogCancelButton.innerText=_this.deletePopupCancelButtonText;dialogCancelButton.addEventListener("click",function(){Top.App.closeAutoCompleteContainers();_this.__closeCardListDialog()});dialogBottom.appendChild(dialogCancelButton);var dialogOkButton=document.createElement("button");dialogOkButton.className="top-dashboard-dialog-footer-button add-button";dialogOkButton.innerText=_this.deletePopupOkButtonText;dialogOkButton.addEventListener("click",function(event){_this.unSelectAllCards();card.parentNode.removeChild(card);_this.showList.splice(i,1);if(Top.Util.__isBooleanTrue(_this.dupcardAllowed)){if(_this.querySelector("#"+card.id+".top-dashboard-card-bound")===undefined){_this.showMap.delete(card.id)}}else{_this.showMap.delete(card.id)}for(var j=0;j<_this.showList.length;j++){var beforeIndex=j;if(i<=j)beforeIndex++;var id=_this.showList[j].id;var cardInfo=_this.cardMap.get(id);var cardBound=_this.querySelector("#"+id+".top-dashboard-card-bound.card_"+beforeIndex);cardBound.className="top-dashboard-card-bound card_"+j;cardBound.index=j}_renderWhileResize();Top.App.closeAutoCompleteContainers();_this.__closeCardListDialog();event.stopPropagation()});dialogBottom.appendChild(dialogOkButton);dialogRoot.appendChild(dialogBottom);document.querySelector("#"+pageId).appendChild(dialogRoot);_this.__setDialogPosition(dialogRoot)})}function _createChangeSizeContextMenu(width,height,contextMenu_ul,title){var titleText=width+" X "+height;if(title)titleText=title;_createContextMenu(contextMenu_ul,titleText,function(){if(_this.editType==="top-align"){if(_this.showList[_this.selected.index].position.x+width<=_this.gridSize){_this.selected.style.width=_getWidth(width,_this.selected)}else{var i=width;while(_this.showList[_this.selected.index].position.x+i>_this.gridSize&&i>1){i--}_this.selected.style.width=_getWidth(i,_this.selected)}}else{_this.selected.style.width=_getWidth(width,_this.selected)}_this.selected.style.height=_getHeight(height,_this.selected);if(!_isValidY(_this.selected)||!_isValidX(_this.selected)){_this.selected.style.height=_this.selected.bfmHeight;_this.selected.ratioHeight=_this.selected.bfmRatioH;_this.selected.style.width=_this.selected.bfmWidth;_this.selected.ratioWidth=_this.selected.bfmRatioW}var onCardSizeChange=_this.cardMap.get(_this.selected.id).onSizeChange;if(typeof onCardSizeChange==="string"){onCardSizeChange=Top.Util.namespace(onCardSizeChange,_this)}if(typeof onCardSizeChange==="function"){onCardSizeChange(_this,_this.selected)}_this.showList[_this.selected.index].size.width=_adjustWidth(_this.selected.offsetWidth);_this.showList[_this.selected.index].size.height=_adjustHeight(_this.selected.offsetHeight);_drawPostCard(false);if(_this.editType==="grid"){}else if(_this.editType==="brick"||_this.editType==="top-align"){_renderWhileResize()}})}function _createContextMenu(contextMenu_ul,titleText,clickFunc){var contextMenu_li=document.createElement("li");contextMenu_li.className="top-dashboard-contextMenu-item";contextMenu_li.innerHTML="<span class='top-dashboard-contextMenu-text'>"+titleText+"</span>";contextMenu_li.addEventListener("click",clickFunc);contextMenu_ul.appendChild(contextMenu_li)}function _setCardSize(cardBound,i,id){if(_this.showList[i].size===undefined){_this.showList[i].size={width:_this.defaultCardSize.width,height:_this.defaultCardSize.height}}cardBound.style.width=_getWidth(_this.showList[i].size.width,cardBound);cardBound.style.height=_getHeight(_this.showList[i].size.height,cardBound)}function _setCardPosition(cardBound,i){var cardWidth=_this.showList[i].size.width;var cardHeight=_this.showList[i].size.height;if(_this.editType==="grid"){if(_this.showList[i].position===undefined||_this.showList[i].position.x===undefined||_this.showList[i].position.y===undefined){noPosition.push(cardBound)}else{cardBound.style.top=_getXPosition(_this.showList[i].position.y,cardBound);cardBound.style.left=_getYPosition(_this.showList[i].position.x,cardBound);_setRenderTable(_this.showList[i].position.x,_this.showList[i].position.y,cardWidth,cardHeight,i)}}else if(_this.editType==="brick"){while(!_validCardPosition(_this.nextCell.x,_this.nextCell.y,cardWidth,cardHeight)){if(_this.nextCell.x+cardWidth>_this.gridSize){for(var x=_this.nextCell.x;x<_this.gridSize;x++){_this.renderTable[_this.nextCell.y][x]=[true,i-1]}_this.nextCell.x=0;_this.nextCell.y++}else{_this.nextCell.x++}}cardBound.style.top=_getYPosition(_this.nextCell.y,cardBound);cardBound.style.left=_getXPosition(_this.nextCell.x,cardBound);_setRenderTable(_this.nextCell.x,_this.nextCell.y,cardWidth,cardHeight,i);if(i===_this.showList.length-1&&_this.nextCell.y+cardHeight<=_this.renderTable.length){removeRow()}}else if(_this.editType==="top-align"){if(_this.showList[i].position===undefined||_this.showList[i].position.x===undefined){_this.showList[i].position={x:0}}var x=_this.showList[i].position.x;while(!_validCardPosition(x,_this.nextCell[x],cardWidth,cardHeight)){_this.nextCell[x]++}cardBound.style.top=_getYPosition(_this.nextCell[x],cardBound);cardBound.style.left=_getXPosition(x,cardBound);_setRenderTable(x,_this.nextCell[x],cardWidth,cardHeight,i);if(i===_this.showList.length-1&&_this.nextCell[x]<=_this.renderTable.length){removeRow()}}}function _setEmptyPosition(cardBound){var cardWidth=_this.showList[cardBound.index].size.width;var cardHeight=_this.showList[cardBound.index].size.height;var nextCellX=0;var nextCellY=0;while(!_validCardPosition(nextCellX,nextCellY,cardWidth,cardHeight)){if(nextCellX+cardWidth>_this.gridSize){for(var x=nextCellX;x<_this.gridSize;x++){_this.renderTable[nextCellY][x]=[true,i-1]}nextCellX=0;nextCellY++}else{nextCellX++}}cardBound.style.top=_getYPosition(nextCellY,cardBound);cardBound.style.left=_getXPosition(nextCellX,cardBound);if(_this.showList[cardBound.index].position===undefined){_this.showList[cardBound.index].position={x:0,y:0}}_this.showList[cardBound.index].position.x=nextCellX;_this.showList[cardBound.index].position.y=nextCellY;_setRenderTable(nextCellX,nextCellY,cardWidth,cardHeight,cardBound.index);if(i===_this.showList.length-1&&nextCellY+cardHeight<=_this.renderTable.length){removeRow()}}function _validCardPosition(startX,startY,width,height){for(var y=startY;y<startY+height;y++){if(_this.renderTable.length<=y)addRow();if(startX+width>_this.renderTable[y].length)return false;for(var x=startX;x<startX+width;x++){if(_this.renderTable[y][x][0]===false)return false}}return true}function addRow(){_this.renderTable.push([]);for(var j=0;j<_this.gridSize;j++){_this.renderTable[_this.renderTable.length-1].push([true,undefined])}_this.__drawGrid()}function removeRow(){for(var i=_this.renderTable.length-1;i>=_this.gridSize;i--){for(var j=0;j<_this.gridSize;j++){if(_this.renderTable[i][j][0]===false){_this.__drawGrid();return}}if(j===_this.gridSize)_this.renderTable.splice(i,1)}_this.__drawGrid()}function _setRenderTable(startX,startY,width,height,i){for(var y=startY;y<startY+height;y++){for(var x=startX;x<startX+width;x++){_this.renderTable[y][x]=[false,i]}}if(_this.editType==="brick"){_this.nextCell.x=x}else if(_this.editType==="top-align"){for(var i=startX;i<startX+width;i++){_this.nextCell[i]=startY+height}}}function _emptyRenderTable(startX,startY,width,height){for(var y=startY;y<startY+height;y++){for(var x=startX;x<startX+width;x++){_this.renderTable[y][x]=[true,undefined]}}}function appendCardContents(data,cardBound){var cardContent=cardBound.querySelector(".top-dashboard-card-content");_this.clearChilds(cardContent,true);_this.appendHtmlString(cardContent,data);_this.initialChilds(cardBound.parentNode.parentNode.parentNode.parentNode);_insertedNodesCallback();_srcRootNodesAttachedCallback()}function _resizeStart(e){_this.isResize=true;_this.selected.bfmWidth=_this.selected.style.width;_this.selected.bfmHeight=_this.selected.style.height;_this.selected.bfmRatioW=_this.selected.ratioWidth;_this.selected.bfmRatioH=_this.selected.ratioHeight;_this.selected.prevX=e.pageX;_this.selected.prevY=e.pageY;_this.selected.prevWidth=parseFloat(e.currentTarget.parentNode.offsetWidth);_this.selected.prevHeight=parseFloat(e.currentTarget.parentNode.offsetHeight);_this.isRight=true;_this.isBottom=true;if(this.classList.contains("resize-right")){_this.isBottom=false}else if(this.classList.contains("resize-bottom")){_this.isRight=false}_this.addEventListener("mousemove",_this._resizeMove);_this.addEventListener("mouseup",_this._resizeEnd)}if(this._resizeMove===undefined){this._resizeMove=function(e){if(_this.isRight){var movingValue=e.pageX-_this.selected.prevX;_this.selected.prevWidth+=movingValue;_this.selected.style.width=_this.selected.prevWidth+"px"}if(_this.isBottom){var movingValue=e.pageY-_this.selected.prevY;_this.selected.prevHeight+=movingValue;_this.selected.style.height=_this.selected.prevHeight+"px"}_this.selected.prevY=e.pageY;_this.selected.prevX=e.pageX;_drawPostCard(true);_this.showList[_this.selected.index].size.width=_adjustWidth(_this.selected.offsetWidth);_this.showList[_this.selected.index].size.height=_adjustHeight(_this.selected.offsetHeight);if(_this.editType==="brick"||_this.editType==="top-align"){_renderWhileResize()}e.preventDefault()}}function _renderWhileResize(){_this.__initRenderTable();for(var i=0;i<_this.showList.length;i++){_setCardPosition(_this.querySelector("#"+_this.showList[i].id+".top-dashboard-card-bound.card_"+i),i)}if(_this.editType==="top-align"){_adjustIndex()}}function _renderWhileMove(){_this.__initRenderTable();for(var i=0;i<_this.showList.length;i++){if(_this.selected.index===i){var cardWidth=_this.showList[i].size.width;var cardHeight=_this.showList[i].size.height;if(_this.showList[i].position===undefined||_this.showList[i].position.x===undefined){_this.showList[i].position={x:0}}var x=_this.showList[i].position.x;while(!_validCardPosition(x,_this.nextCell[x],cardWidth,cardHeight)){_this.nextCell[x]++}_this.selected.postY=_this.nextCell[x];_setRenderTable(x,_this.nextCell[x],cardWidth,cardHeight,i);if(i===_this.showList.length-1&&_this.nextCell[x]+cardHeight<=_this.renderTable.length){removeRow()}}else{_setCardPosition(_this.querySelector("#"+_this.showList[i].id+".top-dashboard-card-bound.card_"+i),i)}}_adjustIndex()}function _adjustIndex(){var currentShowList=$.extend(true,[],_this.showList);var currentShowMap=new Map;for(var i=0;i<currentShowList.length;i++){currentShowMap.set(i,currentShowList[i])}_this.showList=[];for(var i=0;i<_this.renderTable.length;i++){for(var j=0;j<_this.gridSize;j++){if(_this.renderTable[i][j][0]===false){var currentIndex=_this.renderTable[i][j][1];if(currentShowMap.has(currentIndex)){_this.showList.push(currentShowMap.get(currentIndex));var cardBound=_this.querySelector("#"+currentShowMap.get(currentIndex).id+".top-dashboard-card-bound.card_"+currentIndex);cardBound.classList.remove("card_"+currentIndex);cardBound.classList.add("card_"+_this.showList.indexOf(currentShowMap.get(currentIndex)));cardBound.index=_this.showList.indexOf(currentShowMap.get(currentIndex));currentShowMap.delete(currentIndex)}}}}}if(this._resizeEnd===undefined){this._resizeEnd=function(e){_this.isResize=false;if(_this.selected===undefined||_this.selected.classList.contains("top-dashboard-card-bound-ghost")){return}if(_this.isRight){_this.isRight=false;_this.selected.style.width=_getWidth(_adjustWidth(_this.selected.offsetWidth),_this.selected)}if(_this.isBottom){_this.isBottom=false;_this.selected.style.height=_getHeight(_adjustHeight(_this.selected.offsetHeight),_this.selected)}if(!_isValidY(_this.selected)||!_isValidX(_this.selected)){_this.selected.style.height=_this.selected.bfmHeight;_this.selected.ratioHeight=_this.selected.bfmRatioH;_this.selected.style.width=_this.selected.bfmWidth;_this.selected.ratioWidth=_this.selected.bfmRatioW}var onCardSizeChange=_this.cardMap.get(_this.selected.id).onSizeChange;if(typeof onCardSizeChange==="string"){onCardSizeChange=Top.Util.namespace(onCardSizeChange,_this)}if(typeof onCardSizeChange==="function"){onCardSizeChange(_this,_this.selected)}_this.showList[_this.selected.index].size.width=_adjustWidth(_this.selected.offsetWidth);_this.showList[_this.selected.index].size.height=_adjustHeight(_this.selected.offsetHeight);_drawPostCard(false);if(_this.editType==="grid"){}else if(_this.editType==="brick"||_this.editType==="top-align"){_renderWhileResize()}}}function _adjustWidth(width){var _width=parseFloat(width);var gridW=_this.querySelector(".top-dashboard-content").clientWidth;var cellW=gridW/_this.gridSize;var cellN=Math.round(_width/cellW);return cellN}function _getWidth(cellN,card){var _width=cellN/_this.gridSize*100+"%";card.ratioWidth=cellN/_this.gridSize*100;return _width}function _adjustHeight(height){var _height=parseFloat(height);var gridH=_this.querySelector(".top-dashboard-content").clientHeight;var cellH=gridH/_this.gridSize;var cellN=Math.round(_height/cellH);return cellN}function _getHeight(cellN,card){var _height=cellN/_this.gridSize*100+"%";card.ratioHeight=cellN/_this.gridSize*100;return _height}function _moveStart(e){if(_this.selected===undefined||_this.isResize===true)return;_this.selected.bfmTop=_this.selected.style.top;_this.selected.bfmLeft=_this.selected.style.left;_this.selected.bfmWidth=_this.selected.style.width;_this.selected.bfmHeight=_this.selected.style.height;_this.selected.prevX=e.pageX;_this.selected.prevY=e.pageY;_this.selected.prevTop=parseFloat(e.currentTarget.offsetTop);_this.selected.prevLeft=parseFloat(e.currentTarget.offsetLeft);_this.addEventListener("mousemove",_this._cardMove);_this.addEventListener("mouseup",_this._moveEnd);_drawGhostCard(true)}function _drawGhostCard(draw){if(_this.editType==="top-align")return;var contentArea=_this.querySelector(".top-dashboard-content");var copy;if(draw){copy=document.createElement("div");copy.className="top-dashboard-card-bound-ghost card_"+_this.selected.index+"-ghost";copy.innerHTML='<div class="top-dashboard-card"></div>';copy.style.top=_this.selected.style.top;copy.style.left=_this.selected.style.left;copy.style.width=_this.selected.style.width;copy.style.height=_this.selected.style.height;contentArea.appendChild(copy)}else{copy=_this.querySelector(".top-dashboard-card-bound-ghost.card_"+_this.selected.index+"-ghost");if(copy!==null)contentArea.removeChild(copy)}}function _drawPostCard(draw){var contentArea=_this.querySelector(".top-dashboard-content");if(_this.editType==="top-align"){if(draw){var left=_adjustXPosition(_this.selected.offsetLeft);if(_this.isResize===true)var top=_adjustYPosition(_this.selected.offsetTop);else var top=_this.selected.postY;var width=_adjustWidth(_this.selected.offsetWidth);var height=_adjustHeight(_this.selected.offsetHeight);if(left<0)left=0;if(left+width>_this.gridSize){if(_this.isResize===true)width=_this.gridSize-left;else left=_this.gridSize-width}if(top<0)top=0;contentArea.querySelectorAll("div.top-dashboard-content-grid-tile.hover").forEach(function(tile){tile.classList.remove("hover")});for(var i=top;i<top+height;i++){if(contentArea.querySelector("tr.top-dashboard-content-grid-row.row_"+i)){var row_childs=contentArea.querySelector("tr.top-dashboard-content-grid-row.row_"+i).children;for(var j=left;j<left+width;j++){row_childs[j].firstElementChild.classList.add("hover")}}}}else{contentArea.querySelectorAll("div.top-dashboard-content-grid-tile.hover").forEach(function(tile){tile.classList.remove("hover")})}}else{
var copy=_this.querySelector(".top-dashboard-card-bound-post");if(draw){if(copy===null){copy=document.createElement("div");copy.className="top-dashboard-card-bound-post";copy.innerHTML='<div class="top-dashboard-card"></div>';copy.style.top=_this.selected.style.top;copy.style.left=_this.selected.style.left;copy.style.width=_this.selected.style.width;copy.style.height=_this.selected.style.height;copy.ratioWidth=_this.selected.ratioWidth;copy.ratioHeight=_this.selected.ratioHeight;copy.ratioX=_this.selected.ratioX;copy.ratioY=_this.selected.ratioY;contentArea.appendChild(copy)}if(_this.editType==="brick"){if(_this.isResize){copy.style.width=_getWidth(_adjustWidth(_this.selected.offsetWidth),copy);copy.style.height=_getHeight(_adjustHeight(_this.selected.offsetHeight),copy);if(!_isValidX(copy)||!_isValidY(copy)){copy.style.width=_this.selected.bfmWidth;copy.style.height=_this.selected.bfmHeight}}else{if(_this.selected.movingIndex>=_this.showList.length){if(_this.selected.movingIndex===0){copy.style.left=_getXPosition(0,copy);copy.style.top=_getYPosition(0,copy)}else if(_this.selected.index===undefined){var cardWidth=_this.defaultCardSize.width;var cardHeight=_this.defaultCardSize.height;var nextX=_this.nextCell.x;var nextY=_this.nextCell.y;while(!_validCardPosition(nextX,nextY,cardWidth,cardHeight)){if(nextX+cardWidth>_this.gridSize){nextX=0;nextY++}else{nextX++}}copy.style.left=_getXPosition(nextX,copy);copy.style.top=_getYPosition(nextY,copy)}else{contentArea.removeChild(copy)}}else{contentArea.removeChild(copy)}}}else if(_this.editType==="grid"){copy.style.left=_getXPosition(_adjustXPosition(_this.selected.offsetLeft),copy);copy.style.top=_getYPosition(_adjustYPosition(_this.selected.offsetTop),copy);copy.style.width=_getWidth(_adjustWidth(_this.selected.offsetWidth),copy);copy.style.height=_getHeight(_adjustHeight(_this.selected.offsetHeight),copy);if(!_isValidX(copy)||!_isValidY(copy)){copy.style.left=_this.selected.bfmLeft;copy.style.top=_this.selected.bfmTop;copy.style.width=_this.selected.bfmWidth;copy.style.height=_this.selected.bfmHeight}}}else{if(copy===null)return;contentArea.removeChild(copy)}}}if(this._addedCardMoveStart===undefined){this._addedCardMoveStart=function(){var addedGhostCard=document.createElement("div");addedGhostCard.className="top-dashboard-card-bound-ghost added-card";addedGhostCard.innerHTML='<div class="top-dashboard-card"></div>';addedGhostCard.style.width=_getWidth(_this.defaultCardSize.width,addedGhostCard);addedGhostCard.style.height=_getHeight(_this.defaultCardSize.height,addedGhostCard);this.selected=addedGhostCard}}if(this._cardMove===undefined){this._cardMove=function(e){if(_this.selected===undefined||_this.isResize===true)return;if(_this.selected.classList.contains("top-dashboard-card-bound-ghost")&&!_this.selected.classList.contains("top-dashboard-card-bound")&&_this.selected.prevX===undefined&&_this.selected.prevY===undefined){_this.querySelector(".top-dashboard-content").appendChild(_this.selected);if(_this.scrollH===undefined)_this.scrollH=_this.querySelector(".top-dashboard-content-layout").scrollTop;_this.selected.prevX=e.pageX;_this.selected.prevY=e.pageY;_this.selected.style.top=e.offsetY-_this.selected.offsetHeight/2+_this.scrollH+"px";_this.selected.style.left=e.offsetX-_this.selected.offsetWidth/2+"px";_this.selected.prevTop=e.offsetY-_this.selected.offsetHeight/2+_this.scrollH;_this.selected.prevLeft=e.offsetX-_this.selected.offsetWidth/2;if(_this.editType==="top-align"){var newItem={id:_this.addedCardId,size:_this.defaultCardSize,position:{}};var x=_adjustXPosition(_this.selected.prevLeft);var y=_adjustYPosition(_this.selected.prevTop);if(x<0)x=0;if(x+_this.defaultCardSize.width>_this.gridSize){x=_this.gridSize-_this.defaultCardSize.width}if(y<0)y=0;if(_this.renderTable[y][x]!==undefined&&_this.renderTable[y][x][0]===false){for(var i=_this.renderTable[y][x][1];i<_this.showList.length;i++){var id=_this.showList[i].id;var cardBound=_this.querySelector("#"+id+".top-dashboard-card-bound.card_"+i);cardBound.index=i+1;cardBound.className="top-dashboard-card-bound card_"+cardBound.index}_this.showList.splice(_this.renderTable[y][x][1],0,newItem);_this.selected.index=_this.renderTable[y][x][1];_this.selected.classList.add("card_"+_this.selected.index)}else{_this.showList.push(newItem);_this.selected.index=_this.showList.length-1;_this.selected.classList.add("card_"+_this.selected.index)}_this.showMap.set(_this.addedCardId,newItem);_this.selected.id=_this.addedCardId;_this.selected.classList.add("top-dashboard-card-bound")}_renderWhileMove()}else{var movingXValue=e.pageX-_this.selected.prevX;var movingYValue=e.pageY-_this.selected.prevY;if(_this.scrollH===undefined)_this.scrollH=_this.querySelector(".top-dashboard-content-layout").scrollTop;var scrollChange=_this.querySelector(".top-dashboard-content-layout").scrollTop-_this.scrollH;_this.selected.prevTop+=movingYValue;_this.selected.prevLeft+=movingXValue;_this.selected.style.top=_this.selected.prevTop+scrollChange+"px";_this.selected.style.left=_this.selected.prevLeft+"px";_this.selected.prevY=e.pageY;_this.selected.prevX=e.pageX;if(this.editType==="brick"){var x=_adjustXPosition(e.clientX-_this.querySelector(".top-dashboard-content").getBoundingClientRect().left);var y=_adjustYPosition(e.clientY-_this.querySelector(".top-dashboard-content").getBoundingClientRect().top+_this.scrollH);_this.selected.movingIndex=_this.selected.index;if(y<0||x<0||x>=12||_this.renderTable[y]===undefined||_this.renderTable[y][x]===undefined)return;if(_this.renderTable[y][x][0]===true){if(_this.renderTable[y][x][1]===undefined){_this.selected.movingIndex=_this.showList.length}else{_this.selected.movingIndex=_this.renderTable[y][x][1]+1}_turnOnGuide(_this.selected.movingIndex-1,"after")}else{if(_this.renderTable[y][x][1]===_this.selected.index){_this.selected.movingIndex=_this.renderTable[y][x][1]}else{var under=_this.querySelector(".top-dashboard-card-bound.card_"+_this.renderTable[y][x][1]).getBoundingClientRect();var over=_this.selected.getBoundingClientRect();if(under.width/2+under.left>over.width/2+over.left){_this.selected.movingIndex=_this.renderTable[y][x][1];_turnOnGuide(_this.renderTable[y][x][1],"before")}else{_this.selected.movingIndex=_this.renderTable[y][x][1]+1;_turnOnGuide(_this.renderTable[y][x][1],"after")}}}_drawPostCard(true)}else if(_this.editType==="top-align"){var left=_getXCellPosition(_this.selected.offsetLeft);var top=_getYCellPosition(_this.selected.offsetTop);var width=_this.showList[_this.selected.index].size.width;var height=_this.showList[_this.selected.index].size.height;if(left<0)left=0;if(left+width>_this.gridSize){if(_this.isResize===true)width=_this.gridSize-left;else left=_this.gridSize-width}if(top<0)top=0;_this.showList[_this.selected.index].position.x=left;var x=_adjustXPosition(e.clientX-_this.querySelector(".top-dashboard-content").getBoundingClientRect().left);var y=_adjustYPosition(e.clientY-_this.querySelector(".top-dashboard-content").getBoundingClientRect().top+_this.scrollH);if(_this.renderTable[y][x]!==undefined&&_this.renderTable[y][x][0]===false){var selectedIndex=_this.selected.index;if(selectedIndex!==_this.renderTable[y][x][1]){for(var i=0;i<_this.showList.length;i++){var id=_this.showList[i].id;var cardBound=_this.querySelector("#"+id+".top-dashboard-card-bound.card_"+i);if(_this.renderTable[y][x][1]<selectedIndex){if(i<_this.renderTable[y][x][1]){continue}else if(i>=_this.renderTable[y][x][1]&&i<selectedIndex){var index=i+1}else if(i==selectedIndex){var index=_this.renderTable[y][x][1]}else{continue}}else if(_this.renderTable[y][x][1]>selectedIndex){if(i<selectedIndex){continue}else if(i==selectedIndex){var index=_this.renderTable[y][x][1]}else if(i<=_this.renderTable[y][x][1]&&i>selectedIndex){var index=i-1}else{continue}}else{break}if(cardBound.classList.contains("top-dashboard-card-bound-ghost")){cardBound.className="top-dashboard-card-bound-ghost added-card top-dashboard-card-bound card_"+index}else{cardBound.className="top-dashboard-card-bound card_"+index}if(_this.selected===cardBound){cardBound.classList.add("select")}cardBound.index=index}var copy=_this.showList[selectedIndex];_this.showList.splice(selectedIndex,1);_this.showList.splice(_this.renderTable[y][x][1],0,copy)}}_renderWhileMove();_drawPostCard(true)}else if(_this.editType==="grid"){var x=_getXCellPosition(_this.selected.offsetLeft);var y=_getYCellPosition(_this.selected.offsetTop);var width=_this.showList[_this.selected.index].size.width;var height=_this.showList[_this.selected.index].size.height;for(var i=y;i<y+height;i++){if(_this.renderTable.length<=i)addRow()}var overlapedIndex=_getNearestCard();if(overlapedIndex[0]<0){_drawPostCard(true);_this.querySelectorAll(".top-dashboard-card-position-guide").forEach(function(card){card.classList.remove("on")})}else{_drawPostCard(false);_turnOnGuide(overlapedIndex[0],overlapedIndex[1].direction)}}}e.preventDefault()}}function _getNearestCard(){var overlapedCards=new Map;var nearestIndex=-1;var selectedX=_this.selected.offsetLeft;var selectedY=_this.selected.offsetTop;var selectedW=_this.selected.offsetWidth;var selectedH=_this.selected.offsetHeight;var selectedCenterX=selectedX+selectedW/2;var selectedCenterY=selectedY+selectedH/2;var x=_getXCellPosition(selectedX);var y=_getYCellPosition(selectedY);console.log("x: "+selectedCenterX);console.log("y: "+selectedCenterY);if(x<0)x=0;if(y<0)y=0;for(var i=y;i<=_getYCellPosition(selectedY+selectedH);i++){for(var j=x;j<_getXCellPosition(selectedX+selectedW);j++){if(j===12||_this.renderTable[i]===undefined)break;if(_this.renderTable[i][j][0]===false&&_this.renderTable[i][j][1]!==_this.selected.index&&!overlapedCards.has(_this.renderTable[i][j][1])){var card=_this.querySelector(".top-dashboard-card-bound.card_"+_this.renderTable[i][j][1]);var cardCenterX=card.offsetLeft+card.offsetWidth/2;var cardCenterY=card.offsetTop+card.offsetHeight/2;console.log(_this.renderTable[i][j][1]+" card x: "+cardCenterX);console.log(_this.renderTable[i][j][1]+" card y: "+cardCenterY);var distance=Math.pow(Math.abs(cardCenterX-selectedCenterX),2)+Math.pow(Math.abs(cardCenterY-selectedCenterY),2);var slop=Math.abs((cardCenterY-card.offsetTop)/(cardCenterX-card.offsetLeft));var slopBtwCards=Math.abs((cardCenterY-selectedCenterY)/(cardCenterX-selectedCenterX));if(slop<slopBtwCards){if(cardCenterY>selectedCenterY){var direction="top"}else{var direction="bottom"}}else{if(cardCenterX>selectedCenterX){var direction="left"}else{var direction="right"}}overlapedCards.set(_this.renderTable[i][j][1],{distance:distance,direction:direction})}}}var minDisatnce;console.log(overlapedCards);overlapedCards.forEach(function(value,key){if(minDisatnce===undefined||minDisatnce>value.distance){minDisatnce=value.distance;nearestIndex=key}});return[nearestIndex,overlapedCards.get(nearestIndex)]}function _turnOnGuide(index,position){_this.querySelectorAll(".top-dashboard-card-position-guide").forEach(function(card){card.classList.remove("on")});if(_this.selected.index===index||index<0)return;if(_this.querySelector(".top-dashboard-card-bound.card_"+index+" .top-dashboard-card-position-guide."+position))_this.querySelector(".top-dashboard-card-bound.card_"+index+" .top-dashboard-card-position-guide."+position).classList.add("on")}if(this._addedEnd===undefined){this._addedEnd=function(e){_this.querySelectorAll(".top-dashboard-card-position-guide").forEach(function(card){card.classList.remove("on")});var addedGhostCard=Top.App.getCurrentPage().template.querySelector("div.top-dashboard-card-bound-ghost.added-card");if(addedGhostCard){addedGhostCard.parentNode.removeChild(addedGhostCard)}_drawPostCard(false);if(_this.editType==="brick"){if(_this.selected===undefined||_this.selected.movingIndex===undefined||_this.selected.movingIndex<0||!_this.selected.classList.contains("top-dashboard-card-bound-ghost"))return;var i=_this.selected.movingIndex;var item={id:_this.addedCardId};_this.showList.splice(i,0,item);_this.showMap.set(_this.addedCardId,item);_this.querySelectorAll(".top-dashboard-card-bound").forEach(function(card){if(card.index>=i){card.classList.remove("card_"+card.index);card.index=card.index+1;card.classList.add("card_"+card.index)}});var cardInfo=_this.cardMap.get(_this.addedCardId);var cardBound=createCard(i);if(cardInfo.html!==undefined){if(Top.Util.getFileExtension(cardInfo.html)==="html"){$.ajax(cardInfo.html,{success:function(data){appendCardContents(data,cardBound)}})}else{appendCardContents(cardInfo.html,cardBound)}}_this.querySelector(".top-dashboard-content").appendChild(cardBound);_renderWhileResize()}else if(_this.editType==="top-align"){if(_this.selected===undefined||!_this.selected.classList.contains("top-dashboard-card-bound-ghost")&&_this.selected.classList.contains("top-dashboard-card-bound"))return;var i=_this.selected.index;var cardInfo=_this.cardMap.get(_this.addedCardId);var cardBound=createCard(i);if(cardInfo.html!==undefined){if(Top.Util.getFileExtension(cardInfo.html)==="html"){$.ajax(cardInfo.html,{success:function(data){appendCardContents(data,cardBound)}})}else{appendCardContents(cardInfo.html,cardBound)}}_this.querySelector(".top-dashboard-content").appendChild(cardBound);_this.selected=undefined;_renderWhileResize()}_this.selected=undefined}}if(this._moveEnd===undefined){this._moveEnd=function(e){if(_this.selected===undefined||_this.isResize===true){_this.isResize=false;return}_this.querySelectorAll(".top-dashboard-card-position-guide").forEach(function(card){card.classList.remove("on")});_this.scrollH=undefined;_drawGhostCard(false);if(_this.editType==="brick"){_drawPostCard(false);if(!Top.Util.__isBooleanTrue(this.dupcardAllowed)){if(_this.selected.movingIndex<_this.selected.index){var copy=_this.showList[_this.selected.index];_this.showList.splice(_this.selected.index,1);_this.showList.splice(_this.selected.movingIndex,0,copy)}else if(_this.selected.movingIndex>_this.selected.index){var copy=_this.showList[_this.selected.index];_this.showList.splice(_this.selected.index,1);_this.showList.splice(_this.selected.movingIndex-1,0,copy)}for(var i=0;i<_this.showList.length;i++){var id=_this.showList[i].id;var cardInfo=_this.cardMap.get(id);var cardBound=_this.querySelector("#"+id+".top-dashboard-card-bound");cardBound.className="top-dashboard-card-bound card_"+i;if(_this.selected===cardBound){cardBound.classList.add("select")}cardBound.index=i}}else{var selectedIndex=_this.selected.index;for(var i=0;i<_this.showList.length;i++){var id=_this.showList[i].id;var cardBound=_this.querySelector("#"+id+".top-dashboard-card-bound.card_"+i);if(_this.selected.movingIndex<selectedIndex){if(i<_this.selected.movingIndex){continue}else if(i>=_this.selected.movingIndex&&i<selectedIndex){var index=i+1}else if(i==selectedIndex){var index=_this.selected.movingIndex}else{continue}}else if(_this.selected.movingIndex>selectedIndex){if(i<selectedIndex){continue}else if(i==selectedIndex){var index=_this.selected.movingIndex-1}else if(i<_this.selected.movingIndex&&i>selectedIndex){var index=i-1}else{continue}}else{break}cardBound.className="top-dashboard-card-bound card_"+index;if(_this.selected===cardBound){cardBound.classList.add("select")}cardBound.index=index}if(_this.selected.movingIndex<selectedIndex){var copy=_this.showList[selectedIndex];_this.showList.splice(selectedIndex,1);_this.showList.splice(_this.selected.movingIndex,0,copy)}else if(_this.selected.movingIndex>selectedIndex){var copy=_this.showList[selectedIndex];_this.showList.splice(selectedIndex,1);_this.showList.splice(_this.selected.movingIndex-1,0,copy)}}_renderWhileResize()}else if(_this.editType==="top-align"){_drawPostCard(false)}else if(_this.editType==="grid"){_drawPostCard(false);_this.selected.style.left=_getXPosition(_adjustXPosition(_this.selected.offsetLeft),_this.selected);_this.selected.style.top=_getYPosition(_adjustYPosition(_this.selected.offsetTop),_this.selected);if(!_isValidX(_this.selected)||!_isValidY(_this.selected)){_this.selected.style.left=_this.selected.bfmLeft;_this.selected.ratioX=_this.selected.bfmRatioX;_this.selected.style.top=_this.selected.bfmTop;_this.selected.ratioY=_this.selected.bfmRatioY}for(var y=_adjustYPosition(_this.selected.offsetTop);y<_adjustYPosition(_this.selected.offsetTop)+_this.showList[_this.selected.index].size.height;y++){if(_this.renderTable.length<=y)addRow()}_emptyRenderTable(_this.showList[_this.selected.index].position.x,_this.showList[_this.selected.index].position.y,_this.showList[_this.selected.index].size.width,_this.showList[_this.selected.index].size.height);_this.showList[_this.selected.index].position.x=_getXCellPosition(_this.selected.offsetLeft);_this.showList[_this.selected.index].position.y=_getYCellPosition(_this.selected.offsetTop);_setRenderTable(_this.showList[_this.selected.index].position.x,_this.showList[_this.selected.index].position.y,_this.showList[_this.selected.index].size.width,_this.showList[_this.selected.index].size.height,_this.selected.index);if(_this.renderTable.length>_this.gridSize)removeRow()}}}function _getXCellPosition(x){var _x=parseFloat(x);var gridW=_this.querySelector(".top-dashboard-content").clientWidth;var cellW=gridW/_this.gridSize;var cardX=Math.floor(_x/cellW);return cardX}function _adjustXPosition(x){var _x=parseFloat(x);var gridW=_this.querySelector(".top-dashboard-content").clientWidth;var cellW=gridW/_this.gridSize;if(_this.editType==="grid"||_this.editType==="top-align"){var cardX=Math.round(_x/cellW)}else{var cardX=Math.floor(_x/cellW)}return cardX}function _getXPosition(cardX,card){var _x=cardX/_this.gridSize*100+"%";card.ratioX=cardX/_this.gridSize*100;return _x}function _getYCellPosition(y){var _y=parseFloat(y);var gridH=_this.querySelector(".top-dashboard-content").clientHeight;var cellH=gridH/_this.gridSize;var cardY=Math.floor(_y/cellH);return cardY}function _adjustYPosition(y){var _y=parseFloat(y);var gridH=_this.querySelector(".top-dashboard-content").clientHeight;var cellH=gridH/_this.gridSize;if(_this.editType==="grid"||_this.editType==="top-align"){var cardY=Math.round(_y/cellH)}else{var cardY=Math.floor(_y/cellH)}return cardY}function _getYPosition(cardY,card){var _y=cardY/_this.gridSize*100+"%";card.ratioY=cardY/_this.gridSize*100;return _y}function _isValidX(card){if(card.ratioX<0)return false;if(card.ratioWidth<0||card.ratioWidth>100)return false;if(_this.editType==="grid"){if(card.ratioX+card.ratioWidth>100)return false}return true}function _isValidY(card){if(card.ratioY<0)return false;if(card.ratioHeight<0)return false;return true}},initializeHtmlObjects:function(child){if(!child.children)return;if(child.tagName==="TOP-TABLEVIEW"||child.tagName==="TOP-LISTVIEW"||child.tagName==="TOP-TREEVIEW"||child.tagName==="TOP-TABLAYOUT")return;for(var i=0;i<child.children.length;i++){if(child.children[i].tagName&&topWidgets[child.children[i].tagName.toLowerCase()]!==undefined){var topWidget=topWidgets[child.children[i].tagName.toLowerCase()];_initProperties(topWidget,child.children[i]);_prepAllBehaviors(topWidget,child.children[i]);if(!child.children[i].isTemplateAppended())child.children[i].appendTemplate();insertedNodes.push(child.children[i])}this.initializeHtmlObjects(child.children[i])}},clearChilds:function(content,directDetach){if(content.childRoot)var myNode=content.childRoot;else var myNode=content;while(myNode.firstChild){this.clearDeepChilds(myNode.firstChild,directDetach);if(directDetach===true&&myNode.firstChild.tagName&&topWidgets[myNode.firstChild.tagName.toLowerCase()]!==undefined){directDetachedNodes.push(myNode.firstChild)}myNode.removeChild(myNode.firstChild)}if(directDetach===true)_directDetachedNodesDetachedCallback()},clearDeepChilds:function(parentNode,directDetach){while(parentNode.firstChild){while(parentNode.firstChild.firstChild){this.clearDeepChilds(parentNode.firstChild)}if(directDetach===true&&parentNode.firstChild.tagName&&topWidgets[parentNode.firstChild.tagName.toLowerCase()]!==undefined){directDetachedNodes.push(parentNode.firstChild)}parentNode.removeChild(parentNode.firstChild)}},initialChilds:function(content){if(content.childRoot){for(var i=0,len=content.childRoot.children.length;i<len;i++){content.childRoot.children[i].layoutParent=content}content.childs=$(content.childRoot).children()}else{for(var i=0,len=content.children.length;i<len;i++){content.children[i].layoutParent=content}content.childs=$(content).children()}},appendHtmlString:function(cardContent,data){var wrapper=document.createElement("div");wrapper.innerHTML=data;this.initializeHtmlObjects(wrapper);while(wrapper.firstChild){if(wrapper.firstChild.tagName&&topWidgets[wrapper.firstChild.tagName.toLowerCase()]!==undefined)srcRootNode.push(wrapper.firstChild);if(cardContent.childRoot)cardContent.childRoot.appendChild(wrapper.firstChild);else cardContent.appendChild(wrapper.firstChild)}},__addCardToShowList:function(id){if(!Top.Util.__isBooleanTrue(this.dupcardAllowed)&&this.showMap.has(id))return;var item={id:id};this.showList.splice(0,0,item);this.showMap.set(id,item);var appendedCards=this.querySelectorAll(".top-dashboard-card-bound");for(var i=0;i<appendedCards.length;i++){var index=appendedCards[i].index+1;appendedCards[i].className="top-dashboard-card-bound card_"+index;appendedCards[i].index=index}this.__renderCards(true)},__startDragToAddCard:function(id){this.addedCardId=id;this.unSelectAllCards();this._addedCardMoveStart();this.addEventListener("mousemove",this._cardMove);this.addEventListener("mouseup",this._addedEnd)},__updateTitle:function(){if(this.headerTitle!==undefined)this.titleTag.value=this.headerTitle},__updateCardList:function(){this.cardMap=new Map;for(var i=0;i<this.cardList.length;i++){this.cardMap.set(this.cardList[i].id,this.cardList[i])}},__updateShowList:function(){this.showMap=new Map;for(var i=0;i<this.showList.length;i++){this.showMap.set(this.showList[i].id,this.showList[i])}this.__renderCards(true)},__updateCustomEmptyLayout:function(){var _this=this;if(this.customEmptyLayout!==undefined){if(Top.Util.getFileExtension(this.customEmptyLayout)==="html"){var customLayout=this.querySelector("div.top-dashboard-content-layout-custom");customLayout.style.display="block";$.ajax(this.customEmptyLayout,{success:function(data){_this.clearChilds(customLayout,true);_this.appendHtmlString(customLayout,data);_this.initialChilds(customLayout.parentNode.parentNode);_insertedNodesCallback();_srcRootNodesAttachedCallback()}})}}},__showCustomEmptyLayout:function(){var customLayout=this.querySelector("div.top-dashboard-content-layout-custom");if(this.showList.length===0&&this.editModeIsOn===false&&this.customEmptyLayout){customLayout.style.display="block"}else{customLayout.style.display="none"}},__setCardTitle:function(cardBound,titleString){if(titleString){if(cardBound.titleArea===undefined){cardBound.titleArea=document.createElement("div");cardBound.titleArea.className="top-dashboard-card-title";cardBound.cardArea.insertBefore(cardBound.titleArea,cardBound.contentArea)}cardBound.titleArea.innerHTML="<span>"+titleString+"</span>"}},__detached:function(){window.removeEventListener("resize",this.__drawGrid)},getTopStyle:function(){this.topstyle=this.querySelector(".top-dashboard-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-dashboard-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-dashboard-root").style.cssText=this.topstyle}};Top.Widget.Dashboard=function(){Dashboard.prototype=Object.create(Top.Widget.prototype);Dashboard.prototype.constructor=Dashboard;function Dashboard(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-dashboard");this.template.innerHTML='<div class="top-dashboard-root"><div class="top-dashboard-content-layout"><div class="top-dashboard-content"></div><div class="top-dashboard-content-layout-custom"></div></div></div>'}this.id=this.template.id}Dashboard.create=function(element){return new Dashboard(element)};Dashboard.prototype.editModeOn=function(){this.template.__setEditModeOn()};Dashboard.prototype.editModeOff=function(){this.template.unSelectAllCards();this.template.__editModeOn(false)};Dashboard.prototype.isEditModeOn=function(){return this.template.editModeIsOn};Dashboard.prototype.openCardListDialog=function(){this.template.__openCardListDialog()};Dashboard.prototype.closeCardListDialog=function(){this.template.__closeCardListDialog()};Dashboard.prototype.getSelectedCard=function(){return this.template.selected};Dashboard.prototype.getSelectedCardIndex=function(){if(this.template.selected===undefined)return-1;return this.template.selected.index};Dashboard.prototype.getSelectedCardInfo=function(){return this.template.cardMap.get(this.template.selected.id)};Dashboard.prototype.getSelectedCardContent=function(){if(this.template.selected)return this.template.selected.querySelector("div.top-dashboard-card-content").children;else return undefined};Dashboard.prototype.getSelectedCardHtmlString=function(){if(this.template.selected)return this.template.selected.querySelector("div.top-dashboard-card-content").innerHTML;else return undefined};Dashboard.prototype.getCard=function(id){if(this.template.showMap.get(id))return this.template.querySelector("div#"+id+".top-dashboard-card-bound");else return undefined};Dashboard.prototype.getCardIndex=function(id){if(this.template.showMap.get(id)&&this.template.querySelector("div#"+id+".top-dashboard-card-bound"))return this.template.querySelector("div#"+id+".top-dashboard-card-bound").index;else return-1};Dashboard.prototype.getCardInfo=function(id){return this.template.cardMap.get(id)};Dashboard.prototype.getCardContent=function(id){if(this.template.showMap.get(id)&&this.template.querySelector("div#"+id+".top-dashboard-card-bound .top-dashboard-card-content"))return this.template.querySelector("div#"+id+".top-dashboard-card-bound .top-dashboard-card-content").children;else return undefined};Dashboard.prototype.getCardHtmlString=function(){if(this.template.showMap.get(id)&&this.template.querySelector("div#"+id+".top-dashboard-card-bound .top-dashboard-card-content"))return this.template.querySelector("div#"+id+".top-dashboard-card-bound .top-dashboard-card-content").innerHTML;else return undefined};Dashboard.prototype.addCardToShowList=function(id){this.template.__addCardToShowList(id)};Dashboard.prototype.pushCardToShowList=function(id){if(this.template.cardMap.has(id)){var item={id:id};this.template.showList.push(item);this.template.showMap.set(id,item)}else{return false}};Dashboard.prototype.deleteCardFromShowList=function(id){if(this.template.cardMap.has(id)){this.template.showList=this.template.showList.filter(function(v){if(v.id===id)return false;return true});this.template.showMap.delete(id)}else{return false}};Dashboard.prototype.reRender=function(){this.template.__renderCards(true)};Dashboard.prototype.save=function(){this.template.unSelectAllCards();if(this.template.editModeIsOn){this.template.__editModeOn(false)}this.template.currentShowList=$.extend(true,[],this.template.showList);this.template.currentShowMap=new Map(this.template.showMap);this.template.headerTitle=this.template.titleTag.value};Dashboard.prototype.cancel=function(){this.template.unSelectAllCards();this.template.__editCancel()};Dashboard.prototype.startDragToAddCard=function(id){if(!this.template.editModeIsOn)return;this.template.__startDragToAddCard(id)};return Dashboard}();TopDatepicker={is:"top-datepicker",behaviors:[TopWidgetBehavior],properties:{date:{type:String,value:""},maxDate:String,minDate:String,format:{type:String,value:"yy-mm-dd"},selectMonth:{type:String,value:"true"},selectYear:{type:String,value:"true"},onSelect:String,yearNavigator:{type:String,value:"true"},yearRange:{type:String,value:"-5:+5"},firstDay:{type:String,value:"0"},dayNamesMin:{type:Array,value:["SUN","MON","TUE","WEN","THU","FRI","SAT"]},containerAlign:{type:String},fromDatepicker:{type:String},toDatepicker:{type:String}},__ready:function(){this.__initialize()},appendTemplate:function(){this.innerHTML='<div class="top-datepicker-root"><input class="top-datepicker-input" type="text"><i class="top-datepicker-icon"></i></div>';this.__isTemplateAppended=true},__attached2:function(){this.attachEventHandler()},__initEventInternal:function(){this.__addEventByAttr("select")},__detached:function(){$("#top-datepicker-div").css("display","none")},__initialize:function(){this.__updateId();this.__updateDisabled();this.__updateMaxDate();this.__updateMinDate();this.__updateDate();this.__updateName();this.__eventBindingList();this.isOpened=false;document.getElementById("top-datepicker-div").style.display="none"},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-datepicker-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateName:function(){if(this.name){var shadowRoot=this.querySelector(".top-datepicker-root");shadowRoot.name=this.name}},__updateId:function(){if(this.id){var thisPicker=this.querySelector(".top-datepicker-input");thisPicker.id=this.id}},__updateDate:function(){var thisPicker=this.querySelector(".top-datepicker-input");var shadowRoot=this.querySelector(".top-datepicker-root");thisPicker.style.zIndex=100;thisPicker.placeholder=this.format;if(this.selectMonth===true||this.selectMonth==="true")this.selectMonth=true;else this.selectMonth=false;if(this.selectYear===true||this.selectYear==="true")this.selectYear=true;else this.selectYear=false;var _this=this;thisPicker.classList.remove("hasDatepicker");$(thisPicker).topDatepicker({monthNames:["01","02","03","04","05","06","07","08","09","10","11","12"],monthNamesShort:["01","02","03","04","05","06","07","08","09","10","11","12"],dayNamesMin:this.dayNamesMin,showMonthAfterYear:true,showOtherMonths:true,changeMonth:this.selectMonth,changeYear:this.selectYear,dateFormat:this.format,prevText:"",nextText:"",yearRange:this.yearRange,minDate:this.minDateObject,maxDate:this.maxDateObject,firstDay:this.firstDay,containerAlign:this.containerAlign,onSelect:function(dateText,inst){_this.date=dateText;if(!_this.__checkDateFormat()){_this.date="";if(!$(_this).hasClass("error"))$(_this).addClass("error")}else{if($(_this).hasClass("error"))$(_this).removeClass("error")}_this.__checkFromToDatepicker();_this.updateData("date");_this.updateDevice("date");_this.__dispatchEvent(new CustomEvent("select",{detail:{data:dateText}}));_this.__checkToDatepickerMinDate()},onClose:function(){_this.isOpened=false}});if(this.date==="today"){$(thisPicker).topDatepicker("setDate",new Date);this.date=$(thisPicker).topDatepicker().val()}else if(this.date===undefined||this.date===null||this.date.length==0){$(thisPicker).topDatepicker("setDate",null);this.date=$(thisPicker).topDatepicker().val()}else if(!this.__checkDateFormat()){$(thisPicker).topDatepicker("setDate",null);thisPicker.value=this.date;this.date="";if(!$(this).hasClass("error"))$(this).addClass("error")}else{$(thisPicker).topDatepicker("setDate",this.date);if($(this).hasClass("error"))$(this).removeClass("error")}_this.__checkFromToDatepicker();_this.__checkToDatepickerMinDate();this.attachEventHandler()},__addBeforeShow:function(){var thisPicker=this.querySelector(".top-datepicker-input");var _this=this;
$(thisPicker).topDatepicker("option","beforeShow",function(input){setTimeout(function(){},1)})},__addOnChangeMonthYear:function(){var thisPicker=this.querySelector(".top-datepicker-input");var _this=this;$(thisPicker).topDatepicker("option","onChangeMonthYear",function(year,month,instance){setTimeout(function(){},1)})},__setYearNavigator:function(thisPicker){var prevBtn=$(thisPicker).topDatepicker("widget").find(".top-datepicker-prev");$("<a>",{click:function(){$.topDatepicker._adjustDate($(thisPicker),-1,"Y")}}).insertBefore(prevBtn).addClass("top-datepicker-prev-year ui-corner-all");var nextBtn=$(thisPicker).topDatepicker("widget").find(".top-datepicker-next");$("<a>",{click:function(){$.topDatepicker._adjustDate($(thisPicker),+1,"Y")}}).insertBefore(nextBtn).addClass("top-datepicker-next-year ui-corner-all")},attachEventHandler:function(){var thisRoot=this.querySelector(".top-datepicker-root");var $thisInput=$(this.querySelector(".top-datepicker-input"));var _this=this;$(thisRoot.querySelector(".top-datepicker-icon")).off("click").on("click",function(){if($thisInput.is(":focus")){$thisInput.focusout();_this.isOpened=false}else{$thisInput.focus();_this.isOpened=true}Top.App.closeOpenedSelectBox();event.stopPropagation()});$thisInput.on("keyup",function(event){var re=/[\ㄱ-ㅎㅏ-ㅣ가-힣]/g;if(re.test(event.target.value)){this.value=event.target.value.replace(re,"")}_this.date=this.value});$thisInput.on("focus",function(){_this.isOpened=true});$thisInput.off("click").on("click",function(){Top.App.closeOpenedSelectBox();event.stopPropagation()});$thisInput.off("blur").on("blur",function(){this.value=event.target.value.replace(/[\ㄱ-ㅎㅏ-ㅣ가-힣]/g,"");if(!_this.__checkDateFormat()){_this.date="";if(!$(_this).hasClass("error"))$(_this).addClass("error")}else{_this.date=this.value;if($(_this).hasClass("error"))$(_this).removeClass("error")}_this.__checkFromToDatepicker();_this.updateData("date");_this.updateDevice("date");if(_this.isOpened!==true){if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("blur"))}else{_this.__dispatchEvent(new Event("blur"))}}})},__updateMaxDate:function(){if(typeof this.maxDate==="string"){if(this.format==="yy-mm-dd"){var maxDateArray=this.maxDate.split("-")}else if(this.format==="yy.mm.dd"){var maxDateArray=this.maxDate.split(".")}this.maxDateObject=new Date(maxDateArray[0],maxDateArray[1]-1,maxDateArray[2])}var thisPicker=this.querySelector(".top-datepicker-input");$(thisPicker).topDatepicker("option","maxDate",this.maxDateObject);this.hide()},__updateMinDate:function(){if(typeof this.minDate==="string"){if(this.format==="yy-mm-dd"){var minDateArray=this.minDate.split("-")}else if(this.format==="yy.mm.dd"){var minDateArray=this.minDate.split(".")}this.minDateObject=new Date(minDateArray[0],minDateArray[1]-1,minDateArray[2])}var thisPicker=this.querySelector(".top-datepicker-input");$(thisPicker).topDatepicker("option","minDate",this.minDateObject);this.hide()},__updateDisabled:function(){if(this.disabled===null)this.disabled=this.getAttribute("disabled");var disabled=this.calculateDerivedDisabled();var shadowInput=this.querySelector("input");if(disabled=="true"||disabled==true){shadowInput.setAttribute("disabled",true)}else{shadowInput.removeAttribute("disabled")}},__updateOnSelect:function(){this.__addEventByAttr("select")},__updateYearRange:function(){var thisPicker=this.querySelector(".top-datepicker-input");$(thisPicker).topDatepicker("option","yearRange",this.yearRange);this.hide()},__updateFirstDay:function(){var thisPicker=this.querySelector(".top-datepicker-input");$(thisPicker).topDatepicker("option","firstDay",this.firstDay);this.hide()},__updateDayNamesMin:function(){var thisPicker=this.querySelector(".top-datepicker-input");$(thisPicker).topDatepicker("option","dayNamesMin",this.dayNamesMin);this.hide()},__updateContainerAlign:function(){var thisPicker=this.querySelector(".top-datepicker-input");$(thisPicker).topDatepicker("option","containerAlign",this.containerAlign);this.hide()},__updateFormat:function(){var thisPicker=this.querySelector(".top-datepicker-input");thisPicker.placeholder=this.format;$(thisPicker).topDatepicker("option","dateFormat",this.format);this.hide()},__checkDateFormat:function(){var dateArray;var date=this.date;var format=this.format;if(typeof date!=="string")return false;if(date==="today")return true;if(format==="yy/mm/dd")dateArray=date.split("/");else dateArray=date.split("-");if(dateArray.length!==3)return false;var yy=dateArray[0];var mm=dateArray[1];var dd=dateArray[2];if(yy.length!==4||mm.length>2||dd.length>2)return false;if(isNaN(yy)||isNaN(mm)||isNaN(dd))return false;if(Number(mm)>12||Number(dd)>31)return false;return true},__checkFromToDatepicker:function(){var $thisInput=$(this.querySelector(".top-datepicker-input"));if(this.fromDatepicker){var datepicker_start=Top.Dom.selectById(this.fromDatepicker);var date_start=datepicker_start.getDate();if(new Date(this.date)<new Date(date_start)){this.date=date_start;$thisInput.topDatepicker("setDate",date_start)}}else if(this.toDatepicker){var datepicker_end=Top.Dom.selectById(this.toDatepicker);var date_end=datepicker_end.getDate();if(new Date(this.date)>new Date(date_end)){datepicker_end.setDate(this.date)}}},__checkToDatepickerMinDate:function(){if(this.toDatepicker){var datepicker_end=Top.Dom.selectById(this.toDatepicker);datepicker_end.setProperties({"min-date":this.date})}},getTopStyle:function(){this.topstyle=this.querySelector(".top-datepicker-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-datepicker-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-datepicker-root").style.cssText=this.topstyle},hide:function(){var curInst=$.topDatepicker._curInst;if(curInst&&this.id===curInst.id){document.getElementById("top-datepicker-div").style.display="none"}}};Top.Widget.Datepicker=function(){Datepicker.prototype=Object.create(Top.Widget.prototype);Datepicker.prototype.constructor=Datepicker;function Datepicker(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-datepicker");this.template.innerHTML='<div class="top-datepicker-root"><input class="top-datepicker-input" type="text"><i class="top-datepicker-icon"></i></div>'}this.id=this.template.id}Datepicker.create=function(element){return new Datepicker(element)};Datepicker.prototype.getDate=function(){return this.template.date};Datepicker.prototype.isOpened=function(){return this.template.isOpened};Datepicker.prototype.setDate=function(date){this.setProperties({date:date})};return Datepicker}();TopDialog={is:"top-dialog",behaviors:[TopWidgetBehavior,TopLayoutBehavior],properties:{title:String,onOpen:String,onClose:String,onSuccess:String,onFail:String,content:Object,isConfirmation:{type:Boolean,value:false},dialogLayout:String,movable:{type:Boolean,value:true},closedOnclickoutside:Boolean,modeless:Boolean},__ready:function(){this.__updateId();this.__updateClass();this.initialChilds();this.__initialClassname();this.__initI18n("title");this.__isReady=true;if(Top.Util.Browser.isIE()){this.content=this.childs.clone(true,true);if(typeof this.__onReady==="function")this.__onReady()}else{if(typeof this.__onReady==="function")this.__onReady();this.content=this.childs.clone(true,true)}this.clearChilds()},appendTemplate:function(){this.innerHTML="<div>"+this.innerHTML+"</div>";this.__isTemplateAppended=true},__updateId:function(){if(this.id){this.childRoot.id=this.id}},__attached2:function(){},__initEventInternal:function(){this.__addEventByAttr("open");this.__addEventByAttr("close")},__updateClass:function(){if(document.querySelector("#top-dialog-root_"+this.id+".top-dialog-root")){document.querySelector("#top-dialog-root_"+this.id+".top-dialog-root").className="top-dialog-root "+this.className}},initializeChildRoot:function(){return this.querySelector("div")},showDialog:function(){var pageId=Top.App.getCurrentPage().id;var width,height;var dialogSizeClass="";var objDialog=this;var baseZIndex=110+Object.keys(Top.App.getDialogs()).length;var selected=null;if(parseInt(this.layoutWidth)>0){width=this.layoutWidth;dialogSizeClass+=" fixed-width-dialog"}else{width="auto"}if(parseInt(this.layoutHeight)>80){height=this.layoutHeight;dialogSizeClass+=" fixed-height-dialog"}else if(typeof this.layoutHeight==="string"&&this.layoutHeight.includes("%")){height=this.layoutHeight;dialogSizeClass+=" fixed-height-dialog"}else{height="auto"}var curPage=document.querySelector("#"+pageId);var dialogRoot=document.createElement("div");dialogRoot.id="top-dialog-root_"+this.id;dialogRoot.className="top-dialog-root";var prevDisplay=dialogRoot.style.display;dialogRoot.style.cssText="width: "+width+"; height: "+height+"; display: none; z-index: "+(baseZIndex+1)+";";var dialogTitleLayout=document.createElement("div");dialogTitleLayout.className="top-dialog-title-layout";var dialogTitle=document.createElement("span");dialogTitle.className="top-dialog-title";dialogTitle.textContent=this.title;dialogTitleLayout.appendChild(dialogTitle);var dialogCloseButton=document.createElement("button");dialogCloseButton.className="top-dialog-close";dialogCloseButton.addEventListener("click",function(){objDialog.close()});dialogTitleLayout.appendChild(dialogCloseButton);dialogRoot.appendChild(dialogTitleLayout);var dialogContent=document.createElement("div");dialogContent.className="top-dialog-content"+dialogSizeClass;dialogRoot.appendChild(dialogContent);document.querySelector("#"+pageId).appendChild(dialogRoot);if(Top.Util.__isBooleanTrue(this.modeless)!==true){var dialogOverlay=document.createElement("div");dialogOverlay.id="top-dialog-overlay_"+this.id;dialogOverlay.className="top-dialog-overlay";dialogOverlay.style.cssText="z-index: "+baseZIndex+";";document.querySelector("#"+pageId).appendChild(dialogOverlay);if(this.closedOnclickoutside==="true"||this.closedOnclickoutside===true){dialogOverlay.addEventListener("click",function(){objDialog.close()})}}var _this=this;if(typeof this.dialogLayout==="string"){if(!this.dialogLayout.endsWith(".html"))this.dialogLayout=this.dialogLayout.concat(".html");Top.Ajax.execute(this.dialogLayout,{success:function(data){_this.childRoot=document.querySelector("#top-dialog-root_"+objDialog.id+" .top-dialog-content");_this.appendHtmlString(data);_insertedNodesCallback();_this.initialChilds();_srcRootNodesAttachedCallback();objDialog.__adjustPosition()}})}if(this.isConfirmation==="true"){var eventSuccess=this.onSuccess!==undefined?' event-mouse-click="'+this.onSuccess+'"':"";var eventFail=this.onFail!==undefined?' event-mouse-click="'+this.onFail+'"':"";$(document.querySelector("#top-dialog-root_"+this.id)).append('<top-linearlayout layout-height="30px" horizontal-alignment="right" padding="20px" border-width="0"><top-button text="OK" margin="0px 10px"'+eventSuccess+'></top-button><top-button text="Cancel" margin="0px 10px"'+eventFail+"></top-button></top-linearlayout>")}if(this.movable==="true"||this.movable===true){var prevX=0;var prevY=0;function positionCalc(num,size,maxNum){if(num<0)return 0;if(num+size>maxNum)return maxNum-size;return num}function _moveElem(e){if(selected!==null){var movementX=prevX?e.screenX-prevX:0;var movementY=prevY?e.screenY-prevY:0;var divX=selected.offsetWidth;var divY=selected.offsetHeight;var body=document.body,html=document.documentElement;var maxWidth=Math.max(body.scrollWidth,body.offsetWidth,html.clientWidth,html.scrollWidth,html.offsetWidth);var maxHeight=Math.max(body.scrollHeight,body.offsetHeight,html.clientHeight,html.scrollHeight,html.offsetHeight);prevX=e.screenX;prevY=e.screenY;selected.style.left=positionCalc(selected.offsetLeft+movementX,divX,maxWidth)+"px";selected.style.top=positionCalc(selected.offsetTop+movementY,divY,maxHeight)+"px"}e.stopPropagation()}function _destroy(){document.removeEventListener("mousemove",_moveElem);selected=null}document.querySelector("#top-dialog-root_"+this.id+" > .top-dialog-title-layout").addEventListener("mousedown",function(e){selected=this.parentNode;prevX=e.screenX;prevY=e.screenY;document.addEventListener("mousemove",_moveElem);e.preventDefault()});document.addEventListener("mouseup",_destroy)}if(typeof this.content==="object"){var wrapper=document.createElement("div");for(var i=0,len=this.content.length;i<len;i++){wrapper.appendChild(this.content[i].cloneNode(true))}while(wrapper.firstChild){this.createHtmlObjects(wrapper.firstChild);dialogContent.appendChild(wrapper.firstChild);this.createdItemWidgetAttachedCallback()}}else{var wrapper=document.createElement("div");wrapper.innerHTML=this.content;while(wrapper.firstChild){this.createHtmlObjects(wrapper.firstChild);dialogContent.appendChild(wrapper.firstChild);this.createdItemWidgetAttachedCallback()}}this.__updateClass();var childNodes=document.querySelector("#top-dialog-root_"+this.id+" .top-dialog-content").querySelectorAll("*");for(var i=0,len=childNodes.length;i<len;i++){if(typeof childNodes[i].__initBoundData==="function"){childNodes[i].__initBoundData()}}dialogRoot.style.display=prevDisplay},createHtmlObjects:function(child,addNodes){if(topWidgets[child.tagName.toLowerCase()]!==undefined){var topWidget=topWidgets[child.tagName.toLowerCase()];_initProperties(topWidget,child);_prepAllBehaviors(topWidget,child);if(!child.isTemplateAppended())child.appendTemplate();if(Top.App.isLoaded()){_callCallback(child,"created");_callCallback(child,"ready");if(addNodes!==false)createdNodes.push(child);if(this.createdItemWidgets===undefined){this.createdItemWidgets=[]}this.createdItemWidgets.push(child)}}if(!child.children)return;for(var i=0;i<child.children.length;i++){this.createHtmlObjects(child.children[i],addNodes)}},createdItemWidgetAttachedCallback:function(){if(this.createdItemWidgets){for(var i=this.createdItemWidgets.length-1;i>=0;i--){_callCallback(this.createdItemWidgets[i],"attached")}this.createdItemWidgets=[]}},__setPosition:function(top,left,zIndex){var str="#top-dialog-root_"+this.id+".top-dialog-root";var dialogRoot=$(str);if(top==="center"){var height=dialogRoot.height();top=window.pageYOffset+window.innerHeight/2-parseInt(height)/2}if(left==="center"){var width=dialogRoot.width();left=(window.innerWidth-parseInt(width))/2}dialogRoot.css("left",left);dialogRoot.css("top",top);if(zIndex){dialogRoot.css("z-index",zIndex)}},__adjustPosition:function(){var _this=this;_this.__adjustPositionImpl()},__adjustPositionImpl:function(){var str="#top-dialog-root_"+this.id+".top-dialog-root";var dialogRoot=$(str);var width=dialogRoot.width();var height=dialogRoot.height();var top=this.layoutTop!==undefined&&this.layoutTop!=="center"?this.layoutTop:window.pageYOffset+window.innerHeight/2-parseInt(height)/2;var left=this.layoutLeft!==undefined&&this.layoutLeft!=="center"?this.layoutLeft:(window.innerWidth-parseInt(width))/2;dialogRoot.css("left",left);dialogRoot.css("top",top);dialogRoot.css("right",this.layoutRight);dialogRoot.css("bottom",this.layoutBottom);if(this.zIndex){dialogRoot.css("z-index",this.zIndex)}if(document.getElementById("top-dialog-root_"+this.id)){var tableviews=document.getElementById("top-dialog-root_"+this.id).querySelectorAll("top-tableview");for(var i=0,len=tableviews.length;i<len;i++){if(tableviews[i].dataTable)tableviews[i].dataTable.columns.adjust()}}},open:function(){if(this.__isOpen){return}this.showDialog();this.__isOpen=true;if(document.activeElement)document.activeElement.blur();var _this=this;if(this.getContent()){if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("open"))}else{this.__dispatchEvent(new Event("open"))}this.__adjustPosition();if(this.getContent().id&&Top.Dom.selectById(this.getContent().id).onSrcLoad){Top.Dom.selectById(this.getContent().id).onSrcLoad(function(){_this.__adjustPosition();if(typeof _this.getContent().template.adjustSize==="function")_this.getContent().template.adjustSize()})}var tableviews=$("#top-dialog-root_"+this.id).find("top-tableview");var len=tableviews.length;for(var i=0;i<len;i++){if(tableviews[i].scrollTable&&(tableviews[i].layoutWidth!==undefined&&(tableviews[i].layoutWidth.indexOf("%")!==-1||tableviews[i].layoutWidth==="match_parent")||tableviews[i].layoutWidth===undefined)&&tableviews[i].dataTable){tableviews[i].dataTable.columns.adjust()}}if(typeof this.getContent().template.adjustSize==="function")this.getContent().template.adjustSize();Top.App.addDialog(this.id,this)}},close:function(){this.__isOpen=false;if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("close"))}else{this.__dispatchEvent(new Event("close"))}var content=document.querySelector("#top-dialog-root_"+this.id+" .top-dialog-content");if(content!==undefined&&content!==null)this.clearDeepChilds(document.querySelector("#top-dialog-root_"+this.id+" .top-dialog-content"));$(document.querySelector("#top-dialog-root_"+this.id)).remove();$(document.querySelector("#top-dialog-overlay_"+this.id)).remove();Top.App.removeDialog(this.id);if(this.removeOnClose===true){if(Top.Util.Browser.isIE()){this.removeNode(true)}else{this.remove()}}},isOpen:function(){return this.__isOpen},getContent:function(){var contentElem=document.querySelector("#top-dialog-root_"+this.id+" .top-dialog-content");if(contentElem){return Top.Dom.__selectImpl(contentElem.firstChild)}else{console.error("The dialog has no content.")}},__updateLayoutWidth:function(){var root=document.querySelector("#top-dialog-root_"+this.id);if(root){root.style.width=this.layoutWidth;this.__adjustPosition()}},__updateLayoutHeight:function(){var root=document.querySelector("#top-dialog-root_"+this.id);if(root){root.style.height=isNaN(this.layoutHeight)||parseInt(this.layoutHeight)>80?this.layoutHeight:"80px";this.__adjustPosition()}},__updateLayoutTop:function(){this.__adjustPosition()},__updateLayoutLeft:function(){this.__adjustPosition()},__updateZIndex:function(){var str="#top-dialog-root_"+this.id+".top-dialog-root";var dialogRoot=$(str);if(this.zIndex){dialogRoot.css("z-index",this.zIndex)}},__updateTitle:function(){if(this.isOpen()===true){var span=document.querySelector("#top-dialog-root_"+this.id+" .top-dialog-title");span.textContent=this.__i18n(this.title)}},__updateOnOpen:function(){this.__addEventByAttr("open")},__updateOnClose:function(){this.__addEventByAttr("close")},getTopStyle:function(){return this.topstyle},setTopStyle:function(key,value){if(value){this.topstyle+=key+":"+value+";"}},setAllTopStyle:function(){}};Top.Widget.Dialog=function(){Dialog.prototype=Object.create(Top.Widget.prototype);Dialog.prototype.constructor=Dialog;function Dialog(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-dialog");this.template.innerHTML="<div></div>"}this.id=this.template.id}Dialog.create=function(element){return new Dialog(element)};Dialog.prototype.addClass=function(className){this.template.className+=" "+className;this.template.__updateClass()};Dialog.prototype.removeClass=function(className){var classCheck=new RegExp("(\\s|^)"+className+"(\\s|$)");this.template.className=this.template.className.replace(classCheck," ").trim();this.template.__updateClass()};Dialog.prototype.toggleClass=function(className){var classCheck=new RegExp("(\\s|^)"+className+"(\\s|$)");if(classCheck.test(this.template.className)){this.template.className=this.template.className.replace(classCheck," ").trim()}else{this.template.className+=" "+className}this.template.__updateClass()};Dialog.prototype.open=function(){if(this.template.__isReady===true){this.template.open()}else{var _this=this;if(Top.Util.Browser.isIE()){$(this.template).html(this.template.content)}this.template.__onReady=function(){_this.template.open()}}};Dialog.prototype.close=function(){this.template.close()};Dialog.prototype.isOpen=function(){return this.template.isOpen()};Dialog.prototype.getContent=function(){return this.template.getContent()};Dialog.prototype.adjustPosition=function(){this.template.__adjustPosition()};Dialog.prototype.setPosition=function(top,left,zIndex){this.template.__setPosition(top,left,zIndex)};Dialog.prototype.show=function(){document.getElementById("top-dialog-root_"+this.id).style.display="block";if(typeof this.template.getContent().template.adjustSize==="function")this.template.getContent().template.adjustSize()};Dialog.prototype.hide=function(){document.getElementById("top-dialog-root_"+this.id).style.display="none"};return Dialog}();TopDocklayout={is:"top-docklayout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],ready:function(){this.initialChilds();this.renderLayout();this.updateStyle();this.__updateId();this.__updateName()},appendTemplate:function(){this.innerHTML='<div class="top-docklayout-root">'+this.innerHTML+"</div>";this.__isTemplateAppended=true},__updateId:function(){if(this.id){this.childRoot.id=this.id}},__updateName:function(){if(this.name){this.childRoot.name=this.name}},renderLayout:function(){this.clearChilds();for(var i=0;i<this.childs.length;i++)this.appendChild(this.childs[i]);var layout_children=this.childs;for(var i=0;i<layout_children.length;i++){var layoutAlignParent="";if(layout_children[i].getAttribute("layout-align-parent")!=null){layoutAlignParent=layout_children[i].getAttribute("layout-align-parent")}else{layoutAlignParent=layout_children[i].layoutAlignParent}switch(layoutAlignParent){case"top":$(layout_children[i]).wrap("<div class='north'></div>");break;case"bottom":$(layout_children[i]).wrap("<div class='south'></div>");break;case"left":$(layout_children[i]).wrap("<div class='east'></div>");break;case"right":$(layout_children[i]).wrap("<div class='west'></div>");break;case"center":$(layout_children[i]).wrap("<div class='center'></div>");break}}},initializeChildRoot:function(){return this.querySelector("div")},getTopStyle:function(){this.topstyle=this.querySelector("div").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector("div");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector("div").style.cssText=this.topstyle}};Top.Widget.Layout.Docklayout=function(){Docklayout.prototype=Object.create(Top.Widget.Layout.prototype);Docklayout.prototype.constructor=Docklayout;function Docklayout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-docklayout");this.template.innerHTML='<div class="top-docklayout-root"></div>'}this.id=this.template.id}Docklayout.create=function(element){return new Docklayout(element)};return Docklayout}();TopFoldinglayout={is:"top-foldinglayout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],properties:{reduction:{type:String,value:"0px"},expansion:{type:String},onOpen:String,onClose:String},__ready:function(){this.__updateId();this.initialChilds();this.renderLayout();this.__attachEvent()},__updateId:function(){if(this.id){var shadowRoot=this.querySelector(".top-foldinglayout-content");shadowRoot.id=this.id}},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-foldinglayout-content");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},appendTemplate:function(){this.innerHTML='<div class="top-foldinglayout-content"><div class="top-foldinglayout-element">'+this.innerHTML+'</div><div class="top-foldinglayout-sub"><center><i class="top-foldinglayout-open"></i></center></div></div>';this.__isTemplateAppended=true},expectedTemplateClassName:function(){return"top-foldinglayout-content"},__initEventInternal:function(){this.__addEventByAttr("onOpen");this.__addEventByAttr("onClose")},__attached2:function(){var shadowContent=this.childRoot.parentNode;this.fold=true;this.padding=$(shadowContent).css("padding");this.borderWidth=$(shadowContent).css("border-width");if(this.onClose&&typeof this.onClose==="string"){this.onClose=Top.Util.namespace(this.onClose,this)}else if(typeof this.onClose==="function"){this.onClose=this.onClose}if(this.onOpen&&typeof this.onOpen==="string"){this.onOpen=Top.Util.namespace(this.onOpen,this)}else if(typeof this.onOpen==="function"){this.onOpen=this.onOpen}},renderLayout:function(){},initializeChildRoot:function(){return this.querySelector(".top-foldinglayout-element")},close:function(reduction){this.fold=false;var _this=this;var shadowContent=this.childRoot.parentNode;var shadowElement=this.childRoot;var shadowIcon=shadowContent.querySelector("i");_this.borderWidth=$(shadowContent).css("border-width");$(shadowContent).css("height",$(shadowContent).height());if(reduction!=undefined)$(shadowContent).css("width",reduction).css("padding-left","0px").css("padding-right","0px");else $(shadowContent).css("width",_this.reduction).css("padding-left","0px").css("padding-right","0px");$(shadowElement).hide();$(shadowIcon).attr("class","top-foldinglayout-close");if(this.onClose&&typeof this.onClose==="string"){var fnClose=Top.Util.namespace(this.onClose,this)}else if(typeof this.onClose==="function"){var fnClose=this.onClose}if(typeof fnClose==="function"){fnClose(Top.Dom.selectById(_this.id))}},open:function(){this.fold=true;var _this=this;var shadowContent=this.childRoot.parentNode;var shadowElement=this.childRoot;var shadowIcon=shadowContent.querySelector("i");if(_this.layoutHeight==undefined)$(shadowContent).css("height","");else $(shadowContent).css("height",_this.layoutHeight);if(_this.layoutWidth==undefined)$(shadowContent).css("width","").css("padding-left",_this.paddingLeft).css("padding-right",_this.paddingRight).css("border-width",_this.borderWidth);else $(shadowContent).css("width",_this.layoutWidth).css("padding-left",_this.paddingLeft).css("padding-right",_this.paddingRight).css("border-width",_this.borderWidth);$(shadowElement).show();$(shadowIcon).attr("class","top-foldinglayout-open");if(this.onOpen&&typeof this.onOpen==="string"){var fnOpen=Top.Util.namespace(this.onOpen,this)}else if(typeof this.onOpen==="function"){var fnOpen=this.onOpen}if(typeof fnOpen==="function"){fnOpen(Top.Dom.selectById(_this.id))}},__attachEvent:function(){var _this=this;var shadowContent=this.childRoot.parentNode;var shadowElement=this.childRoot;var shadowIcon=shadowContent.querySelector("i");var shadowBtn=shadowContent.querySelector(".top-foldinglayout-sub");if(this.onClose&&typeof this.onClose==="string"){var fnClose=Top.Util.namespace(this.onClose,this)}else if(typeof this.onClose==="function"){var fnClose=this.onClose}if(this.onOpen&&typeof this.onOpen==="string"){var fnOpen=Top.Util.namespace(this.onOpen,this)}else if(typeof this.onOpen==="function"){var fnOpen=this.onOpen}if(_this.expansion===undefined)_this.expansion=$(shadowContent).width();$(shadowBtn).on("click",function(e){if(_this.fold==true){_this.fold=false;$(shadowContent).css("height",$(shadowContent).height());_this.borderWidth=$(shadowContent).css("border-width");$(shadowContent).css("width",_this.reduction).css("padding-left","0px").css("padding-right","0px").css("border-width","0px");$(shadowElement).hide();$(shadowIcon).attr("class","top-foldinglayout-close");if(typeof fnClose==="function"){fnClose(e.originalEvent,Top.Dom.selectById(_this.id))}}else{_this.fold=true;if(_this.layoutHeight==undefined)$(shadowContent).css("height","");else $(shadowContent).css("height",_this.layoutHeight);$(shadowContent).css("width",_this.expansion).css("padding-left",_this.paddingLeft).css("padding-right",_this.paddingRight).css("border-width",_this.borderWidth);$(shadowElement).show();$(shadowIcon).attr("class","top-foldinglayout-open");if(typeof fnOpen==="function"){fnOpen(e.originalEvent,Top.Dom.selectById(_this.id))}}})},getTopStyle:function(){this.topstyle=this.querySelector(".top-foldinglayout-content").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-foldinglayout-content");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-foldinglayout-content").style.cssText=this.topstyle}};Top.Widget.Layout.Foldinglayout=function(){Foldinglayout.prototype=Object.create(Top.Widget.Layout.prototype);Foldinglayout.prototype.constructor=Foldinglayout;function Foldinglayout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-foldinglayout");this.template.innerHTML='<div class="top-foldinglayout-content"><div class="top-foldinglayout-element"></div><div class="top-foldinglayout-sub"><center><i class="top-foldinglayout-open"></i></center></div></div>'}this.id=this.template.id}Foldinglayout.create=function(element){return new Foldinglayout(element)};Foldinglayout.prototype.open=function(){return this.template.open()};Foldinglayout.prototype.close=function(){return this.template.close()};return Foldinglayout}();TopForm={is:"top-form",behaviors:[TopWidgetBehavior],properties:{url:String,request:String,response:String,onSuccess:String,onFail:String},ready:function(){if(this.request){this.data=Top.Util.namespace(this.request.split(".data.")[0]);this.field=this.request.split(".data.")[1]}this.__updateId()},__updateId:function(){if(this.id){this.childRoot.id=this.id}},appendTemplate:function(){this.innerHTML="<div>"+this.innerHTML+"</div>";this.__isTemplateAppended=true},submit:function(){var request=Top.Util.namespace(this.request);var response=Top.Util.namespace(this.response);var prop=this;var onSuccess=function(data,textStatus,jqXHR){var func=Top.Util.namespace(prop.onSuccess);if(typeof func==="function"){func(data,textStatus,jqXHR)}if(prop.data){prop.data.reset(prop.field)}};var onFail=Top.Util.namespace(this.onFail);Top.Ajax.post(this.url,this.request,this.response,onSuccess,onFail)},initializeChildRoot:function(){return this.querySelector("div")},getTopStyle:function(){return this.topstyle},setTopStyle:function(key,value){if(value){this.topstyle+=key+":"+value+";"}},setAllTopStyle:function(){}};Top.Widget.Layout.Form=function(){Form.prototype=Object.create(Top.Widget.Layout.prototype);Form.prototype.constructor=Form;function Form(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-form");this.template.innerHTML="<div></div>"}this.id=this.template.id}Form.create=function(element){return new Form(element)};Form.prototype.submit=function(){this.template.submit()};return Form}();TopFramelayout={is:"top-framelayout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],__ready:function(){this.initialChilds();this.updateStyle();this.__updateId();this.__updateName();this.renderLayout()},__attached2:function(){this.adjustSize()},appendTemplate:function(){this.innerHTML='<div class="top-framelayout-root">'+this.innerHTML+"</div>";this.__isTemplateAppended=true},renderLayout:function(){var layoutRoot=this.childRoot;var pPaddingBottom=layoutRoot.style.paddingBottom||0,pPaddingRight=layoutRoot.style.paddingRight||0;for(var i=0;i<layoutRoot.children.length;i++){var child=layoutRoot.children[i];this.__setWrapperStyle(child,pPaddingBottom,pPaddingRight)}},__updateId:function(){if(this.id){this.childRoot.id=this.id}},__updateName:function(){if(this.name){this.childRoot.name=this.name}},__setWrapperStyle:function(child,pPaddingBottom,pPaddingRight){var horizontal_align=this.getAttribute("horizontal-alignment"),vertical_align=this.getAttribute("vertical-alignment"),horizontalString="",verticalString="",transformString="",horizontalPercentage="0",verticalPercentage="0";
if(child.getAttribute("layout-horizontal-alignment"))horizontal_align=child.getAttribute("layout-horizontal-alignment");if(child.getAttribute("layout-vertical-alignment"))vertical_align=child.getAttribute("layout-vertical-alignment");if(horizontal_align==="center"){horizontalString="left: 50%;";horizontalPercentage="-50"}else if(horizontal_align==="right"){horizontalString="right: "+pPaddingRight||0+";";horizontalPercentage="0"}if(vertical_align==="middle"){verticalString="top: 50%;";verticalPercentage="-50"}else if(vertical_align==="bottom"){verticalString="bottom: "+pPaddingBottom||0+";";verticalPercentage="0"}transformString="transform:translate("+horizontalPercentage+"%, "+verticalPercentage+"%);";child.style.cssText="position: absolute; "+horizontalString+verticalString+transformString},initialChilds:function(){this.childs=[];for(var i=0;i<this.childRoot.children.length;i++){this.childRoot.children[i].layoutParent=this;if(Top.Util.__isTopWidget(this.childRoot.children[i].tagName))this.childs.push(this.childRoot.children[i])}},initializeChildRoot:function(){return this.querySelector(".top-framelayout-root")},__setWidgetSize:function(){var layoutRoot=this.childRoot;var maxChildWidth=0;var maxChildHeight=0;var pWrapWidth=!this.getAttribute("layout-width")||this.getAttribute("layout-width")==="auto",pWrapHeight=!this.getAttribute("layout-height")||this.getAttribute("layout-height")==="auto";var pPaddingWidth=layoutRoot.style.paddingRight||0+layoutRoot.style.paddingLeft||0,pPaddingHeight=layoutRoot.style.paddingTop||0+layoutRoot.style.paddingBottom||0;var root=this.childRoot;for(var i=0,len=root.children.length;i<len;i++){var item=root.children[i];if(item.tagName==="DIV")item=item.firstElementChild;if(item.layoutWidth==="match_parent"){if(pWrapWidth){item.setThisWidgetWidth(parseInt(item.marginRight)+parseInt(item.marginLeft)+"px")}else{item.setThisWidgetWidth("100%"-pPaddingWidth+"px")}}if(item.layoutHeight==="match_parent"){if(pWrapHeight){item.setThisWidgetHeight(parseInt(item.marginTop)+parseInt(item.marginBottom)+"px")}else{item.setThisWidgetHeight("100%"-pPaddingHeight+"px")}}if(pWrapWidth){if(item.getElement()&&item.getElement().offsetWidth>maxChildWidth)maxChildWidth=item.getElement().offsetWidth;this.removeTopStyle("width");this.setTopStyle("width",maxChildWidth+"px")}if(pWrapHeight){if(item.getElement()&&item.getElement().offsetHeight>maxChildHeight)maxChildHeight=item.getElement().offsetHeight;this.removeTopStyle("height");this.setTopStyle("height",maxChildHeight+"px")}}},addWidget:function(widget){var layoutRoot=this.childRoot;var pPaddingBottom=layoutRoot.style.paddingBottom||0;var pPaddingRight=layoutRoot.style.paddingRight||0;widget.__isRendered=true;this.adjusted=false;layoutRoot.appendChild(widget.template);this.__setWrapperStyle(widget.template,pPaddingBottom,pPaddingRight)},removeWidget:function(widget){var widgetId=typeof widget==="string"?widget:widget.id;var root=this.childRoot;this.adjusted=false;for(var i=0;i<root.children.length;i++){var child=root.children[i];if(widgetId==child.id){this.clearDeepChilds(child);root.removeChild(child);break}}},getChildren:function(selector){var topElements=[];if(selector){var elements=this.childRoot.querySelectorAll(selector)}else{var elements=this.childRoot.children}var len=elements.length;for(var i=0;i<len;i++){var item=elements[i];if(item.tagName==="DIV")item=item.firstElementChild;topElements[i]=Top.Dom.__selectImpl(item)}return topElements},hasChild:function(child){if(typeof child=="string"){var childId=child}else{var childId=child.id}if(this.childRoot.querySelector("#"+childId))return true;return false},clear:function(){this.adjusted=false;this.clearChilds()},complete:function(){this.adjustSize()},getTopStyle:function(){this.topstyle=this.querySelector(".top-framelayout-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-framelayout-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-framelayout-root").style.cssText=this.topstyle}};Top.Widget.Layout.Framelayout=function(){Framelayout.prototype=Object.create(Top.Widget.Layout.prototype);Framelayout.prototype.constructor=Framelayout;function Framelayout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-framelayout");this.template.innerHTML='<div class="top-framelayout-root"></div>'}this.id=this.template.id}Framelayout.create=function(element){return new Framelayout(element)};return Framelayout}();TopGridlayout={is:"top-gridlayout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],properties:{cols:{type:Number,value:1},rows:{type:Number,value:1},cellWidth:{type:Number,value:0},cellHeight:{type:Number,value:0}},__ready:function(){this.__updateId();this.initialChilds();this.childDeepCopy();this.renderLayout();this.childs=this.deepChilds},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-gridlayout-content");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateId:function(){if(this.id){this.childRoot.id=this.id}},appendTemplate:function(){this.innerHTML='<div class="top-gridlayout-root">'+this.innerHTML+"</div>";this.__isTemplateAppended=true},__attached2:function(){this.__initAlign();this.adjustSize()},childDeepCopy:function(){this.deepChilds=this.childs.clone()},renderLayout:function(){this.clearChilds();if(this.tileMode==="inherit"){this.tileMode=this.parentNode.parentNode.getAttribute("tile-mode");this.updateStyle("tile-mode")}var table=document.createElement("table");table.style.cssText="width:100%;height:100%;";var tbody=document.createElement("tbody");table.appendChild(tbody);this.childRoot.appendChild(table);for(var i=1;i<parseInt(this.rows)+1;i++){var tr=document.createElement("tr");tr.className="row_"+i;tbody.appendChild(tr);for(var j=1;j<parseInt(this.cols)+1;j++){tr.innerHTML+="<td class='top-gridlayout-cell col_"+j+"'><div></div></td>"}}var layout_children=this.deepChilds;for(var i=0;i<layout_children.length;i++){var childCol=1;var childRow=1;var childColSpan=1;var childRowSpan=1;var horizontal_align="left";var vertical_align="top";if(layout_children[i].getAttribute("layout-column")!=null){childCol=layout_children[i].getAttribute("layout-column");childRow=layout_children[i].getAttribute("layout-row");childColSpan=layout_children[i].getAttribute("layout-column-span");childRowSpan=layout_children[i].getAttribute("layout-row-span");if(this.getAttribute("horizontal-alignment"))horizontal_align=this.getAttribute("horizontal-alignment");horizontal_align=layout_children[i].getAttribute("layout-horizontal-alignment")||horizontal_align;if(this.getAttribute("vertical-alignment"))vertical_align=this.getAttribute("vertical-alignment");layout_children[i].vertical_align=layout_children[i].getAttribute("layout-vertical-alignment")||vertical_align}if(childColSpan==null){childColSpan=1}if(childRowSpan==null){childRowSpan=1}var cell=this.childRoot.querySelector(".row_"+childRow+" .col_"+childCol);cell.firstElementChild.appendChild(layout_children[i]);this.createHtmlObjects(layout_children[i]);cell.setAttribute("colspan",childColSpan);cell.setAttribute("rowspan",childRowSpan);cell.setAttribute("style","text-align:"+horizontal_align+"; overflow:hidden; white-space:nowrap;")}this.createdItemWidgetAttachedCallback()},initializeChildRoot:function(){return this.querySelector(".top-gridlayout-root")},__initAlign:function(){var layout_children=this.childs;for(var i=0;i<layout_children.length;i++){layout_children[i].removeTopStyle("vertical-align");layout_children[i].setTopStyle("vertical-align",layout_children[i].vertical_align)}},__setCellSize:function(){if(Top.Util.Browser.isIE()){var layoutRoot=this.childRoot;var colspans=layoutRoot.querySelectorAll("td.top-gridlayout-cell[colspan]");for(var i=0;i<colspans.length;i++){colspans[i].style.width=""}var rowspans=layoutRoot.querySelectorAll("td.top-gridlayout-cell[rowspan]>div");for(var i=0;i<rowspans.length;i++){rowspans[i].style.width=""}if(this.layoutWidth==="auto"){var cell=layoutRoot.querySelectorAll("td.top-gridlayout-cell[colspan='1']");for(var i=0;i<cell.length;i++){var maxCellWidth;if(i===0)maxCellWidth=cell[i].clientWidth;else maxCellWidth=Math.max(maxCellWidth,cell[i].clientWidth)}this.cellWidth=maxCellWidth;for(var i=0;i<colspans.length;i++){colspans[i].style.width=this.cellWidth}}else{this.cellWidth=$(layoutRoot).width()/parseInt(this.cols);for(var i=0;i<colspans.length;i++){colspans[i].style.width=this.cellWidth}}if(this.layoutHeight==="auto"){var cell=layoutRoot.querySelectorAll("td.top-gridlayout-cell[rowspan='1']");for(var i=0;i<cell.length;i++){var maxCellHeight;if(i===0)maxCellHeight=cell[i].clientHeight;else maxCellHeight=Math.max(maxCellHeight,cell[i].clientHeight)}this.cellHeight=maxCellHeight;for(var i=0;i<rowspans.length;i++){rowspans[i].style.height=this.cellHeight;rowspans[i].style.lineHeight=this.cellHeight+"px";rowspans[i].style.width="inherit"}}else{this.cellHeight=$(layoutRoot).height()/parseInt(this.rows);for(var i=0;i<rowspans.length;i++){rowspans[i].style.height=this.cellHeight;rowspans[i].style.lineHeight=this.cellHeight+"px";rowspans[i].style.width="inherit"}}}else{var layoutRoot=this.childRoot;var colspans=this.querySelectorAll("td.top-gridlayout-cell[colspan]");for(var i=0;i<colspans.length;i++){colspans[i].style.width=""}var rowspans=this.querySelectorAll("td.top-gridlayout-cell[rowspan]>div");for(var i=0;i<rowspans.length;i++){rowspans[i].style.width=""}if(this.layoutWidth==="auto"){var cell=this.querySelectorAll("td.top-gridlayout-cell[colspan='1']");for(var i=0;i<cell.length;i++){var maxCellWidth;if(i===0)maxCellWidth=cell[i].clientWidth;else maxCellWidth=Math.max(maxCellWidth,cell[i].clientWidth)}this.cellWidth=maxCellWidth;for(var i=0;i<colspans.length;i++){colspans[i].style.width=this.cellWidth}}else{this.cellWidth=$(layoutRoot).width()/parseInt(this.cols);for(var i=0;i<colspans.length;i++){colspans[i].style.width=this.cellWidth}}if(this.layoutHeight==="auto"){var cell=this.querySelectorAll("td.top-gridlayout-cell[rowspan='1']");for(var i=0;i<cell.length;i++){var maxCellHeight;if(i===0)maxCellHeight=cell[i].clientHeight;else maxCellHeight=Math.max(maxCellHeight,cell[i].clientHeight)}this.cellHeight=maxCellHeight;for(var i=0;i<rowspans.length;i++){rowspans[i].style.height=this.cellHeight;rowspans[i].style.lineHeight=this.cellHeight+"px";rowspans[i].style.width="inherit"}}else{this.cellHeight=$(layoutRoot).height()/parseInt(this.rows);for(var i=0;i<rowspans.length;i++){rowspans[i].style.height=this.cellHeight;rowspans[i].style.lineHeight=this.cellHeight+"px";rowspans[i].style.width="inherit"}}}},__setWidgetSize:function(){var _this=this;var childrenArray=Array.prototype.slice.call(this.childs);childrenArray.forEach(function(item,index){if(item.layoutWidth==="match_parent"){item.setThisWidgetWidth("100%",_this,_this.childs)}if(item.layoutHeight==="match_parent"){item.setThisWidgetHeight("100%",_this,_this.childs)}})},getTopStyle:function(){this.topstyle=this.querySelector(".top-gridlayout-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-gridlayout-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-gridlayout-root").style.cssText=this.topstyle}};Top.Widget.Layout.Gridlayout=function(){Gridlayout.prototype=Object.create(Top.Widget.Layout.prototype);Gridlayout.prototype.constructor=Gridlayout;function Gridlayout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-gridlayout");this.template.innerHTML='<div class="top-gridlayout-root"></div>'}this.id=this.template.id}Gridlayout.create=function(element){return new Gridlayout(element)};return Gridlayout}();TopHtmleditor={is:"top-htmleditor",behaviors:[TopWidgetBehavior],properties:{format:String,fontSize:String,fontSizes:Array,color:String,bold:String,italic:String,underline:String,numberList:String,bulletList:String,subScript:String,superScript:String,indent:String,outdent:String,left:String,center:String,right:String,strike:String,link:String,unlink:String,clean:String,rule:String,source:String,placeholder:String},ready:function(){this.__initialize();this.__updateId();this.__updateName()},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-htmleditor-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateId:function(){if(this.id){this.childRoot.id=this.id}},__updateName:function(){if(this.name){this.childRoot.name=this.name}},__reRender:function(){var editorHTML=this.getEditorHTML();while(this.firstChild){this.removeChild(this.firstChild)}this.appendTemplate();this.__initialize();this.querySelector(".jqte_editor").innerHTML=editorHTML},appendTemplate:function(){this.innerHTML='<div class="top-htmleditor-root">'+this.innerHTML+"</div>";this.__isTemplateAppended=true},__initialize:function(){var _editor=document.createElement("div");_editor.className+="top-htmleditor-editor";this.appendChild(_editor);var options=this.__makeOptions();$(this.children[0]).jqte(options);this.__updateLayoutHeight()},__makeOptions:function(){return{format:!(this.format==="false"||this.format===false),fsize:!(this.fontSize==="false"||this.fontSize===false),fsizes:this.fontSizes?this.fontSizes:[10,12,16,18,20,24,28],color:!(this.color==="false"||this.color===false),b:!(this.bold==="false"||this.bold===false),i:!(this.italic==="false"||this.italic===false),u:!(this.underline==="false"||this.underline===false),ol:!(this.numberList==="false"||this.numberList===false),ul:!(this.bulletList==="false"||this.bulletList===false),sub:!(this.subScript==="false"||this.subScript===false),sup:!(this.superScript==="false"||this.superScript===false),indent:!(this.indent==="false"||this.indent===false),outdent:!(this.outdent==="false"||this.outdent===false),left:!(this.left==="false"||this.left===false),center:!(this.center==="false"||this.center===false),right:!(this.right==="false"||this.right===false),strike:!(this.strike==="false"||this.strike===false),link:!(this.link==="false"||this.link===false),unlink:!(this.unlink==="false"||this.unlink===false),remove:!(this.clean==="false"||this.remove===false),rule:!(this.rule==="false"||this.rule===false),source:!(this.source==="false"||this.source===false),placeholder:this.placeholder?this.placeholder:""}},__updateLayoutHeight:function(){this.removeTopStyle("height");var borderTopWidth=this.borderTopWidth||0;var borderBottomWidth=this.borderBottomWidth||0;if(this.layoutHeight&&this.layoutHeight.endsWith("%")){this.layoutHeight="calc("+this.layoutHeight+" - "+(parseInt(this.marginTop)+parseInt(this.marginBottom)+parseInt(this.paddingTop)+parseInt(this.paddingBottom)+parseInt(borderTopWidth)+parseInt(borderBottomWidth))+"px)"}if(this.layoutHeight==="match_parent")return;this.setTopStyle("height",this.layoutHeight);if($(this.children[0])){$(this.children[0]).closest(".jqte").find(".jqte_editor").css("height",this.layoutHeight)}this.updatePositionValue(false)},initializeChildRoot:function(){return this.querySelector(".top-htmleditor-root")},getValue:function(){return $(this).find(".top-htmleditor-root").val()},getTopStyle:function(){this.topstyle=this.querySelector(".top-htmleditor-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-htmleditor-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-htmleditor-root").style.cssText=this.topstyle},getEditorHTML:function(){var html=this.getValue();return html},getEditorText:function(){var text=this.getEditorHTML();text=text.replace(/<(\/)?([a-zA-Z]*)(\s[a-zA-Z]*=[^>]*)?(\s)*(\/)?>/gi,"");return text}};Top.Widget.Htmleditor=function(){Htmleditor.prototype=Object.create(Top.Widget.prototype);Htmleditor.prototype.constructor=Htmleditor;function Htmleditor(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-htmleditor");this.template.innerHTML='<div class="top-htmleditor-root"></div>'}this.id=this.template.id}Htmleditor.create=function(element){return new Htmleditor(element)};Htmleditor.prototype.getValue=function(){return this.template.getValue()};Htmleditor.prototype.getEditorHTML=function(){return this.template.getEditorHTML()};Htmleditor.prototype.getEditorText=function(){return this.template.getEditorText()};return Htmleditor}();TopIcon={is:"top-icon",behaviors:[TopWidgetBehavior,TopTextBehavior],properties:{contentColor:{type:String,value:"#fff"},contentSize:{type:String}},__ready:function(){if(this.classList.length>1){this.__updateByClassList()}this.__updateId()},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-icon-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},appendTemplate:function(){this.innerHTML='<span class="top-icon-root"><i class="top-icon-content">'+this.innerHTML+"</i></span>";this.__isTemplateAppended=true},__updateId:function(){if(this.id){var shadowRoot=this.querySelector(".top-icon-root");shadowRoot.id=this.id}},__attached2:function(){var contentElement=this.querySelector(".top-icon-content");var rootElement=this.querySelector(".top-icon-root");if(rootElement.offsetHeight>0)contentElement.style.lineHeight=rootElement.offsetHeight+"px";this.__updateClass();this.__updateTextColor()},__updateByClassList:function(){var contentClass="";var checkIconClass=/(icon-[a-z0-9_-]+)/gm;var matchResult=this.className.match(checkIconClass);if(matchResult.length>1){contentClass=matchResult[matchResult.length-1]}if(contentClass!==""){var contentElement=this.querySelector(".top-icon-content");this.classList.remove(contentClass);this.class=this.classList.toString();contentElement.classList.add(contentClass);contentElement.style.color=this.contentColor;if(this.contentSize){contentElement.style.fontSize=this.contentSize}}},__updateClass:function(){if(this.classList.length>1){this.__updateByClassList()}else{if(this.class!=""){this.classList.add(this.class)}if(this.class!=this.__originClass){if(this.__originClass!=""){this.classList.remove(this.__originClass)}this.__originClass=this.class}}},__updateTextColor:function(){var rootElement=this.querySelector(".top-icon-root");rootElement.style.color=this.textColor},getTopStyle:function(){this.topstyle=this.querySelector(".top-icon-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-icon-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-icon-root").style.cssText=this.topstyle}};Top.Widget.Icon=function(){Icon.prototype=Object.create(Top.Widget.prototype);Icon.prototype.constructor=Icon;function Icon(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-icon");this.template.innerHTML='<span class="top-icon-root"><i class="top-icon-content"></i></span>'}this.id=this.template.id}Icon.create=function(element){return new Icon(element)};return Icon}();TopImagebutton={is:"top-imagebutton",behaviors:[TopWidgetBehavior,TopResourceBehavior],properties:{},__ready:function(){this.__updateId();this.__updateDisabled();this.__updateSrc();this.__updateAlt()},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-imagebutton-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateId:function(){if(this.id){var shadowRoot=this.querySelector(".top-imagebutton-root");shadowRoot.id=this.id}},__updateAlt:function(){if(this.description){var shadowRoot=this.querySelector(".top-imagebutton-root");shadowRoot.alt=this.description}},appendTemplate:function(){this.innerHTML='<input class="top-imagebutton-root" type="image"></input>';this.__isTemplateAppended=true},__updateDisabled:function(){if(this.disabled===null)this.disabled=this.getAttribute("disabled");var disabled=this.calculateDerivedDisabled();var shadowInput=this.querySelector("input");if(disabled=="true"||disabled==true){shadowInput.setAttribute("disabled",true)}else{shadowInput.removeAttribute("disabled")}},__updateSrc:function(){if(this.src){if(this.src.includes("@drawable")){this.src=Top.DrawableManager.get(this.src.replace("@drawable/",""))}var shadowRoot=this.querySelector(".top-imagebutton-root");shadowRoot.setAttribute("src",this.src)}},getTopStyle:function(){this.topstyle=this.querySelector(".top-imagebutton-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-imagebutton-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-imagebutton-root").style.cssText=this.topstyle}};Top.Widget.Imagebutton=function(){Imagebutton.prototype=Object.create(Top.Widget.prototype);Imagebutton.prototype.constructor=Imagebutton;function Imagebutton(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-imagebutton");this.template.innerHTML='<input class="top-imagebutton-root" type="image"></input>'}this.id=this.template.id}Imagebutton.create=function(element){return new Imagebutton(element)};return Imagebutton}();TopImageslider={is:"top-imageslider",behaviors:[TopWidgetBehavior,TopGroupBehavior],properties:{mode:{type:String,value:"horizontal"},autoSlide:{type:String,value:"false"},speed:{type:Number,value:500},startSlide:{type:Number,value:0},slide:Object,randomStart:{type:Boolean,value:false}},ready:function(){this.initItems();this.__initialize();this.__updateMode();this.__updateAutoSlide()},__attached2:function(){var thisSlider=this;if(thisSlider.querySelector(".top-imageslider-ul").offsetHeight==0){thisSlider.slide.redrawSlider()}},__initialize:function(){this.clearItems();this.slide=null;var imgSrc="";var imgCaption="";var str="";var div=document.createElement("div");var ul=document.createElement("ul");div.setAttribute("id",this.id);div.classList.add("top-imageslider-root");div.setAttribute("style",this.topstyle);ul.classList.add("top-imageslider-ul");div.appendChild(ul);this.appendChild(div);for(var i=0;i<this.widgetItems.length;i++){if(this.widgetItems[i].getAttribute("src")!=null){imgSrc=this.widgetItems[i].getAttribute("src");imgCaption=this.widgetItems[i].getAttribute("caption")}else{imgSrc=this.widgetItems[i].src;imgCaption=this.widgetItems[i].caption}var li=document.createElement("i");var img=document.createElement("img");img.setAttribute("src",imgSrc);img.setAttribute("title",imgCaption);li.appendChild(img);this.querySelector(".top-imageslider-ul").appendChild(li)}if(this.widgetItems.length!=0){this.slide=$(this.querySelector("#"+this.id+" .top-imageslider-ul")).bxSlider({mode:this.mode,auto:this.autoSlide,speed:this.speed,startSlide:this.startSlide,randomStart:this.randomStart,wrapperClass:"top-imageslider-container",nextText:"",prevText:""})}var thisSlider=this;$(document).on("mouseenter","#"+this.id+" .top-imageslider-prev",function(){thisSlider.querySelector(".top-imageslider-pager").style.backgroundColor="rgba(0, 0, 0, 0.7)"});$(document).on("mouseenter","#"+this.id+" .top-imageslider-next",function(){thisSlider.querySelector(".top-imageslider-pager").style.backgroundColor="rgba(0, 0, 0, 0.7)"});$(document).on("mouseleave","#"+this.id+" .top-imageslider-prev",function(){thisSlider.querySelector(".top-imageslider-pager").style.backgroundColor=""});$(document).on("mouseleave","#"+this.id+" .top-imageslider-next",function(){thisSlider.querySelector(".top-imageslider-pager").style.backgroundColor=""})},initializeChildRoot:function(){return this},__updateMode:function(){},__updateAutoSlide:function(){if(this.autoSlide==="true"){this.autoSlide=true}else{this.autoSlide=false}},goToSlide:function(index){this.slide.goToSlide(index)},goToNextSlide:function(){this.slide.goToNextSlide()},goToPrevSlide:function(){this.slide.goToPrevSlide()},startAuto:function(){this.slide.startAuto(index)},stopAuto:function(){this.slide.stopAuto(index)},getCurrentSlide:function(){return this.slider.getCurrentSlide()},getTopStyle:function(){return this.topstyle},setTopStyle:function(key,value){if(value){this.topstyle+=key+":"+value+";"}},setAllTopStyle:function(){}};Top.Widget.Group.Imageslider=function(){Imageslider.prototype=Object.create(Top.Widget.Group.prototype);Imageslider.prototype.constructor=Imageslider;function Imageslider(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-imageslider")}this.id=this.template.id}Imageslider.create=function(element){return new Imageslider(element)};Imageslider.prototype.goToSlide=function(index){this.template.goToSlide(index)};Imageslider.prototype.goToNextSlide=function(){this.template.goToNextSlide()};Imageslider.prototype.goToPrevSlide=function(){this.template.goToPrevSlide()};Imageslider.prototype.startAuto=function(){this.template.startAuto(index)};Imageslider.prototype.stopAuto=function(){this.template.stopAuto(index)};Imageslider.prototype.getCurrentSlide=function(){return this.template.getCurrentSlide()};return Imageslider}();TopImageview={is:"top-imageview",behaviors:[TopWidgetBehavior,TopResourceBehavior],__ready:function(){this.__updateId();this.__updateSrc();this.__updateAlt()},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-imageview-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateId:function(){if(this.id){var shadowRoot=this.querySelector(".top-imageview-root");shadowRoot.id=this.id}},__updateAlt:function(){if(this.description){var shadowRoot=this.querySelector(".top-imageview-root");shadowRoot.alt=this.description}},appendTemplate:function(){this.innerHTML='<img class="top-imageview-root"></img>';this.__isTemplateAppended=true},__updateSrc:function(){if(this.src){if(this.src.includes("@drawable")){this.src=Top.DrawableManager.get(this.src.replace("@drawable/",""))}this.querySelector("img").setAttribute("src",this.src)}else{this.querySelector("img").removeAttribute("src")}},getTopStyle:function(){this.topstyle=this.querySelector(".top-imageview-root").style.cssText;return this.topstyle},setAllTopStyle:function(){this.querySelector(".top-imageview-root").style.cssText=this.topstyle}};Top.Widget.Imageview=function(){Imageview.prototype=Object.create(Top.Widget.prototype);Imageview.prototype.constructor=Imageview;function Imageview(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-imageview");this.template.innerHTML='<img class="top-imageview-root"></img>'}this.id=this.template.id}Imageview.create=function(element){return new Imageview(element)};return Imageview}();TopLayout={is:"top-layout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],__ready:function(){this.__updateId();this.initialChilds();this.renderLayout()},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-layout-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateId:function(){if(this.id){this.childRoot.id=this.id}},appendTemplate:function(){this.innerHTML='<div class="top-layout-root">'+this.innerHTML+"</div>";this.__isTemplateAppended=true},__attached2:function(){this.adjustSize()},renderLayout:function(){var layout_children=this.childRoot.children;for(var i=0;i<layout_children.length;i++){var child=layout_children[i];if(child.tagName!=="STYLE"){
this.__setWrapperStyle(child)}}},__setWrapperStyle:function(child){child.style.width="100%";child.style.height="100%";child.style.display="block"},__addWrapper:function(child){var wrapper=document.createElement("div");wrapper.style.width="100%";wrapper.style.height="100%";wrapper.appendChild(child);return wrapper},initialChilds:function(){this.childs=[];for(var i=0;i<this.childRoot.children.length;i++){this.childRoot.children[i].layoutParent=this;if(Top.Util.__isTopWidget(this.childRoot.children[i].tagName))this.childs.push(this.childRoot.children[i])}},initializeChildRoot:function(){return this.querySelector(".top-layout-root")},__setWidgetSize:function(adjustment){if(this.childRoot.children.length<=0)return;var pWrapWidth=!this.getAttribute("layout-width")||this.getAttribute("layout-width")==="auto";var pWrapHeight=!this.getAttribute("layout-height")||this.getAttribute("layout-height")==="auto";var root=this.childRoot;for(var i=0;i<root.children.length;i++){var item=root.children[i];if(item.nodeName==="DIV")item=item.firstElementChild;if(adjustment&&typeof item.adjustSize==="function"){item.adjustSize()}if(item.getAttribute("layout-width")==="match_parent"){if(pWrapWidth){item.setThisWidgetWidth(parseInt(item.marginRight)+parseInt(item.marginLeft)+"px")}else{item.setThisWidgetWidth("100%")}}if(item.getAttribute("layout-height")==="match_parent"){if(pWrapHeight){item.setThisWidgetHeight(parseInt(item.marginTop)+parseInt(item.marginBottom)+"px")}else{item.setThisWidgetHeight("100%")}}}},adjustSize:function(){if(this.adjusted===true){for(var i=0;i<this.childRoot.children.length;i++){if(typeof this.childRoot.children[i].adjustSize==="function")this.childRoot.children[i].adjustSize()}return}var isVisible=!!(this.childRoot.offsetWidth||this.childRoot.offsetHeight||this.childRoot.getClientRects().length);if(isVisible===true){this.adjusted=true;this.__setWidgetSize(true)}},addWidget:function(widget){widget.__isRendered=true;this.adjusted=false;this.childRoot.appendChild(widget.template);this.__setWrapperStyle(widget.template)},removeWidget:function(widgetId){var widgetId=typeof widget==="string"?widget:widget.id;var root=this.childRoot;this.adjusted=false;for(var i=0;i<root.children.length;i++){var child=root.children[i];if(widgetId==child.id){this.clearDeepChilds(child);root.removeChild(child);break}}},getChildren:function(selector){var topElements=[];if(selector){var elements=this.childRoot.querySelectorAll(selector)}else{var elements=this.childRoot.children}var len=elements.length;for(var i=0;i<len;i++){var item=elements[i];if(item.tagName==="DIV")item=item.firstElementChild;topElements[i]=Top.Dom.__selectImpl(item)}return topElements},hasChild:function(child){if(typeof child=="string"){var childId=child}else{var childId=child.id}if(this.childRoot.querySelector("#"+childId))return true;return false},clear:function(){this.adjusted=false;this.clearChilds()},complete:function(){this.adjustSize()},getTopStyle:function(){this.topstyle=this.querySelector(".top-layout-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-layout-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-layout-root").style.cssText=this.topstyle}};Top.Widget.Layout.Layout=function(){Layout.prototype=Object.create(Top.Widget.Layout.prototype);Layout.prototype.constructor=Layout;function Layout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-layout");this.template.innerHTML='<div class="top-layout-root"></div>'}this.id=this.template.id}Layout.create=function(element){return new Layout(element)};return Layout}();TopLinearlayout={is:"top-linearlayout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],properties:{orientation:{type:String,value:"horizontal",reflectToAttribute:true},verticalAlignment:{type:String,value:"top"},multiLine:{type:Boolean,value:false}},__ready:function(){this.__updateId();this.initialChilds();this.renderLayout();this.__updateVerticalAlignment()},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-linearlayout-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateId:function(){if(this.id){this.childRoot.id=this.id}},appendTemplate:function(){this.innerHTML='<div class="top-linearlayout-root">'+this.innerHTML+"</div>";this.__isTemplateAppended=true},__attached2:function(){this.adjustSize();this.__setWidgetWeight()},initializeChildRoot:function(){return this.querySelector(".top-linearlayout-root")},renderLayout:function(){if(this.orientation=="vertical"){if(Top.App.__compatibleWithTOP()){this.topstyle="overflow:hidden;"+this.topstyle;this.setAllTopStyle()}}else{if(Top.App.__compatibleWithTOP()&&this.multiLine!==true){this.topstyle="overflow:hidden;white-space:nowrap;"+this.topstyle;this.setAllTopStyle();this.removeTopStyle("text-align")}else{this.removeTopStyle("overflow");this.removeTopStyle("white-space")}}for(var i=0;i<this.childRoot.children.length;i++){var child=this.childRoot.children[i];this.__setWrapperStyle(child)}},initialChilds:function(){this.childs=[];for(var i=0;i<this.childRoot.children.length;i++){this.childRoot.children[i].layoutParent=this;if(Top.Util.__isTopWidget(this.childRoot.children[i].tagName))this.childs.push(this.childRoot.children[i])}},__setWrapperStyle:function(child){if(this.orientation=="vertical"){var horizontalAlignment=this.horizontalAlignment||"left";if(child.getAttribute("layout-horizontal-alignment")){horizontalAlignment=child.getAttribute("layout-horizontal-alignment")}var height=child.getAttribute("layout-height");if(height&&height.includes("%")){var child_display="block";if(child.display==="none"){child_display="none"}child.style.cssText="display: "+child_display+"; height: "+height+"; text-align: "+horizontalAlignment+";";if(typeof child.__updateLayoutHeight==="function")child.__updateLayoutHeight()}else{child.style.cssText="display: block; text-align: "+horizontalAlignment+";"}}else{if(Top.App.__compatibleWithTOP()&&this.multiLine!==true){var verticalAlignment=this.verticalAlignment;if(!child.getAttribute("layout-vertical-alignment")){child.setAttribute("layout-vertical-alignment",verticalAlignment);child.layoutVerticalAlignment=verticalAlignment;if(typeof child.setTopStyle==="function")child.setTopStyle("vertical-align",verticalAlignment)}child.style.cssText="display: inline; line-height: normal;"}else{var horizontalAlignment=child.getAttribute("layout-horizontal-alignment")||"left";var verticalAlignment=child.getAttribute("layout-vertical-alignment")||"top";child.style.cssText="display: inline; text-align: "+horizontalAlignment+"; vertical-align: "+verticalAlignment+";"}}},__setChildDisplay:function(child){if(this.orientation=="vertical"){var height=child.getAttribute("layout-height");if(height&&height.includes("%")){var horizontalAlignment=this.horizontalAlignment||"left";if(child.getAttribute("layout-horizontal-alignment")){horizontalAlignment=child.getAttribute("layout-horizontal-alignment")}var child_display="block";if(child.display==="none"){child_display="none"}child.style.cssText="display: "+child_display+"; height: "+height+"; text-align: "+horizontalAlignment+";";if(typeof child.__updateLayoutHeight==="function")child.__updateLayoutHeight()}}},__reRenderChildDisplay:function(child){if(child){this.__setChildDisplay(child)}else{for(var i=0;i<this.childRoot.children.length;i++){var child=this.childRoot.children[i];this.__setChildDisplay(child)}}},__setLineHeight:function(){if(!Top.App.__compatibleWithTOP()||this.multiLine===true)return;if(this.orientation==="vertical")return;var shadowRoot=this.childRoot;var sHeight=document.defaultView.getComputedStyle(shadowRoot).height;var isVisible=!!(shadowRoot.offsetWidth||shadowRoot.offsetHeight||shadowRoot.getClientRects().length);if(isVisible&&parseFloat(sHeight)>0){if(typeof parseFloat(this.childRoot.style.lineHeight)==="number"&&parseFloat(sHeight)==parseFloat(this.childRoot.style.lineHeight))return;this.removeTopStyle("line-height");this.setTopStyle("line-height",sHeight)}},__adjustLineHeight:function(){if(this.layoutHeight&&(this.layoutHeight.includes("%")||this.layoutHeight==="match_parent")){this.__setLineHeight();this.childs.forEach(function(child){if(typeof child.__adjustLineHeight==="function")child.__adjustLineHeight()})}else{return}},__setWidgetSize:function(adjustment){var root=this.childRoot;if(root.children[0]&&root.children[0].tagName==="DIV")root=root.children[0];if(root.children.length<=0)return;if(this.layoutWidth==="match_parent"&&this.parentNode.tagName==="TD"){this.layoutWidth="100%";this.__updateLayoutWidth()}var pHorizontal=this.orientation==="horizontal";var pWrapWidth=!this.layoutWidth||this.layoutWidth==="auto",pWrapHeight=!this.layoutHeight||this.layoutHeight==="auto";this.wSum=0,this.hSum=0,this.weightSum=0;if(this.orientation==="horizontal"){for(var i=0,len=root.children.length;i<len;i++){var item=root.children[i];if(item.nodeName==="DIV")item=item.firstElementChild;if(adjustment&&typeof item.adjustSize==="function")item.adjustSize();var itemLayoutHeight=item.layoutHeight;var itemLayoutWidth=item.layoutWidth;if(itemLayoutHeight==="match_parent"){if(pWrapHeight){item.setThisWidgetHeight(parseFloat(item.marginTop)+parseFloat(item.marginBottom)+"px")}else{item.setThisWidgetHeight("100%")}}if(root.children.length===1&&(!itemLayoutWidth||itemLayoutWidth==="auto"||itemLayoutWidth==="wrap_content")){return}var iWidth=parseFloat(itemLayoutWidth);if(!isNaN(iWidth)){iWidth+=parseFloat(item.paddingLeft)+parseFloat(item.paddingRight)+parseFloat(item.marginLeft)+parseFloat(item.marginRight)+parseFloat(item.borderLeftWidth)+parseFloat(item.borderRightWidth);item.setAttribute("actual-width",iWidth);this.wSum+=iWidth}else if(!itemLayoutWidth||itemLayoutWidth==="auto"||itemLayoutWidth==="wrap_content"){if(typeof item.getElement==="function"&&item.getElement()){if(item.tagName==="TOP-RADIOBUTTON"){iWidth+=item.getElement(".top-radiobutton-text")?parseFloat(window.getComputedStyle(item.getElement(".top-radiobutton-text")[0]).width)||0:0}else if(item.tagName==="TOP-CHECKBOX"){iWidth+=item.getElement(".top-checkbox-text")?parseFloat(window.getComputedStyle(item.getElement(".top-checkbox-text")[0]).width)||0:0}else{iWidth=parseFloat(window.getComputedStyle(item.getElement()).width)||0}iWidth+=parseFloat(item.paddingLeft)+parseFloat(item.paddingRight)+parseFloat(item.marginLeft)+parseFloat(item.marginRight)+parseFloat(item.borderLeftWidth)+parseFloat(item.borderRightWidth);item.setAttribute("actual-width",iWidth);this.wSum+=iWidth}}else if(itemLayoutWidth==="match_parent"){var iMargin=parseFloat(item.marginRight)||0+parseFloat(item.marginLeft)||0;if(pWrapWidth){item.setThisWidgetWidth(iMargin+"px")}else{item.setThisWidgetWidth(this.wSum>0?"100% - "+this.wSum+"px":"100%")}if(!item.getAttribute("layout-weight")){this.weightSum=0;return}this.wSum+=iMargin}var iWeight=parseFloat(item.getAttribute("layout-weight"));if(!isNaN(iWeight))this.weightSum+=iWeight}}else{for(var i=0,len=root.children.length;i<len;i++){var item=root.children[i];if(adjustment&&typeof item.adjustSize==="function")item.adjustSize();var itemLayoutHeight=item.layoutHeight;var itemLayoutWidth=item.layoutWidth;if(itemLayoutWidth==="match_parent"){if(pWrapWidth){item.setThisWidgetWidth(parseFloat(item.marginLeft)+parseFloat(item.marginRight)+"px")}else{item.setThisWidgetWidth("100%")}}if(root.children.length===1&&(!itemLayoutHeight||itemLayoutHeight==="auto"||itemLayoutHeight==="wrap_content")){return}var iHeight=parseFloat(itemLayoutHeight);if(!isNaN(iHeight)){iHeight+=parseFloat(item.paddingTop)+parseFloat(item.paddingBottom)+parseFloat(item.marginTop)+parseFloat(item.marginBottom);if(item.borderBottomWidth!==undefined)iHeight+=parseFloat(item.borderBottomWidth);if(item.borderTopWidth!==undefined)iHeight+=parseFloat(item.borderTopWidth);item.setAttribute("actual-height",iHeight);this.hSum+=iHeight}else if(!itemLayoutHeight||itemLayoutHeight==="auto"||itemLayoutHeight==="wrap_content"){if(typeof item.getElement==="function"){if(item.tagName==="TOP-RADIOBUTTON"){iHeight=item.getElement(".top-radiobutton-text")?parseFloat(window.getComputedStyle(item.getElement(".top-radiobutton-text")[0]).height)||0:0}else if(item.tagName==="TOP-CHECKBOX"){iHeight=item.getElement(".top-checkbox-text")?parseFloat(window.getComputedStyle(item.getElement(".top-checkbox-text")[0]).height)||0:0}else if(item.getElement()){iHeight=parseFloat(document.defaultView.getComputedStyle(item.getElement()).height)||0}iHeight+=parseFloat(item.paddingTop)+parseFloat(item.paddingBottom)+parseFloat(item.marginTop)+parseFloat(item.marginBottom);if(item.borderBottomWidth!==undefined)iHeight+=parseFloat(item.borderBottomWidth);if(item.borderTopWidth!==undefined)iHeight+=parseFloat(item.borderTopWidth);item.setAttribute("actual-height",iHeight);this.hSum+=iHeight}}else if(itemLayoutHeight==="match_parent"){var iMargin=parseFloat(item.marginTop)||0+parseFloat(item.marginBottom)||0;if(pWrapHeight){item.setThisWidgetHeight(iMargin+"px")}else{item.style.height=this.hSum>0?"calc(100% - "+this.hSum+"px)":"100%";item.setThisWidgetHeight("100%")}if(!item.getAttribute("layout-weight")){this.weightSum=0;return}this.hSum+=iMargin}var iWeight=parseFloat(item.getAttribute("layout-weight"));if(!isNaN(iWeight))this.weightSum+=iWeight}}},__setWidgetWeight:function(){if(this.childRoot.children.length<=0||!Top.App.__compatibleWithTOP()||this.weightSum<=0)return;var layoutRoot=this.childRoot;var whiteSpaceSize=0;var rootSize=0;if(this.getAttribute("orientation")==="vertical"){var pPadding=parseFloat(this.paddingTop)+parseFloat(this.paddingBottom);rootSize=layoutRoot.clientHeight-pPadding;whiteSpaceSize=rootSize;if(whiteSpaceSize<=0&&!isNaN(parseFloat(this.getAttribute("layout-height")))){whiteSpaceSize=parseFloat(this.getAttribute("layout-height"))-pPadding}whiteSpaceSize-=this.hSum;if(whiteSpaceSize<=0)return;var weightRatio=whiteSpaceSize/this.weightSum;var root=this.childRoot;for(var i=0;i<root.children.length;i++){var item=root.children[i];if(item.getAttribute("layout-weight")){var itemHeight;itemHeight=item.getAttribute("actual-height");itemHeight=itemHeight+weightRatio*parseFloat(item.getAttribute("layout-weight"));itemHeight=itemHeight/rootSize*100+"%";var minusValue=parseFloat(item.marginTop)||0;minusValue+=parseFloat(item.marginBottom)||0;if(typeof item.getElement==="function"&&item.getElement().style.boxSizing!=="border-box"){minusValue+=parseFloat(item.borderTopWidth)||0;minusValue+=parseFloat(item.borderBottomWidth)||0;minusValue+=parseFloat(item.paddingTop)||0;minusValue+=parseFloat(item.paddingBottom)||0}item.removeTopStyle("height");item.setTopStyle("height","calc(100% - "+minusValue+"px)");item.style.height=itemHeight;if(typeof item.__adjustWidgets==="function"){item.__adjustWidgets()}}}}else{var pPadding=parseFloat(this.paddingLeft)+parseFloat(this.paddingRight);rootSize=layoutRoot.clientWidth-pPadding;whiteSpaceSize=rootSize;if(whiteSpaceSize<=0&&!isNaN(parseFloat(this.getAttribute("layout-width")))){whiteSpaceSize=parseFloat(this.getAttribute("layout-width"))-pPadding}whiteSpaceSize-=this.wSum;if(whiteSpaceSize<=0)return;var weightRatio=whiteSpaceSize/this.weightSum;for(var i=0;i<this.children.length;i++){var item=this.children[i].firstElementChild;if(item.getAttribute("layout-weight")){if(item.layoutWidth==="auto"||!item.layoutWidth)item.setTopStyle("width","");if(!isNaN(parseFloat(item.layoutWidth)))item.setTopStyle("width",item.layoutWidth);var itemWidth=item.getAttribute("actual-width");itemWidth=itemWidth+weightRatio*parseFloat(item.getAttribute("layout-weight"));itemWidth=itemWidth/rootSize*100+"%";item.removeTopStyle("width");item.setTopStyle("width",itemWidth);if(typeof item.__adjustWidgets==="function"){item.__adjustWidgets()}}}}},getWidth:function(){return this.childRoot.offsetWidth},getHeight:function(){return this.childRoot.offsetHeight},__updateVerticalAlignment:function(){if(Top.App.__compatibleWithTOP())return;if(this.verticalAlignment=="bottom"){var shadowContent=this.querySelector("div content");$(shadowContent).wrap("<div style='#position: relative; display: table; width:100%; height:100%;  padding: 0px; border: 0px; background-color:transparent'></div>");$(shadowContent).wrap("<div style='#position: absolute; #top: 100%; width: 100%; padding: 0px; border: 0px;  display: table-cell; vertical-align: bottom; background-color:transparent'></div>");$(shadowContent).wrap("<div style='#position: relative; #top:-100%; padding: 0px; border: 0px;background-color:transparent'></div>")}else if(this.verticalAlignment=="middle"){var shadowContent=this.querySelector("div content");$(shadowContent).wrap("<div style='#position: relative; display: table; width:100%; height:100%; padding: 0px; border: 0px;background-color:transparent'></div>");$(shadowContent).wrap("<div style='#position: absolute; #top: 50%; display: table-cell; width: 100%; padding: 0px; border: 0px; vertical-align: middle; background-color:transparent'></div>");$(shadowContent).wrap("<div style='#position: relative; #top: -50%; padding: 0px; border: 0px;background-color:transparent'></div>")}},__updateMultiLine:function(){if(this.multiLine=="true")this.multiLine=true;this.renderLayout()},adjustSize:function(){if(this.adjusted===true){for(var i=0;i<this.childRoot.children.length;i++){if(typeof this.childRoot.children[i].adjustSize==="function")this.childRoot.children[i].adjustSize()}return}var isVisible=!!(this.childRoot.offsetWidth||this.childRoot.offsetHeight||this.childRoot.getClientRects().length);if(isVisible===true){this.adjusted=true;this.__setWidgetSize(true)}},addWidget:function(widget){widget.__isRendered=true;this.adjusted=false;this.childRoot.appendChild(widget.template);this.__setWrapperStyle(widget.template)},removeWidget:function(widget){var widgetId=typeof widget==="string"?widget:widget.id;var root=this.childRoot;this.adjusted=false;for(var i=0;i<root.children.length;i++){var child=root.children[i];if(widgetId==child.id){this.clearDeepChilds(child);root.removeChild(child);break}}},getChildren:function(selector){var topElements=[];if(selector){var elements=this.childRoot.querySelectorAll(selector)}else{var elements=this.childRoot.children}var len=elements.length;for(var i=0;i<len;i++){var item=elements[i];if(item.tagName==="DIV")item=item.firstElementChild;topElements[i]=Top.Dom.__selectImpl(item)}return topElements},hasChild:function(child){if(typeof child=="string"){var childId=child}else{var childId=child.id}if(this.childRoot.querySelector("#"+childId))return true;return false},clear:function(){this.adjusted=false;this.clearChilds()},complete:function(){this.renderLayout();this.__attached2()},getTopStyle:function(){this.topstyle=this.childRoot.style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.childRoot.style[key]=value;this.topstyle=this.childRoot.style.cssText}},setAllTopStyle:function(){this.childRoot.style.cssText=this.topstyle}};Top.Widget.Layout.Linearlayout=function(){Linearlayout.prototype=Object.create(Top.Widget.Layout.prototype);Linearlayout.prototype.constructor=Linearlayout;function Linearlayout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-linearlayout");this.template.innerHTML='<div class="top-linearlayout-root"></div>'}this.id=this.template.id}Linearlayout.create=function(element){return new Linearlayout(element)};Linearlayout.prototype.getWidth=function(){return this.template.getWidth()};Linearlayout.prototype.getHeight=function(){return this.template.getHeight()};Linearlayout.prototype.addWidgetByIndex=function(widget,index){this.removeWidget(widget);this.template.childs.splice(index,0,widget.template)};return Linearlayout}();TopListview={is:"top-listview",behaviors:[TopWidgetBehavior,TopContainerBehavior,TopGroupBehavior],properties:{rowSelected:{type:String,reflectToAttribute:true},onRowclick:String,virtualScroll:{type:String,value:"false"},onScrollend:String},ready:function(){this.childTemplate=this.childRoot.innerHTML;if(this.childTemplate.includes("</ul>"))this.childTemplate=""},appendTemplate:function(){this.innerHTML='<div class="top-listview-root">'+this.innerHTML+"</div>";this.__isTemplateAppended=true},initializeChildRoot:function(){return this.querySelector(".top-listview-root")},__ready:function(){this.initialChilds();this.initialLayout();this.initItems();this.renderLayout();this.__updateId();this.__updateName();this.__updateAlign();this.updateStyle();this.__initialized=true},attached:function(){this.attachEventHandler()},__initEventInternal:function(){this.__addEventByAttr("rowclick")},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-listview-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateId:function(){if(this.id){this.childRoot.id=this.id}},__updateName:function(){if(this.name){this.childRoot.name=this.name}},__updateAlign:function(){if(this.layoutHorizontalAlignment){this.childRoot.align=this.layoutHorizontalAlignment}},__updateOnScrollend:function(){this.__addEventByAttr("scrollend")},__renderVirtualLayout:function(){if(typeof this.onScrollend==="string")this.onScrollend=Top.Util.namespace(this.onScrollend,this);var _this=this;if(this.items&&typeof this.items==="string"){var items=Top.Util.namespace(this.items,this);if(!Array.isArray(items))return}else if(typeof this.items==="object"){var items=this.items}else if(this.widgetItems){this.renderByWidgetItem();return}var layout=this.childTemplate===undefined||this.childTemplate===""?this.itemLayout:this.childTemplate;var switchedItem=this.getSwitchedItem();if(items===undefined)return;this.itemData=items;var root=this.childRoot;root.innerHTML="<ul data-role='listview' data-inset='true' class='top-listview-container top-listview-virtual'></ul>";var viewport=$(root);var content=$(root.querySelector(".top-listview-container"));var len=items.length;if(_this.rh!==undefined||_this.rg!==null){var sample=document.createElement("div");sample.innerHTML=layout;for(var k=0;k<sample.children.length;k++){_this.createHtmlObjects(sample.children[k]);content.append(sample.children[k])}_this.rh=parseInt($(content).css("height"));content.empty()}var h=_this.rh*items.length;var vp=parseInt(this.layoutHeight);content.css("height",h);onScroll();$(root).unbind("scroll");$(root).scroll($.throttle(200,false,onScroll));function onScroll(){content.empty();var scrollTop=viewport.scrollTop();var top=Math.floor(scrollTop/_this.rh);var bottom=top+viewport.height()/_this.rh;if(bottom>len)bottom=len;for(var i=top,child=content[0].children[i-top];i<bottom;i++,child=content[0].children[i-top]){var listItemWidget=document.createElement("div");listItemWidget.innerHTML=layout;for(var k=0;k<listItemWidget.children.length;k++){_this.createHtmlObjects(listItemWidget.children[k]);content.append(listItemWidget.children[k])}if(i==items.length-1){content.children().last().wrapAll("<li id='list_"+i+"' class='row_"+i+" top-listview-list  last-child' data-index='"+i+"' style='position: absolute; top: "+_this.rh*i+"px; height: "+_this.rh+"px; left: 0px; width: 100%;'></li>")}else if(i==0){content.children().last().wrapAll("<li id='list_"+i+"' class='row_"+i+" top-listview-list  first-child' data-index='"+i+"' style='position: absolute; top: "+_this.rh*i+"px; height: "+_this.rh+"px; left: 0px; width: 100%;'></li>")}else{content.children().last().wrapAll("<li id='list_"+i+"' class='row_"+i+" top-listview-list ' data-index='"+i+"' style='position: absolute; top: "+_this.rh*i+"px; height: "+_this.rh+"px; left: 0px; width: 100%;'></li>")}}dataBinding();setLiText();_this.createdItemWidgetAttachedCallback();_this.attachEventHandler();if(typeof _this.onScrollend==="function"){_this.onScrollend()}function dataBinding(){var topWidget=/^TOP-[a-zA-Z]*/;var i=0;var itemsLength=items.length;for(var i=top;i<bottom;i++){var keys=Object.keys(items[i]);var listChildren=root.querySelectorAll("#list_"+i+".row_"+i+" *");var topWidgets=[];var k=0;var listChildrenLength=listChildren.length;while(k<listChildrenLength){if(topWidget.test(listChildren[k].tagName))topWidgets.push(listChildren[k]);k++}var j=0;var keysLength=keys.length;while(j<keys.length){$.each(topWidgets,function(index){var attr=topWidgets[index].attributes;var l=0;var attrLength=attr.length;while(l<attrLength){if(attr[l].value==="{"+keys[j]+"}"){topWidgets[index].setAttribute(attr[l].name,items[i][keys[j]]);topWidgets[index][attr[l].name]=items[i][keys[j]];topWidgets[index].__updateProperties(attr[l].name)}l++}});j++}if(!listChildren[0].id)listChildren[0].id=Top.Util.guid();listChildren[0].dataIndex=i;topWidgets.forEach(function(_item){_item.id=_item.id+"_"+i;if(_item.tagName==="TOP-RADIOBUTTON"){if(_item.getAttribute("group-id")){_item.setAttribute("group-id",_item.getAttribute("group-id")+"_"+i)}}})}}function setLiText(){var listElement=root.querySelectorAll(".top-listview-list");var i=0;var listElementLength=listElement.length;while(i<listElementLength){var j=0;var len=listElement[i].childNodes.length;while(j<len){if(listElement[i].childNodes[j].tagName==="TOP-WIDGETITEM"&&listElement[i].childNodes[j].getAttribute("value")){listElement[i].setAttribute("value",listElement[i].childNodes[j].getAttribute("value"))}if(listElement[i].childNodes[j].tagName==="TOP-WIDGETITEM"&&listElement[i].childNodes[j].getAttribute("text")){listElement[i].setAttribute("text",listElement[i].childNodes[j].getAttribute("text"))}if(listElement[i].childNodes[j].tagName==="TOP-WIDGETITEM"&&listElement[i].childNodes[j].childElementCount===0){var text=listElement[i].childNodes[j].getAttribute("text");listElement[i].innerText=text}j++}i++}}}},renderLayout:function(){var _this=this;this.clearLayout();if(this.virtualScroll==="true"||this.virtualScroll===true){this.__renderVirtualLayout();return}if(this.items&&typeof this.items==="string"){var items=Top.Util.namespace(this.items,this);if(!Array.isArray(items))return}else if(typeof this.items==="object"){var items=this.items}else if(this.widgetItems){this.renderByWidgetItem();return}var layout=this.childTemplate===undefined||this.childTemplate===""?this.itemLayout:this.childTemplate;var switchedItem=this.getSwitchedItem();if(items===undefined)return;this.itemData=items;var root=this.childRoot;for(var i=0;i<items.length;i++){if(this.itemSwitchLogic){root.appendChild(switchedItem[i].outerHTML)}else{var listItemWidget=document.createElement("div");listItemWidget.innerHTML=layout;for(var k=0;k<listItemWidget.children.length;k++){this.createHtmlObjects(listItemWidget.children[k]);root.appendChild(listItemWidget.children[k])}}if(i==items.length-1){$(root).children().last().wrapAll("<li id='list_"+i+"' class='row_"+i+" top-listview-list  last-child' data-index='"+i+"'></li>")}else if(i==0){$(root).children().last().wrapAll("<li id='list_"+i+"' class='row_"+i+" top-listview-list  first-child' data-index='"+i+"'></li>")}else{$(root).children().last().wrapAll("<li id='list_"+i+"' class='row_"+i+" top-listview-list ' data-index='"+i+"'></li>")}}$(root).children().wrapAll("<ul data-role='listview' data-inset='true' class='top-listview-container'></ul>");var topWidget=/^TOP-[a-zA-Z]*/;var i=0;var itemsLength=items.length;while(i<itemsLength){var keys=Object.keys(items[i]);var listChildren=root.querySelectorAll("#list_"+i+".row_"+i+" *");var topWidgets=[];var k=0;var listChildrenLength=listChildren.length;while(k<listChildrenLength){if(topWidget.test(listChildren[k].tagName))topWidgets.push(listChildren[k]);k++}var j=0;var keysLength=keys.length;while(j<keys.length){$.each(topWidgets,function(index){var attr=topWidgets[index].attributes;var l=0;var attrLength=attr.length;while(l<attrLength){if(attr[l].value==="{"+keys[j]+"}"){topWidgets[index].setAttribute(attr[l].name,items[i][keys[j]]);topWidgets[index][attr[l].name]=items[i][keys[j]];topWidgets[index].__updateProperties(attr[l].name)}l++}});j++}if(!listChildren[0].id)listChildren[0].id=Top.Util.guid();listChildren[0].dataIndex=i;topWidgets.forEach(function(_item){_item.id=_item.id+"_"+i;if(_item.tagName==="TOP-RADIOBUTTON"){if(_item.getAttribute("group-id")){_item.setAttribute("group-id",_item.getAttribute("group-id")+"_"+i)}}});i++}var listElement=root.querySelectorAll(".top-listview-list");var i=0;var listElementLength=listElement.length;while(i<listElementLength){var j=0;var len=listElement[i].childNodes.length;while(j<len){if(listElement[i].childNodes[j].tagName==="TOP-WIDGETITEM"&&listElement[i].childNodes[j].getAttribute("value")){listElement[i].setAttribute("value",listElement[i].childNodes[j].getAttribute("value"))}if(listElement[i].childNodes[j].tagName==="TOP-WIDGETITEM"&&listElement[i].childNodes[j].getAttribute("text")){listElement[i].setAttribute("text",listElement[i].childNodes[j].getAttribute("text"))}if(listElement[i].childNodes[j].tagName==="TOP-WIDGETITEM"&&listElement[i].childNodes[j].childElementCount===0){var text=listElement[i].childNodes[j].getAttribute("text");listElement[i].innerText=text}j++}i++}if(this.headerItem&&this.headerItem.length>0){$(root).prepend("<label class='top-listview-header'></label>");if(this.headerItem[0].attributes["text"])root.querySelector(".top-listview-header").innerText=this.headerItem[0].attributes.text.nodeValue;if(this.headerItem[0].childElementCount>0)root.querySelector(".top-listview-header").innerHTML=this.headerItem[0].innerHTML}if(this.separatorVisible){if(this.separatorVisible===true||this.separatorVisible==="true"){var separatorSize=parseInt(this.separatorSize)||"";var separatorColor=this.separatorColor||"";$(root.querySelectorAll(".top-listview-list")).css("border-bottom-color",separatorColor);$(root.querySelectorAll(".top-listview-list")).css("border-bottom-width",separatorSize+"px")}else{$(root.querySelectorAll(".top-listview-list")).css("border-bottom","none")}}this.createdItemWidgetAttachedCallback();this.attachEventHandler()},initializeChildRoot:function(){return this.querySelector(".top-listview-root")},setAllTopStyle:function(){this.querySelector(".top-listview-root").style.cssText=this.topstyle},renderByWidgetItem:function(){this.clearItems();var items=this.makeItems(this.widgetItems);var subItems=[];this.itemData=items;var i=0;var thisWidgetItemsLength=this.widgetItems.length;while(i<thisWidgetItemsLength){if(this.widgetItems[i].childElementCount>0)subItems[i]=this.widgetItems[i].innerHTML;i++}var root=this.childRoot;var i=0;var itemsLength=items.length;while(i<itemsLength){
var liDom=document.createElement("li");var liId="list_"+i;var liClass="row_"+i;liDom.setAttribute("id",liId);liDom.classList.add(liClass);liDom.classList.add("top-listview-list");liDom.setAttribute("data-index",i);if(i==items.length-1){liDom.classList.add("last-child")}else if(i==0){liDom.classList.add("first-child")}root.appendChild(liDom);if(items[i]["text"])root.querySelector("#list_"+i).innerText=items[i]["text"];if(subItems[i])root.querySelector("#list_"+i).innerHTML=subItems[i];i++}$(root).children().wrapAll("<ul data-role='listview' data-inset='true' class='top-listview-container'></ul>");if(this.headerItem.length>0){var tempLabel=document.createElement("label");tempLabel.classList.add("top-listview-header");root.insertBefore(tempLabel,root.firstChild);if(this.headerItem[0].attributes["text"])root.querySelector(".top-listview-header").innerText=this.headerItem[0].attributes.text.nodeValue;if(this.headerItem[0].childElementCount>0)root.querySelector(".top-listview-header").innerHTML=this.headerItem[0].innerHTML}if(this.separatorVisible){if(this.separatorVisible===true||this.separatorVisible==="true"){var separatorSize=parseInt(this.separatorSize)||"";var separatorColor=this.separatorColor||"";$(root.querySelectorAll(".top-listview-list")).css("border-bottom-color",separatorColor);$(root.querySelectorAll(".top-listview-list")).css("border-bottom-width",separatorSize+"px")}else{$(root.querySelectorAll(".top-listview-list")).css("border-bottom","none")}}var allLis=root.querySelectorAll("li.top-listview-list");for(var i=0,len=allLis.length;i<len;i++){var li=allLis[i];for(var j=0,len2=li.children.length;j<len2;j++){li.children[j].layoutParent=this}}this.attachEventHandler()},attachEventHandler:function(){var rowSelected=this.rowSelected;if(typeof rowSelected=="string"){rowSelected=Top.Util.namespace(rowSelected,this)}var _this=this;var root=this.childRoot;var lastClickedIndex,lastClickedType,firstClickedIndex;var allListElements=root.querySelectorAll(".top-listview-container .top-listview-list");$(allListElements).off("click").on("click",function(e){var thisClickedIndex=this.getAttribute("data-index");if(_this.itemClicktype==="select"){if(e.shiftKey||e.ctrlKey){if(e.shiftKey){if(!lastClickedIndex)lastClickedIndex=0;if(!firstClickedIndex)firstClickedIndex=0;if(lastClickedType=="ctrl"||parseInt(lastClickedIndex)>parseInt(firstClickedIndex)&&parseInt(thisClickedIndex)<parseInt(firstClickedIndex)||parseInt(lastClickedIndex)<parseInt(firstClickedIndex)&&parseInt(thisClickedIndex)>parseInt(firstClickedIndex)){$(root.querySelectorAll(".top-listview-list.selected")).removeClass("selected");lastClickedIndex=firstClickedIndex}var selectedElement=root.querySelector(".top-listview-list[data-index='"+lastClickedIndex+"']");if(thisClickedIndex!==lastClickedIndex){while(true){selectedElement.classList.add("selected");if(selectedElement.getAttribute("data-index")===thisClickedIndex)break;selectedElement=thisClickedIndex>lastClickedIndex?selectedElement.nextSibling:selectedElement.previousSibling}}else if(thisClickedIndex===lastClickedIndex){selectedElement.classList.add("selected")}lastClickedType="shift"}else if(e.ctrlKey){if(this.classList){this.classList.toggle("selected")}else{var classes=this.className.split(" ");var existingIndex=classes.indexOf("selected");if(existingIndex>=0)classes.splice(existingIndex,1);else classes.push("selected");this.className=classes.join(" ")}lastClickedType="ctrl";firstClickedIndex=thisClickedIndex}var allListHasSelected=root.querySelectorAll(".top-listview-list.selected");_this.selectedItemIndex=[];var len=allListHasSelected.length;var i=0;while(i<len){var item=allListHasSelected[i];_this.selectedItemIndex.push(item.getAttribute("data-index"));i++}lastClickedIndex=thisClickedIndex}else{$(root.querySelectorAll(".top-listview-list.selected")).removeClass("selected");this.classList.add("selected");_this.selectedItemIndex=thisClickedIndex;lastClickedIndex=thisClickedIndex;lastClickedType="";firstClickedIndex=thisClickedIndex}}else if(_this.itemClicktype==="click"){_this.clickedItemIndex=thisClickedIndex}if(typeof rowSelected==="function"){if(Top.App.__compatibleWithTOP()){_this.clickedItemIndex=thisClickedIndex;rowSelected(e,Top.Dom.selectById(_this.id))}else{rowSelected(thisClickedIndex)}}_this.__dispatchEvent(new CustomEvent("rowclick"))})},makeItems:function(parent){var len=parent.length;var node=[];var i=0;while(i<len){var obj={};obj["text"]=parent[i].getAttribute("text");obj["value"]=parent[i].getAttribute("value");node[i]=obj;i++}return node},__update:function(){this.renderLayout();this.updateStyle()},__updateItems:function(){if(this.__initialized===true){this.renderLayout()}},getSelectedIndex:function(){return this.selectedItemIndex},getSelectedData:function(){if(this.selectedItemIndex instanceof Array){var len=this.selectedItemIndex.length;var selectedData=[];var i=0;while(i<len){selectedData.push(this.itemData[this.selectedItemIndex[i]]);i++}return selectedData}else{return this.itemData[this.selectedItemIndex]}},getClickedIndex:function(){return this.clickedItemIndex},getClickedData:function(){return this.itemData[this.clickedItemIndex]},__selectData:function(index){var selectedList;var root=this.childRoot;if(index instanceof Array){var i=0;var indexLength=index.length;while(i<indexLength){if(typeof index[i]==="number"){selectedList=root.querySelector(".top-listview-list[data-index='"+index[i]+"']")}$(selectedList).trigger($.Event("click",{ctrlKey:true}));i++}}else{if(typeof index==="number"){selectedList=root.querySelector(".top-listview-list[data-index='"+index+"']")}$(selectedList).click()}},__updateOnRowclick:function(){this.__addEventByAttr("rowclick")},getTopStyle:function(){this.topstyle=this.querySelector("div").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector("div");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector("div").style.cssText=this.topstyle}};Top.Widget.Container.Listview=function(){Listview.prototype=Object.create(Top.Widget.Container.prototype);Listview.prototype.constructor=Listview;function Listview(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-listview");this.template.innerHTML='<div class="top-listview-root"></div>'}this.id=this.template.id}Listview.create=function(element){return new Listview(element)};Listview.prototype.addLayout=function(layout){this.template.itemLayout=$(layout.template).wrap("<p/>").parent().html();$(layout.template).unwrap()};Listview.prototype.getSelectedIndex=function(){return this.template.getSelectedIndex()};Listview.prototype.getSelectedData=function(){return this.template.getSelectedData()};Listview.prototype.getClickedIndex=function(){return this.template.getClickedIndex()};Listview.prototype.getClickedData=function(){return this.template.getClickedData()};Listview.prototype.selectData=function(index){this.template.__selectData(index)};return Listview}();TopMenu={is:"top-menu",behaviors:[TopWidgetBehavior,TopTextBehavior,TopMenuBehavior],properties:{items:{type:String},type:{type:Object,reflectToAttribute:true},init:{type:String,value:false},position:String,placement:String,autoClose:String,listMaxHeight:String,listLocation:String,icon:String,animation:String,selectedNode:Object,onOpen:String,onClose:String,onSelect:String,onItemclick:String},__ready:function(){this.__initialize()},appendTemplate:function(){this.innerHTML='<div class="top-menu">'+this.innerHTML+"</div>";this.__isTemplateAppended=true},expectedTemplateClassName:function(){return"top-menu"},__initialize:function(){this.initMenuItems();if(this.type!=="floating"){var tempDiv=document.createElement("div");tempDiv.classList.add("top-menu-root");this.childRoot.appendChild(tempDiv)}this.__updateId();this.__updateItems();this.__initialClassname();this.dataName=this.items?Top.Util.getDataName(this.items):"";this.autoClose=this.autoClose==="true"||this.autoClose===true;this.__initAnimation();this.__isRendered=true},__updateId:function(){if(this.id){this.childRoot.id=this.id}},initializeChildRoot:function(){return this.firstElementChild},__initEventInternal:function(){this.__addEventByAttr("itemclick")},__initAnimation:function(){if(Top.App.__compatibleWithTOP()){if(this.animation==="true")this.animation=true;else this.animation=false}else{if(this.animation===undefined||this.animation==="true")this.animation=true;else this.animation=false}},__attached2:function(){if(this.type==="floating")this.attachEventHandlerforFloating();else if(this.type==="side")this.attachEventHandlerforSide();else if(this.type==="dropdown")this.attachEventHandlerforDropdown();else if(this.type==="drawer")this.attachEventHandlerforDrawer();else if(this.type==="header")this.attachEventHandlerforHeader();else if(this.type==="cascading")this.attachEventHandlerforCascading();this.__initBoundData()},__detached:function(){this.__detachEventHandler()},renderFloating:function(){this.clearMenuItems();if(this.items){if(typeof this.items==="string"){var items=Top.Util.namespace(this.items,this);if(!Array.isArray(items))return}else{var items=this.items}}else if(this.menuItems){var items=this.makeItems(this.menuItems)}if(items===undefined)return;this.setDepth(items);var ulId=Top.Util.guid();var str=document.createElement("ul");str.setAttribute("id",ulId);str.innerHTML=this.makeMenu(items);var root=this;root.appendChild(str);if(this.menuLayout)this.bindDataToTopWidget(items,1);$(root.querySelector("#"+ulId)).slicknav({prependTo:this,label:""})},renderSide:function(){var checkClass02=/\b(menu_02)\b/g;var isMenu02=false;isMenu02=checkClass02.test(this.classList.value)?true:false;if(Top.Util.Browser.isIE())isMenu02=checkClass02.test(this.classList[0])?true:false;this.clearMenuItems();if(this.items){if(typeof this.items==="string"){var items=Top.Util.namespace(this.items,this);if(!Array.isArray(items))return}else{var items=this.items}}else if(this.menuItems){var items=this.makeItems(this.menuItems)}if(items===undefined)return;this.setDepth(items);if(this.placement===undefined)this.placement="left";this.childRoot.classList.remove("placement_left");this.childRoot.classList.remove("placement_right");this.childRoot.classList.add("placement_"+this.placement);var root=this.childRoot;var str="<div class='top-menu-container'><ul class='top-menu_nav'>";str+=this.makeMenu(items);str+="</ul></div>";$(root.firstElementChild).html(str);if(this.menuLayout)this.bindDataToTopWidget(items,1);var sideMenu=this;this.selectedList=[];$(root.querySelectorAll(".top-menu_nav ul")).hide();$(root.querySelectorAll(".top-menu_nav ul")).children(".current").parent().show();var li=root.querySelectorAll(".top-menu_nav li");for(var i=0;i<li.length;i++){if(li[i].lastChild.tagName=="UL"){li[i].classList.add("top-menu_parent");li[i].classList.add("top-menu_collapsed");if(isMenu02){var iDom=document.createElement("i");iDom.classList.add("top-menu_arrow");iDom.classList.add("icon-arrow_potab_down");li[i].getElementsByClassName("top-menu_item_inner")[0].appendChild(iDom)}}}if(this.layoutTop){root.getElementsByClassName("top-menu-container").style.height="calc(100% - "+this.layoutTop+")"}if(this.placement=="right"){this.layoutRight="0px";this.__updateLayoutRight()}},renderDropdown:function(){this.clearMenuItems();if(this.items){if(typeof this.items==="string"){var items=Top.Util.namespace(this.items,this);if(!Array.isArray(items))return}else{var items=this.items}}else if(this.menuItems){var items=this.makeItems(this.menuItems)}if(items===undefined)return;this.setDepth(items);var root=this.childRoot;var str="<a class='top-menu_btn top-menu_collapsed'><i class='top-menu_title_icon "+this.icon+"'></i><span class='top-menu_title' style='color: "+this.textColor+"; font-size: "+this.textSize+"; font-style: "+this.textStyle+"; font-weight: "+this.textWeight+";'>"+this.title+"</span><i class='icon-arrow_filled_down'></i></a><ul class='top-menu_nav'>";str+=this.makeMenu(items);str+="</ul>";$(root.firstElementChild).html(str);$(root.querySelector(".top-menu_nav")).css("display","none");var li=root.querySelectorAll(".top-menu_nav li");for(var i=0;i<li.length;i++){if(li[i].lastChild.tagName=="UL"){li[i].classList.add("top-menu_parent");li[i].classList.add("top-menu_collapsed");$("<i class='top-menu_arrow icon-arrow_filled_right'></i>").insertBefore(li[i].querySelector("ul"))}}if(this.listMaxHeight){this.querySelector(".top-menu_nav").style.maxHeight=this.listMaxHeight;this.querySelector(".top-menu_nav").style.overflowY="scroll"}else this.querySelector(".top-menu_nav").style.overflowY="";if(this.menuLayout)this.bindDataToTopWidget(items,1)},renderDrawer:function(){var root=this.childRoot;if($(root).find(".top-menu_btn").hasClass("top-menu_collapsed"))var isClosed=true;this.clearMenuItems();if(this.items){if(typeof this.items==="string"){var items=Top.Util.namespace(this.items,this);if(!Array.isArray(items))return}else{var items=this.items}}else if(this.menuItems){var items=this.makeItems(this.menuItems)}if(items===undefined)return;this.setDepth(items);if(isClosed)var str="<div class='top-menu-container'><button class='top-menu_btn top-menu_collapsed'></button><ul class='top-menu_nav' style='display: none;'>";else var str="<div class='top-menu-container'><button class='top-menu_btn top-menu_open'></button><ul class='top-menu_nav'>";str+=this.makeMenu(items);str+="</ul></div>";$(root.firstElementChild).html(str);if(this.menuLayout)this.bindDataToTopWidget(items,1);$(root.querySelectorAll(".top-menu_nav ul")).hide();var li=root.querySelectorAll(".top-menu_nav li");for(var i=0;i<li.length;i++){if(li[i].lastChild.tagName=="UL"){li[i].classList.add("top-menu_parent");li[i].classList.add("top-menu_collapsed")}}if(this.onOpen)this.onOpen();var icons=root.querySelectorAll(".top-menu-container > ul > li > a > i.top-menu_icon");for(var i=0,len=icons.length;i<len;i++){if(!icons[i].className.includes("icon-")){icons[i].style.paddingRight="0px"}}},renderHeader:function(){var root=this.childRoot;this.clearMenuItems();if(this.items){if(typeof this.items==="string"){var items=Top.Util.namespace(this.items,this);if(!Array.isArray(items))return}else{var items=this.items}}else if(this.menuItems){var items=this.makeItems(this.menuItems)}if(items===undefined)return;this.setDepth(items);if(this.placement===undefined){this.placement="vertical"}this.childRoot.classList.remove("placement_vertical");this.childRoot.classList.remove("placement_horizontal");this.childRoot.classList.add("placement_"+this.placement);var str="<div class='top-menu-container'><ul class='top-menu_nav'>";str+=this.makeMenu(items);str+="</ul></div>";$(root.firstElementChild).html(str);if(this.menuLayout)this.bindDataToTopWidget(items,1);$(root.querySelectorAll(".top-menu_nav ul")).hide();$(".depth3").remove();var li=root.querySelectorAll(".top-menu_nav li");var i=0;var liLength=li.length;while(i<liLength){if(li[i].lastChild.tagName=="UL"&&!li[i].classList.contains("depth2")){li[i].classList.add("top-menu_parent");li[i].classList.add("top-menu_collapsed");var iDom=document.createElement("i");iDom.classList.add("top-menu_arrow");iDom.classList.add("icon-arrow_down");li[i].appendChild(iDom)}i++}},renderCascading:function(){var root=this.childRoot;this.clearMenuItems();this.menuArray=[];if(this.items){if(typeof this.items==="string"){var items=Top.Util.namespace(this.items,this);if(!Array.isArray(items))return}else{var items=this.items}}else if(this.menuItems){var items=this.makeItems(this.menuItems)}if(items===undefined)return;this.setDepth(items);var str="<div class='top-menu-container'><ul class='top-menu_nav'>";str+=this.makeMenu(items);str+="</ul></div>";$(root.firstElementChild).html(str);if(this.menuLayout)this.bindDataToTopWidget(items,1);var li=root.querySelectorAll(".top-menu_nav li");var i=0;var liLength=li.length;while(i<liLength){if(li[i].lastChild.tagName=="UL"){li[i].classList.add("top-menu_parent");li[i].classList.add("top-menu_collapsed");$("<i class='top-menu_arrow icon-arrow_filled_left'></i>").insertBefore(li[i].querySelector("ul"))}i++}},makeItems:function(parent){var len=parent.length;var item=[];for(var i=0;i<len;i++){var obj={};obj["text"]=parent[i].getAttribute("text");obj["selected"]=parent[i].getAttribute("selected");obj["divider"]=parent[i].getAttribute("divider");obj["id"]=parent[i].getAttribute("id");obj["icon"]=parent[i].getAttribute("icon");obj["image"]=parent[i].getAttribute("image");obj["onClick"]=parent[i].getAttribute("onClick");if(parent[i].children.length>0){obj["children"]=this.makeItems(parent[i].children)}item[i]=obj}return item},makeMenu:function(item){var str="",id="";var len=item.length;var className=this.type==="floating"?"":"top-menu_item ";for(var i=0;i<len;i++){if(item[i].children){str+="<li class='"+className+"depth"+item[i].depth+(item[i].divider===true||item[i].divider==="true"?" divider":"")+"'>"+(this.menuLayout?this.__setMenuLayout(item[i]):this.getAnchor(item[i]))+"<ul>";str+=this.makeMenu(item[i].children);str+="</ul></li>"}else{str+="<li class='"+className+"depth"+item[i].depth+(item[i].divider===true||item[i].divider==="true"?" divider":"")+"'>"+(this.menuLayout?this.__setMenuLayout(item[i]):this.getAnchor(item[i]))+"</li>"}if(item[i].onClick){if(typeof item[i].onClick==="function")var fnOnClick=item[i].onClick;else if(typeof item[i].onClick==="string")var fnOnClick=Top.Util.namespace(item[i].onClick,this);if(this.itemOnClick===undefined)this.itemOnClick={};this.itemOnClick[item[i].id]=fnOnClick}}return str},getAnchor:function(item){var a="<a class='top-menu_item_inner inner_depth"+item.depth;var id="";var selected="";var icon="";var text="";var img="";var fnOnClick;if(item.id)id=" top-menu_"+this.id+"_"+item.id;if(item.selected)selected=item.selected.startsWith("/")?selected="' href = 'javascript:Top.App.routeTo(\""+item.selected+'")':"' href='"+item.selected;selected+="'>";if(item.icon)icon="<i class='top-menu_icon "+item.icon+" icon_depth"+item.depth+"'></i>";else if(item.image)img="<img class='top-menu_image' src='"+item.image+"'/>";else icon="<i class='top-menu_icon icon_depth"+item.depth+"'></i>";if(item.text)text="<span class='top-menu_text text_depth"+item.depth+"'>"+this.__i18n(item.text)+"</span>";a=a+id+selected+icon+img+text+"</a>";return a},__setMenuLayout:function(){var str="<a class='top-menu_item_inner'>";str+=this.menuLayout;str+="</a>";return str},bindDataToTopWidget:function(item,depth,parentNode){if(!parentNode)parentNode=this.childRoot;var topWidget=/^TOP-[a-zA-Z]*/;var itemElement=parentNode.querySelectorAll(".top-menu_item.depth"+depth);for(var i=0;i<item.length;i++){var keys=Object.keys(item[i]);var listChildren=$(itemElement[i]).find("> .top-menu_item_inner  *");var itemInnerElem=$(itemElement[i]).find("> .top-menu_item_inner");var topWidgets=[];for(var k=0;k<listChildren.length;k++)if(topWidget.test(listChildren[k].tagName))topWidgets.push(listChildren[k]);for(var j=0;j<keys.length;j++){$.each(topWidgets,function(index,_item){var attr=topWidgets[index].attributes;for(var l=0;l<attr.length;l++){if(attr[l].value==="{"+keys[j]+"}"){topWidgets[index].setAttribute(attr[l].name,item[i][keys[j]]);topWidgets[index].__updateProperties(attr[l].name)}}if(keys[j]==="id"){_item.id=_item.id+"_"+item[i][keys[j]]}});if(keys[j]==="id"){itemInnerElem.addClass("top-menu_"+this.id+"_"+item[i][keys[j]])}}topWidgets.forEach(function(_item){if(typeof _item.__renderedImpl==="function"){_item.__renderedImpl()}if(typeof _item.__adjustWidgets==="function"){_item.__adjustWidgets()}});if(item[i].children&&item[i].children.length>0){this.bindDataToTopWidget(item[i].children,depth+1,itemElement[i])}}},getMaxWidth:function(){var nodes=this.childRoot.getElementsByTagName("li");var len=nodes.length;var maxText="";var temp="";for(var i=0;i<len;i++){temp=$(nodes[i]).children("a").text();if(temp.length>maxText.length){maxText=temp}}String.prototype.width=function(){var f="13px arial",o=$("<div>"+this+"</div>").css({position:"absolute",float:"left","white-space":"nowrap",visibility:"hidden",font:f}).appendTo($("body")),w=o.width();o.remove();return w};return maxText.width()+110},attachEventHandlerforFloating:function(){var thisMenu=this;var checkReg=new RegExp("^top-menu_"+this.id+"_");var shadowRoot=this.firstElementChild;this.childRoot.remove();this.childRoot=shadowRoot;shadowRoot.classList.add("Menu_type_floating");$(document).off("mouseleave","#"+this.id).on("mouseleave","#"+this.id,function(){$(thisMenu.childRoot.lastChild).slicknav("close");if(this.onClose)this.onClose()});$(document).off("click","#"+this.id+' li:not(.top-menu_parent) a[role="menuitem"]').on("click","#"+this.id+' li:not(.top-menu_parent) a[role="menuitem"]',function(){var itemList=thisMenu.childRoot.querySelectorAll('li:not(.top-menu_parent) a[role="menuitem"]');var selectedItem=this;var selectedParentNode=selectedItem.parentNode.parentNode.parentNode;for(var i=0;i<itemList.length;i++){if(itemList[i]==selectedItem){if(!$(itemList[i]).hasClass("selected"))itemList[i].classList.add("selected")}else{var itemListParentNode=itemList[i].parentNode.parentNode.parentNode;if($(itemList[i]).hasClass("selected"))itemList[i].classList.remove("selected");if(itemListParentNode!=selectedParentNode&&$(itemListParentNode).hasClass("top-menu_open")&&$(itemListParentNode).hasClass("depth2")){$(itemListParentNode.querySelector("a > a")).trigger("click")}}if($(itemList[i]).hasClass("selected")&&$(itemList[i].parentNode).hasClass("depth3")){itemList[i].parentNode.classList.add("selected")}else if(!$(itemList[i]).hasClass("selected")&&$(itemList[i].parentNode).hasClass("depth3")){itemList[i].parentNode.classList.remove("selected")}}for(var i=0;i<this.classList.length;i++){if(checkReg.test(this.classList[i])){thisMenu.selectedMenuId=this.classList[i].replace("top-menu_"+thisMenu.id+"_","");break}}});$(document).off("click","#"+this.id+" .top-menu_nav .top-menu_item_inner").on("click","#"+this.id+" .top-menu_nav .top-menu_item_inner",function(e){if(typeof thisMenu.onSelect==="function"){thisMenu.onSelect(thisMenu.selectedMenuId)}if(Top.Util.Browser.isIE()){thisMenu.__dispatchEvent(new CustomEvent("itemclick"))}else{thisMenu.__dispatchEvent(new Event("itemclick"))}if(thisMenu.selectedMenuId in thisMenu.itemOnClick){thisMenu.itemOnClick[thisMenu.selectedMenuId](event,Top.Dom.selectById(thisMenu.id))}if(!$(this).parent().hasClass("top-menu_parent")){e.stopPropagation()}});$(document).off("#"+this.id+" .top-menu_btn").on("click","#"+this.id+" .top-menu_btn",function(){if($(this).hasClass("top-menu_collapsed")){if(thisMenu.onClose)thisMenu.onClose()}else{if(thisMenu.onOpen)thisMenu.onOpen()}})},attachEventHandlerforSide:function(){var sideMenu=this;this.childRoot.classList.add("Menu_type_side");this.childRoot.classList.add("menu_01");var checkReg=new RegExp("^top-menu_"+this.id+"_");var checkClass02=/\b(menu_02)\b/g;var width=sideMenu.getMaxWidth();$(this.childRoot).find(".top-menu_nav").css("width",width);if(checkClass02.test(this.classList.value)){this.childRoot.classList.remove("menu_01");this.childRoot.classList.add("menu_02");$(document).off("click","#"+this.id+" .top-menu_nav .top-menu_parent").on("click","#"+this.id+" .top-menu_nav .top-menu_parent",function(){if($(this).hasClass("top-menu_collapsed")){var $otherOpenedParent=$(sideMenu.childRoot).find(".top-menu_parent.selected");$otherOpenedParent.removeClass("selected").removeClass("top-menu_open").addClass("top-menu_collapsed");$otherOpenedParent.find("> ul").slideUp();$otherOpenedParent.find(">.top-menu_item_inner .top-menu_arrow").toggleClass("icon-arrow_potab_down").toggleClass("icon-arrow_potab_up");this.classList.remove("top-menu_collapsed");this.classList.add("top-menu_open");this.classList.add("selected");$(this).find("> ul").slideDown();$(this).find("> .top-menu_item_inner .top-menu_arrow").toggleClass("icon-arrow_potab_down").toggleClass("icon-arrow_potab_up")}else{this.classList.remove("top-menu_open");this.classList.add("top-menu_collapsed");this.classList.remove("selected");$(this).find("> ul").slideUp();$(this).find("> .top-menu_item_inner .top-menu_arrow").toggleClass("icon-arrow_potab_down").toggleClass("icon-arrow_potab_up")}});$(document).off("click","#"+this.id+" .top-menu_nav .top-menu_item:not(.top-menu_parent)").on("click","#"+this.id+" .top-menu_nav .top-menu_item:not(.top-menu_parent)",function(e){$(sideMenu.childRoot).find(".selected:not(.top-menu_parent)").removeClass("selected");this.classList.add("selected");$(this.querySelector(".top-menu_item_inner")).click();e.stopPropagation()});$(document).off("click","#"+this.id+" .top-menu_nav .top-menu_item_inner").on("click","#"+this.id+" .top-menu_nav .top-menu_item_inner",function(e){for(var i=0;i<this.classList.length;i++){if(checkReg.test(this.classList[i])){sideMenu.selectedMenuId=this.classList[i].replace("top-menu_"+sideMenu.id+"_","");break}}if(typeof sideMenu.onSelect==="function"){sideMenu.onSelect(sideMenu.selectedMenuId)}if(Top.Util.Browser.isIE()){sideMenu.__dispatchEvent(new CustomEvent("itemclick"))}else{sideMenu.__dispatchEvent(new Event("itemclick"))}if(sideMenu.selectedMenuId in sideMenu.itemOnClick){sideMenu.itemOnClick[sideMenu.selectedMenuId](event,Top.Dom.selectById(sideMenu.id))}if(!$(this).parent().hasClass("top-menu_parent")){e.stopPropagation()}})}else{$(document).off("mouseenter","#"+this.id+" .placement_right .top-menu-container").on("mouseenter","#"+this.id+" .placement_right .top-menu-container",function(){$(this).css("margin-left","-"+sideMenu.getMaxWidth()+"px")});$(document).off("mouseleave","#"+this.id+" .placement_right .top-menu-container").on("mouseleave","#"+this.id+" .placement_right .top-menu-container",function(){$(this).css("margin-left","")});$(document).off("click","#"+this.id+" .top-menu_nav li a").on("click","#"+this.id+" .top-menu_nav li a",function(){var checkElement=$(this).next();if(checkElement.is("ul")){var selected=$("ul.selected");var len=selected.length;for(var i=0;i<len;i++){if(selected[i]!=this&&selected[i]!=this.parentNode.parentNode){$(selected[i]).slideUp();$(selected[i]).removeClass("selected");$(selected[i].parentNode).removeClass("top-menu_open");$(selected[i].parentNode).addClass("top-menu_collapsed")}}if(checkElement.is(":visible")){checkElement.slideUp();$(checkElement[0].parentNode).removeClass("top-menu_open");$(checkElement[0].parentNode).addClass("top-menu_collapsed")}else{$(checkElement).addClass("selected");checkElement.slideDown();$(checkElement[0].parentNode).removeClass("top-menu_collapsed");$(checkElement[0].parentNode).addClass("top-menu_open")}return false}else{$(sideMenu.childRoot.querySelector(".active")).removeClass("active");$(this).addClass("active");sideMenu.selectedNode=this.parentNode}for(var i=0;i<this.classList.length;i++){if(checkReg.test(this.classList[i])){sideMenu.selectedMenuId=this.classList[i].replace("top-menu_"+sideMenu.id+"_","");break}}if(typeof sideMenu.onSelect==="function"){sideMenu.onSelect(sideMenu.selectedMenuId)}if(Top.Util.Browser.isIE()){sideMenu.__dispatchEvent(new CustomEvent("itemclick"))}else{sideMenu.__dispatchEvent(new Event("itemclick"))}});$(document).off("mouseleave","#"+this.id+" .top-menu-container").on("mouseleave","#"+this.id+" .top-menu-container",function(){$(this).css("width","50px");$(this).find(" .top-menu_nav ul:visible").slideUp();$(this).find(".top-menu_parent").removeClass("top-menu_open");$(this).find(".top-menu_parent").addClass("top-menu_collapsed");if(sideMenu.onClose)sideMenu.onClose()});$(document).off("mouseenter","#"+this.id+" .top-menu-container").on("mouseenter","#"+this.id+" .top-menu-container",function(){sideMenu.sideOpen(sideMenu.selectedNode);if(sideMenu.onOpen)sideMenu.onOpen()})}$(this.childRoot).find(".top-menu-container").css("width","50px")},attachEventHandlerforDropdown:function(){var _this=this;var checkReg=new RegExp("^top-menu_"+this.id+"_");var shadowRoot=this.childRoot.firstElementChild;this.childRoot.classList.add("Menu_type_dropdown");function closeMenuItem(menuElem){if(!menuElem)return;var childMenu_ul=menuElem.querySelector("ul");menuElem.classList.remove("selected");menuElem.classList.remove("top-menu_open");menuElem.classList.add("top-menu_collapsed");childMenu_ul.style.display="none";var childMenuItem_li=$(childMenu_ul).find("> .selected");if(childMenuItem_li.length>0&&childMenuItem_li.hasClass("top-menu_parent")){for(var i=0;i<childMenuItem_li.length;i++)closeMenuItem(childMenuItem_li[i])}}function openMenuItem(menuElem){if(!menuElem)return;var parent_ul=menuElem.parentNode;var childMenu_ul=menuElem.querySelector("ul");menuElem.classList.add("selected");menuElem.classList.add("top-menu_open");menuElem.classList.remove("top-menu_collapsed");if(childMenu_ul){childMenu_ul.style.display="block";childMenu_ul.style.top=(parent_ul.clientHeight-parent_ul.offsetHeight)/2+"px";childMenu_ul.style.left=menuElem.offsetLeft+menuElem.offsetWidth+"px"}}$(document).off("click","#"+this.id+" .top-menu_btn.top-menu_collapsed").on("click","#"+this.id+" .top-menu_btn.top-menu_collapsed",function(){$('top-menu[type="dropdown"] .top-menu_btn.top-menu_open').click();var thisNav=_this.childRoot.querySelector(".top-menu_nav");var thisIcon=this.querySelector(".icon-arrow_filled_down");this.classList.add("top-menu_open");this.classList.remove("top-menu_collapsed");$(thisNav).css("display","block");thisIcon.classList.add("icon-arrow_filled_up");thisIcon.classList.remove("icon-arrow_filled_down");if(_this.onOpen)_this.onOpen();_this.setDropdownPosition()});$(document).off("click","#"+this.id+" .top-menu_btn.top-menu_open").on("click","#"+this.id+" .top-menu_btn.top-menu_open",function(){var thisNav=_this.childRoot.querySelector(".top-menu_nav");var thisIcon=this.querySelector(".icon-arrow_filled_up");this.classList.add("top-menu_collapsed");this.classList.remove("top-menu_open");$(thisNav).css("display","none");thisIcon.classList.add("icon-arrow_filled_down");thisIcon.classList.remove("icon-arrow_filled_up");if(_this.onClose)_this.onClose();thisNav.style.top="";thisNav.style.left="";thisNav.style.width="";thisNav.style.right="";thisNav.style.bottom=""});$(document).on("click","#"+this.id+" .top-menu_item.top-menu_collapsed:not(.top-menu_open)",function(e){var parent_ul=this.parentNode;var prevSelectedItem=$(parent_ul).find("> .selected");if(prevSelectedItem){if(prevSelectedItem.hasClass("top-menu_parent"))closeMenuItem(prevSelectedItem[0]);else prevSelectedItem.removeClass("selected")}openMenuItem(this);e.stopPropagation()});$(document).on("click","#"+this.id+" .top-menu_item.top-menu_open:not(.top-menu_collapsed)",function(e){closeMenuItem(this);e.stopPropagation()});$(document).on("click","#"+this.id+" .top-menu_item:not(.top-menu_parent)",function(e){var innerItem=this.querySelector(".top-menu_item_inner");for(var i=0;i<innerItem.classList.length;i++){if(checkReg.test(innerItem.classList[i])){_this.selectedMenuId=innerItem.classList[i].replace("top-menu_"+_this.id+"_","");break}}if(typeof _this.onSelect==="function"){_this.onSelect(_this.selectedMenuId,Top.Dom.selectById(_this.id))}if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("itemclick"))}else{_this.__dispatchEvent(new Event("itemclick"))}if(_this.selectedMenuId in _this.itemOnClick){_this.itemOnClick[_this.selectedMenuId](event,Top.Dom.selectById(sideMenu.id))}var parent_ul=this.parentNode;var prevSelectedItem=$(parent_ul).find("> .selected");if(prevSelectedItem){if(prevSelectedItem.hasClass("top-menu_parent"))closeMenuItem(prevSelectedItem[0]);else prevSelectedItem.removeClass("selected")}this.classList.add("selected");if(_this.autoClose)$(_this.childRoot.querySelector(".top-menu_btn.top-menu_open")).click();e.stopPropagation()});$(document).off("mousedown click","#"+this.id).on("mousedown click","#"+this.id,function(e){e.stopPropagation()});$(document).off("mouseleave","#"+this.id).on("mouseleave","#"+this.id,function(e){$(_this.childRoot.querySelector(".top-menu_btn.top-menu_open")).click();
e.stopPropagation()})},attachEventHandlerforDrawer:function(){var drawerMenu=this;var checkReg=new RegExp("^top-menu_"+this.id+"_");var shadowRoot=this.childRoot;shadowRoot.classList.add("Menu_type_drawer");$(document).off("click","#"+this.id+" .top-menu_nav li a").on("click","#"+this.id+" .top-menu_nav li a",function(e){var thisLI=this.parentNode;$(drawerMenu.childRoot).find(".selected").removeClass("selected");var opened_LIs=$(drawerMenu.childRoot).find("li.top-menu_open");var parent_LIs=$(this).closest("ul").parents("li");$.each(opened_LIs,function(index,openedLI){var isParent=false;$.each(parent_LIs,function(_index,parent_li){if(openedLI===parent_li)isParent=true});if(openedLI===thisLI)isParent=true;if(!isParent){drawerMenu.animation===true?$(openedLI).find("> ul").slideUp():$(openedLI).find("> ul").hide();openedLI.classList.remove("top-menu_open");openedLI.classList.add("top-menu_collapsed")}});this.classList.add("selected");$(drawerMenu.childRoot).find("li.depth1.active").removeClass("active");var activeDepth1=$(this).parents("li.depth1")[0];activeDepth1.classList.add("active");if($(thisLI).hasClass("top-menu_open")){drawerMenu.animation===true?$(thisLI).find("> ul").slideUp():$(thisLI).find("> ul").hide();thisLI.classList.remove("top-menu_open");thisLI.classList.add("top-menu_collapsed");if($(thisLI).hasClass("depth1")){$(activeDepth1).removeClass("active")}}else if($(this.parentNode).hasClass("top-menu_collapsed")){drawerMenu.animation===true?$(thisLI).find("> ul").slideDown():$(thisLI).find("> ul").show();thisLI.classList.remove("top-menu_collapsed");thisLI.classList.add("top-menu_open")}for(var i=0;i<this.classList.length;i++){if(checkReg.test(this.classList[i])){drawerMenu.selectedMenuId=this.classList[i].replace("top-menu_"+drawerMenu.id+"_","");break}}if(typeof drawerMenu.onSelect==="string"){drawerMenu.onSelect=Top.Util.namespace(drawerMenu.onSelect,drawerMenu)}if(typeof drawerMenu.onSelect==="function"){drawerMenu.onSelect(drawerMenu.selectedMenuId)}if(Top.Util.Browser.isIE()){drawerMenu.__dispatchEvent(new CustomEvent("itemclick"))}else{drawerMenu.__dispatchEvent(new Event("itemclick"))}if(drawerMenu.selectedMenuId in drawerMenu.itemOnClick){drawerMenu.itemOnClick[drawerMenu.selectedMenuId](event,Top.Dom.selectById(drawerMenu.id))}});$(document).off("click","#"+this.id+" .top-menu_nav li.depth3 > a").on("click","#"+this.id+" .top-menu_nav li.depth3 > a",function(){var menuItemDepth3=$("li.depth3 a");for(var i=0;i<menuItemDepth3.length;i++){if($(menuItemDepth3[i]).hasClass("selected"))$(menuItemDepth3[i].parentNode).addClass("selected");else $(menuItemDepth3[i].parentNode).removeClass("selected")}});var originWidth=0;var originHeight=0;$(document).off("click","#"+this.id+" .top-menu_btn").on("click","#"+this.id+" .top-menu_btn",function(){if(originWidth===0)originWidth=shadowRoot.offsetWidth;if(originHeight===0)originHeight=shadowRoot.offsetHeight;if($(this).hasClass("top-menu_open")){this.classList.add("top-menu_collapsed");this.classList.remove("top-menu_open");var btnWidth=this.offsetWidth;$(this.nextSibling).css("display","none");$(shadowRoot).css("width",btnWidth);if(!drawerMenu.layoutHeight||drawerMenu.layoutHeight==="auto"){$(shadowRoot).css("height",originHeight)}if(drawerMenu.onClose)drawerMenu.onClose()}else{this.classList.add("top-menu_open");this.classList.remove("top-menu_collapsed");$(this.nextSibling).css("display","");$(shadowRoot).css("width",originWidth);if(drawerMenu.layoutHeight==="auto"){$(shadowRoot).css("height","auto")}if(drawerMenu.onOpen)drawerMenu.onOpen()}})},attachEventHandlerforHeader:function(){var _this=this;var checkReg=new RegExp("^top-menu_"+this.id+"_");var menuRoot=this.childRoot.firstElementChild;this.childRoot.classList.add("Menu_type_header");$(document).off("mouseenter","#"+this.id+" .depth1.top-menu_parent.top-menu_collapsed").on("mouseenter","#"+this.id+" .depth1.top-menu_parent.top-menu_collapsed",function(){var list_elem=this.querySelector("ul");if(Top.Util.Browser.isIE()){$(_this.childRoot.querySelector(".top-menu_open")).mouseleave();list_elem.style.display="block"}else{$(_this.childRoot.querySelector(".top-menu_open")).mouseleave();$(list_elem).stop().slideDown()}this.classList.remove("top-menu_collapsed");this.classList.add("top-menu_open");$(this.querySelector(".top-menu_item_inner")).addClass("selected");$(this.querySelector(".top-menu_arrow")).removeClass("icon-arrow_down");$(this.querySelector(".top-menu_arrow")).addClass("icon-arrow_up");list_elem.style.top=this.getBoundingClientRect().top+this.getBoundingClientRect().height+"px";if(_this.placement==="vertical"){if(list_elem.offsetWidth<this.offsetWidth){list_elem.style.width=this.offsetWidth-2+"px"}list_elem.style.left=this.getBoundingClientRect().left+"px"}else{if(list_elem.offsetWidth<menuRoot.offsetWidth){list_elem.style.width=menuRoot.offsetWidth-2+"px"}list_elem.style.left=menuRoot.getBoundingClientRect().left+"px"}});$(document).off("mouseleave","#"+this.id+" .depth1.top-menu_parent.top-menu_open").on("mouseleave","#"+this.id+" .depth1.top-menu_parent.top-menu_open",function(){var list_elem=this.querySelector("ul");if(Top.Util.Browser.isIE()){list_elem.style.display="none"}else{$(list_elem).stop().slideUp()}this.classList.remove("top-menu_open");this.classList.add("top-menu_collapsed");$(this.querySelector(".top-menu_item_inner")).removeClass("selected");$(this.querySelector(".top-menu_arrow")).removeClass("icon-arrow_up");$(this.querySelector(".top-menu_arrow")).addClass("icon-arrow_down")});$(document).off("click","#"+this.id+" .top-menu_item_inner").on("click","#"+this.id+" .top-menu_item_inner",function(e){if($(this.parentNode).hasClass("depth1"))$(this.parentNode).mouseenter();$(_this.childRoot.querySelectorAll(".top-menu_item_inner.selected")).removeClass("selected");this.classList.add("selected");$(_this.childRoot.querySelectorAll(".depth2.active")).removeClass("active");$(this.parentNode).addClass("active");for(var i=0;i<this.classList.length;i++){if(checkReg.test(this.classList[i])){_this.selectedMenuId=this.classList[i].replace("top-menu_"+_this.id+"_","");break}}if(typeof _this.onSelect==="function"){_this.onSelect(_this.selectedMenuId)}if(_this.selectedMenuId in _this.itemOnClick){_this.itemOnClick[_this.selectedMenuId](event,Top.Dom.selectById(_this.id))}if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("itemclick"))}else{_this.__dispatchEvent(new Event("itemclick"))}e.stopPropagation()});$(document).off("click","#"+this.id+" .depth2").on("click","#"+this.id+" .depth2",function(){$(_this.childRoot.querySelectorAll(".depth2.active")).removeClass("active");this.classList.add("active");$(this.querySelector(".top-menu_item_inner"))[0].click()})},attachEventHandlerforCascading:function(){var _this=this;this.childRoot.classList.add("Menu_type_cascading");var timer;var checkReg=new RegExp("^top-menu_"+this.id+"_");var shadowRoot=this.childRoot;function closeMenuItem(menuElem){if(!menuElem)return;var childMenu_ul=menuElem.querySelector("ul");var arrowElem=menuElem.querySelector(".top-menu_arrow");menuElem.classList.remove("selected");menuElem.classList.remove("top-menu_open");menuElem.classList.add("top-menu_collapsed");childMenu_ul.style.display="none";var childMenuItem_li=$(childMenu_ul).find("> .selected");if(childMenuItem_li.length>0&&childMenuItem_li.hasClass("top-menu_parent")){for(var i=0;i<childMenuItem_li.length;i++)closeMenuItem(childMenuItem_li[i])}arrowElem.classList.remove("icon-arrow_filled_right");arrowElem.classList.add("icon-arrow_filled_left")}function openMenuItem(menuElem){if(!menuElem)return;var parent_ul=menuElem.parentNode;var childMenu_ul=menuElem.querySelector("ul");var arrowElem=menuElem.querySelector(".top-menu_arrow");menuElem.classList.add("selected");menuElem.classList.add("top-menu_open");menuElem.classList.remove("top-menu_collapsed");childMenu_ul.style.display="block";childMenu_ul.style.top=(shadowRoot.clientHeight-shadowRoot.offsetHeight)/2+"px";childMenu_ul.style.left=menuElem.offsetLeft+menuElem.offsetWidth+"px";arrowElem.classList.remove("icon-arrow_filled_left");arrowElem.classList.add("icon-arrow_filled_right")}$("#"+this.id+" .top-menu_item.top-menu_collapsed").off("click").on("click",function(e){var parent_ul=this.parentNode;var prevSelectedItem=$(parent_ul).find("> .selected");if(prevSelectedItem){if(prevSelectedItem.hasClass("top-menu_parent"))closeMenuItem(prevSelectedItem[0]);else prevSelectedItem.removeClass("selected")}openMenuItem(this);e.stopPropagation()});$(this.childRoot).on("mouseenter"," .top-menu_item.top-menu_collapsed",function(e){var thisItem=this;var parent_ul=this.parentNode;timer=setTimeout(function(){var prevSelectedItem=$(parent_ul).find("> .selected");if(prevSelectedItem){if(prevSelectedItem.hasClass("top-menu_parent"))closeMenuItem(prevSelectedItem[0]);else prevSelectedItem.removeClass("selected")}openMenuItem(thisItem)},200);e.stopPropagation()});$("#"+this.id+" .top-menu_item:not(.top-menu_parent)").off("click").on("click",function(e){var innerItem=this.querySelector(".top-menu_item_inner");for(var i=0;i<innerItem.classList.length;i++){if(checkReg.test(innerItem.classList[i])){_this.selectedMenuId=innerItem.classList[i].replace("top-menu_"+_this.id+"_","");break}}if(typeof _this.onSelect==="function"){_this.onSelect(_this.selectedMenuId)}if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("itemclick"))}else{_this.__dispatchEvent(new Event("itemclick"))}var parent_ul=this.parentNode;var prevSelectedItem=$(parent_ul).find("> .selected");if(prevSelectedItem){if(prevSelectedItem.hasClass("top-menu_parent"))closeMenuItem(prevSelectedItem[0]);else prevSelectedItem.removeClass("selected")}this.classList.add("selected");e.stopPropagation()});$(this.childRoot).on("mouseenter"," .top-menu_item:not(.top-menu_parent)",function(e){var thisItem=this;var parent_ul=this.parentNode;timer=setTimeout(function(){var prevSelectedItem=$(parent_ul).find("> .selected");if(prevSelectedItem){if(prevSelectedItem.hasClass("top-menu_parent"))closeMenuItem(prevSelectedItem[0])}},200);e.stopPropagation()})},__detachEventHandler:function(){$(document).off("click","#"+this.id+" .top-menu_btn.top-menu_collapsed");$(document).off("click","#"+this.id+" .top-menu_btn.top-menu_open");$(document).off("click","#"+this.id+" .top-menu_item.top-menu_collapsed:not(.top-menu_open)");$(document).off("click","#"+this.id+" .top-menu_item.top-menu_open:not(.top-menu_collapsed)");$(document).off("click","#"+this.id+" .top-menu_item:not(.top-menu_parent)");$(document).off("click","#"+this.id)},setDepth:function(obj,depth){if(!depth)depth=1;for(var i=0;i<obj.length;i++){if(!obj[i].hasOwnProperty("depth")){obj[i].depth=depth}if(obj[i].hasOwnProperty("children")){this.setDepth(obj[i].children,depth+1)}}},sideOpen:function(selectedNode){var width=this.getMaxWidth();$(this.querySelector(".top-menu-container")).css("width",width);$(this.querySelector(".top-menu-container")).find(".top-menu_nav").css("width",width);if(selectedNode){$(selectedNode.parentNode).slideDown();$(selectedNode.parentNode.parentNode).addClass("top-menu_open");$(selectedNode.parentNode.parentNode).removeClass("top-menu_collapsed");$(selectedNode.parentNode.parentNode.parentNode).slideDown();$(selectedNode.parentNode.parentNode.parentNode.parentNode).addClass("top-menu_open");$(selectedNode.parentNode.parentNode.parentNode.parentNode).removeClass("top-menu_collapsed")}},open:function(menuId,animate){this.__openedMenuId=menuId;var root=this.childRoot;switch(this.type){case"floating":{if(menuId){if(!Array.isArray(menuId)){var $this=$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_collapsed"))$this.click()}else $this.click()}else{for(var i=0;i<menuId.length;i++){var $this=$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId[i]));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_collapsed"))$this.click()}else $this.click()}}}else{$(root.lastChild).slicknav("open");if(this.onOpen)this.onOpen()}break}case"side":{if(menuId){if(!Array.isArray(menuId)){var $this=$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_collapsed"))$this.click()}else $this.click()}else{for(var i=0;i<menuId.length;i++){var $this=$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId[i]));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_collapsed"))$this.click()}else $this.click()}}}else{if(!$(this).hasClass("menu_02")){$(root.querySelector(".top-menu-container")).mouseenter();if(this.onOpen)this.onOpen()}}break}case"drawer":{if(menuId){if(!Array.isArray(menuId)){var $this=$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_collapsed"))$this.click()}else{$this.parent().parent().slideDown();$this.click()}}else{for(var i=0;i<menuId.length;i++){var $this=$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId[i]));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_collapsed")){if(animate===false){$this.next().css("display","block");$this.parent().removeClass("top-menu_collapsed");$this.parent().addClass("top-menu_open")}else{$this.click()}}}else $this.click()}}}else{$(root.querySelector(".top-menu_btn.top-menu_collapsed")).click();if(this.onOpen)this.onOpen()}break}case"dropdown":{if(menuId){if(!Array.isArray(menuId)){var $this=$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId));$this.click()}else{for(var i=0;i<menuId.length;i++){var $this=$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId[i]));$this.click()}}}else{$(root.querySelector(".top-menu_btn.top-menu_collapsed")).click();if(this.onOpen)this.onOpen()}break}case"header":{if(menuId){if(!Array.isArray(menuId)){var $this=$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId));$this.click()}else{for(var i=0;i<menuId.length;i++){var $this=$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId[i]));$this.click()}}}break}case"cascading":{if(menuId){if(!Array.isArray(menuId)){var $this=$("#"+this.id+" .top-menu_"+this.id+"_"+menuId).parent();$this.click()}else{for(var i=0;i<menuId.length;i++){var $this=$("#"+this.id+" .top-menu_"+this.id+"_"+menuId[i]).parent();$this.click()}}}else{var rootElement=root.firstElementChild;rootElement.style.display="inline-block";if(this.onOpen)this.onOpen()}break}}},close:function(menuId){function closeMenuItem(menuElem){if(!menuElem)return;var childMenu_ul=menuElem.querySelector("ul");var arrowElem=menuElem.querySelector(".top-menu_arrow");menuElem.classList.remove("selected");menuElem.classList.remove("top-menu_open");menuElem.classList.add("top-menu_collapsed");if(childMenu_ul){childMenu_ul.style.display="none";var childMenuItem_li=$(childMenu_ul).find("> .selected");if(childMenuItem_li.length>0&&childMenuItem_li.hasClass("top-menu_parent")){for(var i=0;i<childMenuItem_li.length;i++)closeMenuItem(childMenuItem_li[i])}}arrowElem.classList.remove("icon-arrow_filled_right");arrowElem.classList.add("icon-arrow_filled_left")}var root=this.childRoot;switch(this.type){case"floating":{if(menuId){if(!Array.isArray(menuId)){var $this=$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_open"))$this.click()}else $this.click()}else{for(var i=0;i<menuId.length;i++){var $this=$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId[i]));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_open"))$this.click()}else $this.click()}}}else{$(root.lastChild).slicknav("close");if(this.onClose)this.onClose()}break}case"side":{if(menuId){if(!Array.isArray(menuId)){var $this=$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_open"))$this.click()}else $this.click()}else{for(var i=0;i<menuId.length;i++){var $this=$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId[i]));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_open"))$this.click()}else $this.click()}}}else{if(!$(this).hasClass("menu_02")){$(root.querySelector(".top-menu-container")).mouseleave();if(this.onClose)this.onClose()}}break}case"drawer":{if(menuId){if(!Array.isArray(menuId)){var $this=$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_open"))$this.click()}else $this.click()}else{for(var i=0;i<menuId.length;i++){var $this=$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId[i]));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_open"))$this.click()}else $this.click()}}}else{$(root.querySelector(".top-menu_btn.top-menu_open")).click();if(this.onClose)this.onClose()}break}case"dropdown":{if(menuId){if(!Array.isArray(menuId)){var menuItem=root.querySelector(" .top-menu_"+this.id+"_"+menuId).parentNode;closeMenuItem(menuItem)}else{for(var i=0;i<menuId.length;i++){var menuItem=root.querySelector(" .top-menu_"+this.id+"_"+menuId[i]).parentNode;closeMenuItem(menuItem)}}}else{$(root.querySelector(".top-menu_btn.top-menu_open")).click();if(this.onClose)this.onClose()}break}case"header":{if(menuId){if(!Array.isArray(menuId)){var $this=$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_open"))$this.mouseleave()}}else{for(var i=0;i<menuId.length;i++){var $this=$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId[i]));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_open"))$this.mouseleave()}}}}break}case"cascading":{if(menuId){if(!Array.isArray(menuId)){var menuItem=root.querySelector(" .top-menu_"+this.id+"_"+menuId).parentNode;closeMenuItem(menuItem)}else{for(var i=0;i<menuId.length;i++){var menuItem=root.querySelector(" .top-menu_"+this.id+"_"+menuId[i]).parentNode;closeMenuItem(menuItem)}}}else{var rootElement=root.firstElementChild;rootElement.style.display="none";if(this.onClose)this.onClose()}break}}},setDropdownPosition:function(){var btn=this.childRoot.querySelector(".top-menu_btn");var list=this.childRoot.querySelector(".top-menu_nav");if(!list||list.offsetWidth===undefined||list.offsetWidth===0)return;list.style.top="";list.style.left="";list.style.width="";list.style.right="";list.style.bottom="";if(this.listLocation){if(this.listLocation.startsWith("b")){list.style.top=btn.getBoundingClientRect().top+btn.getBoundingClientRect().height+"px"}else{list.style.bottom=window.innerHeight-btn.getBoundingClientRect().bottom+btn.offsetHeight+"px"}if(this.listLocation.endsWith("l")){list.style.left=btn.getBoundingClientRect().left+"px"}else{var calcedRight=Math.abs(btn.getBoundingClientRect().right-$(document).width());list.style.right=calcedRight+"px"}}else{list.style.top=btn.getBoundingClientRect().top+btn.getBoundingClientRect().height+"px";list.style.left=btn.getBoundingClientRect().left+"px";var calcedRight=btn.getBoundingClientRect().right-$(document).width();if(calcedRight>0){calcedRight=Math.abs(btn.getBoundingClientRect().right-$(document).width());list.style.left="";list.style.right=calcedRight+"px"}if($(list).offset().top+list.offsetHeight>$(document).height()){list.style.top="";list.style.bottom=window.innerHeight-btn.getBoundingClientRect().bottom+btn.offsetHeight+"px"}}if(list.offsetWidth!==undefined&&btn&&btn.offsetWidth!==undefined&&list.offsetWidth<=btn.offsetWidth){list.style.width=btn.offsetWidth+"px"}if($(list).css("position")!=="fixed")list.style.position="fixed"},__updateItems:function(){this.itemOnClick={};if(this.onOpen&&typeof this.onOpen==="string"){this.onOpen=Top.Util.namespace(this.onOpen,this)}if(this.onClose&&typeof this.onClose==="string"){this.onClose=Top.Util.namespace(this.onClose,this)}if(this.onSelect&&typeof this.onSelect==="string"){this.onSelect=Top.Util.namespace(this.onSelect,this)}if(this.type==="floating"){this.renderFloating()}else if(this.type==="side"){this.renderSide()}else if(this.type==="dropdown"){this.renderDropdown()}else if(this.type==="drawer"){this.renderDrawer()}else if(this.type==="header"){this.renderHeader()}else if(this.type==="cascading"){this.renderCascading()}this.open(this.__openedMenuId)},__updateType:function(){switch(this.type){case"floating":{this.attachEventHandlerforFloating();break}case"side":{this.attachEventHandlerforSide();break}case"dropdown":{this.attachEventHandlerforDropdown();break}case"drawer":{this.attachEventHandlerforDrawer();break}case"header":{this.attachEventHandlerforHeader();break}case"cascading":{this.attachEventHandlerforCascading();break}}},__updateTitle:function(){switch(this.type){case"dropdown":{this.childRoot.querySelector(".top-menu_title").innerText=this.title;break}}},__getSelectedMenuDataById:function(menuId,items){if(!items){if(this.items){if(typeof this.items==="string"){var items=Top.Util.namespace(this.items);if(!Array.isArray(items))return}else{var items=this.items}}else if(this.menuItems){var items=this.makeItems(this.menuItems)}}if(!items||!menuId)return;var selectedMenuItem;for(var i=0,len=items.length;i<len;i++){if(items[i].id===menuId){return items[i]}if(typeof items[i].children==="object"&&items[i].children.length>0){selectedMenuItem=this.__getSelectedMenuDataById(menuId,items[i].children);if(selectedMenuItem){return selectedMenuItem}}}return selectedMenuItem},__updateMenuId:function(){var items=this.dataName+"."+this.menuId;this.dataModel["items"]=items;this.__initBoundData();this.__updateItems()},__updateOnItemclick:function(){this.__addEventByAttr("itemclick")},setMenuLayout:function(selector,layout){var menuItems=this.childRoot.querySelectorAll(selector);for(var i=0,len=menuItems.length;i<len;i++){var newLayout=layout({menuId:menuItems[i].className.split("top-menu_"+this.id+"_")[1],element:menuItems[i]});if(newLayout!==undefined)menuItems[i].innerHTML=newLayout}},getTopStyle:function(){this.topstyle=this.querySelector("div").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector("div");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector("div").style.cssText=this.topstyle},deSelect:function(){var selectedItems=this.childRoot.querySelectorAll(".selected");for(var i=0;i<selectedItems.length;i++){selectedItems[i].classList.remove("selected")}var activedItems=this.childRoot.querySelectorAll(".active");for(var i=0;i<activedItems.length;i++){activedItems[i].classList.remove("active")}this.selectedMenuId=""}};String.format=function(){var str=arguments[0];for(var i=1;i<arguments.length;i++){str=str.replace(RegExp("\\{"+(i-1)+"\\}","gm"),arguments[i])}return str};TopNotification={is:"top-notification",behaviors:[TopWidgetBehavior],properties:{icon:String,title:String,message:String,url:String,target:{type:String,value:"_blank"},type:{type:String,value:"info"},position:{type:String,value:null},placement:{type:Object,value:{from:"top",align:"right"}},offset:{type:Number,value:0},offsetX:Number,offsetY:Number,delay:{type:Number,value:0}},ready:function(){this.__initialize()},__initialize:function(){if(!this.icon)this.__initDefaultIcon();if(this.offset||this.offset===0){if(!this.offsetX)this.offsetX=this.offset;if(!this.offsetY)this.offsetY=this.offset}this.__updatePlacement();this.notification={};this.element="body"},__initDefaultIcon:function(){switch(this.type){case"success":this.defaultIcon="icon-circle_check";break;case"info":this.defaultIcon="icon-info";break;case"warning":this.defaultIcon="icon-bell";break;case"danger":this.defaultIcon="icon-fatal";break}},__updatePlacement:function(){if(typeof this.placement==="string"){switch(this.placement){case"tl":this.placement={from:"top",align:"left"};break;case"tc":this.placement={from:"top",align:"center"};break;case"tr":this.placement={from:"top",align:"right"};break;case"bl":this.placement={from:"bottom",align:"left"};break;case"bc":this.placement={from:"bottom",align:"center"};break;case"br":this.placement={from:"bottom",align:"right"};break;default:this.placement={from:"top",align:"center"};break}}},setTitle:function(title){if(this.notification)this.notification.update("title",title)},setIcon:function(icon){if(this.notification){if(icon){this.notification.update("icon",icon)}else{this.notification.update("icon",this.defaultIcon)}}},setType:function(type){if(this.notification){if(this.icon){this.notification.update("type",type)}else{this.__initDefaultIcon();this.notification.update({icon:this.defaultIcon,type:type})}}},setUrl:function(url){if(this.notification)this.notification.update("url",url)},setTarget:function(target){if(this.notification)this.notification.update("target",target)},setMessage:function(message){if(this.notification)this.notification.update("message",message)},setPlacement:function(placement){this.placement=placement;__updatePlacement();if(this.notification)this.notification.update("placement",placement)},open:function(){var icon=this.icon?this.icon:this.defaultIcon;this.notification=new Notify({icon:icon,title:this.title,message:this.message,url:this.url,target:this.target},{element:this.element,type:this.type,placement:this.placement,offsetX:this.offsetX,offsetY:this.offsetY,delay:this.delay}).notify},setAllTopStyle:function(){},close:function(){this.notification.close()}};function Notify(content,options){this.settings={content:{icon:content.icon?content.icon:"",message:content.message,title:content.title?content.title:"",url:content.url?content.url:"#",target:content.target?content.target:"-"},element:options.element?options.element:"body",type:options.type?options.type:"info",placement:options.placement?options.placement:{from:"top",align:"right"},offsetX:options.offsetX?options.offsetX:10,offsetY:options.offsetY?options.offsetY:20,delay:options.delay?options.delay:5e3,timer:1e3,z_index:1031};this.init()}$.extend(Notify.prototype,{init:function(){var self=this;this.__buildNotify();this.__setIcon();if(this.settings.content.url!="#"){this.__styleURL()}this.__styleDismiss();this.__placement();this.__bind();this.notify={$ele:this.$ele,update:function(command,update){var commands={};if(typeof command==="string"){commands[command]=update}else{commands=command}for(var cmd in commands){switch(cmd){case"type":this.$ele.classList.remove("alert-"+self.settings.type);self.settings.type=commands[cmd];break;case"icon":var $icon=this.$ele.find('[data-notify="icon"]');$icon.classList.remove(self.settings.content.icon);$icon.classList.add(commands[cmd]);break;case"url":this.$ele.find('[data-notify="url"]').setAttribute("href",commands[cmd]);break;case"target":this.$ele.find('[data-notify="url"]').setAttribute("target",commands[cmd]);break;default:this.$ele.find('[data-notify="'+cmd+'"]').innerHTML=commands[cmd]}}var posX=this.$ele.outerHeight()+10+parseInt(self.settings.offsetY);self.__reposition(posX)},close:function(){self.close()}}},__buildNotify:function(){var template='<div data-notify="container" class="top-notification-root col-xs-11 col-sm-4 alert alert-{0}" role="alert">'+'<button type="button" aria-hidden="true" class="top-notification-close" data-notify="dismiss"></button>'+'<span data-notify="icon" class="top-notification-icon"></span>'+'<span data-notify="title" class="top-notification-title">{1}</span>'+'<span data-notify="message" class="top-notification-message">{2}</span>'+'<a href="{3}" target="{4}" data-notify="url"></a></div>';var content=this.settings.content;this.$ele=$(String.format(template,this.settings.type,content.title,content.message,content.url,content.target));this.$ele.attr("data-notify-position",this.settings.placement.from+"-"+this.settings.placement.align)},__setIcon:function(){this.$ele.find('[data-notify="icon"]').addClass(this.settings.content.icon)},__styleDismiss:function(){this.$ele.find('[data-notify="dismiss"]').css({position:"absolute",right:"16px",top:"10px",zIndex:this.settings.z_index+2})},__styleURL:function(){this.$ele.find('[data-notify="url"]').css({backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)",height:"100%",left:0,position:"absolute",top:0,width:"100%",zIndex:this.settings.z_index+1})},__placement:function(){var self=this,offsetAmt=this.settings.offsetY,css={display:"inline-block",margin:"0px auto",position:"fixed",transition:"all .5s ease-in-out",zIndex:this.settings.z_index};$('[data-notify-position="'+this.settings.placement.from+"-"+this.settings.placement.align+'"]:not([data-closing="true"])').each(function(){offsetAmt=Math.max(offsetAmt,parseInt($(this).css(self.settings.placement.from))+parseInt($(this).outerHeight())+10)});css[this.settings.placement.from]=offsetAmt+"px";switch(this.settings.placement.align){case"left":case"right":css[this.settings.placement.align]=this.settings.offsetX+"px";break;case"center":css.left=0;css.right=0;break}this.$ele.css(css).addClass("animated fadeInDown");$(this.settings.element).append(this.$ele)},__bind:function(){var self=this;this.$ele.find('[data-notify="dismiss"]').on("click",function(){self.close()});this.$ele.mouseover(function(){$(this).data("data-hover","true")}).mouseout(function(){$(this).data("data-hover","false")});this.$ele.data("data-hover","false");if(this.settings.delay>0){self.$ele.data("notify-delay",self.settings.delay);var timer=setInterval(function(){var delay=parseInt(self.$ele.data("notify-delay"))-self.settings.timer;if(self.$ele.data("data-hover")==="false"){self.$ele.data("notify-delay",delay)}if(delay<=-self.settings.timer){clearInterval(timer);self.close()}},self.settings.timer)}},close:function(){var self=this,posX=parseInt(this.$ele.css(this.settings.placement.from));this.$ele.attr("data-closing","true").addClass("animated fadeOutUp");this.__reposition(posX);setTimeout(function(){self.$ele.remove()},600)},__reposition:function(posX){var self=this,notifies='[data-notify-position="'+this.settings.placement.from+"-"+this.settings.placement.align+'"]:not([data-closing="true"])',$elements=this.$ele.nextAll(notifies);$elements.each(function(){$(this).css(self.settings.placement.from,posX);posX=posX+10+$(this).outerHeight()})},getTopStyle:function(){return this.topstyle},setTopStyle:function(key,value){if(value){this.topstyle+=key+":"+value+";"}},setAllTopStyle:function(){}});Top.Widget.Notification=function(){Notification.prototype=Object.create(Top.Widget.prototype);Notification.prototype.constructor=Notification;function Notification(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-notification")}this.id=this.template.id}Notification.create=function(element){return new Notification(element)};Notification.prototype.setTitle=function(title){this.template.setTitle(title)};Notification.prototype.setIcon=function(icon){this.template.setIcon(icon)};Notification.prototype.setType=function(type){this.template.setType(type)};Notification.prototype.setUrl=function(url){this.template.setUrl(url)};Notification.prototype.setTarget=function(target){this.template.setTarget(target)};Notification.prototype.open=function(){this.template.open()};Notification.prototype.close=function(){this.template.close()};return Notification}();TopPage={is:"top-page",behaviors:[TopWidgetBehavior,TopLayoutBehavior],properties:{id:String,src:String,onLoad:Object,onBeforeActivate:Object,onActivate:Object,onDeactivate:Object,visible:String,style:String},__srcLoad:function(onSuccess){var _this=this;Top.Ajax.execute(_this.src,{type:"get",success:function(data){var controllerPaths=Top.Util.__getControllerPaths(data);if(Top.App.__useCommonLogic()===true&&controllerPaths!==undefined){Top.App.__loadControllerFile(controllerPaths,function(_data){onSuccess();_this.__onSuccessSrcLoad(_data)},data)}else{onSuccess();_this.__onSuccessSrcLoad(data);
}data=null}})},__onSuccessSrcLoad:function(data,callback){this.clearChilds(true);this.appendHtmlString(data);_insertedNodesCallback();Top.App.__makeTooltip(Top.App.getCurrentPage());Top.App.__makeContextMenu(Top.App.getCurrentPage());this.initialChilds();if(typeof this.srcLoad==="string"){this.srcLoad=Top.Util.namespace(this.srcLoad)}if(typeof this.srcLoad==="function")this.srcLoad();_srcRootNodesAttachedCallback();if(typeof callback==="function")callback();if(this.srcLoadListeners!==undefined){for(var i=0,len=this.srcLoadListeners.length;i<len;i++){if(typeof this.srcLoadListeners[i]==="function")this.srcLoadListeners[i]()}this.srcLoadListeners=[]}Top.Dialog.init();Top.Notification.init();if(document.getElementById("top-datepicker-div"))document.getElementById("top-datepicker-div").style.display="none"},initialChilds:function(){var i=0;var thisChildrenLength=this.children.length;var maxHeight=0;this.childs=[];while(i<thisChildrenLength){if(Top.Util.__isTopWidget(this.children[i].tagName))this.childs.push(this.children[i]);this.children[i].layoutParent=this;if(this.children[i].childRoot&&this.children[i].childRoot.offsetHeight>maxHeight){maxHeight=this.children[i].childRoot.offsetHeight}i++}this.__height=maxHeight+"px"},ready:function(){this.initialChilds();if(typeof this.onLoad==="string")this.onLoad=Top.Util.namespace(this.onLoad);if(typeof this.onBeforeActivate==="string")this.onBeforeActivate=Top.Util.namespace(this.onBeforeActivate);if(typeof this.onActivate==="string")this.onActivate=Top.Util.namespace(this.onActivate);if(typeof this.onDeactivate==="string")this.onDeactivate=Top.Util.namespace(this.onDeactivate);this.style="display: "+this.visible+";";var _this=this;Top.App.onLoad(function(){if(typeof _this.__attachedImpl==="function")_this.__attachedImpl()})},__updateVisible:function(){if(Top.Util.Browser.isIE())this.style.display=this.visible==="none"?"none":"";else this.style.display=this.visible==="none"?"none":"block"},__adjustLineHeight:function(){this.childs.forEach(function(child){if(typeof child.__adjustLineHeight==="function")child.__adjustLineHeight()})},getAllTopStyle:function(){},getTopStyle:function(){return this.topstyle},setTopStyle:function(key,value){if(value){this.topstyle+=key+":"+value+";"}},setAllTopStyle:function(){}};Top.Widget.Page=function(){Page.prototype=Object.create(Top.Widget.prototype);Page.prototype.constructor=Page;function Page(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-page")}this.id=this.template.id}Page.create=function(element){return new Page(element)};Page.prototype.loaded=false;Page.prototype.activated=false;Page.prototype.append=function(htmlString){$("#"+this.id).append(htmlString)};Page.prototype.html=function(htmlString){$("#"+this.id).html(htmlString)};Page.prototype.src=function(htmlFile,jsFile,callback){if(Top.Util.getFileExtension(htmlFile)!="html")return;if(typeof jsFile==="function"&&callback===undefined)callback=jsFile;var _this=this;loadHtml=function(){Top.Ajax.execute(htmlFile,{success:function(data,textStatus,jqXHR){var controllerPaths=Top.Util.__getControllerPaths(data);if(Top.App.__useCommonLogic()===true&&controllerPaths!==undefined){Top.App.__loadControllerFile(controllerPaths,function(){_this.template.__onSuccessSrcLoad(data,callback)})}else{_this.template.__onSuccessSrcLoad(data,callback)}data=null}})};if(typeof jsFile==="string"){this.template.__loadScript(jsFile,loadHtml)}else{loadHtml()}};Page.prototype.onLoad=function(func){this.template["onLoad"]=func};Page.prototype.onBeforeActivate=function(func){var page=this;this.template["onBeforeActivate"]=function(){func(page.template.params)}};Page.prototype.onActivate=function(func){var page=this;this.template["onActivate"]=function(){if(location.hash!=""&&location.hash.replace("#!","")!=Top.curRoute.path){var path=location.hash.replace("#!","");if(typeof Top.routes[path]==="string")return;Top.App.__routeReplace(path)}func(page.template.params)}};Page.prototype.onDeactivate=function(func){this.template["onDeactivate"]=func};Page.prototype.getChildren=function(selector){var topElements=[];if(selector){var elements=this.querySelectorAll(selector)}else{var elements=this.children}var len=elements.length;for(var i=0;i<len;i++){var item=elements[i];if(item.tagName==="DIV")item=item.firstElementChild;topElements[i]=Top.Dom.__selectImpl(item)}return topElements};Page.prototype.selectById=function(id){var element=this.template.querySelector("#"+id);if(element==null)return null;return Top.Dom.__selectImpl(element)};Page.prototype.select=function(selector){var element=this.template.querySelectorAll(selector);var len=element.length;var widgets=[];for(var i=0;i<len;i++){var selected=Top.Dom.__selectImpl(element[i]);if(selected)widgets.push(selected)}return widgets};return Page}();TopPagination={is:"top-pagination",behaviors:[TopWidgetBehavior],properties:{total:{type:Number,value:1},page:{type:Number},beforepage:{type:Number},type:{type:String,value:"basic"},pagememory:{type:Object,value:{}},maxVisible:Number,targetArea:String,targetContent:String,eventPageSelected:String,hrefSrc:{type:String,value:"javascript:void(0);"},hrefVariable:"{{number}}",pagerId:String,onPagechange:String},__ready:function(){var shadowPage=this.querySelector(".top-pagination-root");this.pagerId=Top.Util.guid();shadowPage.setAttribute("id",this.pagerId);this.__initialize()},appendTemplate:function(){this.innerHTML='<div class="top-pagination-root"></div>';this.__isTemplateAppended=true},__attached2:function(){this.__bindEvent()},__initEventInternal:function(){this.__addEventByAttr("pagechange")},__bindEvent:function(){var shadowPage=this.querySelector(".top-pagination-root");var _this=this;$(shadowPage).off("page");$(shadowPage).on("page",function(event,num){_this.beforepage=_this.page;_this.page=num;_this.updateData("page");if(typeof _this.eventPageSelected==="function")_this.eventPageSelected(_this.page);if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("pagechange"))}else{_this.__dispatchEvent(new Event("pagechange"))}})},__initialize:function(){this.clearWidget();if(this.type=="basic"||this.type=="big"){this.renderBasic()}else if(this.type=="input"){this.renderInput()}else if(this.type==="button"){this.renderButton()}this.__updateEventPageSelected();this.__updatePage()},__updatePage:function(){this.page=parseInt(this.page);this.clearWidget();if(this.type=="basic"||this.type=="big"){this.renderBasic()}else if(this.type=="input"){this.renderInput()}else if(this.type==="button"){this.renderButton()}if(typeof this.eventPageSelected==="function"&&this.page)this.eventPageSelected(this.page)},__updateTotal:function(){this.total=parseInt(this.total);this.clearWidget();if(this.type=="basic"||this.type=="big"){this.renderBasic()}else if(this.type=="input"){this.renderInput()}else if(this.type==="button"){this.renderButton()}},__updateMaxVisible:function(){this.maxVisible=parseInt(this.maxVisible);this.clearWidget();if(this.type=="basic"||this.type=="big"){this.renderBasic()}else if(this.type=="input"){this.renderInput()}else if(this.type==="button"){this.renderButton()}},__updateEventPageSelected:function(){if(typeof this.eventPageSelected=="string"){this.eventPageSelected=Top.Util.namespace(this.eventPageSelected,this)}},renderBasic:function(){if(parseInt(this.total)===0)return;if(this.type==="basic")this.setAttribute("type","basic");else this.setAttribute("type","big");var shadowPage=this.querySelector("div.top-pagination-root");if(this.maxVisible===undefined)this.maxVisible=null;$(shadowPage).bootpag({total:this.total,page:this.page,maxVisible:this.maxVisible,firstLastUse:true,first:" ",last:" ",next:" ",prev:" ",leaps:false})},renderInput:function(){if(parseInt(this.total)===0)return;this.setAttribute("type","input");this.type="input";if(this.maxVisible===null)this.maxVisible=undefined;var shadowPage=this.querySelector("div.top-pagination-root");var thisPager=this;var $owner=$(shadowPage);var $pager,lp,me=$(shadowPage),p=['<ul class="top-pagination-container">'];p=p.concat(['<li data-lp="1" class="first"><a class="cell_link" href="',this.href(1),'">',"</a></li>"]);p=p.concat(['<li data-lp="1" class="prev"><a class="cell_link" href="',this.href(1),'">',"</a></li>"]);p=p.concat(['<li class="cell" ><a class="cell_link"><input class="cell_input" type="number" min="1" max="',this.total,'"> of ',this.total," </a></li>"]);lp=this.total>this.maxVisible?Math.min(this.maxVisible+1,this.total):2;p=p.concat(['<li data-lp="',lp,'" class="next"><a class="cell_link" href="',this.href(lp),'">',"</a></li>"]);p=p.concat(['<li data-lp="',this.total,'" class="last"><a class="cell_link" href="',this.href(this.total),'">',"</a></li>"]);p.push("</ul>");me.find("ul.top-pagination-container").remove();me.append(p.join(""));$pager=me.find("ul.top-pagination-container");me.find("li:not(.cell)").on("click",function paginationClick(){var me=$(this);if(me.hasClass("disabled")||me.hasClass("active")){return}var page=parseInt(me.attr("data-lp"),10);$owner.find("ul.top-pagination-container").each(function(){thisPager.renderInputPage($(this),page)});$owner.trigger("page",page)});me.find("input").keypress(function(event){var $this=$(me.find("ul"));if(event.which==13){thisPager.renderInputPage($this,this.value);thisPager.__updatePage()}});this.renderInputPage($pager,this.page)},renderInputPage:function($pager,page){var thisPager=this;page=parseInt(page,10);var lp,maxV=thisPager.maxVisible==0?1:thisPager.maxVisible,step=thisPager.maxVisible==1?0:1,vis=Math.floor((page-1)/maxV)*maxV,$page=$pager.find("li");thisPager.page=page=page<0?0:page>thisPager.total?thisPager.total:page;lp=page-1<1?1:page-1>=thisPager.maxVisible?Math.floor((page-1)/maxV)*maxV:page-1;$page.first().toggleClass("disabled",page===1);var lfirst=$page.first();lfirst=lfirst.next();lfirst.toggleClass("disabled",page===1).attr("data-lp",lp).find("a").attr("href",thisPager.href(lp));var step=thisPager.maxVisible==1?0:1;lp=page+1>thisPager.total?thisPager.total:thisPager.leaps&&page+1<thisPager.total-thisPager.maxVisible?vis+thisPager.maxVisible+step:page+1;var llast=$page.last();llast=llast.prev();llast.toggleClass("disabled",page===thisPager.total).attr("data-lp",lp).find("a").attr("href",thisPager.href(lp));$page.last().toggleClass("disabled",page===thisPager.total);$page[2].setAttribute("data-lp",page);$page[2].querySelector("a > input").value=page},renderButton:function(){if(parseInt(this.total)===0)return;this.setAttribute("type","button");var shadowPage=this.root.querySelector("div.top-pagination-root");$(shadowPage).bootpag({total:this.total,page:this.page,next:" ",prev:" ",maxVisible:null})},href:function(c){return this.hrefSrc.replace(this.hrefVariable,c)},setPageEvent:function(fn){this.eventPageSelected=fn},clearWidget:function(){var shadowPage=this.querySelector("div#"+this.pagerId);$(shadowPage).children().remove()},__updateOnPagechange:function(){this.__addEventByAttr("pagechange")},getTopStyle:function(){this.topstyle=this.querySelector(".top-pagination-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-pagination-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-pagination-root").style.cssText=this.topstyle}};Top.Widget.Pagination=function(){Pagination.prototype=Object.create(Top.Widget.prototype);Pagination.prototype.constructor=Pagination;function Pagination(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-pagination");this.template.innerHTML='<div class="top-pagination-root"></div>'}this.id=this.template.id}Pagination.create=function(element){return new Pagination(element)};Pagination.prototype.getSelectedPage=function(){return this.template.page};Pagination.prototype.savePage=function(repo,instance){var currentpagedata="pagedata"+this.template.page;var beforepagedata="pagedata"+this.template.beforepage;this.template.pagememory[beforepagedata]=$.extend(true,[],repo[instance]);repo[instance]=[];if(this.template.pagememory[currentpagedata]==undefined){return true}else{repo[instance]=$.extend(true,[],this.template.pagememory[currentpagedata]);return false}};return Pagination}();TopPanel={is:"top-panel",behaviors:[TopWidgetBehavior,TopContainerBehavior],properties:{title:String,titleHtml:String},__ready:function(){this.__updateId();this.__initI18n("title");this.initialChilds();this.initialLayout();this.renderLayout();if(this.__eventMouseClick&&typeof this.__eventMouseClick==="function"){this.querySelector(".top-panel-title-layout").style.cursor="pointer";this.querySelector(".top-panel-content").style.cursor="pointer"}},appendTemplate:function(){this.innerHTML='<div class="top-panel-root">'+this.innerHTML+"</div>";this.__isTemplateAppended=true},__eventBindingList:function(){var shadowDiv=this.querySelector(".top-panel-root");return{__eventMouseClick:function(func){shadowDiv.onclick=func},__eventMousePressed:function(func){shadowDiv.onmousedown=func},__eventMouseReleased:function(func){shadowDiv.onmouseup=func},__eventMouseDblclick:function(func){shadowDiv.ondblclick=func},__eventKeyPressed:function(func){shadowDiv.onkeydown=func},__eventKeyTyped:function(func){shadowDiv.onkeypress=func},__eventKeyReleased:function(func){shadowDiv.onkeyup=func},__eventMouseEnter:function(func){shadowDiv.onmouseenter=func},__eventMouseExit:function(func){shadowDiv.onmouseleave=func},__eventMouseMove:function(func){shadowDiv.onmousemove=func},__eventFocused:function(func){shadowDiv.onfocus=func},__eventLostFocused:function(func){shadowDiv.onblur=func},__eventSecondaryClick:function(func){shadowDiv.oncontextmenu=func}}},renderLayout:function(){var divA=document.createElement("div");var divB=document.createElement("div");var span=document.createElement("span");divA.classList.add("top-panel-title-layout");span.classList.add("top-panel-title");span.textContent=this.title;divB.classList.add("top-panel-content");divA.appendChild(span);this.childRoot.appendChild(divA);this.childRoot.appendChild(divB);this.querySelector(".top-panel-content").style.padding=this.padding;this.querySelector(".top-panel-content").style.height="calc(100% - 28px)";for(var i=0,len=this.itemLayoutDom.length;i<len;i++){this.querySelector(".top-panel-content").appendChild(this.itemLayoutDom[i])}if(this.titleHtml){$(this.querySelector(".top-panel-title-layout")).append(this.titleHtml)}},initializeChildRoot:function(){return this.querySelector(".top-panel-root")},__updateId:function(){if(this.id){this.childRoot.id=this.id}},__updateTitle:function(){$(this.querySelector("span.top-panel-title")).html(this.__i18n(this.title))},__updateTitleHtml:function(){$(this.querySelector(".top-panel-title-layout")).append(this.titleHtml)},setContent:function(htmlString){this.itemLayoutDom=htmlString;this.renderLayout()},setTitle:function(title){this.__updateTitle()},setIcon:function(icon){this.icon=icon;this.renderLayout()},setSrc:function(src){this.src=src;this.renderLayout()},setTitleHtml:function(titleHtml){this.__updateTitleHtml()},getTopStyle:function(){this.topstyle=this.querySelector(".top-panel-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-panel-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-panel-root").style.cssText=this.topstyle}};Top.Widget.Container.Panel=function(){Panel.prototype=Object.create(Top.Widget.Container.prototype);Panel.prototype.constructor=Panel;function Panel(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-panel");this.template.innerHTML='<div class="top-panel-root"></div>'}this.id=this.template.id}Panel.create=function(element){return new Panel(element)};Panel.prototype.setContent=function(layout){this.template.itemLayout=$(layout.template).wrap("<p/>").parent().html();$(layout.template).unwrap();this.template.setContent(this.template.itemLayout)};Panel.prototype.setTitle=function(title){this.template.title=title;this.template.setTitle(title)};Panel.prototype.setTitleHtml=function(titleHtml){this.template.titleHtml=titleHtml;this.template.setTitleHtml(titleHtml)};return Panel}();TopPopover={is:"top-popover",behaviors:[TopWidgetBehavior],properties:{title:String,content:String,placement:String,delay:Number,trigger:String,template:String,onOpen:String},ready:function(){this.__updateId();this.__parent=this.parentNode;this.__addPopover()},__attached2:function(){this.attachEventHandler()},attachEventHandler:function(){var _this=this;$(document).on("click scroll",function(e){$('[data-toggle="popover"],[data-original-title]').each(function(){if(!$(this).is(e.target)&&$(this).has(e.target).length===0&&$(".top-popover").has(e.target).length===0){(($(this).popover("hide").data("bs.popover")||{}).inState||{}).click=false}})});$(window).on("resize",_this.adjustPosition.bind(this))},__updateId:function(){if(this.id){this.childRoot.id=this.id}},appendTemplate:function(){this.innerHTML='<div class="top-popover-root">'+this.innerHTML+"</div>";this.__isTemplateAppended=true},__eventBindingList:function(){var shadowDiv=this.querySelector(".top-popover-root");return{__eventMouseClick:function(func){shadowDiv.onclick=func},__eventMousePressed:function(func){shadowDiv.onmousedown=func},__eventMouseReleased:function(func){shadowDiv.onmouseup=func},__eventMouseDblclick:function(func){shadowDiv.ondblclick=func},__eventKeyPressed:function(func){shadowDiv.onkeydown=func},__eventKeyTyped:function(func){shadowDiv.onkeypress=func},__eventKeyReleased:function(func){shadowDiv.onkeyup=func},__eventMouseEnter:function(func){shadowDiv.onmouseenter=func},__eventMouseExit:function(func){shadowDiv.onmouseleave=func},__eventMouseMove:function(func){shadowDiv.onmousemove=func},__eventFocused:function(func){shadowDiv.onfocus=func},__eventLostFocused:function(func){shadowDiv.onblur=func},__eventSecondaryClick:function(func){shadowDiv.oncontextmenu=func}}},__addPopover:function(){if(this.__parent){if(topWidgets[this.__parent.tagName.toLowerCase()]!==undefined){var element=this.__parent.getElement()}else{var element=this.__parent}this.__popover=$(element).popover(this.__makeOptions());this.__initOnOpen()}},__makeOptions:function(){var hasChildren=this.childRoot.children.length>0;var hasTemplate=hasChildren||this.template;if(hasChildren){var _content=this.childRoot.children[0];var popoverDiv=document.createElement("div");popoverDiv.className+="top-popover";var arrowDiv=document.createElement("div");arrowDiv.className+="top-popover-arrow";popoverDiv.appendChild(arrowDiv);this.childRoot.replaceChild(popoverDiv,_content);popoverDiv.appendChild(_content)}if(this.template){this.template='<div class="top-popover '+this.className+'"><div class="top-popover-arrow"></div>'+this.template+"</div>"}else{this.template='<div class="top-popover '+this.className+'" role="tooltip"><div class="top-popover-arrow"></div><h3 class="top-popover-title"></h3><div class="top-popover-content"></div></div>'}if(this.content===undefined)this.content="-";return{title:hasTemplate?"-":this.title,content:hasTemplate?"-":this.content,placement:this.placement,delay:this.delay,trigger:this.trigger,template:hasChildren?this.childRoot.children[0]:this.template}},setContent:function(content){var popover=$(this).parent().data("bs.popover");if(popover){popover.options.content=content;popover.setContent();popover.$tip.addClass(popover.options.placement)}},setTitle:function(title){var popover=$(this).parent().data("bs.popover");if(popover){popover.options.title=title;popover.setContent();popover.$tip.addClass(popover.options.placement)}},__updateContent:function(){this.setContent(this.content)},__updateTitle:function(){this.setTitle(this.title)},initializeChildRoot:function(){return this.querySelector(".top-popover-root")},getTopStyle:function(){this.topstyle=this.querySelector(".top-popover-root").style.cssText;return this.topstyle},setAllTopStyle:function(){this.querySelector(".top-popover-root").style.cssText=this.topstyle},__reRender:function(){if(this.parentId){this.__parent=document.getElementById(this.parentId)}this.__addPopover()},__initOnOpen:function(){var _this=this;this.__addEventByAttr("open");this.__popover.on("shown.bs.popover",function(){var contentDiv=_this.__parent.querySelector("div.top-popover-content");var contentLayout=Top.Widget.create("top-layout");if(_this.layoutId){contentLayout.id=_this.layoutId;contentLayout.template.id=_this.layoutId}contentDiv.innerHTML="";contentDiv.appendChild(contentLayout.template);_this.originWidth=_this.__parent.querySelector(".top-popover").offsetWidth;_this.__dispatchEvent(new CustomEvent("open",{detail:{contentLayout:contentLayout}}))});this.attachEventHandler()},adjustPosition:function(){var popover=this.__parent.querySelector(".top-popover");if(popover){var parentLeft=this.__popover.offset().left;var parentWidth=this.__popover.outerWidth();var contentWidth=popover.offsetWidth;popover.style.left=parseFloat(parentLeft)-(contentWidth-parentWidth)/2+"px"}}};Top.Widget.Popover=function(){Popover.prototype=Object.create(Top.Widget.prototype);Popover.prototype.constructor=Popover;function Popover(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-popover");this.template.innerHTML='<div class="top-popover-root"></div>'}this.id=this.template.id}Popover.create=function(element){return new Popover(element)};Popover.prototype.setContent=function(content){this.template.setContent(content)};Popover.prototype.setTitle=function(title){this.template.setTitle(title)};Popover.prototype.adjustPosition=function(){this.template.adjustPosition()};Popover.prototype.open=function(){this.template.__popover.popover("show")};Popover.prototype.close=function(){this.template.__popover.popover("hide")};Popover.prototype.toggle=function(){this.template.__popover.popover("toggle")};return Popover}();TopProgressbar={is:"top-progressbar",behaviors:[TopWidgetBehavior,TopRangeBehavior],properties:{indeterminate:String,progressColor:String,progress:String},__ready:function(){this.__initialize();this.__updateId();this.__updateIndeterminate();this.__updateProgressColor();this.__updateProgress()},appendTemplate:function(){this.innerHTML='<progress class="top-progressbar-root"></progress>';this.__isTemplateAppended=true},__eventBindingList:function(){var shadowDiv=this.querySelector(".top-progressbar-root");return{__eventMouseClick:function(func){shadowDiv.onclick=func},__eventMousePressed:function(func){shadowDiv.onmousedown=func},__eventMouseReleased:function(func){shadowDiv.onmouseup=func},__eventMouseDblclick:function(func){shadowDiv.ondblclick=func},__eventKeyPressed:function(func){shadowDiv.onkeydown=func},__eventKeyTyped:function(func){shadowDiv.onkeypress=func},__eventKeyReleased:function(func){shadowDiv.onkeyup=func},__eventMouseEnter:function(func){shadowDiv.onmouseenter=func},__eventMouseExit:function(func){shadowDiv.onmouseleave=func},__eventMouseMove:function(func){shadowDiv.onmousemove=func},__eventFocused:function(func){shadowDiv.onfocus=func},__eventLostFocused:function(func){shadowDiv.onblur=func},__eventSecondaryClick:function(func){shadowDiv.oncontextmenu=func}}},__initialize:function(){this.indeterminate=this.indeterminate==="true"||this.indeterminate===true},__updateId:function(){if(this.id){var progress=this.querySelector(".top-progressbar-root");progress.id=this.id}},__updateIndeterminate:function(){var progress=this.querySelector(".top-progressbar-root");if(this.indeterminate){progress.removeAttribute("value")}else{progress.setAttribute("value",this.progress)}},__updateProgress:function(){var progress=this.querySelector(".top-progressbar-root");if(this.progress!==null&&this.progress!==undefined&&!this.indeterminate){progress.setAttribute("value",this.progress)}},__updateProgressColor:function(){if(!this.progressColor)return;var progress=this.querySelector(".top-progressbar-root");var styles="background-color:"+this.progressColor+";";if(Top.Util.Browser.isChrome()){var s="top-progressbar#"+this.id+">.top-progressbar-root::-webkit-progress-value"}else if(Top.Util.Browser.isIE()){var s="top-progressbar#"+this.id+">.top-progressbar-root::-ms-fill"}var sheet=document.styleSheets[0];if(!this.rule&&this.rule!==0||!sheet.cssRules.length){if(sheet.insertRule){this.rule=sheet.insertRule(s+"{"+styles+"}",0)}else if(sheet.addRule){this.rule=sheet.addRule(s,styles)}}else{sheet.rules[this.rule].style.backgroundColor=this.progressColor}},initBackgroundColor:function(){},getTopStyle:function(){this.topstyle=this.querySelector(".top-progressbar-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-progressbar-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-progressbar-root").style.cssText=this.topstyle}};Top.Widget.Progressbar=function(){Progressbar.prototype=Object.create(Top.Widget.prototype);Progressbar.prototype.constructor=Progressbar;function Progressbar(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-progressbar");this.template.innerHTML='<progress class="top-progressbar-root"></progress>'}this.id=this.template.id}Progressbar.create=function(element){return new Progressbar(element)};return Progressbar}();TopRadiobutton={is:"top-radiobutton",behaviors:[TopWidgetBehavior,TopTextBehavior,TopCheckBehavior],properties:{onChange:String,checkPosition:{type:String,value:"left"}},__attached2:function(){this.__initLabel()},__eventBindingList:function(){var input=this.querySelector("input");var label=this.querySelector("label");return{__eventKeyReleased:function(func){input.onkeyup=func},__eventLostFocused:function(func){input.onblur=func},__eventMouseClick:function(func){input.onclick=func},__eventMouseEnter:function(func){label.onmouseenter=func},__eventMouseExit:function(func){label.onmouseleave=func},__eventMouseMove:function(func){label.onmousemove=func},__eventMousePressed:function(func){input.onmousedown=func},__eventMouseReleased:function(func){input.onmouseup=func},__eventMouseDblclick:function(func){input.ondblclick=func},__eventKeyTyped:function(func){input.onkeypress=func},__eventKeyReleased:function(func){input.onkeyup=func},__eventFocused:function(func){input.onfocus=func},__eventSecondaryClick:function(func){label.oncontextmenu=func}}},__initLabel:function(){var shadowLabel=this.querySelector("label");shadowLabel.setAttribute("for",this.id)},__ready:function(){this.__initialize()},appendTemplate:function(){this.innerHTML='<input class="top-radiobutton-check" type="radio"/><label class="top-radiobutton-text"></label>';this.__isTemplateAppended=true},expectedTemplateClassName:function(){return"top-radiobutton-check"},__initialize:function(){this.__updateId();this.__updateText();this.__updateDisabled();this.__updateChecked();this.__updateGroupId();this.__initBindingEvent();this.__updatePosition()},__initEventInternal:function(){this.__addEventByAttr("change")},__updateId:function(){if(this.id){var shadowInput=this.querySelector(".top-radiobutton-check");shadowInput.id=this.id}},__updateText:function(){if(this.text||this.text===0){this.querySelector(".top-radiobutton-text").textContent=this.text}},__updateDisabled:function(){if(this.disabled===null)this.disabled=this.getAttribute("disabled");var disabled=this.calculateDerivedDisabled();var shadowInput=this.querySelector(".top-radiobutton-check");var shadowLabel=this.querySelector(".top-radiobutton-text");if(disabled=="true"||disabled==true){shadowInput.setAttribute("disabled","true");shadowLabel.setAttribute("disabled","true");this.__detachBindingEvent()}else{shadowInput.removeAttribute("disabled");shadowLabel.removeAttribute("disabled");this.__initBindingEvent()}},__updateChecked:function(){var shadowInput=this.querySelector("input");if(this.checked==="true"||this.checked===true){shadowInput.checked=true;this.__uncheckOther()}else if(this.checked==="false"||this.checked===false){shadowInput.checked=false}},__updateGroupId:function(){if(this.groupId){var shadowInput=this.querySelector("input");shadowInput.name=this.groupId}this.setAttribute("group-id",this.groupId);this.__initBindingEvent()},__updatePosition:function(){if(this.checkPosition==="right"){this.querySelector(".top-radiobutton-text").classList.add("right");this.querySelector(".top-radiobutton-check").classList.add("right")}else{this.querySelector(".top-radiobutton-text").classList.add("left")}},__detachBindingEvent:function(){this.removeEventListener("click",this.__clickListener)},__initBindingEvent:function(){var _this=this;var shadowInput=this.querySelector("input");this.removeEventListener("click",this.__clickListener);this.__clickListener=function(e){_this.callEventChanged(_this.checked);e.stopPropagation();shadowInput.click();shadowInput.checked=true;e.preventDefault()};this.addEventListener("click",this.__clickListener)},callEventChanged:function(checked){var shadowInput=this.querySelector("input");var shadowGroup=$("[group-id='"+this.groupId+"']");for(var i=0;i<shadowGroup.length;i++){if(shadowGroup[i].id===this.id){shadowGroup[i].checked=true}else{shadowGroup[i].checked=false}shadowGroup[i].updateData("checked");shadowGroup[i].updateDevice("checked")}if(typeof this.eventChanged==="string")this.__eventChanged=Top.Util.namespace(this.eventChanged,this);if(typeof this.__eventChanged==="function"){var widget=Top.Dom.selectById(this.id);if(shadowInput.checked){this.__eventChanged(this.text,widget.template.dataIndex)}}},isChecked:function(){var shadowInput=this.querySelector("input");return shadowInput.checked},focus:function(){this.querySelector(".top-radiobutton-check").focus()},blur:function(){this.querySelector(".top-radiobutton-check").blur()},__uncheckOther:function(){var shadowGroup=$("[group-id='"+this.groupId+"']");for(var i=0;i<shadowGroup.length;i++){if(shadowGroup[i].id!==this.id){shadowGroup[i].checked=false}}},__updateOnChange:function(){this.__addEventByAttr("change")},getTopStyle:function(){this.topstyle=this.querySelector(".top-radiobutton-text").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-radiobutton-text");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-radiobutton-text").style.cssText=this.topstyle}};Top.Widget.Radiobutton=function(){Radiobutton.prototype=Object.create(Top.Widget.prototype);Radiobutton.prototype.constructor=Radiobutton;function Radiobutton(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-radiobutton");this.template.innerHTML='<input class="top-radiobutton-check" type="radio"/><label class="top-radiobutton-text"></label>'}this.id=this.template.id}Radiobutton.create=function(element){return new Radiobutton(element)};Radiobutton.prototype.isChecked=function(){return this.template.isChecked()};Radiobutton.prototype.getChecked=function(){return this.template.isChecked()};Radiobutton.prototype.getCheckedButton=function(){var groupButtons=document.querySelectorAll('top-radiobutton[group-id="'+this.template.groupId+'"]');var checkedButton;for(var i=0;i<groupButtons.length;i++){if(groupButtons[i].isChecked()===true||groupButtons[i].isChecked()==="true"){checkedButton=groupButtons[i];break}}return Top.Dom.__selectImpl(checkedButton)};return Radiobutton}();TopScrolllayout={is:"top-scrolllayout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],properties:{horizontalScroll:{type:String,value:true},verticalScroll:{type:String,value:true},horizontalScrollPosition:{type:Number,value:0},verticalScrollPosition:{type:Number,value:0}},__ready:function(){this.__updateId();this.initialChilds();
this.renderLayout()},__updateId:function(){if(this.id){this.childRoot.id=this.id}},appendTemplate:function(){this.innerHTML='<div class="top-scrolllayout-root">'+this.innerHTML+"</div>";this.__isTemplateAppended=true},__eventBindingList:function(){var shadowDiv=this.querySelector(".top-scrolllayout-root");return{__eventMouseClick:function(func){shadowDiv.onclick=func},__eventMousePressed:function(func){shadowDiv.onmousedown=func},__eventMouseReleased:function(func){shadowDiv.onmouseup=func},__eventMouseDblclick:function(func){shadowDiv.ondblclick=func},__eventKeyPressed:function(func){shadowDiv.onkeydown=func},__eventKeyTyped:function(func){shadowDiv.onkeypress=func},__eventKeyReleased:function(func){shadowDiv.onkeyup=func},__eventMouseEnter:function(func){shadowDiv.onmouseenter=func},__eventMouseExit:function(func){shadowDiv.onmouseleave=func},__eventMouseMove:function(func){shadowDiv.onmousemove=func},__eventFocused:function(func){shadowDiv.onfocus=func},__eventLostFocused:function(func){shadowDiv.onblur=func},__eventSecondaryClick:function(func){shadowDiv.oncontextmenu=func}}},__attached2:function(){this.adjustSize();var layoutRoot=this.childRoot;if(layoutRoot.style.paddingTop==="")layoutRoot.style.paddingTop=0;if(layoutRoot.style.paddingBottom==="")layoutRoot.style.paddingBottom=0;if(this.lineHeight===undefined){this.setTopStyle("line-height",layoutRoot.clientHeight-parseInt(layoutRoot.style.paddingTop)-parseInt(layoutRoot.style.paddingBottom)+"px")}},initialChilds:function(){this.childs=[];for(var i=0;i<this.childRoot.children.length;i++){this.childRoot.children[i].layoutParent=this;if(Top.Util.__isTopWidget(this.childRoot.children[i].tagName))this.childs.push(this.childRoot.children[i])}},initializeChildRoot:function(){return this.querySelector(".top-scrolllayout-root")},__setWrapperStyle:function(child){var vertical_align=child.getAttribute("layout-vertical-alignment")||"top";child.style.cssText="display:inline-block; line-height:normal; width:100%; height:100%; vertical-align:"+vertical_align+";"},renderLayout:function(){if(Top.Util.Browser.isIE()){var layoutRoot=this.childRoot;var horizontalPosition=0;var verticalPosition=0;for(var i=0;i<this.childRoot.children.length;i++){var child=this.childRoot.children[i];if(child.getAttribute("layout-horizontal-alignment")){this.removeTopStyle("text-align");this.setTopStyle("text-align",item.getAttribute("layout-horizontal-alignment"))}this.__setWrapperStyle(child)}this.horizontalScrollPosition*=.01;this.verticalScrollPosition*=.01;horizontalPosition=(layoutRoot.scrollWidth-layoutRoot.clientWidth)*this.horizontalScrollPosition;verticalPosition=(layoutRoot.scrollHeight-layoutRoot.clientHeight)*this.verticalScrollPosition;layoutRoot.scrollTop=verticalPosition;layoutRoot.scrollLeft=horizontalPosition}else{if(this.childRoot.children.length===0){return}var layoutRoot=this.childRoot;var horizontalPosition=0;var verticalPosition=0;for(var i=0;i<this.childRoot.children.length;i++){var child=this.childRoot.children[i];if(child.getAttribute("layout-horizontal-alignment")){this.removeTopStyle("text-align");this.setTopStyle("text-align",item.getAttribute("layout-horizontal-alignment"))}this.__setWrapperStyle(child)}this.horizontalScrollPosition*=.01;this.verticalScrollPosition*=.01;horizontalPosition=(layoutRoot.scrollWidth-layoutRoot.clientWidth)*this.horizontalScrollPosition;verticalPosition=(layoutRoot.scrollHeight-layoutRoot.clientHeight)*this.verticalScrollPosition;layoutRoot.scrollTop=verticalPosition;layoutRoot.scrollLeft=horizontalPosition}},__setWidgetSize:function(adjustment){if(this.childRoot.children.length<=0)return;var layoutRoot=this.childRoot;var pWrapWidth=!this.getAttribute("layout-width")||this.getAttribute("layout-width")==="auto";var pWrapHeight=!this.getAttribute("layout-height")||this.getAttribute("layout-height")==="auto";var pPaddingWidth=layoutRoot.style.paddingRight||0+layoutRoot.style.paddingLeft||0;var pPaddingHeight=layoutRoot.style.paddingTop||0+layoutRoot.style.paddingBottom||0;var root=this.childRoot;for(var i=0;i<root.children.length;i++){var item=root.children[i];if(item.nodeName==="DIV")item=item.firstElementChild;if(adjustment&&typeof item.adjustSize==="function"){item.adjustSize()}if(item.layoutWidth==="match_parent"){if(pWrapWidth){item.setThisWidgetWidth(parseInt(item.marginRight)+parseInt(item.marginLeft)+"px")}else{item.setThisWidgetWidth("100% - "+pPaddingWidth+"px")}}if(item.layoutHeight==="match_parent"){if(pWrapHeight){item.setThisWidgetHeight(parseInt(item.marginTop)+parseInt(item.marginBottom)+"px")}else{item.setThisWidgetHeight("100% - "+pPaddingHeight+"px")}}}},adjustSize:function(){if(this.adjusted===true){for(var i=0;i<this.childRoot.children.length;i++){if(typeof this.childRoot.children[i].adjustSize==="function")this.childRoot.children[i].adjustSize()}return}var isVisible=!!(this.childRoot.offsetWidth||this.childRoot.offsetHeight||this.childRoot.getClientRects().length);if(isVisible===true){this.adjusted=true;this.__setWidgetSize(true)}},addWidget:function(widget){widget.__isRendered=true;this.adjusted=false;this.childRoot.appendChild(widget.template);this.__setWidgetSize(widget.template)},removeWidget:function(widget){var widgetId=typeof widget==="string"?widget:widget.id;var root=this.childRoot;this.adjusted=false;for(var i=0;i<root.children.length;i++){var child=root.children[i];if(widgetId==child.id){this.clearDeepChilds(child);root.removeChild(child)}}},getChildren:function(selector){var topElements=[];if(selector){var elements=this.childRoot.querySelectorAll(selector)}else{var elements=this.childRoot.children}var len=elements.length;for(var i=0;i<len;i++){var item=elements[i];if(item.tagName==="DIV")item=item.firstElementChild;topElements[i]=Top.Dom.__selectImpl(item)}return topElements},hasChild:function(child){if(typeof child=="string"){var childId=child}else{var childId=child.id}if(this.childRoot.querySelector("#"+childId))return true;return false},clear:function(){this.adjusted=false;this.clearChilds()},complete:function(){this.adjustSize()},getTopStyle:function(){this.topstyle=this.querySelector(".top-scrolllayout-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-scrolllayout-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-scrolllayout-root").style.cssText=this.topstyle}};Top.Widget.Layout.Scrolllayout=function(){Scrolllayout.prototype=Object.create(Top.Widget.Layout.prototype);Scrolllayout.prototype.constructor=Scrolllayout;function Scrolllayout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-scrolllayout");this.template.innerHTML='<div class="top-scrolllayout-root"></div>'}this.id=this.template.id}Scrolllayout.create=function(element){return new Scrolllayout(element)};return Scrolllayout}();TopSelectbox={is:"top-selectbox",behaviors:[TopWidgetBehavior,TopGroupBehavior,TopTextBehavior,TopContainerBehavior],properties:{title:String,nodes:{type:Object},selectedIndex:{type:String},selectedText:{type:String},focusTooltip:String,listLocation:String,listMaxHeight:String,value:String,autoWidth:String,autoScroll:String,onChange:String},__ready:function(){this.optValue=[];this.__updateDisabled();if(this.focusTooltip)this.tooltip=this.tooltip||true;this.__updateBoundData("disabled");this.autoWidth=this.autoWidth==="true"||this.autoWidth===true;this.originTitle=this.__i18n(this.title);this.__updateId();this.initItems();this.initialLayout();this.initialChilds();this.renderSelectBox();this.__initBindingEvent()},__updateId:function(){if(this.id){this.childRoot.id=this.id}},__updateFocusTooltip:function(){this.__updateTooltip()},__updateTooltip:function(){var thisPageId=Top.App.getCurrentPage().id;var _this=this;if(this.tooltip){var tooltip;if(typeof this.tooltip==="string"){tooltip=Top.Util.namespace(this.tooltip,this);if(tooltip){this.tooltip=tooltip}}}if(this.focusTooltip)this.tooltip=this.tooltip||true;function setTooltipPosition(e){var x=e.clientX+window.pageXOffset+20,y=e.clientY+window.pageYOffset+20;var tooltipText=document.querySelector("#"+thisPageId+" .top-tooltip-text");var text="";if(_this.tooltip.length){if(_this.hoverIndex>=0){text=_this.tooltip[_this.hoverIndex]}else if(_this.hoverIndex<0){text=""}}else{text=_this.focusTooltip?_this.hoverText:_this.tooltip}if(!text&&_this.focusTooltip){text=_this.selectedText}else if(!text){text=""}tooltipText.innerHTML=_this.__i18n(text);tooltipText.style.top=y+"px";tooltipText.style.left=x+"px";e.preventDefault()}this.__addEventFnByCore("eventMouseEnter",function(){window.addEventListener("mousemove",setTooltipPosition);document.querySelector("#"+thisPageId+" .top-tooltip-text").style.display="inline-block"});this.__addEventFnByCore("eventMouseExit",function(){document.querySelector("#"+thisPageId+" .top-tooltip-text").style.display="none";window.removeEventListener("mousemove",setTooltipPosition)})},__eventBindinList:function(){var div=this.querySelector(".top-selectbox-root");return{__eventMouseClick:function(func){div.onclick=func},__eventMouseEnter:function(func){div.onmouseenter=func},__eventMouseExit:function(func){div.onmouseleave=func},__eventMouseMove:function(func){div.onmousemove=func},__eventMousePressed:function(func){div.onmousedown=func},__eventMouseReleased:function(func){div.onmouseup=func},__eventMouseDblclick:function(func){div.ondblclick=func},__eventKeyPressed:function(func){div.onkeydown=func},__eventKeyTyped:function(func){div.onkeypress=func},__eventKeyReleased:function(func){div.onkeyup=func},__eventFocused:function(func){div.onfocus=func},__eventLostFocused:function(func){div.onblur=func},__eventSecondaryClick:function(func){div.oncontextmenu=func}}},appendTemplate:function(){this.innerHTML='<div class="top-selectbox-root" tabIndex="1">'+this.innerHTML+"</div>";this.__isTemplateAppended=true},__eventBindingList:function(){var shadowDiv=this.querySelector(".top-selectbox-root");return{__eventMouseClick:function(func){shadowDiv.onclick=func},__eventMousePressed:function(func){shadowDiv.onmousedown=func},__eventMouseReleased:function(func){shadowDiv.onmouseup=func},__eventMouseDblclick:function(func){shadowDiv.ondblclick=func},__eventKeyPressed:function(func){shadowDiv.onkeydown=func},__eventKeyTyped:function(func){shadowDiv.onkeypress=func},__eventKeyReleased:function(func){shadowDiv.onkeyup=func},__eventMouseEnter:function(func){shadowDiv.onmouseenter=func},__eventMouseExit:function(func){shadowDiv.onmouseleave=func},__eventMouseMove:function(func){shadowDiv.onmousemove=func},__eventFocused:function(func){shadowDiv.onfocus=func},__eventLostFocused:function(func){shadowDiv.onblur=func},__eventSecondaryClick:function(func){shadowDiv.oncontextmenu=func}}},__attached2:function(){this.__updateAutoWidth()},initializeChildRoot:function(){return this.querySelector(".top-selectbox-root")},initialChilds:function(){for(var i=0;i<this.childRoot.children.length;i++){this.childRoot.children[i].layoutParent=this}},attached:function(){if(this.getElementsByClassName("top-selectbox-container")[0]){this.attachEventHandler()}},__detached:function(){$(document).off("click","#"+this.id+" .top-selectbox-options");$(document).off("click","#"+this.id+" .top-selectbox-container");$(this.childRoot).unbind("keydown")},__initEventInternal:function(){this.__addEventByAttr("change");this.__addEventByAttr("close")},changeSelected:function(){if(typeof this.eventChanged==="string"){this.__eventChanged=Top.Util.namespace(this.eventChanged,this)}if(Top.App.__compatibleWithTOP()===true){if(typeof this.__eventChanged==="function"){this.__eventChanged(event,Top.Dom.selectById(this.id))}else if(typeof this.__eventChanged==="object"){fn.fn(event,Top.Dom.selectById(this.id))}}else if(typeof this.__eventChanged==="function"){var rowInfo={};rowInfo.index=this.dataIndex;this.dataObj[this.columnName]=this.selectedText;rowInfo.data=this.dataObj;this.__eventChanged(this.selectedText,rowInfo,this.value)}if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("change"))}else{this.__dispatchEvent(new Event("change"))}},renderSelectBox:function(){var root=this.childRoot;if(typeof this.nodes=="string"){this.nodes=Top.Util.namespace(this.nodes,this)}if(this.nodes===undefined&&this.widgetItems.length===0&&typeof root.children==="object"){this.renderCustomSelectBox();return}this.clearItems();var optText=[];var optValue=this.optValue;var optDisabled=[];var selectRoot=this.childRoot;var optSeperated=[];if(this.nodes){if(typeof this.nodes[0]==="object"){for(var i=0;i<this.nodes.length;i++){optText[i]=this.nodes[i]["text"];optValue[i]=this.nodes[i]["value"]!==undefined?this.nodes[i]["value"]:optText[i];optDisabled[i]=this.nodes[i]["disabled"];optSeperated[i]=this.nodes[i]["seperated"]}}else{optText=this.nodes;optValue=optText}}else if(this.widgetItems){if(this.items){this.renderSelectBoxByItems();return}for(var i=0;i<this.widgetItems.length;i++){if(this.widgetItems[i].getAttribute("text")!=null){optText[i]=this.widgetItems[i].getAttribute("text");optValue[i]=this.widgetItems[i].getAttribute("value")!=undefined&&this.widgetItems[i].getAttribute("value")!=null?this.widgetItems[i].getAttribute("value"):optText[i];optDisabled[i]=this.widgetItems[i].getAttribute("disabled");optSeperated[i]=this.widgetItems[i].getAttribute("seperated")}else{optText[i]=this.widgetItems[i].text;optValue[i]=this.widgetItems[i].value!==undefined&&this.widgetItems[i].getAttribute("value")!==null?this.widgetItems[i].value:optText[i];optDisabled[i]=this.widgetItems[i].getAttribute("disabled");optSeperated[i]=this.widgetItems[i].getAttribute("seperated")}optText[i]=this.__i18n(optText[i])}}this.allValues=optValue;var fragment=document.createDocumentFragment();var child=document.createElement("ul");child.className="top-selectbox-options";fragment.appendChild(child);var selectBoxOp=child;if(selectBoxOp){if(this.originTitle){child=document.createElement("li");child.className="top-selectbox-option title";child.innerHTML=this.originTitle;selectBoxOp.appendChild(child)}for(var i=0;i<optText.length;i++){child=document.createElement("li");child.className="top-selectbox-option option_"+i;child.setAttribute("data-value",optValue[i]);child.innerHTML=optText[i];selectBoxOp.appendChild(child);if(optDisabled[i]===true||optDisabled[i]==="true"){child.classList.add("disabled")}if(optSeperated[i]===true||optSeperated[i]==="true"){child.classList.add("seperated")}if(this.selectedText&&this.selectedText===optText[i]){child.classList.add("active");this.selectedIndex=i;this.value=optValue[i];this.__updateBoundData("selectedIndex");this.__updateBoundData("value")}else if(this.value&&this.value===optValue[i]){child.classList.add("active");this.selectedIndex=i;this.selectedText=optText[i];this.__updateBoundData("selectedIndex");this.__updateBoundData("selectedText")}else if(this.selectedIndex&&parseInt(this.selectedIndex)===i){this.selectedText=optText[i];this.value=optValue[i];child.classList.add("active");this.__updateBoundData("selectedText");this.__updateBoundData("value")}}}child=document.createElement("span");child.className="top-selectbox-container top-selectbox_collapsed";var child_child=this.querySelector(".top-selectbox-icon");if(child_child===null){child_child=document.createElement("i");child.appendChild(child_child)}child_child.className="top-selectbox-icon icon-arrow_filled_down";if(this.selectedText){child.appendChild(document.createTextNode(this.selectedText))}else if(this.value){child.appendChild(document.createTextNode(this.value))}else if(this.selectedIndex){var selected=this.getElementsByClassName("option_"+this.selectedIndex)[0];if(selected)var selectedIndexingText=selected.innerText;if(selectedIndexingText)child.appendChild(document.createTextNode(selectedIndexingText))}else if(this.originTitle){child.appendChild(document.createTextNode(this.originTitle))}else{child.appendChild(document.createTextNode(" "))}fragment.appendChild(child);root.appendChild(fragment);if(this.separatorVisible){if(this.separatorVisible===true||this.separatorVisible==="true"){var separatorSize=parseInt(this.separatorSize)||1;var separatorColor=this.separatorColor||"#f3f4f5";var separatorStyle="solid";var selectBoxOp_nt_nl=this.getElementsByClassName("top-selectbox-option");var l=selectBoxOp_nt_nl.length;while(l--){if(selectBoxOp_nt_nl[l].classList.contains("title")||l==selectBoxOp_nt_nl.length)continue;selectBoxOp_nt_nl[l].style.borderBottomStyle=separatorStyle;selectBoxOp_nt_nl[l].style.borderBottomColor=separatorColor;selectBoxOp_nt_nl[l].style.borderBottomWidth=separatorSize+"px"}}}this.optValue=optValue;this.__setOptions()},renderSelectBoxByItems:function(){if(typeof this.items==="string"){var items=Top.Util.namespace(this.items,this)}else if(typeof this.items==="object"){var items=this.items}if(!items)return;var root=this.childRoot;this.clearLayout();var child=document.createElement("ul");child.className="top-selectbox-options";root.appendChild(child);var selectBoxOp=this.getElementsByClassName("top-selectbox-options")[0];if(selectBoxOp){if(this.originTitle){var child=document.createElement("li");child.className="top-selectbox-option title";child.innerHTML=this.originTitle;selectBoxOp.appendChild(child)}var layout=this.itemLayout;var switchedItem=this.getSwitchedItem();for(var i=0;i<items.length;i++){if(this.itemSwitchLogic){var child=document.createElement("li");child.className="top-selectbox-option option_"+i;child.innerHTML=switchedItem[i].outerHTML;selectBoxOp.appendChild(child)}else{var child=document.createElement("li");child.className="top-selectbox-option option_"+i;child.innerHTML=layout;selectBoxOp.appendChild(child)}}}var child=document.createElement("span");child.className="top-selectbox-container top-selectbox_collapsed";var child_child=document.createElement("i");child_child.className="top-selectbox-icon icon-arrow_filled_down";child.appendChild(child_child);child.appendChild(document.createTextNode(" "));root.appendChild(child);var topWidget=/^TOP-[a-zA-Z]*/;for(var i=0;i<items.length;i++){if(typeof items[i]==="object"){var keys=Object.keys(items[i]);var listChildren=this.querySelectorAll(".option_"+i+" *");var topWidgets=[];for(var k=0;k<listChildren.length;k++)if(topWidget.test(listChildren[k].tagName))topWidgets.push(listChildren[k]);topWidgets.forEach(function(topWidget){for(var j=0;j<keys.length;j++){var attr=topWidget.attributes;for(var l=0;l<attr.length;l++){if(attr[l].value==="{"+keys[j]+"}"){topWidget.setAttribute(attr[l].name,items[i][keys[j]]);if(topWidget.tagName!=="TOP-WIDGETITEM")topWidget.__updateProperties(attr[l].name)}}}topWidget.id=topWidget.id+"_"+i;if(topWidget.tagName==="TOP-RADIOBUTTON"){if(topWidget.getAttribute("group-id")){topWidget.setAttribute("group-id",topWidget.getAttribute("group-id")+"_"+i)}}})}}var listElement=this.getElementsByClassName("top-selectbox-option");var nodes=[];for(var i=0;i<listElement.length;i++){for(var j=0;j<listElement[i].children.length;j++){if(listElement[i].children[j].getAttribute("data-value")){listElement[i].setAttribute("value",listElement[i].children[j].getAttribute("data-value"))}if(listElement[i].children[j].getAttribute("text")){nodes.push(listElement[i].children[j].getAttribute("text"));listElement[i].setAttribute("text",listElement[i].children[j].getAttribute("text"))}if(listElement[i].children[j].getAttribute("tooltip")){var tooltip=listElement[i].children[j].getAttribute("tooltip");listElement[i].setAttribute("tooltip",tooltip);if(i===0){var tooltipSet=[]}tooltipSet.push(tooltip)}if(listElement[i].children[j].getAttribute("disabled")){listElement[i].classList.add("disabled")}if(listElement[i].children[j].childElementCount===0){var text=listElement[i].children[j].getAttribute("text");listElement[i].innerText=text}}}if(tooltipSet){this.tooltip=tooltipSet;this.__updateTooltip()}this.nodes=nodes;if(this.selectedIndex){var selectBoxOp_i=this.getElementsByClassName("option_"+this.selectedIndex)[0];if(selectBoxOp_i){var selectedText=selectBoxOp_i.getAttribute("text");var selectBoxCont=this.getElementsByClassName("top-selectbox-container")[0];if(selectBoxCont){selectBoxCont.childNodes[1].nodeValue=selectedText;selectBoxOp_i.classList.add("active");this.selectedText=selectedText;this.value=this.optValue[i]!==undefined&&this.optValue[i]!==null?this.optValue[i]:selectedText;this.__updateBoundData("selectedText");this.__updateBoundData("value")}}}if(this.separatorVisible){if(this.separatorVisible===true||this.separatorVisible==="true"){var separatorSize=parseInt(this.separatorSize)||1;var separatorColor=this.separatorColor||"#f3f4f5";var separatorStyle="solid";var selectBoxOp_nt_nl=this.getElementsByClassName("top-selectbox-option");var l=selectBoxOp_nt_nl.length;while(l--){if(selectBoxOp_nt_nl[l].classList.contains("title")||l==selectBoxOp_nt_nl.length)continue;selectBoxOp_nt_nl[l].style.borderBottomStyle=separatorStyle;selectBoxOp_nt_nl[l].style.borderBottomColor=separatorColor;selectBoxOp_nt_nl[l].style.borderBottomWidth=separatorSize+"px"}}}this.__setOptions();this.__updateTitle()},renderCustomSelectBox:function(){this.isCustomSelectBox=true;this.clearItems();var child=document.createElement("ul");child.className="top-selectbox-options";child.style.backgroundColor="#fbfbfb";var root=this.childRoot;root.appendChild(child);var options=this.getElementsByClassName("top-selectbox-options")[0];if(options){if(this.originTitle||this.text){if(this.originTitle){var child=document.createElement("li");child.className="top-selectbox-option title";child.innerText=this.originTitle;options.appendChild(child)}var child=document.createElement("span");child.className="top-selectbox-container top-selectbox_collapsed";var child_child=document.createElement("i");child_child.className="top-selectbox-icon icon-arrow_filled_down";child.appendChild(child_child);child.appendChild(document.createTextNode(this.originTitle||this.text));root.appendChild(child)}else{var child=document.createElement("span");child.className="top-selectbox-container top-selectbox_collapsed";var child_child=document.createElement("i");child_child.className="top-selectbox-icon icon-arrow_filled_down";child.appendChild(child_child);root.appendChild(child)}$(options).append(this.childs);if(options.children.length>0){var children=options.children;for(var i=0,len=children.length;i<len;i++){if(children[i].localName!=="li"){children[i].layoutParent=this}}}}this.__setOptions()},attachEventHandler:function(){var _this=this;var selectContainer=this.getElementsByClassName("top-selectbox-container")[0];var selectOptions=this.getElementsByClassName("top-selectbox-options")[0];if(selectContainer){$(selectContainer).off("click").on("click",function(){if(_this.getAttribute("disabled")!==null)return;var options=this.previousSibling;var selectBoxIcon=this.getElementsByClassName("top-selectbox-icon")[0];if(selectBoxIcon){if(this.classList.contains("active")){options.style.display="none";selectBoxIcon.classList.remove("icon-arrow_filled_up");selectBoxIcon.classList.add("icon-arrow_filled_down");this.classList.remove("top-selectbox_open");this.classList.add("top-selectbox_collapsed");this.classList.remove("active");_this.hoverText="";_this.hoverIndex="";options.style.top="";options.style.left="";options.style.width="";options.style.right="";options.style.bottom="";if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("close"))}else{_this.__dispatchEvent(new Event("close"))}}else{var selectBoxCont_act=document.querySelectorAll(".top-selectbox-container.active");$(selectBoxCont_act).click();options.style.display="block";var height=this.getBoundingClientRect().height;var offsetY=this.getBoundingClientRect().top;var pageHeight=document.body.clientHeight;var optionsHeight=options.offsetHeight;var listMaxHeight;if(_this.listLocation){if(_this.listLocation.startsWith("b")){options.style.top=this.getBoundingClientRect().top+this.getBoundingClientRect().height-1+"px";if(_this.autoScroll===true||_this.autoScroll==="true"){listMaxHeight=pageHeight-(offsetY+height)-1+"px"}}else{options.style.bottom=window.innerHeight-this.getBoundingClientRect().bottom+this.offsetHeight-1+"px";if(_this.autoScroll===true||_this.autoScroll==="true"){listMaxHeight=offsetY-1+"px"}}if(_this.listLocation.endsWith("l")){options.style.left=this.getBoundingClientRect().left+"px"}else{var calcedRight=Math.abs(this.getBoundingClientRect().right-$(document).width());options.style.right=calcedRight+"px"}}else{if(offsetY<pageHeight/2){options.style.top=this.getBoundingClientRect().top+this.getBoundingClientRect().height-1+"px";options.style.left=this.getBoundingClientRect().left+"px";listMaxHeight=pageHeight-(offsetY+height)-1+"px"}else{options.style.bottom=window.innerHeight-this.getBoundingClientRect().bottom+this.offsetHeight-1+"px";options.style.left=this.getBoundingClientRect().left+"px";listMaxHeight=offsetY-1+"px"}options.style.left=this.getBoundingClientRect().left+"px";var calcedRight=options.getBoundingClientRect().right-document.body.clientWidth;if(calcedRight>0){calcedRight=Math.abs(this.getBoundingClientRect().right-document.body.clientWidth);options.style.left="";options.style.right=calcedRight+"px"}}if(_this.listMaxHeight||listMaxHeight){var styleMaxHeight=_this.listMaxHeight||listMaxHeight;_this.querySelector(".top-selectbox-options").style.maxHeight=styleMaxHeight}if(options.offsetWidth<this.offsetWidth){options.style.width=this.offsetWidth-2+"px"}selectBoxIcon.classList.remove("icon-arrow_filled_down");selectBoxIcon.classList.add("icon-arrow_filled_up");this.classList.remove("top-selectbox_collapsed");this.classList.add("top-selectbox_open");this.classList.add("active")}}});$(this).find('.top-selectbox-option:not(".title,.disabled")').off("click").on("click",function(){var selectedText=this.innerText?this.innerText:this.getAttribute("text");var containerElement=this.parentNode.nextSibling;if(!containerElement.childNodes[1]){containerElement.innerHTML+=selectedText}else containerElement.childNodes[1].nodeValue=selectedText;_this.selectedText=selectedText;_this.updateData("selectedText");var index=this.classList[1].split("_");_this.selectedIndex=parseInt(index[1]);_this.value=_this.optValue[_this.selectedIndex]!==undefined&&_this.optValue[_this.selectedIndex]!==null?_this.optValue[_this.selectedIndex]:this.getAttribute("data-value");_this.updateData("selectedIndex");_this.updateData("value");var siblingArray=this.parentNode.children;for(var i=0;i<siblingArray.length;i++){siblingArray[i].classList.remove("active")}this.classList.add("active");var selectBoxOp=_this.getElementsByClassName("top-selectbox_open")[0];if(selectBoxOp)$(selectBoxOp).click();_this.changeSelected()});$(this.querySelectorAll(".top-selectbox-option")).off("mouseenter").on("mouseenter",function(){var selectedText=this.innerText?this.innerText:this.getAttribute("text");var tmpHoverIndex=this.getAttribute("class").split("option_")[1];if(tmpHoverIndex){var hoverIndex=tmpHoverIndex.split(" ")[0]}else{var hoverIndex=-1}_this.hoverIndex=hoverIndex;_this.hoverText=selectedText;_this.updateData("hoverText");_this.updateData("hoverIndex")});if(selectOptions){$(selectContainer).add(selectOptions).on("click",function(e){e.stopPropagation()})}}},__setOptions:function(){var _this=this;this.attachEventHandler();this.__updateAutoWidth()},select:function(value){if(typeof value==="number"){this.selectedIndex=value;this.__updateSelectedIndex();this.updateData("selectedIndex")}else{var selectedOption=this.querySelector('.top-selectbox-option[data-value="'+value+'"]');if(selectedOption){$(selectedOption).click()}else{this.selectedText=value;this.__updateSelectedText();this.updateData("selectedText")}}},selectByIndex:function(index){this.select(this.allValues[index])},close:function(){var selectBoxOp=this.getElementsByClassName("top-selectbox_open");$(selectBoxOp).click()},open:function(){var selectBox=this.getElementsByClassName("top-selectbox-container");$(selectBox).click()},__initBindingEvent:function(){var _this=this;var root=this.childRoot;var containerElement=this.getElementsByClassName("top-selectbox-container")[0];$(root).bind("keydown",function(e){var len=_this.allValues.length;if(_this.getAttribute("disabled")!==null){e.preventDefault();return}if(e.keyCode===39||e.keyCode===40){if(_this.selectedIndex===undefined){_this.select(0)}else if(_this.selectedIndex>=0&&_this.selectedIndex<len-1){_this.select(_this.selectedIndex+1)}e.preventDefault()}else if(e.keyCode===37||e.keyCode===38){if(_this.selectedIndex>0&&_this.selectedIndex<len){_this.select(_this.selectedIndex-1)}e.preventDefault()}else if(e.keyCode===27)_this.close();else if(e.keyCode===13){if(containerElement.classList.contains("top-selectbox_collapsed"))_this.open();else _this.close();e.preventDefault()}});$(root).bind("keypress",function(e){if(containerElement.classList.contains("top-selectbox_collapsed"))_this.open();if(!_this.virtualInput||_this.virtualInput.length>=2)_this.virtualInput="";var key=e.key;_this.virtualInput+=key;var option_list=_this.allValues;for(var i=0;i<option_list.length;i++){if(option_list[i].toLowerCase().startsWith(_this.virtualInput))break}_this.select(i);setTimeout(function(){_this.virtualInput=undefined},200)})},__updateNodes:function(){if(this.__isAttached){this.renderSelectBox()}else{var _this=this;Top.App.onWidgetAttach(function(){_this.renderSelectBox()})}},__updateItems:function(){this.renderSelectBoxByItems()},__updateValue:function(){var selectBoxOp=this.getElementsByClassName("top-selectbox-option");var l=selectBoxOp.length;while(l--){selectBoxOp[l].classList.remove("active")}var selectedItem=this.querySelector('.top-selectbox-option[data-value="'+this.value+'"]');if(selectedItem)selectedItem.classList.add("active");if(!selectedItem)return;if(selectedItem.innerText!==this.selectedText){this.selectedText=selectedItem.innerText;this.updateData("selectedText")}var index=selectedItem.classList[1].split("_");if(this.selectedIndex!==parseInt(index[1])){this.selectedIndex=parseInt(index[1]);this.updateData("selectedIndex")}var selectBoxCont=this.getElementsByClassName("top-selectbox-container")[0];if(selectBoxCont)selectBoxCont.childNodes[1].nodeValue=this.selectedText},__updateSelectedText:function(){var listArray=this.getElementsByClassName("top-selectbox-option");var containerElement=this.getElementsByClassName("top-selectbox-container")[0];if(!containerElement)return;var selectBoxOp=this.getElementsByClassName("top-selectbox-option");var l=selectBoxOp.length;while(l--){selectBoxOp[l].classList.remove("active")}var selectedItems=[];for(var i=0;i<listArray.length;i++){if(listArray[i].innerText===this.selectedText){listArray[i].classList.add("active");selectedItems.push(listArray[i])}}if(selectedItems.length===0){this.value=this.selectedText;this.selectedIndex=undefined;var title=typeof this.originTitle==="string"?this.originTitle:this.selectedText;if(containerElement.childNodes[1])containerElement.childNodes[1].nodeValue=title}else if(selectedItems.length===1){var index=selectedItems[0].classList[1].split("_");if(this.selectedIndex!==parseInt(index[1])){this.selectedIndex=parseInt(index[1]);this.updateData("selectedIndex")}if(this.optValue[this.selectedIndex]!==this.value){this.value=this.optValue[this.selectedIndex];this.updateData("value")}}else if(selectedItems.length>1){}if(selectedItems.length>0&&this.selectedText!==undefined&&this.selectedText!==null)containerElement.childNodes[1].nodeValue=this.selectedText},__updateSelectedIndex:function(){var selectBoxOp=this.getElementsByClassName("top-selectbox-option");var l=selectBoxOp.length;while(l--){selectBoxOp[l].classList.remove("active")}var selectedItem=this.getElementsByClassName("option_"+this.selectedIndex)[0];if(selectedItem!==undefined)selectedItem.classList.add("active");if(this.optValue[this.selectedIndex]!==this.value){this.value=this.optValue[this.selectedIndex];this.updateData("value")}if(selectedItem&&selectedItem.innerText!==this.selectedText){
this.selectedText=selectedItem.innerText;this.updateData("selectedText")}if(this.selectedText){var selectBoxCont=this.getElementsByClassName("top-selectbox-container")[0];if(selectBoxCont)selectBoxCont.childNodes[1].nodeValue=this.selectedText}},__updateDisabled:function(){if(this.disabled===null)this.disabled=this.getAttribute("disabled");var disabled=this.calculateDerivedDisabled();if((disabled==="true"||disabled===true)&&(disabled!=="false"||disabled!==false)){this.setAttribute("disabled","true")}else{this.removeAttribute("disabled")}},__updateTitle:function(){this.originTitle=this.__i18n(this.title);var options=this.querySelector(".top-selectbox-options");if(!this.originTitle){if(this.childRoot.querySelector(".top-selectbox-options").querySelector(".title")){this.childRoot.querySelector(".top-selectbox-options").querySelector(".title").remove()}return}if(!options.querySelector(".title")){$(options).prepend("<li class='top-selectbox-option title'>"+this.originTitle+"</li>")}if(!this.selectedText&&!this.selectedIndex){var item=this.getElementsByClassName("top-selectbox-container")[0];if(item){item.replaceChild(document.createTextNode(this.originTitle),item.lastChild)}}var titleElement=this.getElementsByClassName("title")[0];if(titleElement)titleElement.innerText=this.originTitle;if(this.getAttribute("title")){this.setAttribute("title","")}},focus:function(){this.childRoot.focus()},blur:function(){this.childRoot.blur()},__updateOnChange:function(){this.__addEventByAttr("change")},__updateAutoWidth:function(){var selectContainer=this.getElementsByClassName("top-selectbox-container")[0];var selectOptions=this.getElementsByClassName("top-selectbox-options")[0];var optionWidth;this.autoWidth=this.autoWidth==="true"||this.autoWidth===true;if(selectContainer){if(this.autoWidth){if(!selectOptions)return;selectOptions.style.display="block";optionWidth=selectOptions.offsetWidth;selectOptions.style.display="none";if(optionWidth>selectContainer.offsetWidth)selectContainer.style.width=optionWidth+"px"}else{optionWidth=this.layoutWidth||"";if(optionWidth.indexOf("%")===-1){selectContainer.style.width=optionWidth}}}},getTopStyle:function(){this.topstyle=this.querySelector(".top-selectbox-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){var styleNode=this.querySelector(".top-selectbox-root");if(value){styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-selectbox-root").style.cssText=this.topstyle}};Top.Widget.Group.Selectbox=function(){Selectbox.prototype=Object.create(Top.Widget.Group.prototype);Selectbox.prototype.constructor=Selectbox;function Selectbox(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-selectbox");this.template.innerHTML='<div class="top-selectbox-root" tabIndex="1"></div>'}this.id=this.template.id}Selectbox.create=function(element){return new Selectbox(element)};Selectbox.prototype.select=function(value){this.template.select(value)};Selectbox.prototype.getSelected=function(){return this.template.nodes[this.template.selectedIndex]};Selectbox.prototype.getSelectedText=function(){return this.template.selectedText};Selectbox.prototype.getValue=function(){return this.template.value};Selectbox.prototype.close=function(){this.template.close()};Selectbox.prototype.open=function(){this.template.open()};Selectbox.prototype.getClickedIndex=function(){return this.template.selectedIndex};return Selectbox}();TopSidemenu={is:"top-sidemenu",behaviors:[TopWidgetBehavior,TopMenuBehavior],properties:{items:String,type:{type:Object,reflectToAttribute:true},layoutTop:String,selectedNode:Object},__updateItems:function(){if(typeof this.items==="string"){this.items=Top.Util.namespace(this.items)}},renderLayout:function(){this.__initialize();this.initMenu()},initializeChildRoot:function(){return this.querySelector("div")},initMenu:function(){var sideMenu=this;this.selectedList=[];$("#wrapper").toggleClass("toggled-2");$("#menu ul").hide();$("#menu ul").children(".current").parent().show();$("#menu li a").click(function(){var icon=$(this).find(".children");if($(icon).hasClass("icon-arrow_down color_b")){$(icon).removeClass("icon-arrow_down color_b");$(icon).addClass("icon-arrow_right")}else{$(icon).removeClass("icon-arrow_right");$(icon).addClass("icon-arrow_down color_b children")}var checkElement=$(this).next();if(checkElement.is("ul")){var selected=$("ul.selected");var len=selected.length;for(var i=0;i<len;i++){if(selected[i]!=this&&selected[i]!=this.parentNode.parentNode){var icon=$(selected[i].parentNode).find(".children");icon.removeClass("icon-arrow_down color_b");icon.addClass("icon-arrow_right");$(selected[i]).slideUp();$(selected[i]).removeClass("selected")}}if(checkElement.is(":visible")){checkElement.slideUp()}else{$(checkElement).addClass("selected");checkElement.slideDown()}return false}else{$(sideMenu.querySelector(".active")).removeClass("active");$(this).addClass("active");sideMenu.selectedNode=this.parentNode}});if(this.layoutTop){$("#sidebar-wrapper").css("height","calc(100% - "+this.layoutTop+")")}$("#sidebar-wrapper").mouseleave(function(event){$(this).css("width","50px");$("#menu .children").attr("class","icon-arrow_right children");$("#menu ul:visible").slideUp()});$("#sidebar-wrapper").mouseenter(function(event){var width=sideMenu.getMaxWidth();$(this).css("width",width);$(this.querySelector(".sidebar-nav")).css("width",width);sideMenu.open(sideMenu.selectedNode)})},__ready:function(){this.__updateItems();this.__initialize();this.initMenu()},makeMenu:function(items){var str="";var len=items.length;for(var i=0;i<len;i++){if(items[i].children){if(items[i].hasOwnProperty("icon")){str+="<li><a href='javascript:Top.Util.namespace(\""+items[i].selected+"\")()'><span class='fa-stack fa-lg pull-left'><i class='"+items[i].icon+"'></i></span>"+items[i].text+"</a>"}else{items[i].icon="icon-arrow_right";str+="<li><a href='javascript:Top.Util.namespace(\""+items[i].selected+"\")()'><span class='fa-stack fa-lg pull-left'><i class='"+items[i].icon+" children'></i></span>"+items[i].text+"</a>"}str+="<ul class='nav-pills nav-stacked' style='list-style-type:none;'>";str+=this.makeMenu(items[i].children);str+="</ul></li>"}else{if(!items[i].hasOwnProperty("icon"))items[i].icon="";str+="<li><a href='javascript:Top.Util.namespace(\""+items[i].selected+"\")()'><span class='fa-stack fa-lg pull-left'><i class='"+items[i].icon+"'></i></span>"+items[i].text+"</a></li>"}}return str},__initialize:function(){if($(this).children().length!=0){this.clearMenuItems()}var str="<div id='wrapper'><div id='sidebar-wrapper'><ul class='sidebar-nav nav-pills nav-stacked' id='menu'>";str+=this.makeMenu(this.items);str+="</ul></div></div>";$(this).html(str)},getMaxWidth:function(){var nodes=this.getElementsByTagName("li");var len=nodes.length;var maxText="";var temp="";for(var i=0;i<len;i++){temp=$(nodes[i]).children("a").text();if(temp.length>maxText.length){maxText=temp}}String.prototype.width=function(){var f="13px arial",o=$("<div>"+this+"</div>").css({position:"absolute",float:"left","white-space":"nowrap",visibility:"hidden",font:f}).appendTo($("body")),w=o.width();o.remove();return w};return maxText.width()+110},open:function(selectedNode){if(selectedNode){$(selectedNode.parentNode).slideDown();$(selectedNode.parentNode.parentNode.parentNode).slideDown();$(selectedNode.parentNode.parentNode).find(".children").addClass("icon-arrow_down color_b");$(selectedNode.parentNode.parentNode).find(".children").removeClass("icon-arrow_right")}},getTopStyle:function(){this.topstyle=this.querySelector("div").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.querySelector("div").style[key]=value;this.topstyle=this.querySelector("div").style.cssText}},setAllTopStyle:function(){this.querySelector("div").style.cssText=this.topstyle}};TopSlider={is:"top-slider",behaviors:[TopWidgetBehavior,TopRangeBehavior],properties:{orientation:{type:String,value:"horizontal"},direction:String,onHandlechange:String,onHandledragstart:String,onHandledragend:String},__ready:function(){this.__updateId();this.__updateDisabled();this.min=parseInt(this.min);this.max=parseInt(this.max);this.isRendered=false},appendTemplate:function(){this.innerHTML='<div class="top-slider-root"></div>';this.__isTemplateAppended=true},__eventBindingList:function(){var shadowInput=this.querySelector(".top-slider-root");return{__eventMouseClick:function(func){shadowInput.onclick=func},__eventMousePressed:function(func){shadowInput.onmousedown=func},__eventMouseReleased:function(func){shadowInput.onmouseup=func},__eventMouseDblclick:function(func){shadowInput.ondblclick=func},__eventKeyPressed:function(func){shadowInput.onkeydown=func},__eventKeyTyped:function(func){shadowInput.onkeypress=func},__eventKeyReleased:function(func){shadowInput.onkeyup=func},__eventMouseEnter:function(func){shadowInput.onmouseenter=func},__eventMouseExit:function(func){shadowInput.onmouseleave=func},__eventMouseMove:function(func){shadowInput.onmousemove=func},__eventFocused:function(func){shadowInput.onfocus=func},__eventLostFocused:function(func){shadowInput.onblur=func},__eventSecondaryClick:function(func){shadowInput.oncontextmenu=func}}},__attached2:function(){this.__initialize()},__updateId:function(){if(this.id){var shadowRoot=this.querySelector(".top-slider-root");shadowRoot.id=this.id}},__updateDisabled:function(newValue){if(this.disabled===null)this.disabled=this.getAttribute("disabled");var disabled=this.calculateDerivedDisabled();var shadowRoot=this.querySelector(".top-slider-root");if(disabled=="true"||disabled==true){shadowRoot.setAttribute("disabled","true")}else{shadowRoot.removeAttribute("disabled")}},__initialize:function(){if(this.orientation==="horizontal"){if(!this.direction)this.direction="ltr"}else if(this.orientation==="vertical"){if(!this.direction)this.direction="btt"}this.renderSlider()},renderSlider:function(){var shadowRoot=this.querySelector(".top-slider-root");var direction=this.direction;switch(direction){case"btt":{direction="rtl";break}case"ttb":{direction="ltr";break}}var connect=true;if(!(this.number instanceof Array)){connect=[true,false]}if(typeof this.number!=="string"&&!(this.number instanceof Array)){this.number=this.getAttribute("number")}if(typeof this.number==="string"&&this.number.endsWith("%")){this.number=this.max*parseInt(this.number.replace("%",""))*.01}this.slider=noUiSlider.create(shadowRoot,{start:this.number,step:parseInt(this.step),connect:connect,range:{min:this.min,max:this.max},orientation:this.orientation,direction:direction});this.attachEventHandler();this.isRendered=true},attachEventHandler:function(){this.slider.off();var _this=this;var shadowRoot=this.querySelector(".top-slider-root");var shadowFill=this.querySelector(".top-slider-fill");var shadowBase=this.querySelector(".top-slider-base");if(this.onHandlechange&&typeof this.onHandlechange==="string")var fnHandlechange=Top.Util.namespace(this.onHandlechange,this);if(this.onHandledragend&&typeof this.onHandledragend==="string")var fnHandleDragend=Top.Util.namespace(this.onHandledragend,this);if(this.onHandledragstart&&typeof this.onHandledragstart==="string")var fnHandleDragstart=Top.Util.namespace(this.onHandledragstart,this);this.slider.on("update",function(){var value=this.get();_this.value=value;_this.number=value;_this.updateData("number");_this.updateData("value")});this.slider.on("slide",function(value){if(typeof fnHandlechange==="function"){fnHandlechange(event,Top.Dom.selectById(_this.id),value)}});this.slider.on("start",function(value){shadowBase.classList.add("active");if(typeof fnHandleDragstart==="function"){fnHandleDragstart(event,Top.Dom.selectById(_this.id),value)}});this.slider.on("end",function(value){shadowBase.classList.remove("active");if(typeof fnHandleDragend==="function"){fnHandleDragend(event,Top.Dom.selectById(_this.id),value)}})},__updateNumber:function(){if(typeof this.number==="string"){if(Top.Util.namespace(this.number,this))this.number=Top.Util.namespace(this.number,this);else if(this.number.startsWith("["))this.number=JSON.parse(this.number);else this.number=parseFloat(this.number)}if(this.isRendered){this.slider.set(this.number)}},__updateMin:function(){this.min=parseInt(this.min);this.slider.updateOptions({range:{min:this.min,max:this.max}})},__updateMax:function(){this.max=parseInt(this.max);this.slider.updateOptions({range:{min:this.min,max:this.max}})},__updateStep:function(){this.slider.updateOptions({step:parseInt(this.step)})},__updateOrientation:function(){this.slider.updateOptions({orientation:this.orientation});this.__updateDirection()},__updateDirection:function(){var direction=this.direction;switch(direction){case"btt":{direction="rtl";break}case"ttb":{direction="ltr";break}}this.slider.updateOptions({direction:direction})},getTopStyle:function(){this.topstyle=this.querySelector(".top-slider-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.querySelector(".top-slider-root").style[key]=value;this.topstyle=this.querySelector(".top-slider-root").style.cssText}},setAllTopStyle:function(){this.querySelector(".top-slider-root").style.cssText=this.topstyle}};Top.Widget.Slider=function(){Slider.prototype=Object.create(Top.Widget.prototype);Slider.prototype.constructor=Slider;function Slider(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-slider");this.template.innerHTML='<div class="top-slider-root"></div>'}this.id=this.template.id}Slider.create=function(element){return new Slider(element)};return Slider}();TopSpinner={is:"top-spinner",behaviors:[TopWidgetBehavior,TopTextBehavior],properties:{type:{type:String,value:"number"},step:{type:Number,value:1},valueByType:String,number:{type:String,value:0},min:String,max:String,wrap:String,time:String,format:{type:String,value:"HH:mm"},onChange:String},__attached2:function(){this.__initialize();this.__updateId();this.__updateDisabled();this.__updateValueByType()},appendTemplate:function(){this.innerHTML='<div class="top-spinner-root"><input class="top-spinner-input" type="text"><i class="top-spinner-button up"></i><i class="top-spinner-button down"></i></div>';this.__isTemplateAppended=true},__updateId:function(){if(this.id){var shadowInput=this.querySelector("div input");shadowInput.id=this.id}},__updateValueByType:function(){if(this.valueByType){var shadowInput=this.querySelector("div input");shadowInput.setAttribute("value",this.valueByType)}},__eventBindingList:function(){var shadowInput=this.querySelector(".top-spinner-root");return{__eventMouseClick:function(func){shadowInput.onclick=func},__eventMousePressed:function(func){shadowInput.onmousedown=func},__eventMouseReleased:function(func){shadowInput.onmouseup=func},__eventMouseDblclick:function(func){shadowInput.ondblclick=func},__eventKeyPressed:function(func){shadowInput.onkeydown=func},__eventKeyTyped:function(func){shadowInput.onkeypress=func},__eventKeyReleased:function(func){shadowInput.onkeyup=func},__eventMouseEnter:function(func){shadowInput.onmouseenter=func},__eventMouseExit:function(func){shadowInput.onmouseleave=func},__eventMouseMove:function(func){shadowInput.onmousemove=func},__eventFocused:function(func){shadowInput.onfocus=func},__eventLostFocused:function(func){shadowInput.onblur=func},__eventSecondaryClick:function(func){shadowInput.oncontextmenu=func}}},__initialize:function(){var shadowInput=this.querySelector("input");if(this.type=="number"){this.numberOfD=this.format.match(/d/gi)&&this.format.match(/d/gi).length||0;this.__calcNumber();shadowInput.setAttribute("type","number");shadowInput.setAttribute("min",this.min);shadowInput.setAttribute("max",this.max);shadowInput.setAttribute("step",this.step);shadowInput.setAttribute("value",this.value);shadowInput.setAttribute("title","")}else if(this.type=="time"){var d=new Date;var hour,min,second,period="";var isContainHour=/h/gi;var isContainPeriod=/(am)|(pm)/gi;if(isContainHour.test(this.format)){if(this.format.includes("h"))this.timeSystem="12";else this.timeSystem="24"}if(this.time===undefined||this.time===null){hour=d.getHours().toString();min=d.getMinutes().toString();second=d.getSeconds().toString();this.time=hour+min+second}else{if(/[\s]*p*[\s]*/gi.test(this.time)){this.time=this.time.replace(/[\s]*p*[\s]*/,"")}shadowInput.value=this.time;var numberArray=this.time.match(/[0-9]/g);var timeFormat=this.format.replace(/[\s]*p[\s]*/,"");if(this.timeSystem==="12"){hour=this.time.substring(timeFormat.indexOf("h"),timeFormat.lastIndexOf("h")+1)}else{hour=this.time.substring(timeFormat.indexOf("H"),timeFormat.lastIndexOf("H")+1)}min=this.time.substring(timeFormat.indexOf("m"),timeFormat.lastIndexOf("m")+1);second=this.time.substring(timeFormat.indexOf("s"),timeFormat.lastIndexOf("s")+1)}if(isContainPeriod.test(this.time)){period="";periodArray=this.time.match(isContainPeriod);periodArray.forEach(function(item){period+=item})}else{period=hour>11?"PM":"AM"}if(this.timeSystem==="12"&&hour>11){hour=Math.abs(12-parseInt(hour))}this.numberOfH=this.format.match(/h/gi)&&this.format.match(/h/gi).length||0;this.numberOfM=this.format.match(/m/gi)&&this.format.match(/m/gi).length||0;this.numberOfS=this.format.match(/s/gi)&&this.format.match(/s/gi).length||0;hour=this.__leadingZeros(hour,this.numberOfH);min=this.__leadingZeros(min,this.numberOfM);second=this.__leadingZeros(second,this.numberOfS);this.hour=hour;this.min=min;this.second=second;this.period=period;var newTimeValue=this.format;newTimeValue=newTimeValue.replace(/hh|h/gi,hour);newTimeValue=newTimeValue.replace(/mm|m/gi,min);newTimeValue=newTimeValue.replace(/ss|s/gi,second);newTimeValue=newTimeValue.replace(/p/,period);this.time=newTimeValue;this.valueByType=this.time;this.value=this.time;shadowInput.value=this.time;this.hourIndexRange=this.timeSystem=="12"?[this.format.indexOf("h"),this.format.lastIndexOf("h")]:[this.format.indexOf("H"),this.format.lastIndexOf("H")];this.minIndexRange=[this.format.indexOf("m"),this.format.lastIndexOf("m")];this.secondIndexRange=[this.format.indexOf("s"),this.format.lastIndexOf("s")];this.periodIndexRange=[this.format.indexOf("p"),this.format.indexOf("p")+1];this.order=this.format.split(/[^phms]/gi);var orderLength=this.order.length;var index=0;while(index<orderLength){var item=this.order[index];if(item.match(/hh|h/gi)){this.order[index]="hour"}else if(item.match(/mm|m/gi)){this.order[index]="min"}else if(item.match(/ss|s/gi)){this.order[index]="second"}else if(item.match(/p/gi)){this.order[index]="period"}index++}var startsWithP=/^[\s]*p[\s]*/;if(startsWithP.test(this.format)){addArrayValue(this.hourIndexRange);addArrayValue(this.minIndexRange);addArrayValue(this.secondIndexRange);function addArrayValue(array){if(array[0]===-1)return;array[0]++;array[1]++}}}},__leadingZeros:function(n,digits){var zero="";n=n.toString();if(n==""||isNaN(n))n="0";var minus=n.includes("-");if(minus){n=n.substring(1);zero+="-"}if(n.length<digits){var len=digits-n.length;while(len--){zero+="0"}}return zero+n},__attachEventHandler:function(){var shadowRoot=this.querySelector(".top-spinner-root");var shadowInput=this.querySelector("input");var shadowButtonUp=this.querySelector(".top-spinner-button.up:not([disabled])");var shadowButtonDown=this.querySelector(".top-spinner-button.down:not([disabled])");var _this=this;if(this.type=="number"){$(shadowInput).off("keydown").on("keydown",function(e){if(e.which===38){clickSpinBtn(e,"up");e.preventDefault()}else if(e.which===40){clickSpinBtn(e,"down");e.preventDefault()}if(e.which===69||e.which===110||e.which===190){return false}}).off("keyup").on("keyup",function(e){this.value=event.target.value.replace(/[\ㄱ-ㅎㅏ-ㅣ가-힣]/g,"");_this.value=e.target.value===""?"0":e.target.value;if(parseInt(_this.value)<parseInt(_this.min))_this.value=_this.min;_this.number=_this.value;shadowInput.value=parseInt(_this.value);_this.updateData("number")}).off("focus").on("focus",function(e){shadowRoot.classList.add("active");$(this).off("mousewheel").on("mousewheel",function(e){if(e.originalEvent.wheelDelta/120>0){clickSpinBtn(e,"up")}else{clickSpinBtn(e,"down")}e.preventDefault()})}).off("blur").on("blur",function(){this.value=event.target.value.replace(/[\ㄱ-ㅎㅏ-ㅣ가-힣]/g,"");_this.value=parseInt(_this.value)>parseInt(_this.max)?_this.max:_this.value;_this.value=parseInt(_this.value)<parseInt(_this.min)?_this.min:_this.value;_this.value=_this.__leadingZeros(_this.value,_this.numberOfD);if(this.type=="number"){_this.value=parseInt(_this.value).toString()}this.value=_this.value;_this.valueByType=_this.value;_this.number=this.value;_this.updateData("number");shadowRoot.classList.remove("active")}).off("input").on("input",function(){shadowRoot.classList.add("active")}).off("mouseup").on("mouseup",function(e){e.originalEvent.attribute="input#"+e.target.id});var intervals=[];var interval;$(shadowButtonUp).add(shadowButtonDown).off("mousedown").on("mousedown",function(e){shadowRoot.classList.add("active");clickSpinBtn(e);var count=0;var delay=150;intervals.push(interval=setInterval(numberSpinSpeed,delay));function numberSpinSpeed(){clearInterval(interval);clickSpinBtn(e);count++;delay=count<8?delay:count<16?120:count<36?80:count<101?50:30;interval=setInterval(numberSpinSpeed,delay)}});$(shadowButtonUp).add(shadowButtonDown).off("mouseup").on("mouseup",function(e){for(var i=0;i<intervals.length;i++){clearInterval(intervals.pop())}if(interval)clearInterval(interval)});$(shadowButtonUp).add(shadowButtonDown).off("mouseleave").on("mouseleave",function(e){for(var i=0;i<intervals.length;i++){clearInterval(intervals.pop())}if(interval)clearInterval(interval)});var clickSpinBtn=function(e,direction){var currentValue=shadowInput.value;if(e.target==shadowButtonUp||direction=="up"){var newValue=parseFloat(currentValue)+parseFloat(_this.step);shadowInput.value=newValue>_this.max?_this.wrap==="true"||_this.wrap===true?_this.min:currentValue:newValue}else if(e.target==shadowButtonDown||direction=="down"){var newValue=parseFloat(currentValue)-parseFloat(_this.step);shadowInput.value=newValue<_this.min?_this.wrap==="true"||_this.wrap===true?_this.max:currentValue:newValue}_this.value=_this.__leadingZeros(shadowInput.value,_this.numberOfD);_this.valueByType=_this.value;_this.number=shadowInput.value;_this.updateData("number");_this.__dispatchEvent(new CustomEvent("change",{detail:{oldValue:currentValue,value:_this.value}}))}}else if(this.type=="time"){var selectedRange="";var intervals=[];var interval;$(shadowInput).off("click").on("click",function(e){var thisPosition=doGetCaretPosition(this);if(_this.hourIndexRange[0]!=-1&&_this.hourIndexRange[0]<=thisPosition&&_this.hourIndexRange[1]+1>=thisPosition)selectedRange="hour";else if(_this.minIndexRange[0]!=-1&&_this.minIndexRange[0]<=thisPosition&&_this.minIndexRange[1]+1>=thisPosition)selectedRange="min";else if(_this.secondIndexRange[0]!=-1&&_this.secondIndexRange[0]<=thisPosition&&_this.secondIndexRange[1]+1>=thisPosition)selectedRange="second";else if(_this.periodIndexRange[0]!=-1&&_this.periodIndexRange[0]<=thisPosition&&_this.periodIndexRange[1]+1>=thisPosition)selectedRange="period";setSelectionByRange(this)});$(shadowButtonUp).add(shadowButtonDown).off("mousedown").on("mousedown",function(e){shadowRoot.classList.add("active");var count=0;var delay=150;intervals.push(interval=setInterval(timeSpinSpeed,delay));function timeSpinSpeed(){clearInterval(interval);spinInputValue(e);count++;delay=count<8?delay:count<16?120:count<36?80:count<101?50:30;interval=setInterval(timeSpinSpeed,delay)}});$(shadowButtonUp).add(shadowButtonDown).off("click").on("click",function(e){spinInputValue(e)});$(shadowButtonUp).add(shadowButtonDown).off("mouseup").on("mouseup",function(e){if(e.originalEvent.attribute!=="input#"+_this.id){shadowRoot.classList.remove("active")}for(var i=0;i<intervals.length;i++){clearInterval(intervals.pop())}if(interval)clearInterval(interval)});$(shadowButtonUp).add(shadowButtonDown).off("mouseleave").on("mouseleave",function(e){for(var i=0;i<intervals.length;i++){clearInterval(intervals.pop())}if(interval)clearInterval(interval)});var down={};$(shadowInput).off("keydown").on("keydown",function(e){if(isValidKey(e.keyCode,e.key)){if(e.which===38){spinInputValue(e,"up")}else if(e.which===40){spinInputValue(e,"down")}else{if(down[e.which]!=null){return false}else down[e.which]=true}}else{e.preventDefault();return false}}).off("keyup").on("keyup",function(e){this.value=event.target.value.replace(/[\ㄱ-ㅎㅏ-ㅣ가-힣]/g,"");_this.time=this.value;_this.value=this.value;down[e.which]=null;if(!isValidKey(e.keyCode,e.key)){e.preventDefault();return false}validateTimeValue(e);if(e.which===39||e.which===37){if(!selectedRange)selectedRange=_this.order[0];else{var newIndex=e.which===39?_this.order.indexOf(selectedRange)+1:_this.order.indexOf(selectedRange)-1;if(newIndex<0)newIndex=0;if(newIndex>_this.order.length-1)newIndex=_this.order.length-1;selectedRange=_this.order[newIndex];setSelectionByRange(this)}}}).off("focusout").on("focusout",function(e){this.value=event.target.value.replace(/[\ㄱ-ㅎㅏ-ㅣ가-힣]/g,"");_this.time=this.value;validateTimeValue(e);e.stopPropagation()}).off("focus").on("focus",function(e){shadowRoot.classList.add("active");$(this).off("mousewheel").on("mousewheel",function(e){if(e.originalEvent.wheelDelta/120>0){spinInputValue(e,"up")}else{spinInputValue(e,"down")}})}).off("input").on("input",function(){shadowRoot.classList.add("active")}).off("mouseup").on("mouseup",function(e){e.originalEvent.attribute="input#"+e.target.id});function isValidKey(keycode,key){if(keycode>=37&&keycode<=40||keycode===8||keycode===46)return true;if(/^[0-9]*$/.test(key)===false)return false;var checkP=/^[AMPM]$/gi;var key=String.fromCharCode(keycode);if(selectedRange=="period"){if(!checkP.test(key)){return false}else return true}else{if(!(keycode>=48&&keycode<=57||keycode>=96&&keycode<=105)){return false}else return true}return false}var spinInputValue=function(e,direction){if(!selectedRange)selectedRange=_this.order[_this.order.length-1];if(selectedRange==="hour"){e.target==shadowButtonUp||direction=="up"?changeHourValue("up"):changeHourValue("down")}else if(selectedRange==="min"){e.target==shadowButtonUp||direction=="up"?changeMSValue("up","min"):changeMSValue("down","min")}else if(selectedRange==="second"){e.target==shadowButtonUp||direction=="up"?changeMSValue("up","second"):changeMSValue("down","second")}else if(selectedRange==="period"){changePeriodValue()}_this.value=shadowInput.value;_this.time=shadowInput.value;_this.updateData("time")};function doGetCaretPosition(oField){var iCaretPos=0;if(document.selection){oField.focus();var oSel=document.selection.createRange();oSel.moveStart("character",-oField.value.length);iCaretPos=oSel.text.length}else if(oField.selectionStart||oField.selectionStart=="0")iCaretPos=oField.selectionStart;return iCaretPos}function setSelectionByRange(input){if(selectedRange==="hour"){input.setSelectionRange(_this.hourIndexRange[0],_this.hourIndexRange[1]+1)}else if(selectedRange==="min"){input.setSelectionRange(_this.minIndexRange[0],_this.minIndexRange[1]+1)}else if(selectedRange==="second"){input.setSelectionRange(_this.secondIndexRange[0],_this.secondIndexRange[1]+1)}else if(selectedRange==="period"){input.setSelectionRange(_this.periodIndexRange[0],_this.periodIndexRange[1]+1)}}function changeHourValue(direction,fromMin){var currentValue;var newValue;var index1=_this.hourIndexRange[0];var index2=_this.hourIndexRange[1];var hourStep=fromMin?1:parseFloat(_this.step);currentValue=shadowInput.value.substring(index1,index2+1);if(currentValue==="")currentValue="00";if(isNaN(currentValue))currentValue=_this.hour;newValue=direction=="up"?parseFloat(currentValue)+hourStep:parseFloat(currentValue)-hourStep;switch(_this.timeSystem){case"12":{if(newValue>11){newValue=0;changePeriodValue()}if(newValue<0){newValue=11;changePeriodValue()}break}case"24":{if(newValue>23){newValue=0;changePeriodValue()}if(newValue<0){newValue=23;changePeriodValue()}break}}newValue=_this.__leadingZeros(newValue,_this.numberOfH);_this.hour=newValue;var newTimeValue=_this.format;newTimeValue=newTimeValue.replace(/hh|h/gi,_this.hour);newTimeValue=newTimeValue.replace(/mm|m/gi,_this.min);newTimeValue=newTimeValue.replace(/ss|s/gi,_this.second);newTimeValue=newTimeValue.replace(/p/,_this.period);shadowInput.value=newTimeValue}function changeMSValue(direction,range,fromChild){var currentValue;var newValue;var index1,index2;var digits;var newStep=fromChild?1:parseFloat(_this.step);if(range==="min"){index1=_this.minIndexRange[0];index2=_this.minIndexRange[1];digits=_this.numberOfM}else{index1=_this.secondIndexRange[0];index2=_this.secondIndexRange[1];digits=_this.numberOfS}currentValue=shadowInput.value.substring(index1,index2+1);if(currentValue==="")currentValue="00";if(isNaN(currentValue)){currentValue=range==="min"?_this.min:_this.second}newValue=direction=="up"?parseFloat(currentValue)+newStep:parseFloat(currentValue)-parseFloat(_this.step);if(newValue>59){newValue=parseFloat(currentValue)+newStep-60;range==="min"?changeHourValue("up",true):changeMSValue("up","min",true)}if(newValue<0){newValue=parseFloat(currentValue)-newStep+60;range==="min"?changeHourValue("down",true):changeMSValue("down","min",true)}newValue=_this.__leadingZeros(newValue,digits);if(range==="min")_this.min=newValue;else _this.second=newValue;var newTimeValue=_this.format;newTimeValue=newTimeValue.replace(/hh|h/gi,_this.hour);newTimeValue=newTimeValue.replace(/mm|m/gi,_this.min);newTimeValue=newTimeValue.replace(/ss|s/gi,_this.second);newTimeValue=newTimeValue.replace(/p/,_this.period);shadowInput.value=newTimeValue}function changePeriodValue(){var currentValue,newValue,index1,index2;var testPeriod=/\b(am)|\b(pm)/gi;index1=_this.periodIndexRange[0];index2=_this.periodIndexRange[1];currentValue=shadowInput.value.substring(index1,index2+1);if(!testPeriod.test(currentValue))currentValue=_this.period;newValue=togglePeriod(currentValue);_this.period=newValue;var newTimeValue=_this.format;newTimeValue=newTimeValue.replace(/hh|h/gi,_this.hour);newTimeValue=newTimeValue.replace(/mm|m/gi,_this.min);newTimeValue=newTimeValue.replace(/ss|s/gi,_this.second);newTimeValue=newTimeValue.replace(/p/,_this.period);shadowInput.value=newTimeValue;function togglePeriod(p){var ret;var includeA=/a/gi;if(includeA.test(p)){if(p.includes("a"))ret=p.replace("a","p");else ret=p.replace("A","P")}else{if(p.includes("p"))ret=p.replace("p","a");else ret=p.replace("P","A")}return ret}}function validateTimeValue(e){if(e.type=="blur"||e.which==37||e.which==38||e.which==39||e.which==40||e.which==13){var currentValue;var newValue;var index1,index2;var digits;if(selectedRange==="hour"){index1=_this.hourIndexRange[0];index2=_this.hourIndexRange[1];digits=_this.numberOfH;currentValue=shadowInput.value.substring(index1,index2+1);if(isNaN(currentValue))currentValue=_this.hour;switch(_this.timeSystem){case"12":{if(currentValue>11){currentValue=0}if(currentValue<0){currentValue=11}break}case"24":{if(currentValue>23){currentValue=0}if(currentValue<0){currentValue=23}break}}currentValue=_this.__leadingZeros(currentValue,digits);_this.hour=currentValue}else if(selectedRange==="min"){index1=_this.minIndexRange[0];index2=_this.minIndexRange[1];digits=_this.numberOfM;currentValue=shadowInput.value.substring(index1,index2+1);if(isNaN(currentValue))currentValue=_this.min;if(currentValue>59){currentValue=0}if(currentValue<0){currentValue=59}currentValue=_this.__leadingZeros(currentValue,digits);_this.min=currentValue}else if(selectedRange==="second"){index1=_this.secondIndexRange[0];index2=_this.secondIndexRange[1];digits=_this.numberOfS;currentValue=shadowInput.value.substring(index1,index2+1);if(isNaN(currentValue))currentValue=_this.second;if(currentValue>59){currentValue=0}if(currentValue<0){currentValue=59}currentValue=_this.__leadingZeros(currentValue,digits);_this.second=currentValue}else if(selectedRange==="period"){
var testPeriod=/\b(am)|\b(pm)/gi;index1=_this.periodIndexRange[0];index2=_this.periodIndexRange[1];currentValue=shadowInput.value.substring(index1,index2+1);if(!testPeriod.test(currentValue))currentValue=_this.period;_this.period=currentValue}var newTimeValue=_this.format;newTimeValue=newTimeValue.replace(/hh|h/gi,_this.hour);newTimeValue=newTimeValue.replace(/mm|m/gi,_this.min);newTimeValue=newTimeValue.replace(/ss|s/gi,_this.second);newTimeValue=newTimeValue.replace(/p/,_this.period);shadowInput.value=newTimeValue;_this.value=shadowInput.value;_this.time=shadowInput.value;_this.updateData("time");setSelectionByRange(shadowInput)}else if(e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105){var key=e.key;var tens,units;if(selectedRange==="hour"){index1=_this.hourIndexRange[0];index2=_this.hourIndexRange[1];digits=_this.numberOfH;if(_this.hour.length==2){tens=_this.hour.substr(_this.hour.length-1,1);units=key}else{tens=0;units=key}if(_this.timeSystem=="12"){if(tens>1){tens=0}else if(tens==1&&units>1){tens=0;units="0"}}else if(_this.timeSystem=="24"){if(tens>2){tens=0}else if(tens==2&&units>3){tens=0;units="0"}}if(digits==2)currentValue=tens+units;else{currentValue=units}_this.hour=currentValue}else if(selectedRange==="min"){index1=_this.minIndexRange[0];index2=_this.minIndexRange[1];digits=_this.numberOfM;if(_this.min.length==2){tens=_this.min.substr(_this.min.length-1,1);units=key}else{tens=0;units=key}if(tens>5)tens=0;if(digits==2)currentValue=tens+units;else{currentValue=units}_this.min=currentValue}else if(selectedRange==="second"){index1=_this.secondIndexRange[0];index2=_this.secondIndexRange[1];digits=_this.numberOfS;if(_this.second.length==2){tens=_this.second.substr(_this.second.length-1,1);units=key}else{tens=0;units=key}if(tens>5)tens=0;if(digits==2)currentValue=tens+units;else{currentValue=units}_this.second=currentValue}var newTimeValue=_this.format;newTimeValue=newTimeValue.replace(/hh|h/gi,_this.hour);newTimeValue=newTimeValue.replace(/mm|m/gi,_this.min);newTimeValue=newTimeValue.replace(/ss|s/gi,_this.second);newTimeValue=newTimeValue.replace(/p/,_this.period);shadowInput.value=newTimeValue;_this.value=shadowInput.value;_this.time=shadowInput.value;_this.updateData("time");setSelectionByRange(shadowInput)}}}},__initEventInternal:function(){this.__addEventByAttr("change")},__updateOnChange:function(){this.__addEventByAttr("change")},__updateDisabled:function(){if(this.disabled===null)this.disabled=this.getAttribute("disabled");var disabled=this.calculateDerivedDisabled();var shadowInput=this.querySelector("input");var shadowButton=this.querySelectorAll(".top-spinner-button");if(disabled=="true"||disabled==true){this.setAttribute("disabled",true);shadowInput.setAttribute("disabled",true);shadowButton[0].setAttribute("disabled",true);shadowButton[1].setAttribute("disabled",true);$(this).unbind();$(shadowInput).unbind();$(shadowButton).unbind()}else{this.removeAttribute("disabled");shadowInput.removeAttribute("disabled");shadowButton[0].removeAttribute("disabled");shadowButton[1].removeAttribute("disabled");this.__attachEventHandler()}},__calcNumber:function(){if(!this.max||parseInt(this.number)<=parseInt(this.max)){this.number=Math.round(this.number/this.step)*this.step;this.value=this.__leadingZeros(this.number,this.numberOfD)}if(parseInt(this.number)>parseInt(this.max)){this.number=Math.round(this.max/this.step)*this.step;this.value=this.__leadingZeros(this.number,this.numberOfD)}if(parseInt(this.number)<parseInt(this.min)){this.number=Math.round(this.min/this.step)*this.step;this.value=this.__leadingZeros(this.number,this.numberOfD)}},__updateTime:function(){this.__initialize()},__updateFormat:function(){this.__initialize()},__updateNumber:function(){this.__initialize()},__updateMax:function(){this.__initialize()},__updateMin:function(){this.__initialize()},getTopStyle:function(){this.topstyle=this.querySelector(".top-spinner-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.querySelector(".top-spinner-root").style[key]=value;this.topstyle=this.querySelector(".top-spinner-root").style.cssText}},setAllTopStyle:function(){this.querySelector(".top-spinner-root").style.cssText=this.topstyle}};Top.Widget.Spinner=function(){Spinner.prototype=Object.create(Top.Widget.prototype);Spinner.prototype.constructor=Spinner;function Spinner(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-spinner");this.template.innerHTML='<div class="top-spinner-root"><input class="top-spinner-input" type="text"><i class="top-spinner-button up"></i><i class="top-spinner-button down"></i></div>'}this.id=this.template.id}Spinner.create=function(element){return new Spinner(element)};return Spinner}();TopSplitterlayout={is:"top-splitterlayout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],properties:{orientation:{type:String,value:"horizontal"},splitter:{type:Number,value:1},ratio:{type:String,value:"1:1"},onDrag:String,postResize:String},__ready:function(){this.__updateId();this.initialChilds();this.postResize=this.postResize==="true"||this.postResize===true;this.renderLayout()},__updateId:function(){if(this.id){this.childRoot.id=this.id}},appendTemplate:function(){this.innerHTML='<div class="top-splitterlayout-root">'+this.innerHTML+"</div>";this.__isTemplateAppended=true},__eventBindingList:function(){var shadowDiv=this.querySelector("div");return{__eventMouseClick:function(func){shadowDiv.onclick=func},__eventMousePressed:function(func){shadowDiv.onmousedown=func},__eventMouseReleased:function(func){shadowDiv.onmouseup=func},__eventMouseDblclick:function(func){shadowDiv.ondblclick=func},__eventKeyPressed:function(func){shadowDiv.onkeydown=func},__eventKeyTyped:function(func){shadowDiv.onkeypress=func},__eventKeyReleased:function(func){shadowDiv.onkeyup=func},__eventMouseEnter:function(func){shadowDiv.onmouseenter=func},__eventMouseExit:function(func){shadowDiv.onmouseleave=func},__eventMouseMove:function(func){shadowDiv.onmousemove=func},__eventFocused:function(func){shadowDiv.onfocus=func},__eventLostFocused:function(func){shadowDiv.onblur=func},__eventSecondaryClick:function(func){shadowDiv.oncontextmenu=func}}},attached:function(){this.attachEventHandler();this.__adjustLayoutSize(this.__sizeArray,this.__sizeSum)},__attached2:function(){this.__setWidgetSize()},initialChilds:function(){var root=this.childRoot;this.childs=[];for(var i=0;i<root.children.length;i++){root.children[i].layoutParent=this;if(Top.Util.__isTopWidget(this.childRoot.children[i].tagName))this.childs.push(this.childRoot.children[i])}this.childrenLen=root.children.length},initializeChildRoot:function(){return this.querySelector(".top-splitterlayout-root")},renderLayout:function(){var fragment=document.createDocumentFragment();var sizeArray=[];var sizeSum=0;var layoutRoot=this.childRoot;if(this.onDrag&&typeof this.onDrag==="string"){this.onDrag=Top.Util.namespace(this.onDrag,this)}sizeArray=this.ratio.split(":");if(sizeArray.length!==this.childrenLen){console.warn("Validation Error Message: check ratio property")}for(var i=0;i<sizeArray.length;i++){if(sizeArray[i]==="")sizeArray[i]="0";var size=parseInt(sizeArray[i]);sizeSum+=size}var tempChildArray=[];var childWithoutLocation=[];this.originFirstContentRatio=parseInt(sizeArray[0])/sizeSum*100;this.__sizeArray=sizeArray;this.__sizeSum=sizeSum;var root=this.childRoot;for(var i=0;i<root.children.length;i++){var item=root.children[i];var location=item.getAttribute("layout-split-location");if(location)tempChildArray[parseInt(location)]=item;else tempChildArray[i]=item}if(this.orientation=="vertical"){for(var i=0;i<2;i++){var horizontalAlignment=this.horizontalAlignment||"left";var item=tempChildArray[i];if(item&&item.getAttribute("layout-horizontal-alignment")){horizontalAlignment=item.getAttribute("layout-horizontal-alignment")}var wrapper=document.createElement("div");wrapper.className="top-splitterlayout-content content_"+i;wrapper.style.cssText="text-align: "+horizontalAlignment+";";if(item)wrapper.appendChild(item);fragment.appendChild(wrapper);if(this.splitter>i){var splitter=document.createElement("div");splitter.className="top-splitterlayout-splitter";fragment.appendChild(splitter)}}}else{for(var i=0;i<2;i++){var item=tempChildArray[i];var horizontalAlignment=item?item.getAttribute("layout-horizontal-alignment")||"left":"left";var verticalAlignment=item?item.getAttribute("layout-vertical-alignment")||"top":"top";var wrapper=document.createElement("div");wrapper.className="top-splitterlayout-content content_"+i;wrapper.style.cssText="display:inline-block; text-align:"+horizontalAlignment+"; vertical-align:"+verticalAlignment+";";if(item)wrapper.appendChild(item);fragment.appendChild(wrapper);if(this.splitter>i){var splitter=document.createElement("div");splitter.className="top-splitterlayout-splitter";splitter.style.cssText="display:inline-block;";fragment.appendChild(splitter)}}}root.appendChild(fragment)},__adjustLayoutSize:function(sizeArray,sizeSum){var root=this.childRoot;if(this.orientation==="vertical"){var splitterHeight=root.querySelector(".top-splitterlayout-splitter").offsetHeight;var layouts=root.querySelectorAll(".top-splitterlayout-content");var len=this.childrenLen;for(var i=0;i<len;i++){var height="calc("+parseInt(sizeArray[i])/sizeSum*100+"% - "+parseInt(splitterHeight/len)+"px)";layouts[i].style.width="100%";layouts[i].style.height=height}}else{var splitterWidth=root.querySelector(".top-splitterlayout-splitter").offsetWidth;var layouts=root.querySelectorAll(".top-splitterlayout-content");var len=this.childrenLen;for(var i=0;i<len;i++){var width="calc("+parseInt(sizeArray[i])/sizeSum*100+"% - "+parseInt(splitterWidth/len)+"px)";layouts[i].style.width=width;layouts[i].style.height="100%"}var _this=this;Top.App.onWidgetAttach(this.id,function(){_this.initDefaultWidth()})}},initDefaultWidth:function(){var splitter=this.childRoot.querySelector(".top-splitterlayout-splitter");var firstChild=splitter.previousSibling.firstChild;var defaultWidth=firstChild.getAttribute("default-width");var maxWidth=firstChild.getAttribute("max-width");if(defaultWidth===null)defaultWidth=maxWidth;if(defaultWidth){var initRatio=(parseFloat(defaultWidth)+splitter.offsetWidth/2)/this.childRoot.offsetWidth*100;splitter.previousSibling.style.width=splitter.previousSibling.style.width.replace(/[0-9]*[.]?[0-9]+%/g,initRatio+"%");splitter.nextSibling.style.width=splitter.nextSibling.style.width.replace(/[0-9]*[.]?[0-9]+%/g,100-initRatio+"%");splitter.style.left=splitter.previousSibling.style.width;this.originFirstContentRatio=initRatio}},attachEventHandler:function(){if(this.isAttachedHandler===true)return;this.isAttachedHandler=true;var _this=this;var layoutRoot=this.childRoot;var selected=null,min=0,max=0,prevX,prevY,changeValue;var root=this.childRoot;var splitter=root.querySelector(".top-splitterlayout-splitter");splitter.removeEventListener("mousedown",_dragInit);splitter.addEventListener("mousedown",_dragInit);if(this.__splitMouseUpEvent===undefined){this.__splitMouseUpEvent=function(e){if(selected===null)return;_destroy();_this.removeEventListener("mousemove",_moveElem);_this.removeEventListener("mousemove",_destroy);e.preventDefault();selected=null}}document.removeEventListener("mouseup",this.__splitMouseUpEvent);document.addEventListener("mouseup",this.__splitMouseUpEvent);function _dragInit(e){if(_this.postResize){var splitterMove=document.createElement("div");splitterMove.className="top-splitterlayout-splitter_move";splitterMove.style.cssText=_this.orientation==="vertical"?"top:0px":"left:0px"+";";this.appendChild(splitterMove);selected=splitterMove}else{selected=this}prevX=e.pageX;prevY=e.pageY;changeValue=_this.originFirstContentRatio;_this.originTop=_this.getOffsetTop(this)-_this.getOffsetTop(layoutRoot);_this.originLeft=_this.getOffsetLeft(this)-_this.getOffsetLeft(layoutRoot);_this.addEventListener("mousemove",_moveElem);_this.addEventListener("mouseup",_destroy);e.preventDefault()}function _moveElem(e){if(selected==null)return;var movingValue=_this.orientation==="vertical"?e.pageY-prevY:e.pageX-prevX;var movingRatio=_this.orientation==="vertical"?Math.abs(movingValue)/layoutRoot.offsetHeight*100:Math.abs(movingValue)/layoutRoot.offsetWidth*100;if(movingValue>0){changeValue=_this.originFirstContentRatio+movingRatio}else if(movingValue<0){changeValue=_this.originFirstContentRatio-movingRatio}if(changeValue>100)changeValue=100;else if(changeValue<0)changeValue=0;var maxRatio=(parseFloat(selected.previousSibling.firstChild.getAttribute("max-width"))+splitter.offsetWidth/2)/_this.childRoot.offsetWidth*100;var minRatio=(parseFloat(selected.previousSibling.firstChild.getAttribute("min-width"))+splitter.offsetWidth/2)/_this.childRoot.offsetWidth*100;if(maxRatio&&changeValue>maxRatio)changeValue=maxRatio;if(minRatio&&changeValue<minRatio)changeValue=minRatio;if(_this.orientation==="vertical"){if(_this.postResize){var originTop=selected.style.top;selected.style.top=parseFloat(originTop)+movingValue+"px"}else{selected.previousSibling.style.height=selected.previousSibling.style.height.replace(/[0-9]*[.]?[0-9]+%/g,changeValue+"%");selected.nextSibling.style.height=selected.nextSibling.style.height.replace(/[0-9]*[.]?[0-9]+%/g,100-changeValue+"%");selected.style.top=selected.previousSibling.style.height}}else{if(_this.postResize){var originLeft=selected.style.left;selected.style.left=parseFloat(originLeft)+movingValue+"px"}else{selected.previousSibling.style.width=selected.previousSibling.style.width.replace(/[0-9]*[.]?[0-9]+%/g,changeValue+"%");selected.nextSibling.style.width=selected.nextSibling.style.width.replace(/[0-9]*[.]?[0-9]+%/g,100-changeValue+"%");selected.style.left=selected.previousSibling.style.width}}_this.originFirstContentRatio=changeValue;prevY=e.pageY;prevX=e.pageX;if(_this.onDrag)_this.onDrag(e,Top.Dom.selectById(_this.id));var tableviews=_this.getElementsByTagName("TOP-TABLEVIEW");var len=tableviews.length;for(var i=0;i<len;i++){var tableElement=tableviews[i].getElementsByClassName("multiple-header");if(tableElement.length>0){if(tableviews[i].scrollTable&&(tableviews[i].layoutWidth!==undefined&&(tableviews[i].layoutWidth.indexOf("%")!==-1||tableviews[i].layoutWidth==="match_parent")||tableviews[i].layoutWidth===undefined)&&tableviews[i].dataTable){tableviews[i].dataTable.columns.adjust()}}}e.preventDefault()}function _destroy(){if(selected===null)return;if(_this.postResize){if(_this.orientation==="vertical"){selected.parentNode.previousSibling.style.height=selected.parentNode.previousSibling.style.height.replace(/[0-9]*[.]?[0-9]+%/g,changeValue+"%");selected.parentNode.nextSibling.style.height=selected.parentNode.nextSibling.style.height.replace(/[0-9]*[.]?[0-9]+%/g,100-changeValue+"%");selected.parentNode.style.top=selected.parentNode.previousSibling.style.height}else{selected.parentNode.previousSibling.style.width=selected.parentNode.previousSibling.style.width.replace(/[0-9]*[.]?[0-9]+%/g,changeValue+"%");selected.parentNode.nextSibling.width=selected.parentNode.nextSibling.style.width.replace(/[0-9]*[.]?[0-9]+%/g,100-changeValue+"%");selected.parentNode.style.left=selected.parentNode.previousSibling.style.width}$(root).find("> .top-splitterlayout-splitter .top-splitterlayout-splitter_move").remove()}selected=null}},adjustSize:function(){if(this.adjusted===true){for(var i=0;i<this.childRoot.children.length;i++){var item=this.childRoot.children[i];if(item.nodeName==="DIV"&&item.firstElementChild)item=item.firstElementChild;if(typeof item.adjustSize==="function")item.adjustSize()}return}if(this.childRoot){var isVisible=!!(this.childRoot.offsetWidth||this.childRoot.offsetHeight||this.childRoot.getClientRects().length)}else{var isVisible=!!(this.offsetWidth||this.offsetHeight||this.getClientRects().length)}if(isVisible===true){this.adjusted=true;this.__adjustLayoutSize(this.__sizeArray,this.__sizeSum);this.__setWidgetSize()}},__setWidgetSize:function(){var secondContent=this.childRoot.querySelector(".top-splitterlayout-content.content_1");var splitterElem=this.childRoot.querySelector(".top-splitterlayout-splitter");if(this.orientation==="vertical"){secondContent.style.top=splitterElem.offsetHeight+"px"}else{secondContent.style.left=splitterElem.offsetWidth+"px"}var pWrapWidth=!this.getAttribute("layout-width")||this.getAttribute("layout-width")==="auto",pWrapHeight=!this.getAttribute("layout-height")||this.getAttribute("layout-height")==="auto";var root=this.childRoot;for(var i=0;i<root.children.length;i++){var item=root.children[i];if(item.nodeName==="DIV"&&item.firstElementChild)item=item.firstElementChild;else if(item.nodeName==="DIV"&&!item.firstElementChild)continue;if(typeof item.adjustSize==="function")item.adjustSize();if(item.layoutWidth==="match_parent"){if(pWrapWidth){item.setThisWidgetWidth(parseInt(item.marginRight)+parseInt(item.marginLeft)+"px")}else{item.setThisWidgetWidth("100%")}}if(item.layoutHeight==="match_parent"){if(pWrapHeight){item.setThisWidgetHeight(parseInt(item.marginTop)+parseInt(item.marginBottom)+"px")}else{item.setThisWidgetHeight("100%")}}}},getWidth:function(){return this.childRoot.offsetWidth},getHeight:function(){return this.childRoot.offsetHeight},getChildren:function(selector){var topElements=[];if(selector){var elements=this.childRoot.querySelectorAll(selector)}else{var elements=this.childRoot.children}var len=elements.length;for(var i=0;i<len;i++){var item=elements[i];if(item.nodeName==="DIV"&&item.firstElementChild)item=item.firstElementChild;else if(item.nodeName==="DIV"&&!item.firstElementChild)continue;topElements.push(Top.Dom.__selectImpl(item))}return topElements},hasChild:function(child){if(typeof child=="string"){var childId=child}else{var childId=child.id}if(this.childRoot.querySelector("#"+childId))return true;return false},clear:function(){this.adjusted=false;this.clearChilds()},getTopStyle:function(){this.topstyle=this.querySelector(".top-splitterlayout-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.querySelector(".top-splitterlayout-root").style[key]=value;this.topstyle=this.querySelector(".top-splitterlayout-root").style.cssText}},setAllTopStyle:function(){this.querySelector(".top-splitterlayout-root").style.cssText=this.topstyle},__detached:function(){document.removeEventListener("mouseup",this.__splitMouseUpEvent);this.__splitMouseUpEvent=undefined}};Top.Widget.Layout.Splitterlayout=function(){Splitterlayout.prototype=Object.create(Top.Widget.Layout.prototype);Splitterlayout.prototype.constructor=Splitterlayout;function Splitterlayout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-splitterlayout");this.template.innerHTML='<div class="top-splitterlayout-root"></div>'}this.id=this.template.id}Splitterlayout.create=function(element){return new Splitterlayout(element)};Splitterlayout.prototype.getWidth=function(){return this.template.getWidth()};Splitterlayout.prototype.getHeight=function(){return this.template.getHeight()};return Splitterlayout}();TopStepper={is:"top-stepper",behaviors:[TopWidgetBehavior,TopTextBehavior],properties:{disabled:String,text:String,textAlign:String,steps:Number,radius:Number,spacing:String,labels:{type:Object}},__attached2:function(){var _this=this;if(Top.App.isLoaded()){if(this.layoutParent===undefined){var p=this.getNotInitializedParentRoot();if(p.__redrawChild===undefined)p.__redrawChild=[];var f=function(){_this.__initialize()};p.__redrawChild.push(f)}else{this.__initialize()}}else{Top.App.onBeforeLoad(function(){if(_this.layoutParent===undefined){var p=_this.getNotInitializedParentRoot();if(p.__redrawChild===undefined)p.__redrawChild=[];var f=function(){_this.__initialize()};p.__redrawChild.push(f)}else{_this.__initialize()}})}},getNotInitializedParentRoot:function(){var parent=this.getParent();while(parent.getParent().__initialized===undefined){parent=parent.getParent()}return parent},__initialize:function(){this.__initProperties();var _this=this;if(Top.App.isLoaded()){if(_this.layoutParent===undefined){_this.getParent().__isReadied=function(){_this.renderStepper()}}else{_this.renderStepper()}}else{var _this=this;Top.App.onBeforeLoad(function(){if(_this.layoutParent===undefined){_this.getParent().__isReadied=function(){_this.renderStepper()}}else{_this.renderStepper()}})}},__initProperties:function(){this.nodeIndex=0;this.radius=this.radius||11.5;this.steps=this.steps>2?this.steps:2;if(this.spacing)this.spacing=this.spacing.split("px")[0]*1;this.spacing=this.spacing||.5},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-stepper-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},appendTemplate:function(){this.innerHTML='<svg class = "top-stepper-root"><g class = "top-stepper-lines" ></g><g class = "top-stepper-circles" ><g class = "circles" ></g><g class = "numbers" >< /g></g> <g class = "top-stepper-labels" > </g></svg>';this.__isTemplateAppended=true},__updateId:function(){if(this.id){var shadowRoot=this.querySelector(".top-stepper-root");shadowRoot.id=this.id}},__makePath:function(svgWidth,svgHeight){var linePath=[],lineCount=this.steps-1,height=svgHeight/2,width=svgWidth-this.spacing*2-this.radius*2,interval=width/lineCount;var startPoint=this.spacing,endPoint;var lineGenerator=d3.svg.line();for(var i=0;i<lineCount;i++){if(i===0){startPoint=startPoint+this.radius}var newPath=[[startPoint,height],[startPoint+interval,height]];var pathString=lineGenerator(newPath);linePath.push(pathString);startPoint=startPoint+interval}return linePath},__makePoints:function(svgWidth,svgHeight){var points=[],circleCount=this.steps,height=svgHeight/2,width=svgWidth-this.spacing*2-this.radius*2,interval=width/(circleCount-1);var startPoint=this.spacing,endPoint;for(var i=0;i<circleCount;i++){if(i===0){startPoint=startPoint+this.radius}var newPoint=[startPoint,height];points.push(newPoint);startPoint=startPoint+interval}return points},renderStepper:function(){var svg=this.querySelector(".top-stepper-root");if(this.layoutWidth==null){this.layoutWidth="100%";this.setTopStyle("width",this.layoutWidth)}if(this.layoutHeight==null){this.layoutHeight="100%";this.setTopStyle("height",this.layoutHeight)}this.svgWidth=svg.clientWidth;this.svgHeight=svg.clientHeight;if(typeof this.labels==="string"){this.labels=Top.Util.namespace(this.labels,this)}this.updateSvgLine();this.updateSvgCircle();this.updateSvgLabels()},__updateRadius:function(){if(this.radius<11.5)this.radius=11.5;this.renderStepper()},__updateSteps:function(){this.steps=this.steps>2?this.steps:2;this.renderStepper()},__updateSpacing:function(){if(this.spacing&&typeof this.spacing==="String"){this.spacing=this.spacing.split("px")[0]*1}this.spacing=this.spacing||.5;this.renderStepper()},__updateLabels:function(){this.renderStepper()},updateSvgLine:function(){var _this=this;var svg=this.querySelector(".top-stepper-root"),svgWidth=this.svgWidth,svgHeight=this.svgHeight;var path=this.__makePath(svgWidth,svgHeight);var lineGroup=d3.select(svg).select(".top-stepper-lines");this.d3_line=lineGroup.selectAll("path").data(path);this.d3_line.exit().remove();this.d3_line.enter().append("path");this.d3_line.attr("class",function(d,i){if(_this.nodeIndex>i){return"top-stepper-line stepper-line-"+i+" completed"}else{return"top-stepper-line stepper-line-"+i+" unfocused"}}).attr("d",function(d,i){return d})},updateSvgCircle:function(){var _this=this;var svg=this.querySelector(".top-stepper-root"),svgWidth=this.svgWidth,svgHeight=this.svgHeight;this.points=this.__makePoints(svgWidth,svgHeight);var circleGroup=d3.select(svg).select(".top-stepper-circles").select(".circles");this.d3_circle=circleGroup.selectAll("circle").data(this.points);this.d3_circle.exit().remove();this.d3_circle.enter().append("circle");this.d3_circle.attr("class",function(d,i){if(_this.nodeIndex>i){return"top-stepper-circle stepper-circle-"+i+" completed"}else if(_this.nodeIndex===i){return"top-stepper-circle stepper-circle-"+i+" focused"}else{return"top-stepper-circle stepper-circle-"+i+" unfocused"}}).attr("r",_this.radius).attr("cx",function(d,i){return d[0]}).attr("cy",function(d,i){return d[1]});var numberGroup=d3.select(svg).select(".top-stepper-circles").select(".numbers");this.d3_text=numberGroup.selectAll("text").data(this.points);this.d3_text.exit().remove();this.d3_text.enter().append("text");this.d3_text.attr("class",function(d,i){if(_this.nodeIndex>i){return"top-stepper-number completed"}else if(_this.nodeIndex===i){return"top-stepper-number stepper-number-"+i+" focused"}else{return"top-stepper-number stepper-number-"+i+" unfocused"}}).text(function(d,i){if(_this.nodeIndex<=i)return i+1;else return""}).attr("x",function(d,i){if(_this.nodeIndex<=i){if(i>8){return d[0]-10}else{return d[0]-4}}else{return d[0]-6}}).attr("y",function(d,i){return d[1]+6})},updateSvgLabels:function(){var svg=this.querySelector(".top-stepper-root");var labelsGroup=d3.select(svg).select(".top-stepper-labels");var _this=this,points=this.points;this.d3_labels=labelsGroup.selectAll("text").data(points);this.d3_labels.exit().remove();this.d3_labels.enter().append("text");this.d3_labels.attr("class",function(d,i){if(_this.nodeIndex>i){return"top-stepper-label stepper-label-"+i+" completed"}else if(_this.nodeIndex===i){return"top-stepper-label stepper-label-"+i+" focused"}else{return"top-stepper-label stepper-label-"+i+" unfocused"}}).text(function(d,i){if(_this.labels)return _this.labels[i]}).attr("x",function(d,i){if(_this.textAlign==="left"){return d[0]-_this.radius}else{return d[0]-this.textLength.baseVal.value/2}}).attr("y",function(d,i){return d[1]+(_this.radius+20)})},__updateDisabled:function(){if(this.disabled===null)this.disabled=this.getAttribute("disabled");var disabled=this.calculateDerivedDisabled();if((disabled==="true"||disabled===true)&&(disabled!=="false"||disabled!==false)){this.setAttribute("disabled","true")}else{this.removeAttribute("disabled")}},__updateOnClick:function(){this.__addEventByAttr("click")},focus:function(){this.childRoot.focus()},blur:function(){this.childRoot.blur()},getTopStyle:function(){this.topstyle=this.querySelector("svg").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector("svg");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector("svg").style.cssText=this.topstyle}};Top.Widget.Stepper=function(){Stepper.prototype=Object.create(Top.Widget.prototype);Stepper.prototype.constructor=Stepper;function Stepper(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-stepper");this.template.innerHTML='<svg class = "top-stepper-root"><g class = "top-stepper-lines" ></g><g class = "top-stepper-circles" ><g class = "circles" ></g><g class = "numbers" >< /g></g> <g class = "top-stepper-labels" > </g></svg>'}this.id=this.template.id}Stepper.create=function(element){return new Stepper(element)};Stepper.prototype.next=function(){var _this=this.template;if(_this.nodeIndex<_this.steps-1)_this.nodeIndex=_this.nodeIndex+1;_this.renderStepper()};Stepper.prototype.prev=function(){var _this=this.template;if(_this.nodeIndex>0)_this.nodeIndex=_this.nodeIndex-1;_this.renderStepper()};Stepper.prototype.goTo=function(nodeIndex){var _this=this.template;var index=nodeIndex*1;if(index>0&&index<_this.steps+1){_this.nodeIndex=index-1}_this.renderStepper()};Stepper.prototype.getStatus=function(nodeIndex){var _this=this.template;if(nodeIndex)var index=nodeIndex*1-1;else return;if(_this.nodeIndex===index){return"focused"}else if(_this.nodeIndex<index){return"unfocused"}else{return"completed"}};Stepper.prototype.getStepNumber=function(){var _this=this.template;return _this.nodeIndex+1};return Stepper}();TopSwitch={is:"top-switch",behaviors:[TopWidgetBehavior,TopCheckBehavior,TopTextBehavior],properties:{textOn:{type:String,value:"On"},textOff:{type:String,value:"Off"},onChange:String,checked:{observer:"__callEventChanged"}},__ready:function(){this.__initialize();this.__updateId();this.__updateTextOn();this.__updateTextOff()},__attached2:function(){this.__initLineHeight()},__updateId:function(){if(this.id){var label=this.querySelector("label");label.id=this.id}},appendTemplate:function(){this.innerHTML='<label class="top-switch-root"><input class="top-switch-background" type="checkbox"/><div class="top-switch-slider"><div class="top-switch-on"></div><div class="top-switch-off"></div></label>';this.__isTemplateAppended=true},__eventBindingList:function(){var shadowInput=this.querySelector("label input");return{__eventMouseClick:function(func){shadowInput.onclick=func},__eventMousePressed:function(func){shadowInput.onmousedown=func},__eventMouseReleased:function(func){shadowInput.onmouseup=func},__eventMouseDblclick:function(func){shadowInput.ondblclick=func},__eventKeyPressed:function(func){shadowInput.onkeydown=func},__eventKeyTyped:function(func){shadowInput.onkeypress=func},__eventKeyReleased:function(func){shadowInput.onkeyup=func},__eventMouseEnter:function(func){shadowInput.onmouseenter=func},__eventMouseExit:function(func){shadowInput.onmouseleave=func},__eventMouseMove:function(func){shadowInput.onmousemove=func},__eventFocused:function(func){shadowInput.onfocus=func},__eventLostFocused:function(func){shadowInput.onblur=func}}},__initialize:function(){if(this.disabled==="true")this.disabled=true;if(this.disabled==="false")this.disabled=false;if(this.layoutHeight==="match_parent"){var parent=this.parentNode.parentNode;if(parent.classList.contains("top-gridlayout-cell")){this.layoutHeight=parent.offsetHeight+"px";this.querySelector(".top-switch-root").style.height=this.layoutHeight}}},__initLineHeight:function(){var textOn=this.querySelector(".top-switch-on");var textOff=this.querySelector(".top-switch-off");setTimeout(function(){var height=textOn.offsetHeight+"px";textOn.style.lineHeight=height;textOff.style.lineHeight=height})},on:function(){this.checked=true;this.__updateChecked()},off:function(){this.checked=false;this.__updateChecked()},toggle:function(){if(this.checked==="true"||this.checked===true){this.off()}else{this.on()}},getState:function(){return this.querySelector(".top-switch-background").checked},__callEventChanged:function(newvalue,oldvalue){if(oldvalue===undefined||typeof newvalue==="string"&&newvalue.indexOf("{")>-1||typeof oldvalue==="string"&&oldvalue.indexOf("}")>-1){return}if(typeof this.onChange==="string")this.onChange=Top.Util.namespace(this.onChange,this);if(typeof this.onChange==="function"){this.onChange(new Event("change"),this)}},__updateChecked:function(){var shadowBackground=this.querySelector(".top-switch-root").querySelector(".top-switch-background");if(this.checked===true||this.checked==="true")shadowBackground.checked=true;else shadowBackground.checked=false},__updateTextOn:function(){var shadowOn=this.querySelector(".top-switch-root").querySelector(".top-switch-on");shadowOn.textContent=this.textOn},__updateTextOff:function(){var shadowOff=this.querySelector(".top-switch-root").querySelector(".top-switch-off");shadowOff.textContent=this.textOff},getTopStyle:function(){this.topstyle=this.querySelector(".top-switch-root").style.cssText;
return this.topstyle},setTopStyle:function(key,value){if(value){this.querySelector(".top-switch-root").style[key]=value;this.topstyle=this.querySelector(".top-switch-root").style.cssText}},setAllTopStyle:function(){this.querySelector(".top-switch-root").style.cssText=this.topstyle}};Top.Widget.Switch=function(){Switch.prototype=Object.create(Top.Widget.prototype);Switch.prototype.constructor=Switch;function Switch(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-switch");this.template.innerHTML='<label class="top-switch-root"><input class="top-switch-background" type="checkbox"/><div class="top-switch-slider"><div class="top-switch-on"></div><div class="top-switch-off"></div></label>'}this.id=this.template.id}Switch.create=function(element){return new Switch(element)};Switch.prototype.on=function(){this.template.on()};Switch.prototype.off=function(){this.template.off()};Switch.prototype.toggle=function(){this.template.toggle()};Switch.prototype.getState=function(){return this.template.getState()};return Switch}();TopTablayout={is:"top-tablayout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],properties:{tabs:String,selected:String,onSelect:String,onDeselect:String,paginate:{type:String,value:false},tabPaging:Object,maxTab:Number,currentPage:Number,nextPage:Number,prevPage:Number,onTabchange:String,onTabclose:String,tabMaxWidth:String,custommenu:String,hiddenTabArray:Array},__ready:function(){this.tabId=Top.Util.guid();this.__initI18n("title");this.initialChilds();this.__updateId();this.__updateName();this.__initialClassname();this.renderLayout();this.initClosable();this.__load();if(this.paginate===true||this.paginate==="true"){this.tabPaginate();this.resizeWindow()}this.__attachClickEvent();this.__attachKeyEvent();if(this.selected!==undefined&&this.tabs!==undefined){var selectedIndex=-1;for(var i=0;i<this.tabs.length;i++){if(this.tabs[i].disabled===false||this.tabs[i].disabled==="false"||this.tabs[i].disabled===undefined){selectedIndex=i;break}}if(selectedIndex<0){console.log("all tabs are disabled");for(var i=0;i<this.tabs.length;i++){this.tabs[i].layout.remove()}return}this.selectTab(this.tabs[selectedIndex].id)}else if(this.tabs!==undefined){this.selectTab(this.selected)}},__updateId:function(){if(this.id){this.childRoot.id=this.id}},__updateName:function(){if(this.name){this.childRoot.setAttribute("name",this.name)}},appendTemplate:function(){this.innerHTML='<div class="top-tablayout-root">'+this.innerHTML+"</div>";this.__isTemplateAppended=true},initialChilds:function(){this.childs=[];for(var i=0;i<this.childRoot.children.length;i++){this.childRoot.children[i].layoutParent=this;if(Top.Util.__isTopWidget(this.childRoot.children[i].tagName))this.childs.push(this.childRoot.children[i])}},initializeChildRoot:function(){return this.querySelector(".top-tablayout-root")},__initEventInternal:function(){this.__addEventByAttr("tabchange");this.__addEventByAttr("tabclose")},initializeChildRoot:function(){return this.querySelector(".top-tablayout-root")},__attached2:function(){this.__updateSelected();this.__updateVerticalAlignment();this.attachTooltip()},initClosable:function(){},onLoad:function(func){if(this.__loadEvent===undefined)this.__loadEvent=[];this.__loadEvent.push(func)},isLoaded:function(){return!!this.__isLoaded},__load:function(){this.__isLoaded=true;if(this.__loadEvent!==undefined){for(var i=0,len=this.__loadEvent.length;i<len;i++){this.__loadEvent[i]()}}},__addChildrenLoadEvent:function(fn){Top.App.onWidgetAttach(this.id,fn)},refresh:function(__isFromComplete){__isFromComplete?this.renderLayout(true):this.renderLayout();this.__updateSelected();this.__updateVerticalAlignment()},resizeWindow:function(){var _this=this;$(window).resize($.throttle(500,false,function(e){_this.tabPaginate()}))},tabPaginate:function(tabSelect){var _this=this;var container=this.getElementsByClassName("top-tablayout-container")[0];var table=container.getElementsByTagName("table")[0];var tabTr=this.getElementsByTagName("tr")[0];var firstTab=tabTr.children[1];var navigatorTab=tabTr.children[0];var lastTab=tabTr.children[tabTr.children.length-4];if(this.tableWidth===undefined){this.tableWidth=table.clientWidth}if(this.firstTab_clientWidth===undefined){this.firstTab_clientWidth=firstTab.clientWidth}this.display_tab_length=Math.floor(container.clientWidth/this.firstTab_clientWidth);if(this.display_tab_length>this.tabs.length+1){this.display_tab_length=this.tabs.length+1}if(tabSelect!==false){for(var i=1;i<this.display_tab_length;i++){tabTr.children[i].style.display="table-cell"}for(var i=this.display_tab_length;i<tabTr.children.length-3;i++){tabTr.children[i].style.display="none"}}if(this.tableWidth>container.clientWidth+navigatorTab.clientWidth*2){if(tabSelect!==false){for(var i=1;i<this.display_tab_length;i++){tabTr.children[i].style.display="table-cell"}for(var i=this.display_tab_length;i<tabTr.children.length-3;i++){tabTr.children[i].style.display="none"}}}var alt_display_num=0;if(this.hiddenTabArray!==undefined){for(var i=1;i<this.display_tab_length;i++){for(var j=0;j<this.hiddenTabArray.length;j++){if(this.hiddenTabArray[j]===tabTr.children[i].id){tabTr.children[i].style.display="none";alt_display_num++}}}}var last_tab=tabTr.children[this.display_tab_length-1];for(var i=1;i<tabTr.children.length;i++){if(last_tab.id===tabTr.children[i].id){for(var j=0;j<alt_display_num;j++){if(tabTr.children[i+j+1].classList[0]==="top-tablayout-tab-wrapper"){break}if(tabTr.children[i+j+1]!==undefined){tabTr.children[i+j+1].style.display="table-cell"}}}}if(lastTab.style.display!=="table-cell"){tabTr.children[tabTr.children.length-3].style.display="table-cell";var paginateList=_this.querySelector(".tap_paginate-list");var flag=false;paginateList.innerHTML="";for(var i=tabTr.children.length-4;i>0;i--){if(tabTr.children[i].style.display==="none"){var thisTab=_this.tabs[i-1];var tab=document.createElement("li");tab.setAttribute("id",thisTab.id);tab.classList.add("list_item");if(thisTab.disabled===true){tab.classList.add("tab-disabled")}tab.innerText=thisTab.text;if(thisTab.icon!==undefined&&thisTab.icon!==null){var icon=document.createElement("i");icon.classList.add("icon");icon.classList.add(thisTab.icon);icon.style.marginRight="13px";tab.appendChild(icon)}paginateList.insertAdjacentElement("afterbegin",tab)}else{break}}}else{tabTr.children[tabTr.children.length-3].style.display="none"}if(firstTab.style.display!=="table-cell"){navigatorTab.children[0].style.display="table-cell";var prev_paginateList=container.querySelector(".tap_paginate-prev-list");prev_paginateList.innerHTML="";var flag=false;for(var i=1;i<tabTr.children.length-3;i++){if(tabTr.children[i].style.display==="none"){var thisTab=_this.tabs[i-1];var tab=document.createElement("li");tab.setAttribute("id",thisTab.id);tab.classList.add("list_item");if(thisTab.disabled===true){tab.classList.add("tab-disabled")}tab.innerText=thisTab.text;if(thisTab.icon!==undefined&&thisTab.icon!==null){var icon=document.createElement("i");icon.classList.add("icon");icon.classList.add(thisTab.icon);icon.style.marginRight="13px";tab.appendChild(icon)}prev_paginateList.appendChild(tab);flag=true}else if(flag===true){break}}}else{navigatorTab.children[0].style.display="none"}if(this.custommenu){if(container.querySelector(".tab_custommenu")){return}var custommenu=document.createElement("div");custommenu.classList.add("tab_custommenu");var custommenu_ul=document.createElement("ul");for(var i=0;i<this.custommenu.length;i++){var custommenu_li=document.createElement("li");custommenu_li.innerText=this.custommenu[i].text;custommenu_li.classList.add("custommenu_item");custommenu_ul.appendChild(custommenu_li)}custommenu.appendChild(custommenu_ul);container.appendChild(custommenu)}},__attachKeyEvent:function(){var _this=this;_this.keyShift=false;var tr=_this.querySelector("tr");Top.EventManager.on("keydown",this.id,function(e){if(e.keyCode===16){_this.keyShift=true;setTimeout(function(){_this.keyShift=false},300)}else if(e.keyCode===9&&_this.keyShift===true){for(var i=0;i<tr.children.length;i++){if(_this.selected===tr.children[i].id){tr.children[i-1].click();break}}}else if(e.keyCode===9){for(var i=0;i<tr.children.length;i++){if(_this.selected===tr.children[i].id){tr.children[i+1].click();break}}}})},__attachClickEvent:function(){var _this=this;var container=this.querySelector("#"+this.tabId+".top-tablayout-container");Top.EventManager.on("click",this.id,".top-tablayout-container .top-tablayout-tab-wrapper",function(e){_this.__tabChangeEvent(e.target.children[0])});Top.EventManager.on("click",this.id,".top-tablayout-container .top-tablayout-next",function(e){var list=_this.querySelector(".tab_paginate-container .tap_paginate-list");_this.__tabPaginateEvent(list,e,true);e.stopPropagation()});Top.EventManager.on("click",this.id,".top-tablayout-container .top-tablayout-prev",function(e){var list=_this.querySelector(".tab_paginate-prev-container .tap_paginate-prev-list");_this.__tabPaginateEvent(list,e,false);e.stopPropagation()});Top.EventManager.on("click",this.id,".top-tablayout-container .top-tablayout-plus",function(e){_this.__tabPlusEvent(_this);e.stopPropagation()});Top.EventManager.on("click",this.id,".top-tablayout-container li.list_item",function(e){if(e.target.classList.contains("tab-disabled"))return;_this.__tabDisplayEvent(e);e.stopPropagation()});Top.EventManager.on("click",this.id,".top-tablayout-container .td_menu",function(e){_this.__tabMenuOpenCloseEvent(e);e.stopPropagation()});Top.EventManager.on("click",this.id,".top-tablayout-container li.custommenu_item",function(e){_this.__tabMenuEvent(e);e.stopPropagation()})},__tabMenuOpenCloseEvent:function(e){var custommenu_ul=this.querySelector(".tab_custommenu");if(custommenu_ul.children[0].style.display!=="block"){custommenu_ul.style.left=$(e.target).offset().left+"px";custommenu_ul.children[0].style.display="block"}else custommenu_ul.children[0].style.display="none";this.__currentTabText=e.target.parentNode.innerText;this.__currentTab=e.target.parentNode.parentNode},__tabMenuEvent:function(e){for(var i=0;i<this.custommenu.length;i++){if(this.custommenu[i].text===e.target.innerText){if(typeof this.custommenu[i].callback==="string")var callback=Top.Util.namespace(this.custommenu[i].callback,this);else var callback=this.custommenu[i].callback;var thisTab;for(var j=0;j<this.tabs.length;j++){if(this.tabs[j].text===this.__currentTabText){var thisTab=this.tabs[j];break}}callback(e,this.__currentTab,thisTab);this.__currentTabText=undefined;this.__currentTab=undefined;this.querySelector(".tab_custommenu").style.display="none";break}}},__tabPlusEvent:function(_this){var new_tab={id:this.tabs[this.tabs.length-1].id+"_new",text:this.tabs[this.tabs.length-1].id+"_new"};this.tabs.push(new_tab);var tr=this.querySelector("tr");var cnt=0;var tab_td=document.createElement("td");tab_td.id=new_tab.id;tab_td.classList.add("top-tablayout-tab-wrapper");var td_div=document.createElement("div");td_div.classList.add("top-tablayout-tab");td_div.classList.add("tab_"+new_tab.id);var td_span=document.createElement("span");td_span.classList.add("tab_text");td_span.innerHTML=this.__i18n(new_tab.text);var td_menu=document.createElement("span");td_menu.classList.add("td_menu");td_div.appendChild(td_span);td_div.appendChild(td_menu);tab_td.appendChild(td_div);if(tr.children[tr.children.length-4].style.display==="none"){tab_td.style.display="none"}tr.children[tr.children.length-3].insertAdjacentElement("beforeBegin",tab_td);this.tabPaginate(false)},__tabPaginateEvent:function(list,e,flag){if(list.style.display!="none")list.style.display="none";else list.style.display="block";if(flag===true){target=e.target.tagName==="SPAN"?e.target.parentNode:e.target;left=$(target).offset().left;aa=$(target).offset().top;list.style.left=left+"px";list.style.top=aa+target.clientHeight+"px"}},__tabDisplayEvent:function(e){var list=this.querySelector(".tab_paginate-container .tap_paginate-list");list.style.display="none";var list=this.querySelector(".tab_paginate-prev-container .tap_paginate-prev-list");list.style.display="none";var tab_tr=this.querySelector("tr");var tmp;for(var i=1;i<tab_tr.children.length-3;i++){if(tab_tr.children[i].id===e.target.id){tab_tr.children[i].style.display="table-cell";tmp=i;this.__tabClick(tab_tr.children[i].children[0])}else{tab_tr.children[i].style.display="none"}}for(var j=tmp-1;j>tmp-Math.ceil(this.display_tab_length/2);j--){tab_tr.children[j].style.display="table-cell";if(j<1)break}for(var j=tmp+1;j<tmp+Math.floor(this.display_tab_length/2);j++){tab_tr.children[j].style.display="table-cell";if(j>tab_tr.children.length-4)break}this.tabPaginate(false)},__tabClick:function(target){var __this;var thisTabLayout=this;var tab_tr=this.querySelector("tr");if(target.tagName==="DIV")__this=target.parentNode;else if(target.tagName==="SPAN")__this=target.parentNode.parentNode;if(__this.classList.contains("tab-disabled"))return;for(var j=0;j<tab_tr.children.length;j++){tab_tr.children[j].children[0].classList.remove("active")}__this.children[0].classList.add("active");thisTabLayout.updateData("selected");thisTabLayout.selected=__this.id;thisTabLayout.__addChildrenLoadEvent(function(){if(thisTabLayout.select){thisTabLayout.select(thisTabLayout.objTabs[__this.id])}if(Top.Util.Browser.isIE()){thisTabLayout.__dispatchEvent(new CustomEvent("tabchange"))}else{thisTabLayout.__dispatchEvent(new Event("tabchange"))}if(thisTabLayout.__isIDETab){var selectedChild=thisTabLayout.objTabs[__this.id].layout;if(thisTabLayout.objTabs[__this.id].__isCalled===false){var tmp=thisTabLayout.__setSelectedWidgetSize(selectedChild);thisTabLayout.objTabs[__this.id].__width=tmp[0];thisTabLayout.objTabs[__this.id].__height=tmp[1];thisTabLayout.objTabs[__this.id].__isCalled=true}var width=thisTabLayout.objTabs[__this.id].__width;var height=thisTabLayout.objTabs[__this.id].__height;selectedChild.style.display="";selectedChild.removeTopStyle("width");selectedChild.removeTopStyle("height");selectedChild.setTopStyle("width",width);selectedChild.setTopStyle("height",height);if(typeof selectedChild.adjustSize==="function"){selectedChild.adjustSize()}var tableviews=selectedChild.getElementsByTagName("TOP-TABLEVIEW");var len=tableviews.length;for(var i=0;i<len;i++){tableviews[i].__adjustBytablayout()}if(selectedChild.getAttribute("layout-horizontal-alignment")){thisTabLayout.removeTopStyle("text-align");thisTabLayout.setTopStyle("text-align",selectedChild.getAttribute("layout-horizontal-alignment"))}if(selectedChild.getAttribute("layout-vertical-alignment")){thisTabLayout.hasVerticalAlign=true;selectedChild.setTopStyle("line-height","normal")}for(var k=1;k<thisTabLayout.childRoot.children.length;k++){if(topWidgets[thisTabLayout.childRoot.children[k].tagName.toLowerCase()]!==undefined){if(selectedChild!=thisTabLayout.childRoot.children[k]){thisTabLayout.childRoot.children[k].setTopStyle("width","0px");thisTabLayout.childRoot.children[k].setTopStyle("height","0px");thisTabLayout.childRoot.children[k].style.display="none"}}}}})},__tabChangeEvent:function(event){this.__tabClick(event);if(this.navigator===true||this.navigator==="true"){this.tabPaginate(false)}},createTab:function(containerElement,thisTabLayout){var tab_table=document.createElement("table");tab_table.cellspacing="0";tab_table.cellpadding="1";tab_table.width="100%";var tab_tbody=document.createElement("tbody");var tab_tr=document.createElement("tr");var selectedId=typeof this.selected!=="string"?["0"]:this.selected.split("_");var selectedTabIndex=parseInt(selectedId[selectedId.length-1]);this.tabClickFuct=[];var _this=this;for(var i=0;i<this.tabs.length;i++){var tab_td=document.createElement("td");tab_td.id=this.tabs[i].id;var _this=this;tab_td.classList.add("top-tablayout-tab-wrapper");if(this.tabs[i].disabled===true){tab_td.classList.add("tab-disabled")}var td_div=document.createElement("div");td_div.classList.add("top-tablayout-tab");td_div.classList.add("tab_"+i);var td_span=document.createElement("span");td_span.classList.add("tab_text");td_span.innerHTML=this.__i18n(this.tabs[i].text);td_div.appendChild(td_span);if(_this.custommenu!==undefined){var td_menu=document.createElement("span");td_menu.classList.add("td_menu");td_menu.id=this.tabs[i].id;td_div.appendChild(td_menu)}tab_td.appendChild(td_div);tab_tr.appendChild(tab_td)}if(this.paginate===true||this.paginate==="true"){var nextSpan=document.createElement("td");nextSpan.classList.add("top-tablayout-tab-wrapper");nextSpan.classList.add("top-tablayout-tab-btn");var div=document.createElement("div");div.classList.add("top-tablayout-next");var span=document.createElement("span");span.classList.add("list");span.style.marginLeft="-8px";div.appendChild(span);nextSpan.appendChild(div);tab_tr.children[tab_tr.children.length-1].insertAdjacentElement("afterend",nextSpan);var prevSpan=document.createElement("td");prevSpan.classList.add("top-tablayout-tab-wrapper");prevSpan.classList.add("top-tablayout-tab-btn");var div=document.createElement("div");div.classList.add("top-tablayout-prev");var span=document.createElement("span");span.classList.add("list");span.style.marginLeft="-8px";div.appendChild(span);prevSpan.appendChild(div);tab_tr.children[0].insertAdjacentElement("beforeBegin",prevSpan);var plusSpan=document.createElement("td");plusSpan.classList.add("top-tablayout-tab-wrapper");var plusDiv=document.createElement("div");plusDiv.classList.add("top-tablayout-plus");var span=document.createElement("span");span.style.marginLeft="-8px";plusDiv.appendChild(span);plusSpan.appendChild(plusDiv);tab_tr.children[tab_tr.children.length-1].insertAdjacentElement("afterend",plusSpan);var container=this.getElementsByClassName("top-tablayout-container")[0];var prev_paginateList=document.createElement("div");prev_paginateList.classList.add("tap_paginate-prev-list");prev_paginateList.style.display="none";var paginatePrevContainer=document.createElement("div");paginatePrevContainer.classList.add("tab_paginate-prev-container");paginatePrevContainer.appendChild(prev_paginateList);container.appendChild(paginatePrevContainer);var paginateContainer=document.createElement("div");paginateContainer.classList.add("tab_paginate-container");var paginateList=document.createElement("div");paginateList.classList.add("tap_paginate-list");paginateList.style.display="none";paginateContainer.appendChild(paginateList);container.appendChild(paginateContainer)}var tab_td=document.createElement("td");tab_td.id=this.id+"_right";tab_td.width="100%";var td_div=document.createElement("div");td_div.classList.add("top-tablayout-tab");td_div.classList.add("last");tab_td.appendChild(td_div);tab_tr.appendChild(tab_td);tab_tbody.appendChild(tab_tr);tab_table.appendChild(tab_tbody);containerElement.appendChild(tab_table);if(this.__isIDETab){var selectedId=typeof this.selected!=="string"?["0"]:this.selected.split("_");var selectedTabIndex=parseInt(selectedId[selectedId.length-1]);var child=this.childRoot.children[selectedTabIndex+1];if(child&&child.getAttribute("layout-tab-name")){this.selected=this.id+"_"+this.__i18n(child.getAttribute("layout-tab-name")).replace(/ /g,"")+"_"+selectedTabIndex}var layoutRoot=this.childRoot;layoutRoot.style.overflow="hidden"}},renderLayout:function(hasNewChild){var containerElement=this.querySelector("#"+this.tabId+".top-tablayout-container");var root=this.childRoot;if(containerElement==null){containerElement=document.createElement("div");containerElement.className="top-tablayout-container";containerElement.id=this.tabId;root.insertBefore(containerElement,root.firstChild)}if(hasNewChild){while(containerElement.firstChild){containerElement.removeChild(containerElement.firstChild)}}if(typeof this.tabs==="string"){this.tabs=Top.Util.namespace(this.tabs,this)}else if((!this.tabs||hasNewChild)&&Top.App.__compatibleWithTOP()){this.tabs=[];for(var i=1;i<root.children.length;i++){var child=root.children[i];if(child.getAttribute("layout-tab-name")){var tabName=this.__i18n(child.getAttribute("layout-tab-name"));var tabDisabled=child.getAttribute("layout-tab-disabled")==="true"||child.getAttribute("layout-tab-disabled")===true?true:false;this.tabs.push({id:this.id+"_"+tabName.replace(/ /g,"")+"_"+(i-1),text:tabName,layout:child,disabled:tabDisabled,__isCalled:false});if(child.attributes["layout-tab-icon"]){this.tabs[i].image=child.attributes["layout-tab-icon"].nodeValue}}}this.__isIDETab=true}var len=this.tabs.length;this.objTabs={};for(var i=0;i<len;i++){this.objTabs[this.tabs[i].id]=this.tabs[i]}if(typeof this.onSelect=="string"){this.select=Top.Util.namespace(this.onSelect,this)}if(typeof this.onDeselect=="string"){this.deselect=Top.Util.namespace(this.onDeselect,this)}if(!this.beforeTabId){this.beforeTabId=this.selected}if(typeof this.custommenu==="string"){this.custommenu=Top.Util.namespace(this.custommenu,this)}this.createTab(containerElement,this)},postClose:function(event){},appendPaginateButton:function(tabs,last){},setFocusedPage:function(selectedTab){},add:function(tab){this.tabs.push(tab);this.__updateTabs()},insert:function(index,tab){this.tabs.splice(index,0,tab);this.__updateTabs()},remove:function(id){var index=-1;for(var i=0,len=this.tabs.length;i<len;i++){if(this.tabs[i].id===id){index=i;break}}if(index>-1){this.tabs.splice(index,1);this.__updateTabs()}},current:function(){return this.selected},selectTab:function(tabId){var selected=tabId?tabId:this.selected;if(selected)this.childRoot.querySelector("#"+selected.replace(/\//g,"\\/").replace(/\&/g,"\\&")).click()},selectTabByIndex:function(index){this.selectTab(this.tabs[index].id)},focus:function(tabId){if(this.isLoaded()){this.selected=tabId;this.childRoot.querySelector("#"+this.selected.replace(/\//g,"\\/")).click()}else{var _this=this;this.onLoad(function(){_this.selected=tabId;_this.childRoot.querySelector("#"+_this.selected.replace(/\//g,"\\/")).click()})}},blur:function(){this.selected=undefined;this.childRoot.querySelector("div.active").classList.remove("active")},append:function(tab,html){},clear:function(tab){},hiddenContent:function(){},updateTitle:function(){},setTitle:function(title){},setImage:function(tab,src){},attachTooltip:function(){},attachEventHandler:function(){},detachEventHandler:function(){},__updateSelected:function(){if(this.selected&&this.tabs&&this.tabs.length>0){var selectedTab=this.childRoot.querySelector("#"+this.selected.replace(/\//g,"\\/").replace(/ /g,"").replace(/\&/g,"\\&"));if(selectedTab!==null)selectedTab.click()}},__updateTabs:function(){this.__isIDETab=false;this.refresh()},__updateTabMaxWidth:function(){},__setSelectedWidgetSize:function(selected){var layoutRoot=this.childRoot;var layoutContainer=this.childRoot.querySelector(".top-tablayout-container");var pWrapWidth=!this.getAttribute("layout-width")||this.getAttribute("layout-width")==="auto";var pWrapHeight=!this.getAttribute("layout-height")||this.getAttribute("layout-height")==="auto";var ret=new Array;if(selected.getAttribute("layout-width")==="match_parent"){if(pWrapWidth){ret[0]=selected.setThisWidgetWidth(parseInt(selected.marginRight)+parseInt(selected.marginLeft)+"px")}else{ret[0]=selected.setThisWidgetWidth("100%")}}else{ret[0]=selected.layoutWidth}if(selected.layoutHeight==="match_parent"){if(pWrapHeight){ret[1]=selected.setThisWidgetHeight(parseInt(selected.marginTop)+parseInt(selected.marginBottom)+"px")}else{var spaceSize=layoutContainer.offsetHeight;var layoutHeight="100% - "+spaceSize+"px";ret[1]=selected.setThisWidgetHeight(layoutHeight)}}else{ret[1]=selected.layoutHeight}if(typeof selected.adjustSize==="function"){selected.adjustSize()}if(ret)return ret},__setWidgetSize:function(){return;var layoutRoot=this.childRoot;var layoutContainer=this.childRoot.querySelector(".top-tablayout-container");var pWrapWidth=!this.getAttribute("layout-width")||this.getAttribute("layout-width")==="auto";var pWrapHeight=!this.getAttribute("layout-height")||this.getAttribute("layout-height")==="auto";var root=this.childRoot;for(var i=1;i<root.children.length;i++){var item=root.children[i];if(item.getAttribute("layout-width")==="match_parent"){if(pWrapWidth){item.setThisWidgetWidth(parseInt(item.marginRight)+parseInt(item.marginLeft)+"px")}else{item.setThisWidgetWidth("100%")}}if(item.layoutHeight==="match_parent"){if(pWrapHeight){item.setThisWidgetHeight(parseInt(item.marginTop)+parseInt(item.marginBottom)+"px")}else{var spaceSize=layoutContainer.offsetHeight;var layoutHeight="100% - "+spaceSize+"px";item.setThisWidgetHeight(layoutHeight)}}}},__updateOnTabchange:function(){this.__addEventByAttr("tabchange")},__updateOnTabclose:function(){this.__addEventByAttr("tabclose")},__updatePaginate:function(){},__updateVerticalAlignment:function(){var vertical_align=this.getAttribute("vertical-alignment")||"top";if(this.getAttribute("vertical-alignment")||this.hasVerticalAlign){var layoutRoot=this.childRoot;var layoutContainer=this.childRoot.querySelector(".top-tablayout-container");if(layoutRoot.style.paddingTop==="")layoutRoot.style.paddingTop=0;if(layoutRoot.style.paddingBottom==="")layoutRoot.style.paddingBottom=0;this.removeTopStyle("line-height");this.setTopStyle("line-height",layoutRoot.clientHeight-layoutContainer.offsetHeight-parseInt(layoutRoot.style.paddingTop)-parseInt(layoutRoot.style.paddingBottom)+"px");layoutContainer.style.lineHeight="normal";for(var i=1;i<this.children.length;i++){var child=this.children[i];if(!child.getAttribute("layout-vertical-alignment")){child.setTopStyle("line-height","normal");child.setTopStyle("vertical-align",vertical_align)}}}},getChildren:function(selector){var topElements=[];if(selector){var elements=this.childRoot.querySelectorAll(selector)}else{var elements=this.childRoot.children}var len=elements.length;for(var i=0;i<len;i++){var item=elements[i];if(item.classList.contains("top-tablayout-container"))continue;topElements.push(Top.Dom.__selectImpl(item))}return topElements},hasChild:function(child){if(typeof child=="string"){var childId=child}else{var childId=child.id}if(this.childRoot.querySelector("#"+childId))return true;return false},addWidget:function(widget){var child=widget.template;if(child.getAttribute("layout-tab-name")){var tabName=child.getAttribute("layout-tab-name");var tab={id:this.id+"_"+tabName.replace(/ /g,"")+"_"+this.tabs.length,text:tabName,layout:child,__isCalled:false};if(child.attributes["layout-tab-icon"]){tab.image=child.getAttribute("layout-tab-icon")}this.tabs.push(tab);this.childRoot.appendChild(child)}},removeWidget:function(widget){var widgetId=typeof widget==="string"?widget:widget.id;var root=this.childRoot;for(var i=1;i<root.children.length;i++){var child=root.children[i];if(widgetId==child.id){var tab=root.querySelectorAll("td.top-tablayout-tab-wrapper")[i-1];tab.parentNode.removeChild(tab);if(this.selected===this.tabs[i-1].id){this.tabs.splice(i-1,1);this.clearDeepChilds(child);root.removeChild(child);if(this.tabs.length>1)this.focus(this.tabs[0].id);break}else{this.tabs.splice(i-1,1);this.clearDeepChilds(child);root.removeChild(child);break}}}},getTopStyle:function(){this.topstyle=this.querySelector(".top-tablayout-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.querySelector(".top-tablayout-root").style[key]=value;this.topstyle=this.querySelector(".top-tablayout-root").style.cssText}},setAllTopStyle:function(){this.querySelector(".top-tablayout-root").style.cssText=this.topstyle},__detached:function(){for(var i=0;i<this.tabs.length;i++){this.tabClickFuct[i]=null}this.tabClickFuct=undefined}};Top.Widget.Layout.Tablayout=function(){Tablayout.prototype=Object.create(Top.Widget.Layout.prototype);Tablayout.prototype.constructor=Tablayout;function Tablayout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-tablayout");this.template.innerHTML='<div class="top-tablayout-root"></div>'}this.id=this.template.id}Tablayout.create=function(element){return new Tablayout(element)};Tablayout.prototype.add=function(tab){this.template.add(tab)};Tablayout.prototype.insert=function(index,tab){this.template.insert(index,tab)};Tablayout.prototype.close=function(id){this.template.remove(id)};Tablayout.prototype.current=function(){return this.template.current()};Tablayout.prototype.select=function(tabId){if(typeof tabId==="number"){this.template.selectTabByIndex(tabId)}else{this.template.selectTab(tabId)}};Tablayout.prototype.focus=function(tabId){this.template.focus(tabId)};Tablayout.prototype.blur=function(){this.template.blur()};Tablayout.prototype.append=function(tab,html){this.template.hiddenContent();this.template.append(tab,html)};Tablayout.prototype.appendFile=function(tab,filePath){var template=this.template;template.hiddenContent();Top.Ajax.get(filePath,"","",function(data,textStatus,jqXHR){template.append(tab,data)},"")};Tablayout.prototype.clear=function(tab){this.template.clear(tab)};Tablayout.prototype.setTitle=function(title){this.template.setTitle(title)};Tablayout.prototype.setImage=function(tab,src){this.template.setImage(tab,src)};Tablayout.prototype.getSelectedTab=function(){if(typeof this.template.tabs==="object"){var tabs=this.template.tabs;var selectedTabId=this.template.selected;for(var i=0,len=tabs.length;i<len;i++){if(tabs[i].id===selectedTabId){return tabs[i]}}return selectedTabId}else{return this.template.selected}};Tablayout.prototype.getSelectedTabIndex=function(){if(typeof this.template.tabs==="object"){var tabs=this.template.tabs;var selectedTabId=this.template.selected;for(var i=0,len=tabs.length;i<len;i++){if(tabs[i].id===selectedTabId){return i}}}};Tablayout.prototype.complete=function(){this.template.refresh(true);this.select(this.template.selected)};Tablayout.prototype.hiddenTab=function(tabId){if(this.template.hiddenTabArray===undefined)this.template.hiddenTabArray=new Array;var tr=this.template.querySelector("tr");var len=tr.children.length-1;if(this.template.paginate==="true"||this.template.paginate===true){len-2}for(var i=0;i<tr.children.length;i++){if(tr.children[i].id===tabId){tr.children[i].style.display="none";this.template.hiddenTabArray.push(tabId);if(this.template.selected===tabId){if(i+1>len)tr.children[i-1].click();else tr.children[i+1].click()}}}};Tablayout.prototype.hiddenTabByIndex=function(index){var tr=this.template.querySelector("tr");var len=tr.children.length-1;if(this.template.paginate==="true"||this.template.paginate===true){index++;len-2}if(tr.children[index]!==undefined){tr.children[index].style.display="none";if(this.template.hiddenTabArray===undefined)this.template.hiddenTabArray=new Array;this.template.hiddenTabArray.push(tr.children[index].id);if(this.template.selected===tr.children[index].id){if(index+1>len)tr.children[index-1].click();else tr.children[index+1].click()}}};Tablayout.prototype.removeHiddenTab=function(tabId){if(this.template.hiddenTabArray!==undefined){for(var i=0;i<this.template.hiddenTabArray.length;i++){if(tabId===this.template.hiddenTabArray[i]){this.template.hiddenTabArray.splice(i,1);break}}if(this.template.hiddenTabArray.length===0)this.template.hiddenTabArray=undefined}console.log(this.template.paginate);if(this.template.paginate==="true"||this.template.paginate===true){this.template.tabPaginate()}else{var tr=this.template.querySelector("tr");for(var i=0;i<tr.children.length;i++){if(tr.children[i].id===tabId)tr.children[i].style.display="table-cell"}}};return Tablayout}();TopTableview={is:"top-tableview",behaviors:[TopWidgetBehavior,TopContainerBehavior],properties:{dataTable:{type:Object},paginate:{type:String,value:false},pageLength:{type:Number,value:-1},lengthMenu:{type:Object,value:[{text:"10",value:10},{text:"25",value:25},{text:"50",value:50}]},lengthChange:{type:String,value:false},pagerType:{type:String,value:"basic"},pagerMaxVisible:{type:String,value:20},pagerLocation:{type:String,value:"bc"},showresult:{type:String,value:true},orientation:{type:String,value:"horizontal"},rowSelected:{type:String,reflectToAttribute:true},rowDblclicked:{type:String,reflectToAttribute:true
},onCellSelect:String,onEmpty:String,sortable:{type:String,value:true},editable:String,order:{type:Object,value:[]},checkable:{type:String,value:false},checkedaa:{type:String,value:false},onCheck:{type:String,reflectToAttribute:true},onCheckhead:{type:String,reflectToAttribute:true},column:{type:Object,reflectToAttribute:true},columnOption:{type:String,reflectToAttribute:true},columnName:{type:String,reflectToAttribute:true},columnReorder:{type:String,value:false},columnResize:{type:String,value:false},cellOption:{type:String,reflectToAttribute:true},headerOption:{type:String,reflectToAttribute:true},readonly:{type:String,value:true,reflectToAttribute:true},emptyMessage:{type:String,value:"No data available in table",reflectToAttribute:true},scrollBodyHeight:{type:String,value:"",reflectToAttribute:true},horizontalScroll:false,selectedIndex:{type:Number,value:-1},selectType:{type:String,value:"row"},virtualScroll:{type:String,value:true},onScrollend:String,onRowclick:String,onRowdblclick:String,onRowcontextmenu:String,onCellclick:String,onCelldblclick:String,onCellcontextmenu:String,onRowcheck:String,onHeadercheck:String,onNodata:String,checkOption:String,indexOption:String,treeOption:String,indexable:String,onIndexclick:String,dataLength:Number,onPagechange:String,onLengthchange:String,onUpdate:String,onEdit:String,onHeaderclick:String,onHeaderdbclick:String,storeColumn:String,storeKey:String},appendTemplate:function(){this.innerHTML='<div class="top-tableview">'+this.innerHTML+"</div>";this.__isTemplateAppended=true},expectedTemplateClassName:function(){return"top-tableview"},__ready:function(){if(!this.layoutVerticalAlignment){this.layoutVerticalAlignment="top"}this.__updateId();this.__updateName();this.initialChilds();this.initialLayout();this.__initialClassname();this.__initI18n("column");this.__initI18n("emptyMessage");this.__initialized=true;if(Top.App.isLoaded()){this.renderLayout()}else{var _this=this;Top.App.onLoad(function(){_this.renderLayout()})}},__updateId:function(){if(this.id){this.childRoot.id=this.id}},__updateName:function(){if(this.name){this.childRoot.setAttribute("name",this.name)}},__eventBindingList:function(){var div=this.querySelector("div");return{__eventMouseClick:function(func){div.onclick=func},__eventMouseEnter:function(func){div.onmouseenter=func},__eventMouseExit:function(func){div.onmouseleave=func},__eventMouseMove:function(func){div.onmousemove=func},__eventMousePressed:function(func){div.onmousedown=func},__eventMouseReleased:function(func){div.onmouseup=func},__eventMouseDblclick:function(func){div.ondblclick=func},__eventKeyPressed:function(func){div.onkeydown=func},__eventKeyTyped:function(func){div.onkeypress=func},__eventKeyReleased:function(func){div.onkeyup=func},__eventFocused:function(func){div.onfocus=func},__eventLostFocused:function(func){div.onblur=func},__eventSecondaryClick:function(func){div.oncontextmenu=func}}},__initEventInternal:function(){this.__addEventByAttr("scrollend");this.__addEventByAttr("rowclick");this.__addEventByAttr("rowdblclick");this.__addEventByAttr("rowcontextmenu");this.__addEventByAttr("cellclick");this.__addEventByAttr("celldblclick");this.__addEventByAttr("cellcontextmenu");this.__addEventByAttr("rowcheck");this.__addEventByAttr("headercheck");this.__addEventByAttr("nodata");this.__addEventByAttr("pagechange");this.__addEventByAttr("lengthchange");this.__addEventByAttr("update");this.__addEventByAttr("edit");this.__addEventByAttr("headerclick");this.__addEventByAttr("headerdbclick")},__attached2:function(){var thisTable=this;this.setColWidget();this.attachTooltip();var root=this.childRoot;if(this.separatorVisible){if(this.separatorVisible===true||this.separatorVisible==="true"){var addRule=function(sheet,selector,styles){if(sheet.insertRule)return sheet.insertRule(selector+" {"+styles+"}",sheet.cssRules.length);if(sheet.addRule)return sheet.addRule(selector,styles)};if(this.separatorSize&&parseInt(this.separatorSize)!==1){var separatorSize=parseInt(this.separatorSize);$(root.querySelectorAll(".body-row:not(:last-child) .body-cell")).css("border-bottom-width",separatorSize+"px");addRule(document.styleSheets[0],"#"+this.id+" .body-cell:not(:last-child):before","border-right-width: "+separatorSize+"px")}if(this.separatorColor){$(root.querySelectorAll(".body-row:not(:last-child) .body-cell")).css("border-bottom-color",this.separatorColor);addRule(document.styleSheets[0],"#"+this.id+" .body-cell:not(:last-child):before","border-right-color: "+this.separatorColor)}}else{$(root.querySelectorAll(".body-row:not(:last-child) .body-cell")).css("border-bottom","none");$(root.querySelectorAll(".body-cell")).addClass("no_separator")}}},attached:function(){},initializeChildRoot:function(){return this.firstElementChild},__indexOverflown:function(){var _this=this;var cell_exam=$(_this.querySelector("th.indexable"));var res;var vwidth;var text=this.virtualScroll?_this.backupdata.length:_this.dataLength;if(text==undefined||text==""){return}var cont=$("<div>"+text+"</div>").css("display",cell_exam.css("none")).css("z-index","-50").css("position","absolute").css("padding",cell_exam.css("padding")).css("font-family",cell_exam.css("font-family")).css("font-size",cell_exam.css("font-size")).css("font-weight",cell_exam.css("font-weight")).appendTo("body");vwidth=cont.outerWidth();cont.remove();res=vwidth+35+"px";return res},renderLayoutAsync:function(){var _this=this;if(this.__isAttached===false)return;var root=this.childRoot.querySelector("#"+this.id+" .top-tableview-root");this.sortable=this.sortable==="true"||this.sortable===true;this.checkable=this.checkable==="true"||this.checkable===true;this.checked=this.checked==="true"||this.checked===true;this.paginate=this.paginate==="true"||this.paginate===true;this.showresult=this.showresult==="true"||this.showresult===true;this.columnReorder=this.columnReorder==="true"||this.columnReorder===true;this.columnResize=this.columnResize==="true"||this.columnResize===true?"auto":this.columnResize;this.lengthChange=this.lengthChange==="true"||this.lengthChange===true;this.editable=this.editable==="true"||this.editable===true;this.horizontalScroll=this.horizontalScroll==="true"||this.horizontalScroll===true;this.indexable=this.indexable==="true"||this.indexable===true;this.storeColumn=this.storeColumn==="true"||this.storeColumn===true;this.sequence=this.sequence==="true"||this.sequence===true;this.virtualScroll=true;this.wheelState=false;if($(this).find("top-headercolumn[type='swap']").length!==0)this.swappable=true;if(this.columnReorder){this.columnResize="auto"}if(this.data==undefined){this.data=[];this.items=[]}this.pagerange=undefined;_this.pagestartnum=0;if(this.columnResize)this.horizontalScroll=true;this.horizontalScroll=!(this.horizontalScroll==="false"||this.horizontalScroll===false);this.scrollBodyHeight=!(this.scrollBodyHeight==="false"||this.scrollBodyHeight===false);if(this.scrollBodyHeight||this.horizontalScroll)this.scrollTable=true;this.columnDefs=[];this.columnOptiontoTable=[];if(typeof this.order==="object"){this.order=JSON.parse(JSON.stringify(this.order))}else if(typeof this.order==="string"){this.order=Top.Util.namespace(this.order,this)}if(!this.pageLength)this.pageLength=-1;this.__columnOption=typeof this.columnOption==="string"?Top.Util.namespace(this.columnOption,this):this.columnOption;this.__column=typeof this.column==="string"?Top.Util.namespace(this.column,this):this.column;this.__columnName=typeof this.columnName==="string"?Top.Util.namespace(this.columnName,this):this.columnName;this.__swapOption=typeof this.swapOption==="string"?Top.Util.namespace(this.swapOption,this):this.swapOption;this.__checkOption=typeof this.checkOption==="string"?Top.Util.namespace(this.checkOption,this):this.checkOption;this.__indexOption=typeof this.indexOption==="string"?Top.Util.namespace(this.indexOption,this):this.indexOption;this.__treeOption=typeof this.treeOption==="string"?Top.Util.namespace(this.treeOption,this):this.treeOption;if(this.__treeOption){this.treeTable=true;this.sortable=false;var tree_default={key:"children",width:"43px",left:"10",expandIcon:"+",collapseIcon:"-",showExpandIconAll:false,onExpand:null,onCollapse:null};this.__treeOption=$.extend(true,tree_default,this.__treeOption);this.__treeOption["onExpand"]=typeof this.__treeOption["onExpand"]==="string"?Top.Util.namespace(this.__treeOption["onExpand"],this):this.__treeOption["onExpand"];this.__treeOption["onCollapse"]=typeof this.__treeOption["onCollapse"]==="string"?Top.Util.namespace(this.__treeOption["onCollapse"],this):this.__treeOption["onCollapse"]}if(typeof Object.values==="undefined"){Object.values=function(obj){var array=new Array;for(var key in obj){array.push(obj[key])}return array}}if(this.__column){this.itemKeys=Object.values(this.__column);this.itemText=Object.keys(this.__column)}else{if(this.data&&this.data[0]){this.itemKeys=Object.keys(this.data[0]);this.itemText=Object.keys(this.data[0])}else{this.itemKeys=[];this.itemText=[]}}var columnsLen=this.itemKeys.length;if(this.treeTable){var childrenIndex=-1;while(columnsLen--){if(this.itemKeys[columnsLen]===this.__treeOption["key"])childrenIndex=columnsLen}if(childrenIndex!==-1){this.itemKeys.splice(childrenIndex,1)}}columnsLen=this.itemKeys.length;if(this.__columnOption){for(var columnNameKey in this.__columnOption){if(this.__columnOption[columnNameKey]!==undefined&&this.__columnOption[columnNameKey].hasOwnProperty("order")){for(var i=0;i<columnsLen;i++){if(this.__column&&this.__column[this.itemKeys[i]]===columnNameKey){var newValue=this.itemKeys[i];this.itemKeys.splice(i,1);this.itemKeys.splice(this.__columnOption[columnNameKey]["order"],0,newValue)}else if(this.itemKeys[i]===columnNameKey){this.itemKeys.splice(i,1);this.itemKeys.splice(this.__columnOption[columnNameKey]["order"],0,columnNameKey)}}}}}var isIDE=false;if(this.itemLayoutDom){for(var i=0;i<this.itemLayoutDom.length;i++){if(this.itemLayoutDom[i].tagName=="TOP-ROWITEM"||this.itemLayoutDom[i].tagName=="TOP-TABLEHEADER"){isIDE=true;break}}}this.isIDETableview=isIDE;if(!isIDE){this.changeItemLayoutDom()}this.virtualtable01_splitdata();if(this.children.length==0){return}this.renderIDETableByItems();$("td.body-cell:has(top-button, top-checkbox, top-spinner, top-datepicker, top-selectbox, top-menu)").css("text-overflow","clip");$("th.head-cell:has(top-button, top-checkbox, top-spinner, top-datepicker, top-selectbox, top-menu)").css("text-overflow","clip");this.virtualtable02_makeviewport();this.onScroll();this.timer=null;this.__callRenderLayoutListeners()},forsone:function(){var _this=this;_this.viewport.css({height:this.viewport_height});var headsetting=Array.from(_this.querySelectorAll("th.last-head:not(.ui-draggable-dragging):not(.incapable_header)")).sort(this.sortByHeadIndex);var hcolgroup=_this.querySelector(".head_colgroup");var bcolgroup=_this.querySelector(".body_colgroup");if(headsetting.length==1){hcolgroup.children[0].style.width="0px";bcolgroup.children[0].style.width="0px"}else{hcolgroup.children[headsetting.length].style.width="0px";bcolgroup.children[headsetting.length].style.width="0px"}var thirdheads=_this.querySelectorAll(".top-tableview-resizer");if(thirdheads.length<1){return}for(var j=0;j<headsetting.length-1;j++){if(headsetting[j].getAttribute("colspan")==="1"){if(j==headsetting.length-2){}var headCellLeft=headsetting[j+1].offsetLeft-5+"px";thirdheads[j].style.left=headCellLeft}}},changeItemLayoutDom:function(){var _this=this;var childRootDom=createChildRootDom();var tableHeaderDom=createTableHeaderDom();var rowItemDom=createRowItemDom();if(rowItemDom)childRootDom.appendChild(rowItemDom);childRootDom.appendChild(tableHeaderDom);_this.itemLayout=$(childRootDom).html();_this.itemLayoutDom=$(childRootDom).children();function createChildRootDom(){var childRootDom=document.createElement("div");childRootDom.classList.add("top-tableview");childRootDom.id=_this.id;return childRootDom}function createRowItemDom(){var rowItemDom=document.createElement("top-rowitem");var StringBuffer=function(){this.buffer=new Array};StringBuffer.prototype.append=function(str){this.buffer[this.buffer.length]=str};StringBuffer.prototype.toString=function(){return this.buffer.join("")};var itemKeys=_this.itemKeys;var bufBodyrow=new StringBuffer;if(_this.headerOption){var headerkeys=Object.keys(_this.headerOption[0])}else{var headerkeys=_this.itemKeys}for(var i=0;i<headerkeys.length;i++){if(_this.headerOption&&_this.headerOption[0]){if(!_this.headerOption[0][i]){continue}}var bufBody=new StringBuffer;var currentColumn=_this.itemKeys[i]?_this.itemKeys[i]:{};var currentOption={};if(_this.__columnOption){if(_this.__columnOption[currentColumn]){currentOption=_this.__columnOption[currentColumn]}else if(_this.__columnOption[i]){currentOption=_this.__columnOption[i]}}bufBody.append("<top-columnitem");var bindingprop="";if(currentOption["type"]){var propstr=currentOption["property"]?JSON.stringify(currentOption["property"]):"";var matchs=[];var dataFieldRegExp=new RegExp("[\"|']([\\w-]+)[\"|']+:[\"|']({[\\w]+})[\"|']","g");matches=propstr.match(dataFieldRegExp);if(matches){for(var k=0;k<matches.length;k++){bindingprop+=matches[k].replace(/'|"/g,"").replace(/:/g,"=");bindingprop+=" "}}else{bindingprop=""}}else if(_this.__columnOption){bindingprop=currentOption["text"];bufBody.append(" text=");bufBody.append(bindingprop)}else{bufBody.append(" text=");bufBody.append("{"+currentColumn+"}")}bufBody.append(">");if(currentOption["type"]=="selectbox"){var bindtype="selected-text";var sidx="0";var stext="";var svalue="";if(currentOption.property){if(currentOption["property"]["nodes"]){var option=currentOption["property"]["nodes"];bufBody.append("<top-"+currentOption["type"]+" "+bindingprop+">");for(var k=0;k<option.length;k++){bufBody.append("<top-widgetitem"+" id=op"+i+' border-width="0px" text='+option[k].text+" value="+option[k].value+' selected="false">');bufBody.append("</top-widgetitem>")}}else if(currentOption["property"]["data-model"]){var dataModel=currentOption["property"]["data-model"];bufBody.append("<top-"+currentOption["type"]+' data-model=\'{"nodes":"'+dataModel["nodes"]+"\"}'"+" "+bindingprop+">")}}else{bufBody.append("<top-"+currentOption["type"]+" "+bindingprop+"></top-"+currentOption["type"]+">")}bufBody.append("")}else if(currentOption["type"]){bufBody.append("<top-"+currentOption["type"]+" "+bindingprop+"></top-"+currentOption["type"]+">")}bufBody.append("</top-columnitem>");bufBodyrow.append(bufBody.toString())}if(Top.Util.Browser.isChrome()){rowItemDom.innerHTML=bufBodyrow.toString()}else{for(var q=0;q<bufBodyrow.buffer.length;q++){rowItemDom.innerHTML+=bufBodyrow.buffer[q]}}return rowItemDom}function createTableHeaderDom(){var tableHeaderDom=document.createElement("top-tableheader");var StringBuffer=function(){this.buffer=new Array};StringBuffer.prototype.append=function(str){this.buffer[this.buffer.length]=str};StringBuffer.prototype.toString=function(){return this.buffer.join("")};var itemKeys=_this.itemKeys;var itemText=_this.itemText;var columnsLen=itemText.length;_this.sumOfColspan=0;var bufHead=new StringBuffer;var headerOptionKeys=_this.headerOption?Object.keys(_this.headerOption):["0"];var headOptionLen=headerOptionKeys.length;var lastIndex=parseInt(headerOptionKeys[headOptionLen-1]);var rowsCount=headOptionLen;if(Top.Util.Browser.isChrome()){rowsCount=""}while(true){lastIndex--;if(lastIndex===-1)break;if(_this.headerOption&&!_this.headerOption[lastIndex])_this.headerOption[lastIndex]={}}for(var i=0;i<headOptionLen;i++){if(headOptionLen>1){bufHead.append("<top-headerrow>")}if(_this.swappable){var text=_this.__swapOption&&_this.__swapOption.text?_this.__i18n(_this.__swapOption.text):"Position";var str=_this.createHeaderColumn(text,rowsCount,_this.__swapOption,"swap");bufHead.append(str)}if(_this.headerOption&&_this.headerOption[i]){if(_this.headerOption[i]["index"]){_this.__indexOption=_this.headerOption[i]["index"];_this.indexable=true}if(_this.headerOption[i]["check"]){_this.__checkOption=_this.headerOption[i]["check"];_this.checkable=true}}if(!_this.__indexOption){_this.__indexOption={visible:_this.indexable?"visible":"none"}}if(!_this.__checkOption){_this.__checkOption={visible:_this.checkable?"visible":"none"}}if(_this.checkable){var strchk=_this.createHeaderColumn("",rowsCount,_this.__checkOption,"check");bufHead.append(strchk)}if(_this.indexable){var text=_this.__indexOption&&_this.__indexOption.text?_this.__i18n(_this.__indexOption.text):"NO";var strindx=_this.createHeaderColumn(text,rowsCount,_this.__indexOption,"index");bufHead.append(strindx)}if(_this.data.length===0&&_this.headerOption){columnsLen=Object.keys(_this.headerOption[i]).length;var needToBeCalcedByHO=true}var sumOfColspanForRow=0;if(!needToBeCalcedByHO){if(tempValueForRowSpan===undefined)var tempValueForRowSpan=columnsLen;else columnsLen=tempValueForRowSpan}for(var j=0;j<columnsLen;j++){if(_this.headerOption){if(!_this.headerOption[i]||!_this.headerOption[i][j]){continue}}var styleStr="";if(sumOfColspanForRow===columnsLen)break;var headerText=_this.__i18n(itemText[j]);if(_this.headerOption&&_this.headerOption[i]&&_this.headerOption[i][j]&&_this.headerOption[i][j]["layout"]){if(typeof _this.headerOption[i][j]["layout"]==="string"){headerText=_this.__i18n(_this.headerOption[i][j]["layout"])}else if(typeof _this.headerOption[i][j]["layout"]==="function"){headerText=_this.headerOption[i][j]["layout"](itemText[j])}}var headerOpt=_this.headerOption&&_this.headerOption[i]&&_this.headerOption[i][j]?headerOpt=_this.headerOption[i][j]:{};var str=_this.createHeaderColumn(headerText,rowsCount,headerOpt,"normal");bufHead.append(str)}bufHead.append("</top-headerrow>")}tableHeaderDom.innerHTML=bufHead.toString();return tableHeaderDom}},createHeaderColumn:function(text,rc,option,type){var str="";var visibility="visible";rc=rc?rc:null;var id=option&&option.id?option.id:"";text=option&&option.text?option.text:text;colSpan=option&&option.colspan?option.colspan:1;rowSpan=option&&option.rowspan?option.rowspan:1;if(option["visible"]=="none"||option["visible"]=="false"||option["visible"]==false){visibility="none"}else{visibility="visible"}if(type!="normal"){layoutwidth="";if(type=="check"&&option["layout-width"]){layoutwidth=option["layout-width"]}if(type=="index"&&option["layout-width"]){layoutwidth=option["layout-width"]}if(type=="check"||type=="index"){if(option["textposition"]=="left"){textposition="left"}else{textposition="right"}if(option["checked"]==true){checkbool=true}else{checkbool=false}}}else{layoutwidth=option&&option["layout-width"]?option["layout-width"]:"match_parent"}str+="<top-headercolumn";str+=" id='"+id+"'";if(type=="check"){str+=" textposition='"+textposition+"'";str+=" checked='"+checkbool+"'"}str+=" text='"+text+"'";str+=" colspan='"+colSpan+"'";str+=" rowspan='"+rowSpan+"'";str+=" type='"+type+"'";str+=" visible='"+visibility+"'";str+=" layout-width='"+layoutwidth+"'";if(rc)str+=" rowsCount='"+rc+"'";str+="></top-headercolumn>";return str},renderIDETableByItems:function(){this.isIDETableview=true;if(!this.__indexOption)this.__indexOption={};if(!this.__checkOption)this.__checkOption={};var _this=this;if(this.itemLayoutDom[1]&&!this.itemLayoutDom[1].innerHTML.includes("incapable")){var rowNum=1;if(this.itemLayoutDom[0].tagName=="TOP-TABLEHEADER"&&this.itemLayoutDom[0].children[0]&&this.itemLayoutDom[0].children[0].tagName=="TOP-HEADERROW")rowNum=this.itemLayoutDom[0].children.length;if(this.itemLayoutDom[1].tagName=="TOP-TABLEHEADER"&&this.itemLayoutDom[1].children[0]&&this.itemLayoutDom[1].children[0].tagName=="TOP-HEADERROW")rowNum=this.itemLayoutDom[1].children.length;var headerColumnStr="<top-headercolumn id='incapable_header' class='incapable_header' rowspan='"+rowNum+"' type='incapable' visible='visible' layout-width=''></top-headercolumn>";var columnItemStr="<top-columnitem  class='incapable_column' rowspan='9999' type='incapable' visible='visible' layout-width=''></top-columnitem>";for(var i=0;i<this.itemLayoutDom.length;i++){if(this.itemLayoutDom[i].children[0]&&this.itemLayoutDom[i].tagName=="TOP-TABLEHEADER"){if(this.itemLayoutDom[i].children[0].tagName=="TOP-HEADERROW")this.itemLayoutDom[i].children[0].innerHTML+=headerColumnStr;else this.itemLayoutDom[i].innerHTML+=headerColumnStr}else{this.itemLayoutDom[i].innerHTML+=columnItemStr}}}if(!this.rowItemArray)this.rowItemArray=[];if(!this.tableHeaderArray)this.tableHeaderArray=[];if(this.rowItemArray.length===0||this.tableHeaderArray.length===0){for(var i=0;i<this.itemLayoutDom.length;i++){var itemDom=Top.Util.Browser.isIE()?this.itemLayoutDom[i].cloneNode(true):this.itemLayoutDom[i];if(this.itemLayoutDom[i].tagName=="TOP-ROWITEM"){this.rowItemArray=Array.from(itemDom.children)}else if(this.itemLayoutDom[i].tagName=="TOP-TABLEHEADER"){var newHeaderArray=[];if(itemDom.children[0].tagName==="TOP-HEADERROW"){this.tableHeaderHeight=new Array(itemDom.children.length);this.tableHeaderRowClass=new Array(itemDom.children.length);newHeaderArray=new Array(itemDom.children.length);for(var j=0;j<itemDom.children.length;j++){this.tableHeaderHeight[j]=itemDom.children[j].getAttribute("layout-height");this.tableHeaderRowClass[j]=itemDom.children[j].getAttribute("class");newHeaderArray[j]=Array.from(itemDom.children[j].children)}}else{this.tableHeaderHeight=new Array(1);this.tableHeaderRowClass=new Array(1);this.tableHeaderHeight.push(itemDom.children[0].getAttribute("layout-height"));this.tableHeaderRowClass.push(itemDom.children[0].getAttribute("class"));newHeaderArray=new Array(1);newHeaderArray[0]=Array.from(itemDom.children)}this.tableHeaderArray=newHeaderArray}}}if(this.storeColumn){var name=this.storeKey||this.id;var cookie_value=_this.getCookie(name);if(cookie_value){_this.setTableheaderByTree(cookie_value)}}if(this.__setDataLengthCalled!==true)this.dataLength=this.data?this.data.length:0;var tableTagStr='<table cellpadding="0" cellspacing="0" border="0" class="top-tableview'+(this.tableHeaderArray.length>1?" multiple-header":"")+'">';tableTagStr+=this.__makeTHeadTag();tableTagStr+='<tbody class="body"></tbody></table>';var root=this.childRoot;root.innerHTML=tableTagStr;if(this.checkable){var checkhead=root.querySelector("th.head-cell.checkable");var checkableHeadCheckbox=Top.Widget.create("top-checkbox");checkableHeadCheckbox.template.classList.add("checkable-head");if(_this.__checkOption&&_this.__checkOption["type"]&&_this.__checkOption["type"]==="single"){checkableHeadCheckbox.setProperties({disabled:"true"})}checkableHeadCheckbox.setProperties({disabled:checkhead.getAttribute("disabled")});var leftorRight=checkhead.getAttribute("textposition");if(leftorRight=="left"){checkhead.appendChild(checkableHeadCheckbox.template)}else{$(checkhead).prepend(checkableHeadCheckbox.template)}_callCallback(checkableHeadCheckbox.template,"attached");checkableHeadCheckbox.template.checked=checkhead.getAttribute("checked");checkableHeadCheckbox.template.__updateProperties("checked")}for(var i=0;i<this.columnDefs.length;i++){var item=this.columnDefs[i];if(item["width"]==="wrap_content"){var columnIndex=parseInt(item.getAttribute("col"));var th=root.querySelector("th#"+this.headerColumnArray[_this.mainColumnIndex][columnIndex].id);var headerWidth;if(this.headerColumnArray[_this.mainColumnIndex][columnIndex].children.length==0){var headerText=th.innerText;var headerTextSize=window.getComputedStyle(th,null).getPropertyValue("font-size");var headerTextStyle=window.getComputedStyle(th,null).getPropertyValue("font-style");headerWidth=Top.Util.__measureTextSize(headerText,headerTextSize,headerTextStyle).width}else if(this.headerColumnArray[_this.mainColumnIndex][columnIndex].children.length>0){var headerLayout=this.headerColumnArray[_this.mainColumnIndex][columnIndex].children[0];headerWidth=headerLayout.getAttribute("layout-width");if(headerWidth==="auto"){headerWidth=root.querySelector("th#"+this.headerColumnArray[_this.mainColumnIndex][columnIndex].id).querySelector("#"+headerLayout.id)[0].getElement().offsetWidth}}item["width"]=typeof headerWidth==="number"?headerWidth+"px":headerWidth}else if(item["width"]==="match_parent"){item["width"]=undefined}}_this.editableHead=[];_this.nonTooltipHead=[];var allThs=root.querySelectorAll(".head-row .head-cell:not(.checkable)");for(var i=0;i<allThs.length;i++){var item=allThs[i];if(this.data&&this.data.length>0){item.columnName=item.getAttribute("value")}if(item.classList.contains("editable")){_this.editableHead.push(item.cellIndex);item.classList.remove("editable")}if(item.classList.contains("non-tooltip")){_this.nonTooltipHead.push(item.cellIndex);item.classList.remove("non-tooltip")}if(item.previousSibling===null){if(item.offsetLeft!==0){item.classList.add("no-border-left")}}}var bodyRoot=this.getElementsByClassName("body")[0];if(bodyRoot){this.__makeTBodyTag(this.data,undefined,bodyRoot)}this.createdItemWidgetAttachedCallback();if(_this.checkable){var checkableTd=_this.childRoot.querySelectorAll(".checkable.body-cell");var checked=root.querySelector("th.head-cell.checkable").getAttribute("checked");for(var i=0;i<checkableTd.length;i++){var checkableCheckbox=Top.Widget.create("top-checkbox").template;checkableCheckbox.classList.add("checkable-body");checkableCheckbox.givenidx=i;checkableTd[i].appendChild(checkableCheckbox);_callCallback(checkableCheckbox,"attached");checkableCheckbox.checked=checked;checkableCheckbox.__updateProperties("checked");_this.checkIndexInfo[i].checkbool=checked}}if(bodyRoot){var allTds=bodyRoot.querySelectorAll(".body-row .body-cell:not(.checkable)");this.__postBodyAppend(allTds,this.data)}this.__makeTopTablesObj()},__makeTempRowItem:function(len){var rowItem=document.createElement("top-rowitem");for(var i=0;i<len;i++){var columnItem=document.createElement("top-columnitem");rowItem.appendChild(columnItem)}return[rowItem]},__makeTHeadTag:function(){var root=this.childRoot;var _this=this;var StringBuffer=function(){this.buffer=new Array};StringBuffer.prototype.append=function(str){this.buffer[this.buffer.length]=str};StringBuffer.prototype.toString=function(){return this.buffer.join("")};var bufHead=new StringBuffer;var bufColgroup=new StringBuffer;var headerRowArrayLen=this.tableHeaderArray.length;var rowcountStr=Top.Util.Browser.isIE()?" rowcount_"+headerRowArrayLen:"";this.sumOfColspan=0;this.headerColumnArray=new Array;this.indexHeaderElem=new Array;this.checkHeaderElem=new Array;this.bodyItemOrder=new Array;bufHead.append("<thead class='head'>");if(this.rowItemArray.length===0){this.rowItemArray=Array.from(this.__makeTempRowItem(this.tableHeaderArray[0].length)[0].children)}var headerOptionCount=0;for(var i=0;i<_this.tableHeaderArray.length;i++){for(var j=0;j<_this.tableHeaderArray[i].length;j++){var headerType=_this.tableHeaderArray[i][j].getAttribute("type");if(headerType==="check"){headerOptionCount++;_this.checkable=true}else if(headerType==="index"||headerType==="index_r"){headerOptionCount++;_this.indexable=true}}}if(!_this.headerInfoArray){makeHeaderInfoArray(_this,headerOptionCount);_this.lastHeader=new Array;for(var i=0;i<_this.headerInfoArray.length;i++){var row=_this.headerInfoArray[i]["xmlRow"];var col=_this.headerInfoArray[i]["xmlCol"];var headerType=_this.headerInfoArray[i]["type"];_this.tableHeaderArray[row][col].classList.add("headIndex_"+_this.headerInfoArray[i]["class"]);if(_this.headerInfoArray[i]["isLastHead"]==true){_this.lastHeader.push(_this.headerInfoArray[i]);_this.tableHeaderArray[row][col].classList.add("last-head")}}_this.lastHeader.sort(sortCompare);for(var i=0;i<_this.lastHeader.length;i++){var row=_this.lastHeader[i]["xmlRow"];var col=_this.lastHeader[i]["xmlCol"];var index=_this.lastHeader[i]["index"];var headerType=_this.tableHeaderArray[row][col].getAttribute("type");var str=headerType==="check"||headerType==="index"||headerType==="index_r"?headerType:i-headerOptionCount;_this.tableHeaderArray[row][col].setAttribute("body-mapping-index",str);_this.headerInfoArray[index]["lastHeadNum"]=str}for(var i=0;i<_this.tableHeaderArray.length;i++){for(var j=0;j<_this.tableHeaderArray[i].length;j++){var currentCell=_this.tableHeaderArray[i][j];var visible=currentCell.getAttribute("visible");var colspan=currentCell.getAttribute("colspan")||1;var headerArrayIndex=currentCell.getAttribute("header-array-index");var bodyMappingIndex=currentCell.getAttribute("body-mapping-index");if(visible!="none"){continue}setParentColspan(_this,headerArrayIndex,-colspan);setChildrenVisible(_this,headerArrayIndex,visible);if(bodyMappingIndex!=="check"&&bodyMappingIndex!=="index"&&bodyMappingIndex!=="index_r"){_this.rowItemArray[bodyMappingIndex].setAttribute("visible",visible)}}}}if(this.Columns_info){for(var i=0;i<this.Columns_info.length;i++){var colIndex=this.Columns_info[i].index+headerOptionCount;if(this.Columns_info[i].index=="check"){colIndex=_this.headerCheckableIndex}else if(this.Columns_info[i].index=="index"||this.Columns_info[i].index=="index_r"){colIndex=_this.headerIndexableIndex}var colVisible=this.Columns_info[i].visible;var row=_this.lastHeader[colIndex]["xmlRow"];var col=_this.lastHeader[colIndex]["xmlCol"];var colspan=_this.lastHeader[colIndex]["colspan"];var cell=_this.tableHeaderArray[row][col];var defaultVisible=cell.getAttribute("visible")||"visible";var headerArrayIndex=cell.getAttribute("header-array-index");var bodyMappingIndex=cell.getAttribute("body-mapping-index");if(colVisible==defaultVisible){continue}setParentColspan(_this,headerArrayIndex,colVisible=="none"?-colspan:colspan);setChildrenVisible(_this,headerArrayIndex,colVisible);if(this.Columns_info[i].index!="check"&&this.Columns_info[i].index!="index"&&this.Columns_info[i].index!="index_r"){_this.rowItemArray[bodyMappingIndex].setAttribute("visible",colVisible)}}}if(_this.headerChangeByTree){var BeforeRowItemArray=_this.rowItemArray.slice(0);for(var i=0;i<_this.tableHeaderArray.length;i++){for(var j=0;j<_this.tableHeaderArray[i].length;j++){var currentCell=_this.tableHeaderArray[i][j];var beforeBodyMappingIndex=currentCell.getAttribute("before-body-mapping-index");var currentBodyMappingIndex=currentCell.getAttribute("body-mapping-index");if(beforeBodyMappingIndex=="null")beforeBodyMappingIndex=null;if(currentBodyMappingIndex=="null")currentBodyMappingIndex=null;if(beforeBodyMappingIndex==null||currentBodyMappingIndex==null||beforeBodyMappingIndex=="check"||beforeBodyMappingIndex=="index"||beforeBodyMappingIndex=="index_r"||currentBodyMappingIndex=="check"||currentBodyMappingIndex=="index"||currentBodyMappingIndex=="index_r"){continue}_this.rowItemArray[currentBodyMappingIndex]=BeforeRowItemArray[beforeBodyMappingIndex]}}_this.headerChangeByTree=false}for(var i=0;i<this.tableHeaderArray.length;i++){var offsetByColspan=0;var sumHeaderLayoutWidth=0;var sumOptionCount=0;var headerRowClass=this.tableHeaderRowClass[i];bufHead.append('<tr class="head-row '+headerRowClass+'" '+headerHeightStyle+">");for(var j=0;j<this.tableHeaderArray[i].length;j++){var currentCell=this.tableHeaderArray[i][j];var userClass=currentCell.className;var sumOfColspanForRow=0;var headerHeightStyle=!isNaN(parseInt(this.tableHeaderHeight[i]))?'style="height:'+this.tableHeaderHeight[i]+';"':"";var headerType=currentCell.getAttribute("type")||"normal";var editClass=currentCell.getAttribute("editable")===true||currentCell.getAttribute("editable")==="true"?" editable":"";var tooltipClass=currentCell.getAttribute("tooltip")===false||currentCell.getAttribute("tooltip")==="false"?" non-tooltip":"";var rowSpan=currentCell.getAttribute("rowspan")||"1";var colSpan=currentCell.getAttribute("colspan")||"1";var headerId=currentCell.getAttribute("id")||"";var headerStyle=getHeaderStyle(currentCell);var headerWidth=currentCell.getAttribute("layout-width");var headerText=currentCell.children&&currentCell.children.length>0?currentCell.innerHTML:_this.__i18n(currentCell.getAttribute("text"))||"";var headerValue=_this.__i18n(currentCell.getAttribute("value"))||_this.__i18n(currentCell.getAttribute("text"))||"";var headerSortable=currentCell.getAttribute("sortable");var textposition=currentCell.getAttribute("textposition")||"right";
var checked=currentCell.getAttribute("checked")||false;var disabled=currentCell.getAttribute("disabled")||false;var i18n="";if(currentCell.getAttribute("text")!==null&&currentCell.getAttribute("text").match(/\{\{(.*?)\}\}/)!==null){var i18n=currentCell.getAttribute("text").match(/\{\{(.*?)\}\}/)[1];Top.i18n.__addBoundWidget(this)}var columnNum=j-sumOptionCount;var visible=currentCell.getAttribute("visible")=="none"?false:true;if(headerType=="incapable"&&!userClass.includes("incapable_header")){userClass+=" incapable_header"}if(headerType==="check"&&visible!="none"){this.checkable=visible;if(visible){bufHead.append('<th id="'+headerId+'" style="'+headerStyle+'" textposition="'+textposition+'" class="head-cell checkable '+rowcountStr+" "+userClass+'" rowspan="'+rowSpan+'" colspan="'+colSpan+'" checked="'+checked+'" disabled="'+disabled+'">'+headerText+"</th>");sumOfColspanForRow+=parseInt(colSpan)}sumOptionCount++}else if((headerType==="index"||headerType==="index_r")&&visible!="none"){this.indexable=visible;if(visible){if(headerType==="index_r"){this.__indexOption["reverse"]=visible}var indexColumnText=_this.__i18n(currentCell.getAttribute("text"))||"NO";bufHead.append('<th id="'+headerId+'" class="head-cell indexable '+rowcountStr+" "+userClass+'" style="'+headerStyle+'" rowspan="'+rowSpan+'" colspan="'+colSpan+'" value="'+indexColumnText+'">'+indexColumnText+"</th>");sumOfColspanForRow+=parseInt(colSpan)}sumOptionCount++}else{if(!this.headerColumnArray[i])this.headerColumnArray[i]=new Array;this.headerColumnArray[i].push(currentCell);sumOfColspanForRow+=colSpan;if(parseInt(colSpan)>1)offsetByColspan+=parseInt(colSpan)-1;if(!visible){setColumnDefsFromHeader(columnNum,"visible",false);if(!_this.tHeadsColspanOne)_this.tHeadsColspanOne=[];_this.tHeadsColspanOne.push(currentCell);continue}bufHead.append('<th  id="'+headerId+'" class="head-cell'+rowcountStr+" "+userClass+editClass+tooltipClass+'" style="'+headerStyle+'" value="'+headerValue+'" rowspan="'+rowSpan+'" colspan="'+colSpan+'" actualdx="'+columnNum+'" data-i18n="'+i18n+'">'+headerText+"</th>");if(colSpan=="1"){_this.mainColumnIndex=columnNum;if(!_this.tHeadsColspanOne)_this.tHeadsColspanOne=[];_this.tHeadsColspanOne.push(currentCell);if(headerSortable!==null){headerSortable=headerSortable==="true"?true:false;setColumnDefsFromHeader(i,"orderable",headerSortable)}if(headerWidth!==null&&userClass.includes("last-head")){if(isNaN(parseInt(headerWidth))&&headerWidth==="auto")headerWidth="wrap_content";if(i===0)setColumnDefsFromHeader(columnNum+offsetByColspan,"width",headerWidth)}}}}if(_this.sumOfColspan<sumOfColspanForRow)_this.sumOfColspan=sumOfColspanForRow;bufHead.append("</tr>")}bufHead.append("</thead>");bufColgroup.append('<colgroup class="head_colgroup">');for(var i=0;i<_this.lastHeader.length;i++){var row=_this.lastHeader[i]["xmlRow"];var col=_this.lastHeader[i]["xmlCol"];if(_this.tableHeaderArray[row][col].getAttribute("visible")=="none"){continue}var dataIndex=headerOptionCount<=i?"class='last-head_"+parseInt(i-headerOptionCount)+"'":"";bufColgroup.append("<col "+dataIndex+" span='1'>")}bufColgroup.append("</colgroup>");return bufColgroup.toString()+bufHead.toString();function checkParent(parent,child){if(parent["xmlRow"]+parent["rowspan"]>child["xmlRow"]){return false}if(parent["countColspan"]>=child["colspan"]){return true}return false}function makeHeaderInfoArray(_this,headerOptionCount){_this.headerInfoArray=[];var beforeLength=0;var idIndex=0;for(var i=0;i<_this.tableHeaderArray.length;i++){beforeLength=_this.headerInfoArray.length;for(var j=0;j<_this.tableHeaderArray[i].length;j++){var currentCell=_this.tableHeaderArray[i][j];var rowSpan=currentCell.getAttribute("rowspan")||"1";var colSpan=currentCell.getAttribute("colspan")||"1";var headerType=currentCell.getAttribute("type")||"normal";var width=currentCell.getAttribute("layout-width")||null;var classStr=String(idIndex-headerOptionCount);if(headerType=="check"){classStr="check"}else if(headerType=="index"||headerType=="index_r"){classStr="index"}var headerInfo={xmlRow:i,xmlCol:j,isLastHead:true,lastHeadNum:null,parent:null,children:[],rowspan:parseInt(rowSpan),colspan:parseInt(colSpan),countColspan:parseInt(colSpan),index:idIndex,class:classStr,type:headerType,width:width};if(i>0){var flag=false;for(var k=0;k<beforeLength;k++){var parent=_this.headerInfoArray[k];if(checkParent(parent,headerInfo)){headerInfo["parent"]=_this.headerInfoArray[k]["index"];headerInfo["class"]=_this.headerInfoArray[k]["class"]+"_"+_this.headerInfoArray[k]["children"].length;_this.headerInfoArray[k]["isLastHead"]=false;_this.headerInfoArray[k]["children"].push(idIndex);_this.headerInfoArray[k]["countColspan"]-=colSpan;break}else{for(var l=0;l<parent["children"].length;l++){if(parent["children"][l]>=beforeLength){break}var parent2=_this.headerInfoArray[parent["children"][l]];if(checkParent(parent2,headerInfo)){headerInfo["parent"]=parent2["index"];headerInfo["class"]=_this.headerInfoArray[parent["children"][l]]["class"]+"_"+_this.headerInfoArray[parent["children"][l]]["children"].length;_this.headerInfoArray[parent["children"][l]]["isLastHead"]=false;_this.headerInfoArray[parent["children"][l]]["children"].push(idIndex);_this.headerInfoArray[parent["children"][l]]["countColspan"]-=colSpan;flag=true;break}}if(flag)break}}}_this.headerInfoArray.push(headerInfo);_this.tableHeaderArray[i][j].setAttribute("header-array-index",idIndex);if(headerType=="check"){_this.headerCheckableIndex=idIndex}else if(headerType=="index"||headerType=="index_r"){_this.headerIndexableIndex=idIndex}idIndex++}}}function sortCompare(a,b){var aList=a["class"].split("_");var bList=b["class"].split("_");for(var i=0;i<Math.min(aList.length,bList.length);i++){var aNum=aList[i]=="check"?-2:aList[i]=="index"?-1:parseInt(aList[i]);var bNum=bList[i]=="check"?-2:bList[i]=="index"?-1:parseInt(bList[i]);if(aNum==bNum){continue}return aNum-bNum}return false}function setParentColspan(_this,headerArrayIndex,appendix){var parentIndex=_this.headerInfoArray[headerArrayIndex]["parent"];if(parentIndex==null){return}var row=_this.headerInfoArray[parentIndex]["xmlRow"];var col=_this.headerInfoArray[parentIndex]["xmlCol"];var parentCell=_this.tableHeaderArray[row][col];var colspan=parseInt(parentCell.getAttribute("colspan"));if(isNaN(colspan))colspan=1;if(parentCell.getAttribute("visible")=="none"&&appendix<0){return}colspan+=appendix;parentCell.setAttribute("colspan",colspan);parentCell.setAttribute("visible",colspan<=0?"none":"visible");setParentColspan(_this,parentIndex,appendix)}function setChildrenVisible(_this,headerArrayIndex,visible){var row=_this.headerInfoArray[headerArrayIndex]["xmlRow"];var col=_this.headerInfoArray[headerArrayIndex]["xmlCol"];var children=_this.headerInfoArray[headerArrayIndex]["children"];_this.tableHeaderArray[row][col].setAttribute("visible",visible);for(var i=0;i<children.length;i++){setChildrenVisible(_this,children[i],visible)}}function getHeaderStyle(item){var headerTextColor=item.getAttribute("text-color")||"";var headerTextStyle=item.getAttribute("text-style")||"";var headerTextSize=item.getAttribute("text-size")||"";var headerBgColor=item.getAttribute("background-color")||"";var headerBgImage=item.getAttribute("background-image")||"";var headerTileMode=item.getAttribute("tile-mode")||"";var headerOpacity=item.getAttribute("opacity")||"";var headerWidth=item.getAttribute("layout-width")||"";var headerStyle="";headerStyle+=headerTextColor?"color:"+headerTextColor+";":"";headerStyle+=headerTextSize?" font-size:"+headerTextSize+";":"";headerStyle+=headerBgColor?" background-color:"+headerBgColor+";":"";headerStyle+=headerBgImage?" background-image: url("+headerBgImage+");":"";headerStyle+=headerOpacity?" opacity:"+headerOpacity+";":"";headerStyle+=headerWidth?" width:"+headerWidth+";":"";if(headerTileMode!==""){headerStyle+=headerTileMode==="stretch"?" background-size: cover;":" background-repeat: "+headerStyle+";"}if(headerTextStyle!==""){var textStyleArray=headerTextStyle.split("|");for(var j=0;j<textStyleArray.length;j++){textStyleArray[j]=textStyleArray[j].replace(/ /g,"");if(textStyleArray[j]==="bold"){headerStyle+=" font-weight:bold;"}else if(textStyleArray[j]==="italic"){headerStyle+=" font-style:italic;"}else if(textStyleArray[j]==="underline"){headerStyle+=" text-decoration:underline;"}}}return headerStyle}function setColumnDefsFromHeader(index,key,value){var obj={};obj["targets"]=index+_this.__getColumnIndexByLabel();obj[key]=value;if(_this.columnDefs.length==0){_this.columnDefs.push(obj)}else{var len=_this.columnDefs.length;while(len--){var item=_this.columnDefs[len];if(item["targets"]==index+_this.__getColumnIndexByLabel()){item[key]=value}if(item["targets"]!=index+_this.__getColumnIndexByLabel()&&len===0){_this.columnDefs.push(obj)}}}}},__makeTBodyTag:function(data,startIndex,bodyRoot,scrolled){var root=this.childRoot;var _this=this;_this.createdItemWidgets=[];this.bindingarray=[];this.bindingtd={};if(startIndex===undefined)startIndex=0;var StringBuffer=function(){this.buffer=new Array};StringBuffer.prototype.append=function(str){this.buffer[this.buffer.length]=str};StringBuffer.prototype.toString=function(){return this.buffer.join("")};columnOption=this.__columnOption;var bufBody=new StringBuffer;if(_this.headerOption&&_this.bodyItemOrder.length==this.rowItemArray.length){var rowItemNewArr=this.rowItemArray.slice()}var rowItemArray=this.rowItemArray;if(!data){return bufBody}else if(data.length===0||!this.items){}else if(data.length>0){var switchedItem=this.getSwitchedItem();if(this.itemSwitchLogic){rowItemArray=switchedItem}var ths=this.childRoot.querySelectorAll(".head-cell:not(.checkable):not(.indexable)");for(var i=0;i<data.length;i++){var bodyRowHeightStyle="";if(this.ih){bodyRowHeightStyle="height:"+parseInt(this.ih)+"px;"}var tableTr=document.createElement("tr");tableTr.setAttribute("style",bodyRowHeightStyle);tableTr.classList.add("body-row");tableTr.classList.add("row_"+(i+startIndex));if(!isNaN(parseInt(this.rowItemHeight))){tableTr.style.height=this.rowItemHeight}if(i+startIndex%2===0){tableTr.classList.add("odd")}else{tableTr.classList.add("even")}if(this.checkable){var tableTd=document.createElement("td");tableTd.classList.add("checkable");tableTd.classList.add("body-cell");tableTr.appendChild(tableTd)}if(this.indexable){var tableTd=document.createElement("td");tableTd.classList.add("indexable");tableTd.classList.add("body-cell");tableTd.setAttribute("col","index");tableTr.appendChild(tableTd)}for(var j=0;j<rowItemArray.length;j++){var columnItem=rowItemArray[j];var cellText="";var cellWidget=undefined;var columnValue="";if(columnItem.getAttribute("visible")=="none"){continue}if(columnItem.getAttribute("value")||columnItem.getAttribute("text")){columnValue=columnItem.getAttribute("value")||columnItem.getAttribute("text");if(columnValue.startsWith("{")){columnValue=columnValue.substring(1,columnValue.indexOf("}"))}if(!this.__columnFieldTextMatch)this.__columnFieldTextMatch={};if(columnValue){this.__columnFieldTextMatch[columnValue]=_this.tHeadsColspanOne[j].getAttribute("value")||_this.tHeadsColspanOne[j].getAttribute("text")}}var thisColumnOption=null;if(columnOption){for(var k=0;k<Object.keys(columnOption).length;k++){var objKey=Object.keys(columnOption)[k];if(!isNaN(objKey.charAt(0))){if(parseInt(objKey)==j){thisColumnOption=columnOption[j]}}else{if(objKey==columnValue){thisColumnOption=columnOption[objKey]}}}}var bodyValue,bodyBoundField;if(columnValue){if(data[i][columnValue]!==undefined){bodyValue=data[i][columnValue]}else if(data[i][this.__columnFieldTextMatch[columnValue]]!==undefined){bodyValue=data[i][this.__columnFieldTextMatch[columnValue]]}else{bodyValue=""}bodyBoundField=columnValue||this.__columnFieldTextMatch[columnValue]}else{bodyValue=bodyBoundField=""}if(columnItem.attributes.text){var boundField=columnItem.attributes.text.nodeValue;var fixvalue=true;if(boundField.startsWith("{")){fixvalue=false;boundField=boundField.substring(1,boundField.indexOf("}"))}if(boundField!==""&&fixvalue==false){boundField=data[i][boundField]!==undefined?boundField:this.__columnFieldTextMatch[boundField];if(data[i][boundField]!=undefined&&data[i][boundField]!=null){cellText=data[i][boundField].toString()}else{cellText=""}}else{cellText=""}cellText=this.__getValueByDataConverter(cellText,{dataIndex:i+startIndex,columnIndex:j,columnName:bodyBoundField});if(thisColumnOption&&cellText.length>thisColumnOption.textLength){var originText=cellText;cellText=cellText.slice(0,parseInt(thisColumnOption.textLength)-3).concat("...");thisColumnOption.tooltip=true}}else if(thisColumnOption&&thisColumnOption["layout"]){var fnLayout=thisColumnOption["layout"];if(typeof thisColumnOption["layout"]==="string")fnLayout=Top.Util.namespace(fnLayout,this);var convertedData=this.__getValueByDataConverter(data[i],{dataIndex:i+startIndex,columnIndex:j,columnName:bodyBoundField});if(typeof fnLayout==="function")cellText=fnLayout(convertedData,i)!==undefined?fnLayout(convertedData,i).toString():"";cellWidget=document.createElement("div");cellWidget.innerHTML=cellText;for(var k=0;k<cellWidget.children.length;k++){this.createHtmlObjects(cellWidget.children[k])}}else{cellText=columnItem.innerHTML;var dataFieldRegExp=new RegExp("([-\\w]+)=[\"|']({[\\w]+})[\"|']","g");var startsWithString=/^\s+/;var matches=[];var newCellText="";if(cellText.includes("top-widgetitem")){var cellTextSplitArr=cellText.split("<");for(var l=1;l<cellTextSplitArr.length;l++){if(!(cellTextSplitArr[l].startsWith("/")||cellTextSplitArr[l].startsWith("top-widgetitem"))){if(cellTextSplitArr[l].match(dataFieldRegExp)!==null){cellTextSplitArr[l]=changeInnerHTML(cellTextSplitArr[l],cellTextSplitArr[l].match(dataFieldRegExp))}}newCellText+=startsWithString.test(cellTextSplitArr[l])?cellTextSplitArr[l]:"<"+cellTextSplitArr[l]}cellText=newCellText}else{matches=cellText.match(dataFieldRegExp);cellText=changeInnerHTML(cellText,matches)}function changeInnerHTML(cellText,matches){if(matches===null)return cellText;for(var k=0;k<matches.length;k++){var attributeName=matches[k].split("=")[0];var fieldName=matches[k].split("=")[1];fieldName=fieldName.substring(2,fieldName.indexOf("}"));var convertedData;if(bodyBoundField===""&&bodyValue===""){if(data[i][fieldName]!==undefined){bodyValue=data[i][fieldName]}else if(data[i][_this.__columnFieldTextMatch[fieldName]]!==undefined){bodyValue=data[i][_this.__columnFieldTextMatch[fieldName]]}else{bodyValue=fieldName}bodyBoundField=fieldName}if(typeof bodyValue!=="object"){convertedData=_this.__getValueByDataConverter(bodyValue,{dataIndex:i+startIndex,columnIndex:j,columnName:fieldName})}else{convertedData=_this.itemsString+"."+(i+startIndex)+"."+fieldName}if(k<1){cellText=cellText.replace(matches[k],"data-field="+fieldName+" "+attributeName+"='"+convertedData+"' data-boundproperties='"+attributeName+"'")}else{cellText=cellText.replace(matches[k],"data-field"+k+"="+fieldName+" "+attributeName+"='"+convertedData+"' data-boundproperties"+k+"='"+attributeName+"'")}}return cellText}cellWidget=document.createElement("div");cellWidget.innerHTML=cellText;for(var k=0;k<cellWidget.children.length;k++){this.createHtmlObjects(cellWidget.children[k],false)}}var align=columnItem.getAttribute("horizontal-alignment")?columnItem.getAttribute("horizontal-alignment"):"";var cellClassName=columnItem.getAttribute("class");var rowSpan=columnItem.getAttribute("rowspan")||"1";var colSpan=columnItem.getAttribute("colspan")||"1";var editClass=this.editable?"editable":"";if(thisColumnOption&&(thisColumnOption["editable"]||thisColumnOption["editable"]===false)){editClass=thisColumnOption["editable"]===true||thisColumnOption["editable"]==="true"?"editable":""}var tooltipClass="non-tooltip";if(!thisColumnOption||thisColumnOption&&(thisColumnOption["tooltip"]===undefined||thisColumnOption["tooltip"]))tooltipClass=undefined;var tableTd=document.createElement("td");tableTd.classList.add("body-cell");if(editClass!==undefined||editClass!==null||editClass!=="")$(tableTd).addClass(editClass);tableTd.classList.add("column_"+j);tableTd.setAttribute("col",j);if(cellClassName!==undefined||cellClassName!==null||cellClassName!=="")$(tableTd).addClass(cellClassName);if(tooltipClass!==undefined||tooltipClass!==null||tooltipClass!=="")$(tableTd).addClass(tooltipClass);tableTd.setAttribute("value",bodyValue);tableTd.style.textAlign=align;tableTd.style.colSpan=colSpan;tableTd.style.rowSpan=rowSpan;if(cellWidget===undefined){tableTd.innerHTML=cellText;this.bindingtd[j]=tableTd;if(fixvalue){tableTd.textContent=bodyBoundField}else{tableTd.setAttribute("data-field",bodyBoundField)}}else{while(cellWidget.firstChild){tableTd.appendChild(cellWidget.firstChild)}tableTd.style.textOverflow="clip";_this.__initChildWidgetId(tableTd,i,j)}tableTr.appendChild(tableTd);if(i===0&&ths[j]){ths[j].dataField=bodyBoundField}}this.bindingarray.push(this.bindingtd);this.bindingtd={};bodyRoot.appendChild(tableTr)}var thisColumnOption=this.__columnOption;var ckey=this.tableHeaderArray[0];for(var k=0;k<this.bindingarray.length;k++){for(var i=0;i<ckey.length;i++){if(this.rowItemArray[i]&&this.rowItemArray[i].getAttribute("visible")=="none"){continue}var btg=_this.bindingarray[k][i];if(typeof btg=="string"){var wgt=Top.Dom.selectById(btg);_this.bindingarray[k][i]=wgt}if(this.__columnOption){var colOption=this.__columnOption;if(colOption[i]){var columnName=i}else{continue}var thisCol=colOption[columnName];if(thisCol["property"]){var prop=thisCol["property"];wgt.setProperties(prop)}}}}}return bufBody},__postBodyAppend:function(nTds,data,startIndex,__hasParent){var _this=this;var allTds=nTds;var columnOption=this.__columnOption;if(startIndex===undefined)startIndex=0;for(var allTdsIndex=0;allTdsIndex<allTds.length;allTdsIndex++){var item=allTds[allTdsIndex];var rowClassName=item.parentNode.className.match(/row_[0-9]+/)[0];var row=parseInt(rowClassName.replace("row_",""));var col=parseInt(item.getAttribute("col"));item.pos={row:row,col:col};item.dataIndex=__hasParent?row-startIndex:row;if(!item.parentNode.hasOwnProperty("dataIndex")){item.parentNode.dataIndex=__hasParent?row-startIndex:row}if(data.length>0){var columnName=item.getAttribute("data-field")||_this.getElementsByClassName("head-cell")[item.cellIndex].getAttribute("value");item.columnName=columnName;item.dataObj=data[row-startIndex]}else if(data.length===0&&!_this.items){var thValue=_this.getElementsByClassName("head-cell")[item.cellIndex].getAttribute("value");item.columnName=thValue}if(columnOption){var thisColumnOption=columnOption[col]==undefined?columnOption[columnName]:columnOption[col]}if(thisColumnOption&&thisColumnOption["event"]){var events=thisColumnOption["event"];var eventKeys=Object.keys(events);for(var k=0;k<eventKeys.length;k++){switch(eventKeys[k]){case"onCreated":{var onCreated=events["onCreated"];if(typeof events["onCreated"]==="string")onCreated=Top.Util.namespace(events["onCreated"],_this);onCreated(row+_this.startRowNum,data[row-startIndex][columnName],item)}case"onCelldblclick":{_this["onCelldblclick_"+col]=events.onCelldblclick;_this.__addEventByAttr("celldblclick_"+col)}}}}for(var index=0;index<_this.editableHead.length;index++){if(_this.editableHead[index]===item.cellIndex)item.classList.add("editable")}for(var index=0;index<_this.nonTooltipHead.length;index++){if(_this.nonTooltipHead[index]===item.cellIndex)item.classList.add("non-tooltip")}}this.columnsLen=_this.sumOfColspan;for(var i=0;i<_this.sumOfColspan;i++){this.columnOptiontoTable[i]=null}if(this.checkable){var checkableBody=this.childRoot.querySelectorAll(".body-row .checkable-body");for(var i=0;i<checkableBody.length;i++){var item=checkableBody[i];var rowClassName=item.parentNode.parentNode.className.match(/row_[0-9]+/)[0].replace("row_","");item.dataIndex=__hasParent?parseInt(rowClassName)-startIndex:parseInt(rowClassName)}var checkColumnWidth;for(var i=0;i<this.checkHeaderElem.length;i++){var _checkElemWidth=this.checkHeaderElem[i].getAttribute("layout-width");if(_checkElemWidth==="match_parent"){checkColumnWidth=undefined}else if(_checkElemWidth===null){checkColumnWidth="53px"}else{checkColumnWidth=_checkElemWidth}}this.columnOptiontoTable[0]=checkColumnWidth?{width:checkColumnWidth}:null;this.columnDefs.push({targets:0,orderable:false})}if(this.indexable){var indexColumnWidth;for(var i=0;i<this.indexHeaderElem.length;i++){indexColumnWidth=this.indexHeaderElem[i].getAttribute("layout-width")==="match_parent"?undefined:this.indexHeaderElem[i].getAttribute("layout-width")}if(indexColumnWidth==="auto"){var th=_this.getElementsByClassName("head-cell")[_this.__getColumnIndexByLabel("__index")];var headerText=th.innerText;var headerTextSize=window.getComputedStyle(th,null).getPropertyValue("font-size");var headerTextStyle=window.getComputedStyle(th,null).getPropertyValue("font-style");indexColumnWidth=Top.Util.__measureTextSize(headerText,headerTextSize,headerTextStyle).width}var needwidth=this.__indexOverflown();indexColumnWidth=indexColumnWidth?indexColumnWidth:needwidth;this.columnOptiontoTable[_this.__getColumnIndexByLabel("__index")]=indexColumnWidth?{width:indexColumnWidth}:null;this.columnDefs.push({targets:_this.__getColumnIndexByLabel("__index"),orderable:false})}var bodyRoot=_this.getElementsByClassName("body")[0];var objColumn=this.__column;var objOption=this.__columnOption;if(objOption==undefined){return}var itemKeys=[];if(_this.bindingarray[0]){var keylen=Object.keys(_this.bindingarray[0]).length;for(var k=0;k<keylen;k++){if(!_this.bindingarray[0][k]){continue}var dld=null;if(_this.bindingarray[0][k].tagName=="TD"){dld=_this.bindingarray[0][k].getAttribute("data-field")}else{dld=_this.bindingarray[0][k].template.getAttribute("data-field")}itemKeys[k]=dld}}for(var i=startIndex;i<data.length+startIndex;i++){var targetRow=bodyRoot.children[i];for(var j=0;j<this.rowItemArray.length;j++){if(this.rowItemArray[j].getAttribute("visible")=="none"){continue}if(objOption[itemKeys[j]]){var columnName=itemKeys[j]}else if(objOption[j]){var columnName=j}else{continue}if(objOption[columnName]==undefined){continue}var bindProperty=objOption[columnName]["bindProperty"];var cell=targetRow.querySelector(".column_"+j);var cell_parent=cell;var convertedData=_this.__getValueByDataConverter(data[i-startIndex][itemKeys[j]],{dataIndex:i,columnIndex:j,columnName:columnName});if(objOption[columnName]["layout"]==undefined){continue}if(typeof objOption[columnName]["layout"]==="function"){cell.innerHTML="";var fnLayout=objOption[columnName].layout;var strLayout=fnLayout(convertedData,i)||"";var cellWidget=document.createElement("div");cellWidget.innerHTML=strLayout;for(var k=0;k<cellWidget.children.length;k++){this.createHtmlObjects(cellWidget.children[k])}while(cellWidget.firstChild){cell.appendChild(cellWidget.firstChild)}this.createdItemWidgetAttachedCallback();cell.classList.remove("body-cell");cell.classList.add("body-cell");cell.classList.add("body-cell-custom");var children=cell.children;for(var k=0,len=children.length;k<len;k++){children[k].dataIndex=i;if(typeof children[k].__widgetAttached==="function")children[k].__widgetAttached()}bindProperty=bindProperty?bindProperty:"value";cell.setAttribute(bindProperty,data[i-startIndex][columnName]);cell.boundProperties=[bindProperty]}}}},__initChildWidgetId:function(item,row,col){var _this=this;var tdChildren=item.querySelectorAll("*");var topWidget=/^TOP-[a-zA-Z]*/;var topWidgets=[];var len=tdChildren.length;while(len--){if(topWidget.test(tdChildren[len].tagName)){topWidgets.push(tdChildren[len])}}item.pos={row:row,col:col};initChildWidgetId();for(var k=0;k<topWidgets.length;k++){var wname=topWidgets[k].tagName;switch(wname){case"TOP-LINEARLAYOUT":break;case"TOP-CHECKBOX":this.bindingtd[col]=topWidgets[k].id;break;case"TOP-RADIOBUTTON":this.bindingtd[col]=topWidgets[k].id;break;case"TOP-SPINNER":this.bindingtd[col]=topWidgets[k].id;break;case"TOP-COLORPICKER":this.bindingtd[col]=topWidgets[k].id;break;case"TOP-DATEPICKER":this.bindingtd[col]=topWidgets[k].id;break;case"TOP-SELECTBOX":this.bindingtd[col]=topWidgets[k].id;break;case"TOP-TEXTVIEW":this.bindingtd[col]=topWidgets[k].id;break;case"TOP-TEXTFIELD":this.bindingtd[col]=topWidgets[k].id;break;default:this.bindingtd[col]=topWidgets[k].id;break}}if(this.data.length>0){for(var index=0;index<topWidgets.length;index++){if(topWidgets[index].getAttribute("data-boundproperties")){if(!topWidgets[index].boundProperties)topWidgets[index].boundProperties=[];topWidgets[index].boundProperties.push(topWidgets[index].getAttribute("data-boundproperties"));topWidgets[index].className+=" editable-cell"}if(topWidgets[index].getAttribute("data-boundproperties1")){topWidgets[index].boundProperties.push(topWidgets[index].getAttribute("data-boundproperties1"))}if(topWidgets[index].getAttribute("data-field")){if(!topWidgets[index].fieldProperties)topWidgets[index].fieldProperties=[];topWidgets[index].fieldProperties.push(topWidgets[index].getAttribute("data-field"))}if(topWidgets[index].getAttribute("data-field1")){topWidgets[index].fieldProperties.push(topWidgets[index].getAttribute("data-field1"))}}}function initChildWidgetId(){for(var i=0;i<topWidgets.length;i++){var _item=topWidgets[i];if(!_item.id)_item.id=Top.Util.guid();if(_item.tagName==="TOP-LINEARLAYOUT"){}_item.id=_item.id+"_"+row+"_"+col;_item.setAttribute("row",item.pos.row);_item.setAttribute("col",item.pos.col);if(typeof _item.__updateId==="function")_item.__updateId();_item.layoutParent=_this;if(_item.tagName==="TOP-RADIOBUTTON"){if(_item.getAttribute("group-id")){_item.setAttribute("group-id",_item.getAttribute("group-id")+"_"+row+"_"+col)}}if(typeof _item.__renderedImpl==="function"){_item.__renderedImpl()}if(typeof _item.__adjustWidgets==="function"){_item.__adjustWidgets()}}}},sortByHeadIndex:function(a,b){var aClassList=a.className.split(" ");var bClassList=b.className.split(" ");var aClassStr="";var bClassStr="";for(var i=0;i<a.classList.length;i++){if(a.classList[i].includes("headIndex_"))aClassStr=a.classList[i].substring("headIndex_".length,a.classList[i].length).split("_")}for(var i=0;i<b.classList.length;i++){if(b.classList[i].includes("headIndex_"))bClassStr=b.classList[i].substring("headIndex_".length,b.classList[i].length).split("_")}for(var i=0;i<Math.min(aClassStr.length,aClassStr.length);i++){var aCurStr=aClassStr[i]=="check"?-2:aClassStr[i]=="index"?-1:parseInt(aClassStr[i]);var bCurStr=bClassStr[i]=="check"?-2:bClassStr[i]=="index"?-1:parseInt(bClassStr[i]);if(aCurStr==bCurStr){continue}return aCurStr-bCurStr}return false},_colwidthsync:function(){var _this=this;var headsetting=Array.from(_this.querySelectorAll("th.last-head:not(.ui-draggable-dragging):not(.incapable_header)")).sort(this.sortByHeadIndex);var default_width=150;var hcolgroup=_this.querySelector(".head_colgroup");for(var i=0;i<headsetting.length;i++){if(!headsetting[i].style.width){hcolgroup.children[i].style.width=default_width+"px"}else{hcolgroup.children[i].style.width=headsetting[i].style.width}}},_adjustcolumn:function(){var _this=this;var hcolgroup=_this.querySelector(".head_colgroup");var bcolgroup=_this.querySelector(".body_colgroup");for(var i=0;i<hcolgroup.children.length;i++){bcolgroup.children[i].style.width=hcolgroup.children[i].style.width}return},_makeTableshtml:function(){var _this=this;function _fnStringToCss(s){if(s===null){return"0px"}if(typeof s=="number"){return s<0?"0px":s+"px"}return s.match(/\d$/)?s+"px":s}var root=this.childRoot;var table=$(this.querySelector("#"+this.id+" table"));table.attr("role","grid");var scroll={sX:this.layoutWidth,sY:this.layoutHeight,sXInner:""};var scrollX=scroll.sX;var scrollY=scroll.sY;var classes={sScrollId:"TopTables_Table_"+this.id+"_wrapper",sScrollWrapper:"top-tableview-root no-footer",sScrollHead:"top-tableview-scrollHead",sScrollHeadInner:"top-tableview-scrollHeadInner",sScrollBodyBorder:"top-tableview-scrollBody-border",sScrollBody:"top-tableview-scrollBody",sScrollFoot:"",sScrollFootInner:""};var caption=table.children("caption");var captionSide=caption.length?caption[0]._captionSide:null;var headerClone=$(table[0].cloneNode(false));var footerClone=$(table[0].cloneNode(false));var colgroupClone=this.querySelector(".head_colgroup").cloneNode(true);colgroupClone.className="body_colgroup";var footer=table.children("tfoot");var _div="<div/>";var size=function(s){return!s?null:_fnStringToCss(s)};if(!footer.length){footer=null}var scrollbox=$(_div,{id:classes.sScrollId,class:classes.sScrollWrapper});var scroller=$(_div,{class:"top-tableview-scroll"}).append($(_div,{class:classes.sScrollHead}).css({overflow:"hidden",position:"relative",border:0,width:scroll.sXInner||"100%"}).append($(_div,{class:classes.sScrollHeadInner}).css({"box-sizing":"border-box",width:scroll.sXInner||"100%"}).append(headerClone.removeAttr("id").css("margin-left",0).append(captionSide==="top"?caption:null).append(table.children("colgroup")).append(table.children("thead"))))).append($(_div,{class:classes.sScrollBodyBorder}).css({position:"relative",width:"100%",height:"auto"}).append($(_div,{class:classes.sScrollBody}).css({position:"relative",overflowX:this.virtualScroll?"unset":"auto",overflow:this.virtualScroll?"unset":"auto",width:"100%"}).append(table.prepend(colgroupClone))));if(footer){scroller.append($(_div,{class:classes.sScrollFoot}).css({overflow:"hidden",border:0,width:scrollX?size(scrollX):"100%"}).append($(_div,{class:classes.sScrollFootInner}).append(footerClone.removeAttr("id").css("margin-left",0).append(captionSide==="bottom"?caption:null).append(table.children("tfoot")))))}var children=scroller.children();var scrollHead=children[0];var scrollBody=children[1].children[0];var scrollFoot=footer?children[2]:null;if(scrollX){$(scrollBody).on("scroll.DT",function(e){var scrollLeft=this.scrollLeft;scrollHead.scrollLeft=scrollLeft;if(footer){scrollFoot.scrollLeft=scrollLeft}})}$(scrollBody).css(scrollY&&scroll.bCollapse?"max-height":"height",scrollY);this.nScrollHead=scrollHead;this.nScrollBody=scrollBody;this.nScrollFoot=scrollFoot;var autopage=document.createElement("div");autopage.className="auto-pagination";scrollbox.append(scroller[0]);if(this.pagerLocation.startsWith("t")){scrollbox.prepend(autopage)}else{scrollbox.append(autopage)}if(Top.Util.Browser.isIE()){$(root).append(scrollbox[0])}else{root.append(scrollbox[0])}},__makeTopTablesObj:function(){var _this=this;var root=this.childRoot;var nTable=root.querySelector("#"+this.id+" table");this.pageLength=parseInt(this.pageLength);var dom=this.pagerLocation.startsWith("t")?"<l>t":"t<l>";var thisTable=this;this.Toptablerendered=true;this._colwidthsync();this._makeTableshtml();if(_this.paginate){_this.virtualmakePage()}if(_this.checkable){_this.checkboxes=$("#"+this.id+" .top-tableview-scrollBody"+" table").find(".checkable-body");_this.showedCheckboxes=[];if(!_this.paginate)_this.showedCheckboxes=_this.checkboxes}if(this.indexable)this.__renderIndex();if(_this.columnResize){var gripsElement=this.getElementsByClassName("top-tableview-grips")[0];gripsElement=undefined;if(!gripsElement){_this.makeColResizer()}}var order=this.order;var colReorder=this.columnReorder;if(this.columnReorder){_this.makeColReorder()}if(this.sequence){_this.makesequence()}if(nTable.classList.contains("multiple-header")&&this.scrollTable&&(this.layoutWidth!==undefined&&(_this.layoutWidth.indexOf("%")!==-1||_this.layoutWidth==="match_parent"))||this.layoutWidth===undefined){if(this.windowResizeEvent===undefined)this.windowResizeEvent=function(){};window.removeEventListener("resize",this.windowResizeEvent);window.addEventListener("resize",this.windowResizeEvent)}this.defaultbindEvent();this.bindEvent()},makesequence:function(){var sequencestr='<div class="seqbox">'+"[ "+"0"+"/"+this.backupdata.length+" ]"+"</div>";if(this.querySelector(".seqbox")==null){$(this.querySelector(".top-tableview-root")).append(sequencestr)}},updatesequence:function(inputnumber){var nownum=inputnumber+1;var str="[ "+nownum+"/"+this.backupdata.length+" ]";$(this.querySelector(".seqbox")).text(str)},checknodata:function(){
if(this.data.length===0||!this.items){this.startRowNum=0;this.scrollbar_height();this.querySelector("div").style["overflow-y"]="hidden";var table=this.querySelector(".top-tableview-scrollBody table");var headdom=this.querySelector(".top-tableview-scrollHeadInner table");if(!this.h_total){this.h_total="100%"}$(table).css("width",this.h_total);var body=this.querySelector(".top-tableview-scrollBody table .body");$(body).append("<tr class='body-row row_0 empty'><td colspan="+this.getHeaders().length+" class='body-cell empty'>"+this.emptyMessage+"</td></tr>")}},bindDTEvent:function(){var _this=this;var root=this.childRoot;var nDataTable=root.querySelector("#"+this.id+" .top-tableview-scrollBody"+" table");$(nDataTable).on("order.dt",function(e){_this.setColWidget();var pageInfo=_this.getPageInfo();if(pageInfo&&pageInfo.page!==1){var pager=root.querySelector("top-pagination");if(!pager)return;pager.setAttribute("page",1);pager.page=1;_this.pagerType==="input"?pager.renderInput():pager.renderBasic();var dataLength=_this.dataLength!==undefined?_this.dataLength:_this.data.length;var len=_this.pageLength;var end=len===-1||len>dataLength?dataLength-1:len-1;_this.setPageInfo({start:0,end:end,page:1})}}).off("draw.dt").on("draw.dt",function(e,settings){if(_this.data.length===0&&_this.items){if(typeof _this.onEmpty==="function"){_this.onEmpty(Top.Dom.selectById(_this.id))}_this.__dispatchEvent(new CustomEvent("nodata"))}if(_this.itemClicktype==="select"&&_this.selectedItemIndex!==undefined){var previousRow=root.querySelector(".previous");var selectedRow=root.querySelector(".body-row.selected");if(selectedRow)var newPrevRow=selectedRow.previousSibling||selectedRow.parentNode.previousSibling.querySelector(".head-row");if(previousRow)previousRow.classList.remove("previous");if(newPrevRow)newPrevRow.classList.add("previous")}if(_this.checkable){_this.showedCheckboxes=[];_this.showedCheckboxes=Array.prototype.slice.call(root.querySelectorAll(".body-row .checkable .checkable-body"));_this.checkCallback()}_this.__renderDummyView();setRowIndex()}).off("column-reorder.dt").on("column-reorder.dt",function(){var allTrs=_this.getElementsByClassName("body-row");for(var trIndex=0;trIndex<allTrs.length;trIndex++){var item=allTrs[trIndex];var columnElem=item.querySelectorAll('[class*="column_"]');for(var i=0;i<columnElem.length;i++){var columnClassName=columnElem[i].className.match(/column_[0-9]+/)[0];columnElem[i].classList.remove(columnClassName);columnElem[i].classList.add("column_"+i);columnElem[i].pos["col"]=i;if(columnElem[i].tagName!=="TD")columnElem[i].parentNode.pos["col"]=i}}});function setRowIndex(){var pageInfo={start:this.startRowNum};var allTrs=_this.getElementsByClassName("body-row");for(var trIndex=0;trIndex<allTrs.length;trIndex++){var item=allTrs[trIndex];var rowClassName=item.className.match(/row_[0-9]+/)[0];var prevRowIndex=rowClassName.replace("row_","");var rowIndex=trIndex+pageInfo.start;if(rowIndex%2===0){item.classList.add("even");item.classList.remove("odd")}else{item.classList.add("odd");item.classList.remove("even")}item.classList.remove(rowClassName);item.classList.add("row_"+rowIndex);if(item.hasOwnProperty("childrenRows")){$(item.childrenRows).attr("parent-index",rowIndex)}var Tds=item.getElementsByClassName("body-cell");for(var i=0;i<Tds.length;i++){var _item=Tds[i];if(_item.pos)_item.pos["row"]=rowIndex;if(_item.firstChild&&_item.firstChild.pos)_item.firstChild.pos["row"]=rowIndex}}}},defaultbindEvent:function(){var _this=this;var root=this.childRoot;var delay=200;var clicks=0;var timer=null;if(this.onHeaderdbclick){$(root.querySelector("thead")).find(".head-row .head-cell").on("click",function(e){clicks++;var __this=this;if(clicks===1){timer=setTimeout(function(){clicks=0;clickFunc(_this,__this)},delay)}else{clearTimeout(timer);clicks=0;dbclickFunc(_this,__this)}}).on("dbclick",function(e){e.preventDefault()})}else{$(root.querySelector("thead")).find(".head-row .head-cell").on("click",function(e){clickFunc(_this,this)})}var sortdirect=[];var sort_dom=_this.querySelectorAll(".head-cell:not(.checkable)");for(var i=0;i<sort_dom.length;i++){sort_dom[i].origintxt=sort_dom[i].textContent}var clickFunc=function(_this,__this){var columnName=__this.getAttribute("value")||"";var headerType="normal";var columnIndex=parseInt(__this.getAttribute("col"));if($(__this).hasClass("checkable")){headerType="check";columnIndex=""}if($(__this).hasClass("indexable")){headerType="index";columnIndex=""}if($(__this).hasClass("incapable_header")){headerType="incapable"}if(_this.sortable&&!(_this.data.length===0||!_this.items)){for(var i=0;i<sort_dom.length;i++){sort_dom[i].textContent=sort_dom[i].origintxt}if(headerType=="check"||headerType=="incapable"){return}else if(headerType=="index"){_this.__indexOption={};if(sortdirect["index"]){sortdirect["index"]=false;_this.__indexOption["reverse"]=false}else{sortdirect["index"]=true;_this.__indexOption["reverse"]=true}_this.__renderIndexForVirtualScroll();_this.index_reverse_sort(sortdirect["index"]);__this.textContent=_this.__indexOption["reverse"]?__this.origintxt+" △▼":__this.origintxt+" ▲▽";return}var columname=__this.dataField?__this.dataField:__this.innerText;if(sortdirect[columname]){sortdirect[columname]=false}else{sortdirect[columname]=true}__this.textContent=sortdirect[columname]?__this.origintxt+" △▼":__this.origintxt+" ▲▽";_this.virtualsort(columname,sortdirect[columname])}_this.__dispatchEvent(new CustomEvent("headerclick",{detail:{headerType:headerType,columnIndex:columnIndex,columnName:columnName,target:__this}}))};var dbclickFunc=function(_this,__this){var columnName=__this.getAttribute("value")||"";var headerType="normal";var columnIndex=parseInt(__this.getAttribute("col"));if($(__this).hasClass("checkable")){headerType="check";columnIndex=""}if($(__this).hasClass("indexable")){headerType="index";columnIndex=""}_this.__dispatchEvent(new CustomEvent("headerdbclick",{detail:{headerType:headerType,columnIndex:columnIndex,columnName:columnName,target:__this}}))};if(this.virtualScroll){var scrollHead=root.querySelector(".top-tableview-scrollHead");var gripresizer=root.querySelector(".top-tableview-grips");this.__moveHeaderScroll=function(){scrollHead.scrollLeft=this.scrollLeft;if(gripresizer){gripresizer.style.right=this.scrollLeft+"px"}};var scrollBodyBorder=root.querySelector(".top-tableview-scrollBody-border");scrollBodyBorder.removeEventListener("scroll",this.__moveHeaderScroll);scrollBodyBorder.addEventListener("scroll",this.__moveHeaderScroll)}},bindEvent:function(){var _this=this;var root=this.childRoot;var data=this.data;var before_tr_idx=0;var before_col_idx=0;var origin_tr_idx=0;var origin_col_idx=0;var tr_idx=0;var col_idx=0;var tr_object=null;var td_object=null;$(root.querySelector("tbody")).off("mousedown").on("mousedown",function(e){mEventhandler(e);_this.addEventListener("mouseover",mEventhandler,false)}).off("mouseup scroll").on("mouseup mousewheel DOMMouseScroll",function(e){_this.removeEventListener("mouseover",mEventhandler,false);$(_this).off("mouseover")});$(root.querySelector("tbody")).off("click contextmenu dblclick").on("click contextmenu dblclick",function(e){_this.removeEventListener("mouseover",mEventhandler,true);mEventhandler(e)});var mEventhandler=function(e){if(e.target.className.includes("empty")){return}var etype=e.type;var begin=e.target;var search=begin;tr_idx=0;col_idx=0;var col_name="";var dataIndex=0;tr_object=null;td_object=null;while(true){if(search.tagName==undefined||search.tagName==null||search.tagName=="TBODY"){return}if(search.tagName=="TD"){col_idx=parseInt(search.getAttribute("col"));col_name=search.columnName;td_object=search}if(search.tagName=="TR"&&search.className.includes("body")){tr_idx=parseInt(search.className.match(/row_[0-9]+/)[0].replace("row_",""));dataIndex=search.dataIndex;tr_object=search;break}search=search.parentNode}if(td_object.className.includes("incapable")){return}if(_this.itemClicktype==="select"||etype=="mouseover"){multiselect(e)}else if(_this.itemClicktype==="click"){multiselect(e)}_this.clickedItemIndex=[tr_idx+_this.startRowNum,col_idx];var _ClickedRowData=data[tr_idx];var _ClickedCellData=data[tr_idx][col_name];if(etype=="click"){_this.__dispatchEvent(new CustomEvent("rowclick",{detail:{data:_ClickedRowData,dataIndex:dataIndex+_this.startRowNum,rowIndex:dataIndex,beforerowIndex:before_tr_idx,target:begin}}));_this.__dispatchEvent(new CustomEvent("cellclick",{detail:{data:_ClickedRowData,dataIndex:dataIndex+_this.startRowNum,rowIndex:dataIndex,columnIndex:col_idx,columnName:col_name,target:begin}}))}if(etype=="dblclick"){_this.__dispatchEvent(new CustomEvent("rowdblclick",{detail:{data:_ClickedRowData,dataIndex:dataIndex+_this.startRowNum,rowIndex:dataIndex,beforerowIndex:before_tr_idx,target:begin}}));_this.__dispatchEvent(new CustomEvent("celldblclick",{detail:{data:_ClickedRowData,dataIndex:dataIndex+_this.startRowNum,rowIndex:dataIndex,columnIndex:col_idx,columnName:col_name,target:begin}}))}if(etype=="contextmenu"){_this.__dispatchEvent(new CustomEvent("rowcontextmenu",{detail:{data:_ClickedRowData,dataIndex:dataIndex+_this.startRowNum,rowIndex:dataIndex,target:begin}}));_this.__dispatchEvent(new CustomEvent("cellcontextmenu",{detail:{data:_ClickedRowData,dataIndex:dataIndex+_this.startRowNum,rowIndex:dataIndex,columnIndex:col_idx,columnName:col_name,target:begin}}))}before_tr_idx=tr_idx;before_col_idx=col_idx;if(_this.sequence){_this.updatesequence(tr_idx+_this.startRowNum)}};var multiselect=function(e){var etype=e.type;if(e.ctrlKey){if(_this.selectType=="row"){tr_object.classList.add("selected")}else{td_object.classList.add("selected")}}else if(e.shiftKey||etype=="mouseover"){$(".selected").removeClass("selected");$(".previous").removeClass("previous");var fromtr=tr_idx>origin_tr_idx?origin_tr_idx:tr_idx;var totr=tr_idx<origin_tr_idx?origin_tr_idx:tr_idx;var fromcol=col_idx>origin_col_idx?origin_col_idx:col_idx;var tocol=col_idx<origin_col_idx?origin_col_idx:col_idx;if(_this.selectType=="row"){for(var i=fromtr;i<totr+1;i++){var rowstr=".row_"+i;$("#"+_this.id+" "+rowstr).addClass("selected")}}else{for(var i=fromtr;i<totr+1;i++){var rowstr=".row_"+i;for(var k=fromcol;k<tocol+1;k++){var colstr=".column_"+k;$("#"+_this.id+" "+rowstr+" "+colstr).addClass("selected")}}}}else{$(".selected").removeClass("selected");$(".previous").removeClass("previous");if(_this.selectType=="row"){tr_object.classList.add("selected");origin_tr_idx=tr_idx;origin_col_idx=col_idx}else{td_object.classList.add("selected");origin_tr_idx=tr_idx;origin_col_idx=col_idx}}};if(this.checkable){var checkableHead=$("#"+this.id+" .checkable-head .top-checkbox-text");checkableHead.off("click").on("click",function(event){var __checked=this.previousElementSibling.checked;if(Top.Util.Browser.isIE())__checked=!__checked;_this.checkAll(__checked,_this.paginate)});this.checkboxes=$("#"+this.id+" .top-tableview-scrollBody"+" table").find(".checkable-body");var len=this.checkboxes.length;var lastChecked=null;var lastCheckedIndex=null;var currentRowNum=this.startRowNum;if(this.__checkClickListener===undefined){this.__checkClickListener=function(event){var widget=Top.Dom.__selectImpl(event.target.parentNode);if(_this.__checkOption&&_this.__checkOption["type"]&&_this.__checkOption["type"]==="single"){var __checked=!widget.getProperties("checked");_this.checkAll(false);widget.setProperties({checked:__checked})}if(_this.virtualScroll){if(widget.getProperties("checked")==true||widget.getProperties("checked")=="true"){var __checked=true}else{var __checked=false}var idx=widget.template.givenidx;if(_this.connect){_this.datapointer[idx]["temp"].checkbool=__checked}else{_this.checkIndexInfo[idx].checkbool=__checked}}if(!lastChecked){lastChecked=widget.template;lastCheckedIndex=_this.checkboxes.index(lastChecked)+_this.startRowNum}if(event.shiftKey){var first=_this.checkboxes.index(widget.template)+_this.startRowNum;var last=lastCheckedIndex;var start=Math.min(first,last);var end=Math.max(first,last);for(var j=start;j<end+1;j++){_this.checkIndexInfo[j].checkbool=widget.template.checked;if(_this.checkboxes[j-_this.startRowNum])_this.checkboxes[j-_this.startRowNum].querySelector(".top-checkbox-check").checked=widget.template.checked}if(Top.Util.Browser.isIE())document.getSelection().removeAllRanges()}lastChecked=widget.template;lastCheckedIndex=_this.checkboxes.index(lastChecked)+_this.startRowNum;_this.checkCallback();if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("rowcheck"))}else{_this.__dispatchEvent(new Event("rowcheck"))}}}for(var i=0;i<len;i++){var checkbox=Top.Dom.__selectImpl(this.checkboxes[i]);checkbox.template.__isRendered=true;checkbox.template.getElementsByClassName("top-checkbox-text")[0].addEventListener("click",this.__checkClickListener)}$(root.querySelector("tbody")).on("click","tr.body-row td.checkable",function(e){e.stopPropagation()})}$(root.querySelector("tbody")).off("dblclick","td.editable").on("dblclick","td.editable",function(){var editingCell=this;var rowIndex=parseInt($(this).closest("tr")[0].className.match(/row_[0-9]+/)[0].replace("row_",""));var columnName=this.columnName;var columnIndex=this.pos["col"];for(var i=0;i<this.childNodes.length;i++){if(this.childNodes[i].nodeName==="#text"){var thisText=this.childNodes[i].nodeValue||"";var textElement=this.childNodes[i]}if(this.childNodes[i].nodeName==="TOP-TEXTVIEW"){var thisText=this.childNodes[i].getAttribute("text")||"";var textElement=this.childNodes[i];break}}if(!textElement&&this.childNodes.length>0)return;if(textElement){if(textElement.tagName==="TOP-TEXTVIEW")$(textElement).hide();else $(textElement).remove()}if(typeof _this.columnOption==="string"){var objOption=Top.Util.namespace(_this.columnOption,_this)}else if(typeof _this.columnOption==="object"){var objOption=_this.columnOption}var editType="textfield";if(objOption&&objOption[columnName]){editType=objOption[columnName].editType||"textfield";var editProperties=objOption[columnName].editProperty}else if(objOption&&objOption[columnIndex]){editType=objOption[columnIndex].editType||"textfield";var editProperties=objOption[columnIndex].editProperty}if(editProperties===undefined){var editProperties={}}var newEditWidget;switch(editType){case"selectbox":{newEditWidget=Top.Widget.create("top-selectbox");editProperties["selected-text"]=thisText||"";break}case"datepicker":{newEditWidget=Top.Widget.create("top-datepicker");editProperties["date"]=thisText||"";break}case"textfield":{newEditWidget=Top.Widget.create("top-textfield");editProperties["text"]=thisText||"";break}default:{newEditWidget=eval("Top.Widget.create('top-"+editType+"')");editProperties["text"]=thisText||""}}if(editProperties){newEditWidget.setProperties(editProperties)}$(this).append(newEditWidget.template);_callCallback(newEditWidget.template,"attached");var $editingWidget=$(this).find("> top-"+editType);if(editType==="textfield"){var input=this.querySelector("top-textfield input");input.addEventListener("blur",function(){$editingWidget.blur()})}if(editProperties){$editingWidget.prop("layoutParent",_this);$editingWidget[0].__boundController=_this.getController();$editingWidget[0].__initBoundData(true,$editingWidget[0].id);$editingWidget[0].__initEvent()}$editingWidget.focus();$editingWidget.on("dblclick",function(e){e.stopPropagation()}).on("mousedown",function(e){e.stopPropagation()});$editingWidget.on("blur keypress change select close",function(e,w,p){var textContentValue="";if(this.tagName==="TOP-TEXTFIELD"){if(!(e.type==="blur"||e.keyCode===13))return;textContentValue=this.text}else if(this.tagName==="TOP-TEXTAREA"){if(!(e.type==="blur"))return;textContentValue=this.text}else if(this.tagName==="TOP-SELECTBOX"){if(!(e.type==="change"||e.type==="close"))return;textContentValue=this.selectedText}else if(this.tagName==="TOP-DATEPICKER"){if(e.type!=="select")return;textContentValue=this.date}if(this.tagName==="TOP-TEXTFIELD"){if(typeof this.validation==="function"){if(!this.validation())return}}var textContent=document.createTextNode(textContentValue);$(this).remove();if(textElement&&textElement.tagName==="TOP-TEXTVIEW"){textElement.setAttribute("text",textContent.nodeValue);textElement.text=textContent.nodeValue;textElement.__updateProperties("text");$(textElement).show()}else{editingCell.appendChild(textContent)}var convertedData=_this.__setValueByDataConverter(textContent.nodeValue,{dataIndex:editingCell.dataIndex,rowIndex:rowIndex,columnIndex:columnIndex,columnName:columnName});editingCell.setAttribute("value",convertedData);_this.__dispatchEvent(new CustomEvent("edit",{detail:{dataIndex:editingCell.dataIndex,rowIndex:rowIndex,columnIndex:columnIndex,columnName:columnName,before:thisText,after:textContentValue,target:editingCell}}))})})},__renderDummyView:function(rows){if(this.dummyRow!==true)return;if(rows)this.numOfDummyRows=rows;var dummyRowElement=this.childRoot.querySelectorAll(".body-row-dummy:not(.tree-control)");var columnsLen=this.columnsLen;var fragment=document.createDocumentFragment();var tempTRElement,tempTDElement;if(this.numOfDummyRows){if(this.numOfDummyRows===dummyRowElement.length){return}else if(this.numOfDummyRows>=dummyRowElement.length){for(var i=0;i<this.numOfDummyRows-dummyRowElement.length;i++){tempTRElement=document.createElement("tr");tempTRElement.className="body-row-dummy";for(var j=0;j<columnsLen;j++){tempTDElement=document.createElement("td");tempTDElement.className="body-cell-dummy";tempTRElement.appendChild(tempTDElement)}fragment.appendChild(tempTRElement)}}else if(this.numOfDummyRows<dummyRowElement.length){var len=dummyRowElement.length-this.numOfDummyRows;while(len--){dummyRowElement[len].parentNode.removeChild(dummyRowElement[len])}}}else{if(!this.paginate||this.pageInfo===undefined)return;var startIndex=this.pageInfo.start;var endIndex=this.pageInfo.end;var pageLength=this.pageInfo.length;var showedItems=endIndex-startIndex+1;if(this.data.length===0)showedItems++;if(pageLength>=showedItems){if(pageLength-showedItems===dummyRowElement.length){return}else if(pageLength-showedItems>=dummyRowElement.length){for(var i=0;i<pageLength-showedItems-dummyRowElement.length;i++){tempTRElement=document.createElement("tr");tempTRElement.className="body-row-dummy";for(var j=0;j<columnsLen;j++){tempTDElement=document.createElement("td");tempTDElement.className="body-cell-dummy";tempTRElement.appendChild(tempTDElement)}fragment.appendChild(tempTRElement)}}else if(pageLength-showedItems<dummyRowElement.length){var len=dummyRowElement.length-(pageLength-showedItems);while(len--){dummyRowElement[len].parentNode.removeChild(dummyRowElement[len])}}}}if(fragment.childNodes.length>0){this.getElementsByClassName("body")[0].appendChild(fragment)}},__renderIndex:function(){this.__renderIndexForVirtualScroll();return},__renderIndexForVirtualScroll:function(){var tds=this.querySelectorAll(".indexable.body-cell");var start=this.startRowNum>0?this.startRowNum:0;if(this.__indexOption&&this.__indexOption.reverse){for(var i=0,len=tds.length;i<len;i++){tds[i].innerHTML=this.datapointer.length-start-i}}else{for(var i=0,len=tds.length;i<len;i++){tds[i].innerHTML=start+i+1}}},sync:function(){console.log("sync method")},__syncData:function(editableCells,type){var _this=this;for(var i=0,len=editableCells.length;i<len;i++){var bodyCell=$(editableCells[i]).closest(".body-cell")[0];var index=bodyCell&&bodyCell.dataIndex!==undefined?bodyCell.dataIndex:editableCells[i].dataIndex;var column=bodyCell&&bodyCell.columnName?bodyCell.columnName:editableCells[i].columnName;var data=editableCells[i].dataObj||{};var updatedValue,convertedData;if(type==="editable"){if(editableCells[i].tagName=="TD"){updatedValue=editableCells[i].innerText||""}convertedData=this.__setValueByDataConverter(updatedValue,{dataIndex:index,columnName:column});data[column]=convertedData;if(bodyCell)bodyCell.setAttribute("value",convertedData)}else if(type==="editable-cell"){if(editableCells[i].hasOwnProperty("boundProperties")){var boundProperties=editableCells[i].boundProperties;for(var j=0;j<boundProperties.length;j++){var _item=boundProperties[j];updatedValue=editableCells[i][_item]!==undefined?editableCells[i][_item]:"";convertedData=_this.__setValueByDataConverter(updatedValue,{dataIndex:index,columnName:column});if(editableCells[i].tagName==="TOP-SELECTBOX"){if(_item!=="value"&&_item!=="selected-text"&&_item!=="selected-index"){updatedValue=editableCells[i].selectedText||"";convertedData=_this.__setValueByDataConverter(updatedValue,{dataIndex:index,columnName:column})}else{data[column]=convertedData}}else{data[column]=convertedData}if(bodyCell)bodyCell.setAttribute("value",convertedData)}}else{if(editableCells[i].tagName=="TOP-SELECTBOX"){updatedValue=editableCells[i].selectedText||""}else if(editableCells[i].tagName=="TOP-CHECKBOX"){updatedValue=editableCells[i].checked?true:false}else if(editableCells[i].tagName=="TOP-DATEPICKER"){updatedValue=editableCells[i].date||""}else{updatedValue=editableCells[i].text||""}convertedData=_this.__setValueByDataConverter(updatedValue,{dataIndex:index,columnName:column});data[column]=convertedData;if(bodyCell)bodyCell.setAttribute("value",convertedData)}}}this.updateData("items")},check:function(index,checked){if(!this.checkable===true)return;if(index===undefined){console.log("wroing index!");return}if(index>=this.checkIndexInfo.length){console.log("wroing index!");return}if(checked===undefined)checked=true;if(this.checkIndexInfo){if(index instanceof Array){for(var i=0;i<index.length;i++){if(!this.checkIndexInfo[index[i]])continue;this.checkIndexInfo[index[i]].checkbool=checked}}else{this.checkIndexInfo[index].checkbool=checked}this.onScroll(event);if(this.showedCheckboxes!==undefined){var _this=this;setTimeout(function(){_this.checkCallback()},0)}var fnRowCheck=this.onRowcheck;if(typeof this.onRowcheck==="string"){fnRowCheck=Top.Util.namespace(this.onRowcheck,this)}if(typeof fnRowCheck==="function"){if(Top.Util.Browser.isIE()){fnRowCheck(new CustomEvent("rowcheck"),Top.Dom.selectById(this.id))}else{fnRowCheck(new Event("rowcheck"),Top.Dom.selectById(this.id))}}}},checkAll:function(checked,paginate){if(checked==undefined){checked=true}if(this.connect){for(var i=0;i<this.datapointer.length;i++){this.datapointer[i]["temp"].checkbool=checked}this.onScroll();return}if(paginate==undefined){paginate=this.paginate}if(!paginate){for(var i=0;i<this.checkIndexInfo.length;i++){this.checkIndexInfo[i].checkbool=checked}}else{for(var i=this.getPageInfo().start;i<this.getPageInfo().end+1;i++){this.checkIndexInfo[i].checkbool=checked}}this.onScroll();this.checkCallback()},setOnCheck:function(func){this.onCheckFunc=func},checkCallback:function(index){if(!this.checkable)return;if(!this.paginate&&!this.connect){var isAllChecked=true;var checkableHead=Top.Dom.__selectImpl(this.childRoot.querySelector(".checkable-head"));for(var i=0;i<this.checkIndexInfo.length;i++){if(this.checkIndexInfo[i].checkbool==false||this.checkIndexInfo[i].checkbool=="false"){isAllChecked=false}}checkableHead.setProperties({checked:isAllChecked});return}this.showedCheckboxes=[];this.showedCheckboxes=Array.prototype.slice.call(this.querySelectorAll(".body-row .checkable .checkable-body"));var data=this.data;var len=this.showedCheckboxes.length;var checkedList=[];var isAllChecked=false;for(var i=0;i<len;i++){isAllChecked=true;checkedList[i]=this.showedCheckboxes[i].querySelector("input").checked;if(!checkedList[i]){isAllChecked=false;break}}if(typeof this.onCheckFunc==="function"&&index>=0){var checked=this.checkboxes[index].querySelector("input").checked;this.onCheckFunc(index,data[index],checked)}var checkableHead=Top.Dom.__selectImpl(this.childRoot.querySelector(".checkable-head"));if(isAllChecked&&checkableHead){checkableHead.setProperties({checked:true})}else if(!isAllChecked&&checkableHead){checkableHead.setProperties({checked:false})}},__getColumnNameByIndex:function(column){var root=this.childRoot;if(column===undefined||root.querySelector(".body-row .body-cell.column_"+column)===null)return;var columnName=root.querySelector(".body-row .body-cell.column_"+column).columnName;return columnName},__getColumnIndexByLabel:function(label){var swapNum=this.swappable?1:0;var checkNum=this.checkable?1:0;var indexNum=this.indexable?1:0;var treeNum=this.treeTable?1:0;if(label=="__swap")return 0;if(label=="__check")return swapNum;if(label=="__index")return swapNum+checkNum;if(label=="__tree")return swapNum+checkNum+indexNum;return swapNum+checkNum+indexNum+treeNum},getClickedIndex:function(){var clickedIndex=[];clickedIndex.push(this.clickedItemIndex[0]);clickedIndex.push(this.clickedItemIndex[1]);return clickedIndex},getClickedData:function(){return this.backupdata[this.clickedItemIndex[0]]},getCheckedIndex:function(){var checkedIndex=[];this.checkIndexInfo.forEach(function(item,index){if(item.checkbool==true||item.checkbool=="true"){checkedIndex.push(index)}});return checkedIndex},getCheckedData:function(){var checkedData=[];for(var i=0;i<this.checkIndexInfo.length;i++){if(this.checkIndexInfo[i].checkbool==true||this.checkIndexInfo[i].checkbool=="true"){checkedData.push(this.datapointer[i])}}return checkedData},selectCells:function(row,column){if(column){var base=0;if(this.checkable){base++}if(this.indexable){base++}column=column+base}var thisTr=this.dataTable.cells(row,column).nodes();if(thisTr.length>1){for(var i=0;i<thisTr.length;i++){$(thisTr[i]).trigger($.Event("click",{ctrlKey:true}))}}else{$(thisTr).click()}},Cells:function(row,column){if(column){var base=0;if(this.checkable){base++}if(this.indexable){base++}column=column+base}return this.dataTable.cells(row,column).nodes()},selectData:function(index){var _this=this;var thisTr=this.querySelectorAll(".body-row");if(index instanceof Array){for(var i=0;i<index.length;i++){this.clickedItemIndex=index[i]-_this.startRowNum;$(thisTr[index[i]-_this.startRowNum]).trigger($.Event("click",{ctrlKey:true}))}}else{if(thisTr[index-_this.startRowNum]){$(thisTr[index-_this.startRowNum]).click();$(thisTr[index-_this.startRowNum]).addClass("selected")}else{this.deselectData()}this.selectedItemIndex=index;this.clickedItemIndex=index}},deselectData:function(index){var _this=this;if(index!==undefined){var thisTr=this.querySelectorAll(".body-row");for(var i=0;i<thisTr.length;i++){if(thisTr[i].classList.contains("selected")){thisTr[i].classList.remove("selected");if(thisTr[i].nextSibling&&thisTr[i].nextSibling.classList.contains("selected")){thisTr[i].classList.add("previous")}}var prevItem=thisTr[i].previousSibling;if(!prevItem){if(this.scrollTable){prevItem=this.querySelector(".top-tableview-scrollHeadInner .head .head-row")}else{prevItem=thisTr[i].parentNode.previousSibling.querySelector(".head-row")}}if(prevItem.classList.contains("previous")){prevItem.classList.remove("previous")}}if(this.selectedItemIndex instanceof Array){for(var i=0;i<this.selectedItemIndex.length;i++){if(index instanceof Array){for(var j=0;j<index.length;j++){if(this.selectedItemIndex[i]==index[j]){this.selectedItemIndex.splice(i,1)}}}else{if(this.selectedItemIndex[i]==index){this.selectedItemIndex.splice(i,1)}}}}else if(this.selectedItemIndex==index){this.selectedItemIndex=undefined}}else{for(var i=0;i<thisTr.length;i++){thisTr[i].classList.remove("selected");thisTr[i].classList.remove("previous")}this.selectedItemIndex=[];this.clickedItemIndex=[]}},calcPage:function(index){if(index<this.data.length){var pageInfo=this.dataTable.page.info();return parseInt(index/pageInfo.length)}},makeColReorder:function(){var _this=this;_this.base=0;if(this.checkable){_this.base++}if(this.indexable){_this.base++}_this.beforecol=-1;_this.aftercol=-1;_this.firstHeads=Array.from(_this.querySelectorAll("th.last-head:not(.checkable):not(.indexable):not(.incapable_header)")).sort(_this.sortByHeadIndex);_this.hcolgroup=_this.querySelector(".head_colgroup:not(.incapable_header)");$(_this.firstHeads).off().draggable({helper:"clone",axis:"x",start:function(e){currentcolumn(e.target.offsetLeft)},drag:function(e,helper){whereisthecolumnposition(helper.offset.left)},stop:function(e){moveheader(e);_this._adjustcolumn();movecolumn(e);setdefualt(e)}});var resizers=_this.resizers;function setdefualt(){for(var i=0;i<resizers.length;i++){resizers[i].style.backgroundColor=""}}function testmove(e){if(_this.beforecol==_this.aftercol||_this.aftercol<0){return}var after=_this.aftercol;var before=_this.beforecol;$(_this.querySelectorAll(".body-row")).remove();if(after<before){_this.tableHeaderArray[0].splice(after,0,_this.tableHeaderArray[0][before]);_this.tableHeaderArray[0].splice(before+1,1);_this.rowItemArray.splice(after,0,_this.rowItemArray[before]);_this.rowItemArray.splice(before+1,1)}else{_this.tableHeaderArray[0].splice(after,0,_this.tableHeaderArray[0][before]);_this.tableHeaderArray[0].splice(before+1,1);_this.rowItemArray.splice(after,0,_this.rowItemArray[before]);_this.rowItemArray.splice(before+1,1)}_this.renderLayout()}function moveheader(){if(_this.beforecol==_this.aftercol||_this.aftercol<0){return}var after=_this.aftercol;var before=_this.beforecol;var beforecol=_this.firstHeads[before];var temptext=beforecol.textContent;var tempstyle=_this.hcolgroup.children[before+_this.base].style.width;if(_this.__columnOption){var tempoption=_this.__columnOption[before]}var tempkey=_this.itemKeys[before];if(after<before){for(var i=after;i<before+1;i++){var txt=temptext;var style=tempstyle;var nextcol=_this.firstHeads[i];temptext=nextcol.textContent;nextcol.textContent=txt;var nextcolgroup=_this.hcolgroup.children[i+_this.base];tempstyle=nextcolgroup.style.width;nextcolgroup.style.width=style;var op=tempoption;var key=tempkey;if(_this.__columnOption){tempoption=_this.__columnOption[i];_this.__columnOption[i]=op}tempkey=_this.itemKeys[i];_this.itemKeys[i]=key}}else{for(var i=after-1;i>before-1;i--){var txt=temptext;var style=tempstyle;var nextcol=_this.firstHeads[i];temptext=nextcol.textContent;nextcol.textContent=txt;var nextcolgroup=_this.hcolgroup.children[i+_this.base];tempstyle=nextcolgroup.style.width;nextcolgroup.style.width=style;var op=tempoption;var key=tempkey;if(_this.__columnOption){tempoption=_this.__columnOption[i];_this.__columnOption[i]=op}tempkey=_this.itemKeys[i];_this.itemKeys[i]=key}}if(_this.columnResize){_this.resizer_reposition()}}function movecolumn(e){if(_this.beforecol==_this.aftercol||_this.aftercol<0){return}var after=_this.aftercol;var before=_this.beforecol;$(_this.querySelectorAll(".body-row")).remove();if(after<before){_this.rowItemArray.splice(after,0,_this.rowItemArray[before]);_this.rowItemArray.splice(before+1,1)}else{_this.rowItemArray.splice(after,0,_this.rowItemArray[before]);_this.rowItemArray.splice(before,1)}_this.bindingarray.length=0;_this.rowsync=false;_this.onScroll()}function currentcolumn(tagetpos){var tleft=tagetpos;for(var i=0;i<resizers.length;i++){if(tleft<resizers[i].offsetLeft){_this.beforecol=i-_this.base;if(_this.beforecol<0){return}_this.beforecol=i-_this.base;return}}}function whereisthecolumnposition(tagetpos){var tleft=tagetpos+_this.viewport[0].scrollLeft;for(var i=0;i<resizers.length;i++){if(i==resizers.length-1){if(tleft>resizers[i].offsetLeft){resizers[i].style.backgroundColor="orange";_this.aftercol=i-_this.base+1}else{resizers[i].style.backgroundColor=""}break}if(tleft<resizers[i+1].offsetLeft&&tleft>resizers[i].offsetLeft){_this.aftercol=i-_this.base+1;if(_this.aftercol<0){resizers[i].style.backgroundColor=""}else{resizers[i].style.backgroundColor="orange"}}else{resizers[i].style.backgroundColor=""}}}},makeColResizer:function(){var root=this.childRoot;var tableElement=root.querySelector("table.top-tableview");if(tableElement===null)return;var gripsElement=this.getElementsByClassName("top-tableview-grips")[0];if(gripsElement)return;var headRows=this.querySelectorAll(".top-tableview-scrollHead .head-row");var _this=this;var tableRoot=root.getElementsByClassName("top-tableview-root")[0];var numOfHeader=this.sumOfColspan||this.columnOptiontoTable.length;var tableHeight=tableElement.offsetHeight;this.selectedResizer=null;
gripsElement=document.createElement("div");gripsElement.className="top-tableview-grips";tableRoot.insertBefore(gripsElement,tableRoot.firstChild);var firstHeads=Array.from(_this.querySelectorAll("th.last-head:not(.ui-draggable-dragging)")).sort(_this.sortByHeadIndex);if(firstHeads.length==0){return}if(this.scrollTable){if(!this.data.length===0||!this.items){}}var headCellTop=firstHeads[0].offsetTop;var bodyHeight=Math.min(root.querySelector(".top-tableview-scrollBody .top-tableview").offsetHeight,root.querySelector(".top-tableview-scrollBody").offsetHeight);var bodyWidth=Math.min(root.querySelector(".top-tableview-scrollBody .top-tableview").offsetWidth,root.querySelector(".top-tableview-scrollBody").offsetWidth);var resizerHeight=firstHeads[0].offsetHeight;for(var i=0;i<firstHeads.length-1;i++){if(firstHeads[i].getAttribute("colspan")==="1"){var headCell=firstHeads[i];if(i==firstHeads.length-2){if(_this.columnResize!="auto"){}}var headCellLeft=firstHeads[i+1].offsetLeft-5+"px";if(this.paginate&&this.pagerLocation.startsWith("t")){headCellTop=$("#"+this.id+" .top-tableview-scroll")[0].offsetTop}var resizerElement=document.createElement("div");resizerElement.className="top-tableview-resizer";resizerElement.setAttribute("index",i);resizerElement.setAttribute("style","height:"+resizerHeight+"px; left:  "+headCellLeft+"; top: "+headCellTop+"px "+(parseInt(headCellLeft)>tableRoot.offsetWidth?"display:none; ":""));gripsElement.appendChild(resizerElement);var headCellWidth=headCell.offsetWidth;if(!headCell.style.width)headCell.style.width=headCellWidth+"px"}}var prevX;$(tableRoot.querySelectorAll(".top-tableview-resizer")).off("mousedown").on("mousedown",function(e){_dragInit(this);prevX=e.pageX});tableRoot.removeEventListener("mouseup",this._destroy);tableRoot.addEventListener("mouseup",this._destroy);this.resizers=$("#"+_this.id+" .top-tableview-resizer");this.resizers.off().draggable({axis:"x",start:function(e){_this.originLeft=e.target.offsetLeft;e.target.style.backgroundColor="#357fd2"},drag:function(e){},stop:function(e){_moveElem(e);e.target.style.backgroundColor="";if(_this.storeColumn){_this.__storeCookieHeaderInfo()}}});if(_this.columnResize!="auto"){$("#"+_this.id+" .top-tableview-resizer:last-child").off()}function _dragInit(elem){_this.selectedResizer=elem}function _moveElem(e){var hcolgroup=_this.querySelector(".head_colgroup");var bcolgroup=_this.querySelector(".body_colgroup");var selected=e.target;var originLeft=_this.originLeft;var movingValue=parseInt(e.target.style.left)-_this.originLeft;if(movingValue==0)return;var index=parseInt(selected.getAttribute("index"));var leftTH=[],rightTH=[];var hcolleft=hcolgroup.children[index];var bcolleft=bcolgroup.children[index];leftTH.push(firstHeads[index]);if(firstHeads[index+1]){rightTH.push(firstHeads[index+1]);var hcolright=hcolgroup.children[index+1];var bcolright=bcolgroup.children[index+1]}else{rightTH.push(null);var hcolright=null;var bcolright=null}if(_this.scrollTable){secondHeads=_this.querySelector(".body_colgroup");leftTH.push(secondHeads[index]);secondHeads[index+1]?rightTH.push(secondHeads[index+1]):rightTH.push(null)}var leftComputedStyle=window.getComputedStyle(leftTH[0]);var rightComputedStyle=window.getComputedStyle(rightTH[0]);var min=leftTH[0].offsetLeft;if(leftTH[0].nextSibling){var max=leftTH[0].nextSibling.offsetLeft+leftTH[0].nextSibling.offsetWidth}else{var max=min+leftTH[0].offsetWidth}var unitRatio=10;var overMax=false,overMin=false;if(movingValue>0){var movingLeft=parseFloat(originLeft)+movingValue;if(movingLeft>=max-unitRatio&&_this.columnResize!="auto"){$(selected).css("left",originLeft+"px");return}}else if(movingValue<0){var movingLeft=parseFloat(originLeft)+movingValue;if(movingLeft<=min+unitRatio){$(selected).css("left",originLeft+"px");return}}if(_this.columnResize=="auto"){rightTH[0]={style:"",colspan:"",auto:true};rightTH[1]={style:"",colspan:"",auto:true}}if(leftTH[0].style.whiteSpace)leftTH[0].style.whiteSpace="";if(leftTH[0].style.wordWrap)leftTH[0].style.wordWrap="";if(rightTH[0].style.whiteSpace)rightTH[0].style.whiteSpace="";if(rightTH[0].style.wordWrap)rightTH[0].style.wordWrap="";var leftTHBoxsizing=leftComputedStyle["boxSizing"];var rigthTHBoxsizing=rightComputedStyle["boxSizing"];if(leftTH[0].style.width&&rightTH[0].style.width){var sumOfWidth=parseInt(rightTH[0].style.width)+parseInt(leftTH[0].style.width)}if(leftTH[0].getAttribute("colspan")==="1"){if(leftTHBoxsizing==="border-box"){leftTH[0].style.width=movingLeft-min+"px";hcolleft.style.width=movingLeft-min+"px";bcolleft.style.width=movingLeft-min+"px"}else{leftTH[0].style.width=movingLeft-min-sumForLeft+"px";hcolleft.style.width=movingLeft-min-sumForLeft+"px";bcolleft.style.width=movingLeft-min-sumForLeft+"px"}}else{leftTH[0].style.width=leftTH[0].clientWidth-movingValue+"px"}if(_this.columnResize!="auto"){if(rightTH[0].getAttribute("colspan")==="1"){if(sumOfWidth){rightTH[0].style.width=sumOfWidth-parseInt(leftTH[0].style.width)+"px";hcolright.style.width=sumOfWidth-parseInt(leftTH[0].style.width)+"px";bcolright.style.width=sumOfWidth-parseInt(leftTH[0].style.width)+"px"}else{if(rigthTHBoxsizing==="border-box"){rightTH[0].style.width=max-movingLeft+"px";hcolright.style.width=movingLeft-min+"px";bcolright.style.width=movingLeft-min+"px"}else{rightTH[0].style.width=max-movingLeft-sumForRight+"px";bcolright.style.width=movingLeft-min-sumForLeft+"px";bcolright.style.width=movingLeft-min-sumForLeft+"px"}}}else{rightTH[0].style.width=rightTH[0].clientWidth-movingValue+"px"}}if(leftTH[1]){leftTH[1].style.width=leftTH[0].style.width;if(leftTH[1].style.whiteSpace)leftTH[1].style.whiteSpace="";if(leftTH[1].style.wordWrap)leftTH[1].style.wordWrap=""}if(_this.columnResize=="auto"){var thirdheads=root.querySelectorAll(".top-tableview-resizer");for(var j=0;j<firstHeads.length-1;j++){if(firstHeads[j].getAttribute("colspan")==="1"){if(j==firstHeads.length-2){if(_this.columnResize!="auto"){break}}var headCellLeft=firstHeads[j+1].offsetLeft-5+"px";thirdheads[j].style.left=headCellLeft}}}if(rightTH[1]){rightTH[1].style.width=rightTH[0].style.width;if(rightTH[1].style.whiteSpace)rightTH[1].style.whiteSpace="";if(rightTH[1].style.wordWrap)rightTH[1].style.wordWrap=""}var bojung=leftTH[0].offsetLeft+leftTH[0].offsetWidth-5;$(selected).css("left",bojung+"px")}this.setResizerLeft=function(){};this.setResizerHeight=function(){};this.changeFirstHeads=function(){firstHeads=this.scrollTable?root.querySelectorAll(".top-tableview-scrollHeadInner th.head-cell"):root.querySelectorAll("th.head-cell")}},attachTooltip:function(){var thisTable=this;var thisPageId=Top.App.getCurrentPage().id;var tooltipDirection="";var select_dom="td:not(.non-tooltip)";var timer=null;$(document).off("mouseenter",select_dom).on("mouseenter",select_dom,function(){clearTimeout(timer);timer=setTimeout(toolhandle.bind(this),500)});var toolhandle=function(){var $tooltipText=$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=$("#"+thisPageId+" .top-tooltip-arrow");for(var i=0;i<this.children.length;i++){if(this.children[i].tagName!=="TOP-TEXTVIEW")return}if(this.firstChild&&(this.firstChild.nodeName==="#text"||this.firstChild.tagName==="TOP-TEXTVIEW")){if(this.firstChild.tagName==="TOP-TEXTVIEW")var thisTextView=Top.Dom.selectById(this.firstChild.id);var isOverflown=$(this).hasOverflown();if(isOverflown||thisTextView&&thisTextView.getProperties("ellipsis")){$tooltipText.html(this.getAttribute("value"));$tooltipText.css("display","inline-block");$tooltipArrow.css("display","inline-block");var children=$tooltipText.find("*");for(var i=0,len=children.length;i<len;i++){children[i].layoutParent=thisTable}var thisoffset=$(this).offset();$tooltipText.css("left",thisoffset.left);var calculatedHeight=$(document).height()-(thisoffset.top+40);var tooltipHeight=$tooltipText[0].offsetHeight;if(calculatedHeight<tooltipHeight){$tooltipText.css("top",thisoffset.top-tooltipHeight);$tooltipArrow.addClass("top");tooltipDirection="top"}else{$(thisTable).hasClass("white")?$tooltipText.css("top",thisoffset.top+35):$tooltipText.css("top",thisoffset.top+25);$tooltipArrow.addClass("bottom");tooltipDirection="bottom"}var tooltipoffset=$tooltipText.offset();if(tooltipDirection==="bottom"){$(thisTable).hasClass("white")?$tooltipArrow.css("left",tooltipoffset.left+6):$tooltipArrow.css("left",tooltipoffset.left+7);$tooltipArrow.css("top",tooltipoffset.top-3)}else if(tooltipDirection==="top"){$(thisTable).hasClass("white")?$tooltipArrow.css("left",tooltipoffset.left+6):$tooltipArrow.css("left",tooltipoffset.left+7);$tooltipArrow.css("top",tooltipoffset.top+tooltipHeight-4)}}}};$(document).off("mouseleave",select_dom).on("mouseleave",select_dom,function(){clearTimeout(timer);var $tooltipText=$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=$("#"+thisPageId+" .top-tooltip-arrow");$tooltipText.css("display","none");$tooltipArrow.css("display","none");if(tooltipDirection==="bottom")$tooltipArrow.removeClass("bottom");else if(tooltipDirection==="top")$tooltipArrow.removeClass("top")});$(document).off("mouseenter","#"+thisPageId+" .top-tooltip-text").on("mouseenter","#"+thisPageId+" .top-tooltip-text",function(){var $tooltipText=$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=$("#"+thisPageId+" .top-tooltip-arrow");$(this).css("display","inline-block");$tooltipArrow.css("display","inline-block");if(tooltipDirection==="bottom")$tooltipArrow.addClass("bottom");else if(tooltipDirection==="top")$tooltipArrow.addClass("top")});$(document).off("mouseleave","#"+thisPageId+" .top-tooltip-text").on("mouseleave","#"+thisPageId+" .top-tooltip-text",function(){var $tooltipText=$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=$("#"+thisPageId+" .top-tooltip-arrow");$(this).css("display","none");$tooltipArrow.css("display","none");if(tooltipDirection==="bottom")$tooltipArrow.removeClass("bottom");else if(tooltipDirection==="top")$tooltipArrow.removeClass("top")})},detachTooltip:function(){var thisPageId=Top.App.getCurrentPage().id;var $tooltipText=$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=$("#"+thisPageId+" .top-tooltip-arrow");$tooltipText.css("display","none");$tooltipArrow.css("display","none");if($tooltipArrow.hasClass("bottom"))$tooltipArrow.removeClass("bottom");else if($tooltipArrow.hasClass("top"))$tooltipArrow.removeClass("top")},organizeLengthMenu:function(){if(typeof this.lengthMenu[0]=="number"){for(var i=0;i<this.lengthMenu.length;i++){if(this.pageLength==this.lengthMenu[i])break;if(i==this.lengthMenu.length-1){this.lengthMenu.push(this.pageLength)}}this.lengthMenu.sort(function(a,b){return a-b})}else{for(var i=0;i<this.lengthMenu[0].length;i++){if(this.pageLength==this.lengthMenu[0][i])break;if(i==this.lengthMenu[0].length-1){this.lengthMenu[0].push(this.pageLength);this.lengthMenu[1].push(this.pageLength)}}this.lengthMenu[0].sort(function(a,b){if(b=="-1"&&a>b)return-1;else if(a=="-1"&&a<b)return 1;else return a-b});this.lengthMenu[1].sort(function(a,b){if(typeof a=="number"&&typeof b=="string"){return-1}else if(typeof a=="string"&&typeof b=="number"){return 1}else return a-b})}},setColWidget:function(){var selectBox=Top.Dom.select("#"+this.id+" .body top-selectbox");if(selectBox.length>0){for(var i=0;i<selectBox.length;i++){if(selectBox[i].template.selectedText!==undefined&&selectBox[i].template.selectedText!==null&&typeof selectBox[i].setProperties==="function"){selectBox[i].setProperties({"selected-text":selectBox[i].template.selectedText})}}}var root=this.childRoot;var menu=root.querySelectorAll("top-menu");if(menu.length>0){for(var i=0,len=menu.length;i<len;i++){if(menu[i].type==="dropdown"&&typeof menu[i].setDropdownPosition==="function")menu[i].setDropdownPosition()}}var radiobuttons=root.querySelectorAll("top-radiobutton");for(var i=0,len=radiobuttons.length;i<len;i++){if(typeof radiobuttons[i].__initLabel==="function")radiobuttons[i].__initLabel()}var textfields=root.querySelectorAll("top-textfield");for(var i=0,len=textfields.length;i<len;i++){if(typeof textfields[i].setTitlePosition==="function")textfields[i].setTitlePosition();if(typeof textfields[i].setIconPosition==="function")textfields[i].setIconPosition()}var datepickers=this.querySelectorAll("top-datepicker");for(var i=0,len=datepickers.length;i<len;i++){if(typeof datepickers[i].__updateDate==="function")datepickers[i].__updateDate()}},setPageInfo:function(info){if(this.pageInfo===undefined){this.pageInfo={page:1,length:this.pageLength,start:0,end:this.pageLength-1}}if(typeof info==="object"){var keys=Object.keys(info);for(var i=0,len=keys.length;i<len;i++){this.pageInfo[keys[i]]=info[keys[i]]}}},getPageInfo:function(){return this.pageInfo},filterColumns:function(columnObj){var data=this.data;if(data===undefined)return;var _this=this;var dataKeys=Object.keys(data[0]);var removeColArray=[];var allThs=this.childRoot.querySelectorAll(".head-row .head-cell");var allTds=this.childRoot.querySelectorAll(".body-row .body-cell");for(var key in columnObj){var thElement;allThs.forEach(function(item){if(item.columnName===columnObj[key]){thElement=item}});$(thElement).text(key);if(thElement.style.display==="none")$(thElement).css("display","");allTds.forEach(function(item){if(item.columnName===columnObj[key]){if(item.style.display==="none")$(item).css("display","")}})}dataKeys.forEach(function(item){var willRemove=true;for(var key in columnObj){if(item==columnObj[key]){willRemove=false}}if(willRemove){removeColArray.push(item)}});for(var i=0;i<removeColArray.length;i++){allThs.forEach(function(item){if(item.columnName===removeColArray[i]){$(item).css("display","none")}});allTds.forEach(function(item){if(item.columnName===removeColArray[i]){$(item).css("display","none")}})}},onVisibleChanged:function(){if(this.visible==="visible"){this.initialLayout();this.renderLayout()}},src:function(htmlFile){if(this.data.length>0)return;if(Top.Util.getFileExtension(htmlFile)!="html")return;var _this=this.childRoot.querySelector(".top-tableview-empty");Top.Ajax.get(htmlFile,"","",function(data,textStatus,jqXHR){$(_this).html(data)})},html:function(htmlString){if(this.data.length>0)return;$(this.childRoot.querySelector(".top-tableview-empty")).html(htmlString)},__updateItems:function(){if(typeof this.items==="string"){this.data=Top.Util.namespace(this.items,this)}else if(typeof this.items==="object"){this.data=this.items}else{this.data=[]}if(this.datapointer){this.datapointer=this.data;this.backupdata=this.data}if(!this.checkIndexInfo){return}if(this.hcolgroup&&this.hcolgroup.children.length<=1){this.itemLayoutDom=[];this.rowItemArray=undefined;this.tableHeaderArray=undefined;this.renderLayout();return}if(this.data.length!=this.checkIndexInfo.length){for(var i=0;i<this.data.length;i++){if(this.checkIndexInfo[i]){this.checkIndexInfo[i].checkbool=false;continue}this.checkIndexInfo.push({checkbool:false,status:"new",selected:false})}this.checkCallback()}if(this.paginate=="true"||this.paginate==true){this.virtualmakePage();this.virtualgoToPage(this.currentPage,this.getPageInfo())}this.onScroll(event);this.scrollbar_height()},renderLayout:function(){this.__initProperties();clearTimeout(this.timer);this.timer=setTimeout(this.renderLayoutAsync.bind(this),0)},__initProperties:function(){if(typeof this.items==="string"){this.data=Top.Util.namespace(this.items,this);this.itemsString=this.items}else if(typeof this.items==="object"){this.data=this.items}else if(this.items===undefined){this.data=[]}this.onCheckFunc=typeof this.onCheck==="string"?Top.Util.namespace(this.onCheck,this):this.onCheck;this.onCheckHeadFunc=typeof this.onCheckhead==="string"?Top.Util.namespace(this.onCheckhead,this):this.onCheckhead;this.headerOption=typeof this.headerOption==="string"?Top.Util.namespace(this.headerOption,this):this.headerOption;this.__columnOption=typeof this.columnOption==="string"?Top.Util.namespace(this.columnOption,this):this.columnOption;this.__column=typeof this.column==="string"?Top.Util.namespace(this.column,this):this.column;this.__checkOption=typeof this.checkOption==="string"?Top.Util.namespace(this.checkOption,this):this.checkOption;this.__indexOption=typeof this.indexOption==="string"?Top.Util.namespace(this.indexOption,this):this.indexOption;this.__treeOption=typeof this.treeOption==="string"?Top.Util.namespace(this.treeOption,this):this.treeOption},__onRenderLayout:function(fn){if(this.__onRenderLayoutListeners===undefined){this.__onRenderLayoutListeners=[]}this.__onRenderLayoutListeners.push(fn)},__callRenderLayoutListeners:function(){if(this.__onRenderLayoutListeners===undefined)return;for(var i=0,len=this.__onRenderLayoutListeners.length;i<len;i++){this.__onRenderLayoutListeners[i]()}this.__onRenderLayoutListeners=[]},__reRender:function(){this.__initProperties();if(!this.__initialized===undefined||this.Toptablerendered===undefined)return;var _this=this;if(this.paginate){this.currentPage=this.currentPage>0?this.currentPage:1}if(this.checkable&&this.checkIndexInfo){var checkedIndex=this.getCheckedIndex()}if(this.__setDataLengthCalled!==true&&this.data&&this.data.length===0)this.dataLength=undefined;for(var p=0;p<this.itemLayoutDom[1].children.length;p++){var type=this.itemLayoutDom[1].children[p].getAttribute("type");if(type=="check"){var vncheck=this.checkable?"visible":"none";this.itemLayoutDom[1].children[p].setAttribute("visible",vncheck)}if(type=="index"){var vnidx=this.indexable?"visible":"none";this.itemLayoutDom[1].children[p].setAttribute("visible",vnidx)}}this.renderLayout();this.__onRenderLayout(function(){if(_this.virtualScroll)return;if(checkedIndex&&checkedIndex.length>0){var l=checkedIndex.length;while(l--){_this.check(checkedIndex[l],true)}}_this.__dispatchEvent(new CustomEvent("update"));if(_this.dragSelection)_this.setDragSelection(true);_this.setColWidget();if(_this.paginate){_this.goToPage(0)}})},__updateSelectType:function(){this.setAttribute("select-type",this.selectType);$(this.childRoot.querySelectorAll(".selected")).removeClass("selected");$(this.childRoot.querySelectorAll(".previous")).removeClass("previous");this.selectedItemIndex=[];this.bindEvent()},setRowLayout:function(rowIndex,layout){var tr=this.childRoot.querySelector(".row_"+(rowIndex-this.startRowNum));if(tr==null)return;var tds=tr.children;var uneditableTdNum=0;if(tds[0].classList.contains("checkable")||tds[0].classList.contains("indexable")){uneditableTdNum++}if(tds[1].classList.contains("indexable")){uneditableTdNum++}if(typeof layout==="string")layout=Top.Util.namespace(layout,this);if(typeof layout!=="function")return;for(var i=uneditableTdNum,len=tds.length;i<len;i++){var columnIndex=i-uneditableTdNum;var columnName=this.__getColumnNameByIndex(columnIndex);if(columnName!==undefined&&this.backupdata[rowIndex][columnName]!==undefined){var newLayout=layout({data:this.backupdata[rowIndex][columnName],rowIndex:rowIndex,columnIndex:columnIndex,columnName:columnName})||undefined;if(newLayout!==undefined){if(newLayout instanceof Top.Widget){$(tds[i]).html(newLayout.template);newLayout.template.__attachedImpl();newLayout.template.__initBoundData(true,newLayout.id);if(!Top.Util.Browser.isIE())newLayout.template.__initEvent()}else{tds[i].innerHTML=newLayout}tds[i].style.overflow="visible";tds[i].classList.add("editable")}}$(tds[i]).find("*").on("mousedown",function(e){e.stopPropagation()})}},setCellLayout:function(rowIndex,columnIndex,layout){var td=this.childRoot.querySelector(".row_"+(rowIndex-this.startRowNum)+" .column_"+columnIndex);var columnName=this.__getColumnNameByIndex(columnIndex);if(typeof layout==="string")layout=Top.Util.namespace(layout,this);if(typeof layout!=="function")return;if(columnName!==undefined){var childWidgets=[];for(var i=0,len=td.children.length;i<len;i++){childWidgets.push(Top.Dom.selectById(td.children[i].id))}var newLayout=layout({data:this.backupdata[rowIndex][columnName],rowIndex:rowIndex,columnIndex:columnIndex,columnName:columnName,childWidgets:childWidgets})||undefined;if(newLayout!==undefined){if(newLayout instanceof Top.Widget){$(td).html(newLayout.template);newLayout.template.__attachedImpl();newLayout.template.__initBoundData(true,newLayout.id);if(!Top.Util.Browser.isIE())newLayout.template.__initEvent()}else{td.innerHTML=newLayout}td.classList.add("editable")}}$(td).find("*").on("mousedown",function(e){e.stopPropagation()})},complete:function(option){var tds=this.childRoot.querySelectorAll(".body-cell.editable");for(var i=0,len=tds.length;i<len;i++){if(typeof option==="object"){if(option.rowIndex===undefined){this.__widgetsToText(tds[i])}else if(option.rowIndex===tds[i].pos.row&&(option.columnIndex===undefined||option.columnIndex===tds[i].pos.col)){this.__widgetsToText(tds[i])}}else{this.__widgetsToText(tds[i])}tds[i].style.overflow=""}if(option===undefined||typeof option==="object"&&option.syncData!==false)this.sync()},__widgetsToText:function(td){var children=td.children;for(var i=0,len=children.length;i<len;i++){if(children[i].tagName=="TOP-SELECTBOX"){td.value=children[i].selectedText;td.innerText=children[i].selectedText}else if(children[i].tagName=="TOP-DATEPICKER"){td.value=children[i].date;td.innerText=children[i].date}else{td.value=children[i].text;td.innerText=children[i].text}}},setDataLength:function(dataLength){this.__setDataLengthCalled=true;this.dataLength=dataLength;if(this.indexable)this.__renderIndex();if(this.paginate){var root=this.childRoot;if(this.showresult){root.querySelector(".top-tableview-result > .number").innerHTML=dataLength}var total=this.pageLength===-1?1:Math.ceil(dataLength/this.pageLength);var pagerElement=root.querySelector(".top-tableview-pager top-pagination");pagerElement.setAttribute("total",total);pagerElement.total=total;pagerElement.__updateProperties("total")}},setDragSelection:function(bool){var _this=this;bool=bool===true||bool==="true";this.dragSelection=bool;if(!this.dataTable)return;var nTable=this.dataTable.table().node();var root=this.childRoot;if(bool){$(root.querySelectorAll(".body-cell *")).on("mousedown",function(e){e.stopPropagation()});$(nTable).off("t_dragstart").on("t_dragstart",{distance:1},function(ev,dd){return $('<div class="drag-selection" />').css("opacity",.65).appendTo(document.body)}).off("t_drag").on("t_drag",function(ev,dd){$(dd.proxy).css({top:Math.min(ev.pageY,dd.startY),left:Math.min(ev.pageX,dd.startX),height:Math.abs(ev.pageY-dd.startY),width:Math.abs(ev.pageX-dd.startX)})}).off("t_dragend").on("t_dragend",function(ev,dd){$("div.drag-selection").remove()});$.drop({multi:true});if(this.selectType==="row"){$(root.querySelectorAll(".body-row")).drop("t_dropstart",function(){$(this).trigger($.Event("click",{ctrlKey:true}))})}else if(this.selectType==="cell"){$(root.querySelectorAll(".body-cell")).drop("t_dropstart",function(){$(this).trigger($.Event("click",{ctrlKey:true}))})}}else{$(this).off("t_dragstart");$(root.querySelectorAll(".body-row")).off("t_dropstart");$(root.querySelectorAll(".body-cell")).off("t_dropstart")}},__storeCookieHeaderInfo:function(){var name=this.storeKey||this.id;var nodes=this.getTableHeaderInfoByTree();this.setCookie(name,nodes)},setCookie:function(name,value){var cookie=[name,"=",JSON.stringify(value),";"].join("");document.cookie=cookie},getCookie:function(name){var result=document.cookie.match(new RegExp(name+"=([^;]+)"));result&&(result=JSON.parse(result[1]));return result},getTableHeaderInfo:function(){var _table=this;var table_id=_table.getAttribute("id");var table_head=_table.querySelectorAll(".top-tableview-scrollHead .head-row .head-cell");var table_head_info=new Object;var cnt=0;var column=_table.column||null;for(var i=0;i<_table.itemKeys.length;i++){var temp={class:table_head[cnt+i].getAttribute("class"),value:table_head[cnt+i].getAttribute("value"),text:table_head[cnt+i].getAttribute("text"),width:table_head[cnt+i].offsetWidth+"px",rowspan:table_head[cnt+i].getAttribute("rowspan"),colspan:table_head[cnt+i].getAttribute("colspan")};table_head_info[_table.itemKeys[i]]=temp}var table_info={id:table_id,"header-option":table_head_info,column:column};return table_info},setTableHeaderInfo:function(value){var _table=this;Top.Dom.selectById(_table.id).setProperties({column:value.column,"header-option":value.headerOption})},recursiveTableToTree:function(index){var className="headIndex_"+this.headerInfoArray[index]["class"];var header=this.querySelector("th."+className);if(!header)return;var hcolgroup=this.querySelector(".head_colgroup");var hcolgroupIndex=0;for(var i=0;i<this.lastHeader.length;i++){if(this.headerInfoArray[index]==this.lastHeader[i]){hcolgroupIndex=i;break}}var result={id:header.getAttribute("id"),text:header.classList.contains("checkable")?"check":header.getAttribute("value"),colspan:this.headerInfoArray[index]["colspan"],rowspan:this.headerInfoArray[index]["rowspan"],xmlRow:this.headerInfoArray[index]["xmlRow"],xmlCol:this.headerInfoArray[index]["xmlCol"],width:hcolgroup.children[hcolgroupIndex].style.width,parent:this.headerInfoArray[index]["parent"],lastHeadNum:this.headerInfoArray[index]["lastHeadNum"],index:this.headerInfoArray[index]["index"]};var childrenResult=[];for(var i=0;i<this.headerInfoArray[index]["children"].length;i++){childrenResult.push(this.recursiveTableToTree(this.headerInfoArray[index]["children"][i]))}result["children"]=childrenResult;return result},recursiveTreeToTable:function(tree,index,result){if(result.length<=index)return;for(var i=0;i<tree.length;i++){result[index].push({id:tree[i].id,text:tree[i].text==="check"?"":tree[i].text,colspan:tree[i].colspan,rowspan:tree[i].rowspan,xmlRow:tree[i].xmlRow,xmlCol:tree[i].xmlCol,width:tree[i].width,parent:tree[i].parent,lastHeadNum:tree[i].lastHeadNum,index:tree[i].index});if(tree[i].children.length!=0){this.recursiveTreeToTable(tree[i].children,index+tree[i].rowspan,result)}}},getTableHeaderInfoByTree:function(){var result=[];if(!this.headerInfoArray){return}for(var i=0;i<this.headerInfoArray.length;i++){if(this.headerInfoArray[i]["parent"]!==null){continue}result.push(this.recursiveTableToTree(i))}return result},__detached:function(){this.detachTooltip();this.showedCheckboxes=null;this.checkboxes=null;this.childs=null;this.rowItemArray=null;document.removeEventListener("mouseup",this._destroy)},__updateOnScrollend:function(){this.__addEventByAttr("scrollend")},__updateOnRowclick:function(){this.__addEventByAttr("rowclick")},__updateOnRowclick:function(){this.__addEventByAttr("rowclick")},__updateOnRowdblclick:function(){this.__addEventByAttr("rowdblclick")},__updateOnRowcontextmenu:function(){this.__addEventByAttr("rowcontextmenu")},__updateOnCellclick:function(){this.__addEventByAttr("cellclick")},__updateOnCelldblclick:function(){this.__addEventByAttr("celldblclick")},__updateOnCellcontextmenu:function(){this.__addEventByAttr("cellcontextmenu")},__updateOnRowcheck:function(){this.__addEventByAttr("rowcheck")},__updateOnHeadercheck:function(){this.__addEventByAttr("headercheck")},__updateOnNodata:function(){this.__addEventByAttr("nodata")},__updateOnPagechange:function(){this.__addEventByAttr("pagechange")},__updateOnLengthchange:function(){this.__addEventByAttr("lengthchange")},__updateOnUpdate:function(){this.__addEventByAttr("update")},__updateOnEdit:function(){this.__addEventByAttr("edit")},__updateOnHeaderclick:function(){this.__addEventByAttr("headerclick")},__updateOnHeaderdbclick:function(){this.__addEventByAttr("headerdbclick")},__updateColumnResize:function(){this.columnResize=this.columnResize==="auto"||this.columnResize==="true"||this.columnResize===true?true:this.columnResize;if(this.columnResize){this.makeColResizer()}else{var gripsElement=this.getElementsByClassName("top-tableview-grips")[0];if(gripsElement){gripsElement.parentNode.removeChild(gripsElement)}}},__updateItemClicktype:function(){},__loadI18nForTable:function(){var allCells=this.querySelectorAll(".head-cell, .body-cell");var prevValue;for(var i=0;i<allCells.length;i++){if(allCells[i].getAttribute("data-i18n")){var newValue=eval(allCells[i].getAttribute("data-i18n"));if(allCells[i].children[0]&&allCells[i].children[0].classList.contains("dataTables_sizing")){prevValue=allCells[i].children[0].innerText;allCells[i].children[0].innerText=newValue}else{prevValue=allCells[i].innerText;allCells[i].innerText=newValue}allCells[i].setAttribute("value",newValue);allCells[i].columnName=newValue;var ariaLabel=allCells[i].getAttribute("aria-label");if(ariaLabel){allCells[i].setAttribute("aria-label",ariaLabel.replace(prevValue,newValue))}}}},setAllTopStyle:function(){this.querySelector("div").style.cssText=this.topstyle},getHeaders:function(){var headarr=this.querySelector("table thead tr");if(headarr==null){return[]}else{return headarr.children}},virtualtable01_splitdata:function(){if(this.itemLayoutDom[1]&&this.itemLayoutDom[1].children[0]&&this.itemLayoutDom[1].tagName=="TOP-TABLEHEADER"){switch(this.itemLayoutDom[0].tagName){case"TOP-ROWITEM":case"TOP-TABLEHEADER":{this.isIDETableview=true}}var hasHeaderRows=true}if(this.hh===undefined||this.ih===undefined){if(this.isIDETableview){if(this.itemLayoutDom[1].children.length>1&&hasHeaderRows===true&&this.itemLayoutDom[1].children[1].tagName=="TOP-HEADERROW"){this.hh=0;for(var i=0;i<this.itemLayoutDom[1].children.length;i++){this.hh+=this.itemLayoutDom[1].children[i].attributes["layout-height"]?Number(this.itemLayoutDom[1].children[i].attributes["layout-height"].value.split("px")[0]):38}this.ih=this.itemLayoutDom[0].attributes["layout-height"]?Number(this.itemLayoutDom[0].attributes["layout-height"].value.split("px")[0]):35}else{this.hh=this.itemLayoutDom[1].attributes["layout-height"]?Number(this.itemLayoutDom[1].attributes["layout-height"].value.split("px")[0]):39;this.ih=this.itemLayoutDom[0].attributes["layout-height"]?Number(this.itemLayoutDom[0].attributes["layout-height"].value.split("px")[0]):35}}else{this.hh=39;this.ih=35}}if(this.hh==0){this.hh=39}if(this.ih==0){this.ih=35}var vheight=500;if(this.layoutHeight=="match_parent"){vheight=this.parentNode.offsetHeight}else if(this.layoutHeight==""||this.layoutHeight==undefined||this.layoutHeight=="auto"||this.layoutHeight=="wrap_content"){var plength=this.pageLength>0?parseInt(this.pageLength):this.data.length;vheight=this.ih*plength+this.hh+25;if(this.paginate){vheight=vheight+42}if(this.parentNode){if(vheight<this.parentNode.offsetHeight){vheight=this.parentNode.offsetHeight}}if(plength==0){vheight=500}}else if(this.layoutHeight.includes("%")){var perc=this.layoutHeight.split("%")[0];vheight=this.offsetHeight*(perc/100)}else{vheight=this.layoutHeight.split("px")[0];this.style.height=this.layoutHeight}if(this.paginate){vheight=vheight-42;this.pagestartnum=0}this.viewport_height=vheight-this.hh;if(this.getAttribute("scroll-body-height")&&this.getAttribute("scroll-body-height").includes("px")){this.viewport_height=Number(this.getAttribute("scroll-body-height").split("px")[0])}this.rownum=parseInt(this.viewport_height/this.ih);if(this.rownum*this.ih+12>this.viewport_height&&this.rownum>1){this.rownum--;this.viewport_height=this.rownum*this.ih+this.ih-17}else if(this.rownum*this.ih+this.ih<this.viewport_height){this.viewport_height=this.rownum*this.ih+this.ih}if(this.pageLength>0&&this.pageLength<this.rownum){this.rownum=parseInt(this.pageLength)}if(this.rownum<=0){this.rownum=0}if(typeof this.items==="string"){this.datapointer=Top.Util.namespace(this.items,this)}else if(typeof this.items==="object"){this.datapointer=this.items}else{this.datapointer=[]}this.startRowNum=0;this.checkIndexInfo=[];for(var i=0;i<this.datapointer.length;i++){this.checkIndexInfo.push({checkbool:false,status:"R",selected:false})}this.backupdata=this.datapointer;this.data=null;this.data=this.datapointer.slice(0,this.rownum)},virtualtable02_makeviewport:function(){var _this=this;this.childRoot.style.overflow="hidden";this.childRoot.style.height="auto";var multiheader=$(this.querySelector(".top-tableview.multiple-header.no-footer"));multiheader.css({});var singleheader=$(this.querySelector(".top-tableview-scrollHeadInner"));singleheader.css({});var header=$(this.querySelector(".top-tableview-scrollHead"));
header.css({overflowX:"hidden"});var content=$(this.querySelector(".top-tableview-scrollBody"));var viewport=$(this.querySelector(".top-tableview-scrollBody-border"));var scrollHead=$(this.querySelector(".top-tableview-scrollHead"));var tablebody=$(content.children()[0]);this.viewport=viewport;this.scrollHead=scrollHead;tablebody.css({});if(tablebody[0].offsetWidth>0){content.css({})}content.css({height:"auto"});if(this.horizontalScroll){this.viewScrollX="auto"}else{this.viewScrollX="hidden"}viewport.css({overflowX:this.viewScrollX,overflowY:"hidden"});scrollHead.css({});var scrollstr='<div id="innerframe_'+this.id+'" class="viframe">                  <div id="upbtn_'+this.id+'" class="viupbtn"></div>                  <div id="bar_'+this.id+'" class="vibar">                      <div id="scroll_'+this.id+'" class="draggable ui-widget-content viscroll"></div>                  </div>                  <div id="downbtn_'+this.id+'" class="vidownbtn"></div>                  </div>';if(this.querySelector(".viframe")==null){$(this.querySelector(".top-tableview-scroll")).append(scrollstr)}var upbtn=$("#upbtn_"+this.id);var downbtn=$("#downbtn_"+this.id);var scroll=$("#scroll_"+this.id);var innerframe=$("#innerframe_"+this.id);var bar=$("#bar_"+this.id);this.upbtn=upbtn;this.downbtn=downbtn;this.scroll=scroll;this.innerframe=innerframe;this.bar=bar;var timeoutId=0;var timeoutId_2=0;upbtn.on("mousedown",function(){timeoutId=setInterval(upscroll,80)}).on("mouseup mouseleave",function(){clearTimeout(timeoutId)});downbtn.on("mousedown",function(){timeoutId=setInterval(downscroll,80)}).on("mouseup mouseleave",function(){clearTimeout(timeoutId)});bar.on("click",function(e){if(!e.target.className.includes("bar")){return}movepoint(e)});function movepoint(e){var pointy=e.offsetY;var bh=parseFloat(bar.height());var sh=parseFloat(scroll.height());var posScroll=Number(scroll.css("top").split("px")[0]);var posy=posScroll+sh;if(pointy<posy){scroll.css("top",pointy)}else if(pointy>posy){scroll.css("top",pointy-sh)}else{return}dragfunc(e)}innerframe.css("width","15");if($("#"+this.id+" .top-tableview-scroll")[0]===undefined)return;var scrollpos=$("#"+this.id+" .incapable_header").height()+$("#"+this.id+" .top-tableview-scroll")[0].offsetTop;innerframe.css("margin-top",scrollpos+2);this.scrollbar_height();var updateTimer;scroll.off().draggable({axis:"y",containment:"#bar_"+this.id,scroll:false,start:function(){},drag:function(e){dragfunc(e)},stop:function(){}});function dragfunc(e){var posy=Number(scroll.css("top").split("px")[0]);var bary=bar.height()-scroll.height();var rate=(posy/bary).toFixed(8);var newrownum=Math.round(rate*_this.Dlegnth);if(_this.startRowNum==newrownum){return}_this.startRowNum=newrownum;if(_this.paginate){_this.startRowNum=_this.startRowNum+_this.pagestartnum}if(!updateTimer){updateTimer=setTimeout(function(){updateTimer=null;_this.onScroll()},100)}}$(_this).off().on("mousewheel DOMMouseScroll","#scroll_"+this.id+",#"+this.id+",.top-tableview",function(e){e.stopPropagation();e.preventDefault();if(_this.posi==_this.startRowNum){_this.posi=-1;return}_this.posi=_this.startRowNum;var EE=e.originalEvent;if(EE.wheelDelta>0){upscroll()}else{downscroll()}});$(_this.querySelector(".top-tableview-scroll")).off("keydown").on("keydown",function(e){if(e.key=="ArrowUp"){upscroll()}else if(e.key=="ArrowDown"){downscroll()}});$(_this.querySelector("tbody")).off("mousedown").on("mousedown",function(e){var clickPosition=e.clientY;var onWheelClick=function(){_this.wheelState=true;$("body").off("mousemove").on("mousemove",function(event){var currentPosition=event.clientY;if(clickPosition>currentPosition){upscroll()}else{downscroll()}})};var offWheelClick=function(){_this.wheelState=false;$("body").off("mousemove")};if(e.which==2){_this.wheelState?offWheelClick():onWheelClick();e.stopPropagation()}else{offWheelClick()}});$("body").on("mousedown",function(){_this.wheelState=false;$("body").off("mousemove")});function upscroll(event){var posy=Number(scroll.css("top").split("px")[0]);if(posy<=0){return}_this.startRowNum--;if(_this.startRowNum<0){_this.startRowNum=0;return}var bary=Number(bar.height()-scroll.height());posy=posy-Number((bary/_this.Dlegnth).toFixed(8));scroll.animate({top:posy},{duration:0,complete:_this.onScroll(event)})}function downscroll(event){var bary=parseFloat(bar.height())-parseFloat(scroll[0].style.height);var barb=parseFloat(scroll.css("top"));if(bary-barb<=.01||scroll.height()==0){return}if(_this.paginate){if(_this.startRowNum+_this.rownum>=_this.pageInfo.end+1){return}}_this.startRowNum++;if(_this.startRowNum>_this.backupdata.length-_this.rownum){_this.startRowNum--;return}var posy=Number(scroll.css("top").split("px")[0]);var bary=Number(bar.height()-scroll.height());posy=posy+Number((bary/_this.Dlegnth).toFixed(8));scroll.animate({top:posy},{duration:0,complete:_this.onScroll(event)})}function __onScrollEnd(){if(this.originScrollLeft===undefined)this.originScrollLeft=0;var scrollLeft=this.querySelector(".top-tableview-scrollBody-border").scrollLeft;var resizers=this.querySelectorAll(".top-tableview-resizer");this.deltaScrollLeft=this.originScrollLeft-scrollLeft;for(var i=0,len=resizers.length;i<len;i++){resizers[i].style.left=parseInt(resizers[i].style.left)+this.deltaScrollLeft+"px"}this.originScrollLeft=scrollLeft}},resizer_reposition:function(){var _this=this;var headsetting=Array.from(_this.querySelectorAll("th.last-head:not(.ui-draggable-dragging)")).sort(_this.sortByHeadIndex);if(headsetting.length<1){return}var thirdheads=_this.querySelectorAll(".top-tableview-resizer");if(thirdheads.length<1){return}var hcolgroup=_this.querySelector(".head_colgroup");var bcolgroup=_this.querySelector(".body_colgroup");var resizerHeight=headsetting[0].offsetHeight+"px";for(var j=0;j<headsetting.length-1;j++){if(headsetting[j].getAttribute("colspan")==="1"){var headCellLeft=headsetting[j+1].offsetLeft-5+"px";thirdheads[j].style.left=headCellLeft;thirdheads[j].style.height=resizerHeight}}},__adjustBytablayout:function(){var _this=this;this.scrollbar_height();this.resizer_reposition()},scrollbar_height:function(){if(this.innerframe===undefined)return;var _this=this;var scroll=$("#scroll_"+this.id);var bar=$("#bar_"+this.id);var index_inpage=_this.startRowNum;var tbody=this.querySelector(".top-tableview tbody");this.innerframe.css("height",tbody.offsetHeight);this.bar.css("height",tbody.offsetHeight-30);if(_this.data.length===0||!_this.items){_this.pagestartnum=0}_this.Dlegnth=0;if(_this.paginate&&_this.pageLength<_this.datapointer.length){index_inpage=index_inpage-_this.pagestartnum;if(_this.pageLength>0){if(_this.pagerange<=_this.rownum){_this.Dlegnth=0}else if(_this.pagerange<_this.pageLength){_this.Dlegnth=this.pagerange}else{_this.Dlegnth=_this.pageLength}}else{_this.Dlegnth=_this.rownum}}else{_this.Dlegnth=this.datapointer.length}var scrollh=0;if(_this.Dlegnth<=this.rownum){scrollh=0;_this.startRowNum=_this.pagestartnum}else{scrollh=bar.height()/(_this.Dlegnth/this.rownum);if(scrollh<6){scrollh=6}if(this.bar.height()<8){this.bar.css("height","8px")}}if(_this.Dlegnth>=_this.rownum){_this.Dlegnth=_this.Dlegnth-_this.rownum}if(scrollh==0){this.innerframe.css("visibility","hidden");var fixwidth=this.querySelector(".top-tableview").offsetWidth;this.viewport[0].style.width="calc(100%)";this.scrollHead[0].style.width="calc(100%)"}else{this.innerframe.css("visibility","visible")}scroll.css("height",scrollh);var bary=bar.height()-scroll.height();if(_this.Dlegnth!=0){var posy=Number(Number(index_inpage/_this.Dlegnth)*bary)}scroll.css("top",posy);if(this.Dlegnth<index_inpage){index_inpage=this.Dlegnth;scroll.css("top",bary)}},onScroll:function(e){var _this=this;var startrownum=_this.startRowNum;var bodyRoot=_this.getElementsByClassName("body")[0];_this.rowsync=true;if(!this.items||this.datapointer.length==0){$(_this.querySelectorAll(".body-row")).remove();_this.bindingarray.length=0;_this.checknodata();return}_this.data=null;_this.data=_this.datapointer.slice(startrownum,startrownum+_this.rownum);if(_this.data.length!=_this.bindingarray.length){_this.rowsync=false}if(!_this.rowsync){$(_this.querySelectorAll(".body-row")).remove();var bufBody=_this.__makeTBodyTag(_this.data,undefined,bodyRoot,true)}if(_this.data.length>0){for(var k=0;k<this.data.length;k++){for(var i=0;i<this.tableHeaderArray[0].length;i++){if(!_this.bindingarray[k][i]){continue}var widget=undefined;var bindtarget=undefined;widget=_this.bindingarray[k][i];bindtarget=_this.bindingarray[k][i].template;if(bindtarget){if(!bindtarget.outerHTML.includes("data-field")){continue}else{var dld=bindtarget.getAttribute("data-field")}}else{if(!widget.outerHTML||!widget.outerHTML.includes("data-field")){continue}else{var dld=widget.getAttribute("data-field")}}var bindvalue="";if(_this.data[k][dld]==null||_this.data[k][dld]==undefined){}else{var bindvalue=_this.data[k][dld]}if(widget.tagName=="TD"){widget.textContent=bindvalue;continue}switch(bindtarget.tagName){case"TOP-CHECKBOX":case"TOP-RADIOBUTTON":if(!bindtarget.boundProperties)continue;var boundp=bindtarget.boundProperties;var fieldp=bindtarget.fieldProperties;for(var j=0;j<boundp.length;j++){if(boundp[j]=="text"){widget.setProperties({text:_this.data[k][fieldp[j]]})}else if(boundp[j]=="checked"){widget.setProperties({checked:_this.data[k][fieldp[j]]})}}break;case"TOP-TEXTFIELD":widget.setText(bindvalue);break;case"TOP-BUTTON":widget.setText(bindvalue);break;case"TOP-COLORPICKER":break;case"TOP-DATEPICKER":widget.setDate(bindvalue);break;case"TOP-SPINNER":widget.setProperties({number:bindvalue});break;case"TOP-TEXTVIEW":widget.setProperties({text:bindvalue});break;case"TOP-SELECTBOX":widget.select(null);var bindProperty="selected-text";if(bindtarget.boundProperties){bindProperty=bindtarget.boundProperties[0]}else if(bindtarget.selectedIndex){widget.select(bindtarget.selectedIndex);break}else if(bindtarget.selectedText){widget.select(bindtarget.selectedText);break}if(bindProperty=="selected-index"){widget.setProperties({"selected-index":bindvalue})}else{widget.setProperties({"selected-text":bindvalue})}break;default:break}}}}var allTds=bodyRoot.querySelectorAll(".body-row .body-cell:not(.checkable)");if(_this.checkable){var checkableTd=_this.childRoot.querySelectorAll(".checkable.body-cell");var bodyrow=_this.childRoot.querySelectorAll(".body-row");for(var i=0;i<_this.data.length;i++){if(!_this.rowsync){var checkableCheckbox=Top.Widget.create("top-checkbox").template;checkableCheckbox.classList.add("checkable-body");checkableTd[i].appendChild(checkableCheckbox);_callCallback(checkableCheckbox,"attached")}else{var checkableCheckbox=checkableTd[i].querySelector("top-checkbox")}checkableCheckbox.givenidx=startrownum+i;if(_this.connect){var TorF=_this.datapointer[i+startrownum]["temp"].checkbool}else{var TorF=this.checkIndexInfo.length>this.startRowNum+i?this.checkIndexInfo[this.startRowNum+i].checkbool:false}checkableCheckbox.checked=TorF;checkableCheckbox.__updateProperties("checked")}}_this.__postBodyAppend(allTds,_this.data,0);_this.__dispatchEvent(new CustomEvent("scrollend",{detail:{current_pos:top,startIndex:startrownum,current_data:_this.data,target:_this}}));top=undefined;bodyRoot=undefined;if(this.indexable)this.__renderIndex();this.bindEvent();if(_this.sequence){this.updatesequence(_this.getSelectionRows())}},virtualgoToPage:function(page,pageInfo){var _this=this;if(!_this.querySelector("top-pagination")||_this.data.length===0||!_this.items){return}if(page==null)return;this.scroll.css("top",0);var dataLength=this.datapointer.length;var len=this.pageLength;var start=len===-1?0:len*page;var end=len===-1||len*(page+1)>dataLength?dataLength-1:len*(page+1)-1;_this.pagerange=end-start+1;_this.pagestartnum=start;_this.startRowNum=start;this.onScroll();this.scrollbar_height();this.setPageInfo({start:start,end:end,page:page+1});var pager=this.childRoot.querySelector("top-pagination");pager.setAttribute("page",page+1);pager.page=page+1;this.pagerType==="input"?pager.renderInput():pager.renderBasic()},virtualmakePage:function(){var thisTable=this;var dataLength=this.datapointer!==undefined?this.datapointer.length:this.datapointer.length;var pagelength=this.pageLength;thisTable.currentPage=0;var total=pagelength===-1?1:Math.ceil(dataLength/pagelength);thisTable.total=total;var pageInfo={page:thisTable.currentPage,length:total,recordsTotal:""};if(pageInfo.length===-1)pageInfo.length=pageInfo.recordsTotal;var pagerType=this.pagerType;var pagerMaxVisible=this.pagerMaxVisible;var root=this.childRoot;var pagerContainer=root.querySelector(".auto-pagination");var nTable=this.scrollTable?root.querySelector(".top-tableview-scrollBody > .top-tableview"):root.querySelector(".top-tableview");var pagerDiv=root.querySelector(".top-tableview-pager");var beforepage;if(pagerContainer==null){return;var pagerContainer=document.createElement("div");pagerContainer.className="auto-pager";$(root.querySelector("div.top-tableview-root")).append(pagerDiv)}if(pagerDiv==null){pagerDiv=document.createElement("div");pagerDiv.className="top-tableview-pager";$(pagerContainer).append(pagerDiv)}var paginationWidget=pagerContainer.querySelector("top-pagination");if(paginationWidget==null){paginationWidget=Top.Widget.create("top-pagination").template;pagerDiv.appendChild(paginationWidget);_callCallback(paginationWidget,"attached")}var editProperties={type:pagerType,total:total,page:1};if(pagerMaxVisible)editProperties["max-visible"]=pagerMaxVisible;if(editProperties){var keys=Object.keys(editProperties);var len=keys.length;for(var j=0;j<len;j++){paginationWidget.setAttribute(keys[j],editProperties[keys[j]])}Top.Widget.create("top-pagination",undefined,paginationWidget).setProperties(editProperties)}if(this.showresult){if(root.querySelector(".top-tableview-result")==null){$(pagerContainer).prepend('<div class="top-tableview-result"><span class="number">'+dataLength+"</span><span> Results</span></div>")}else{root.querySelector(".top-tableview-result").innerHTML='<span class="number">'+dataLength+"</span><span> Results</span>"}}switch(this.pagerLocation){case"tl":case"bl":{$(pagerContainer).css("text-align","left");break}case"tc":case"bc":{$(pagerContainer).css("text-align","center");break}case"tr":case"br":{$(pagerContainer).css("text-align","right");break}}var curPage=this.currentPage>0?this.currentPage:pageInfo.page;beforepage=this.getPageInfo()==undefined?null:this.getPageInfo().page;this.setPageInfo({beforepage:beforepage,pages:total,items:dataLength,length:this.pageLength,page:curPage+1,start:this.pageLength===-1?0:this.pageLength*curPage,end:this.pageLength===-1||this.pageLength*(curPage+1)>dataLength?dataLength-1:this.pageLength*(curPage+1)-1});var pagination=root.querySelector("top-pagination");pagination.page=this.getPageInfo().page;paginationWidget.setAttribute("page",this.getPageInfo().page);Top.Widget.create("top-pagination",undefined,paginationWidget).setProperties({page:this.getPageInfo().page});if(pagination!==null){pagination.setPageEvent(function(page){pageInfo.page=page-1;thisTable.currentPage=page-1;thisTable.virtualgoToPage(page-1,thisTable.getPageInfo());var start=thisTable.pageLength===-1?0:thisTable.pageLength*(page-1);var end=thisTable.pageLength===-1||thisTable.pageLength*page>dataLength?dataLength-1:thisTable.pageLength*page-1;var len=thisTable.pageLength;thisTable.setPageInfo({length:len,start:start,end:end,page:page});thisTable.__dispatchEvent(new CustomEvent("pagechange",{detail:thisTable.getPageInfo()}));thisTable.checkCallback();thisTable.__renderDummyView()});pagination.__bindEvent()}if(this.lengthChange){if(!this.lcflag){this.lcflag=true;var lengthChangeProp={nodes:this.lengthMenu};var lengthChangeWidget=Top.Widget.create("top-selectbox",lengthChangeProp).template;pagerDiv.appendChild(lengthChangeWidget);lengthChangeWidget.onclick=function(e){var prevLen=thisTable.pageLength;var page=thisTable.getPageInfo().page;thisTable.pageLength=this.value;pageInfo=thisTable.getPageInfo();var total=thisTable.pageLength===-1?1:Math.ceil(pageInfo.items/thisTable.pageLength);var start=thisTable.pageLength===-1?0:thisTable.pageLength*(pageInfo.page-1);var end=thisTable.pageLength===-1||thisTable.pageLength*pageInfo.page>dataLength?dataLength-1:thisTable.pageLength*pageInfo.page-1;var len=thisTable.pageLength;pagination.setAttribute("total",total);pagination.total=total;pagerType==="input"?pagination.renderInput():pagination.renderBasic();thisTable.setPageInfo({pages:total,start:start,end:end,length:len});thisTable.__dispatchEvent(new CustomEvent("lengthchange",{detail:thisTable.getPageInfo()}));thisTable.virtualmakePage();thisTable.onScroll()}}}},virtualaddRows:function(obj,index,movePage){var _this=this;if(typeof obj!=="object")return;if(!(obj instanceof Array))obj=[obj];if(index===undefined)index=this.backupdata.length;else if(index<0)index=0;if(movePage===undefined)movePage=1;for(var i=0;i<obj.length;i++){this.backupdata.splice(index,0,obj[i]);this.checkIndexInfo.splice(index,0,{checkbool:false,status:"C"})}if(this.paginate){this.virtualmakePage();this.virtualgoToPage(movePage-1,this.getPageInfo())}this.onScroll(event);this.scrollbar_height()},virtualremoveRows:function(index,movePage){if(index===undefined){console.log("wroing index!");return}if(index>=this.checkIndexInfo.length){console.log("wroing index!");return}if(movePage===undefined)movePage=1;if(index instanceof Array){for(var i=0;i<index.length;i++){this.backupdata.splice(index[i]-i,1);this.checkIndexInfo.splice(index[i]-i,1)}}else{this.backupdata.splice(index,1);this.checkIndexInfo.splice(index[i]-i,1)}if(this.backupdata.length==0){this.data.length=0}if(this.paginate){this.virtualmakePage()}this.onScroll(event);this.scrollbar_height()},virtualsort:function(key,reverse){var _this=this;this.rowidxconnecting();this.sortByKey(_this.backupdata,key);if(reverse){_this.backupdata.reverse()}this.rowidxdisconnecting();this.onScroll(event)},index_reverse_sort:function(reverse){var _this=this;this.rowidxconnecting();this.backupdata.reverse();this.rowidxdisconnecting();this.onScroll(event)},swap:function(index1,index2){var _this=this;this.rowidxconnecting();var swaparr=_this.backupdata;var tamp=null;temp=swaparr[index1];swaparr[index1]=swaparr[index2];swaparr[index2]=temp;_this.datapointer=null;_this.datapointer=swaparr;swaparr=null;this.rowidxdisconnecting();this.onScroll(event)},virtualfilter:function(word,colname){var _this=this;_this.startRowNum=0;this.rowidxconnecting();var searcharr=_this.backupdata;var reg=new RegExp(word);var resultarr=searcharr.filter(function(searcharr){for(var i=0;i<_this.itemKeys.length;i++){if(reg.test(searcharr[_this.itemKeys[i]])){return reg.test(searcharr[_this.itemKeys[i]])}}});_this.datapointer=null;_this.datapointer=resultarr;if(this.paginate){this.virtualmakePage()}else{this.onScroll(event)}this.scrollbar_height();if(word==""||word==undefined){this.rowidxdisconnecting();this.datapointer=this.backupdata}this.checkCallback()},sortByKey:function(array,key){var _this=this;return array.sort(function(a,b){var x=a[key];var y=b[key];var result=x<y?-1:x>y?1:0;return result})},rowidxconnecting:function(){var _this=this;for(var i=0;i<_this.backupdata.length;i++){_this.backupdata[i]["temp"]=_this.checkIndexInfo[i]}_this.connect=true},rowidxdisconnecting:function(){var _this=this;if(!_this.connect){return}for(var i=0;i<_this.backupdata.length;i++){_this.checkIndexInfo[i]=_this.backupdata[i]["temp"];_this.backupdata[i]["temp"]=undefined;delete _this.backupdata[i].temp}_this.connect=false},getSelectionRows:function(){var selectedobj=this.querySelectorAll(".body-row.selected");var selectedindex=[];if(selectedobj.length>0){var extrow=Number(selectedobj[0].getAttribute("class").split("row_")[1].split(" ")[0])}else{return 0}return extrow+this.startRowNum},getSelectedIndex:function(){if(this.selectType=="row"){var selectedobj=this.querySelectorAll(".body-row.selected");var selectedindex=[];for(var i=0;i<selectedobj.length;i++){var extrow=Number(selectedobj[i].getAttribute("class").split("row_")[1].split(" ")[0]);extrow=extrow+this.startRowNum;selectedindex.push(extrow)}if(selectedindex.length===1)return selectedindex[0]}else{var selectedobj=this.querySelectorAll(".body-cell.selected");var selectedindex=[];for(var i=0;i<selectedobj.length;i++){var extrow=Number(selectedobj[i].dataIndex);var extcol=Number(selectedobj[i].getAttribute("col"));extrow=extrow+this.startRowNum;selectedindex.push({row:extrow,column:extcol})}}return selectedindex},getSelectedData:function(){var selecteddata=[];var selectedindex=this.getSelectedIndex();if(this.selectType=="row"){if(typeof selectedindex!="object")return this.backupdata[selectedindex];for(var i=0;i<selectedindex.length;i++){selecteddata.push(this.backupdata[selectedindex[i]])}}else{if(typeof selectedindex!="object")return;for(var i=0;i<selectedindex.length;i++){var row=selectedindex[i]["row"];var col=selectedindex[i]["column"];selecteddata.push(this.getCellValue(row,col))}}return selecteddata},getstatusdata:function(status){var _this=this;var sstr=status;var rdata=[];var info=_this.checkIndexInfo;for(var i=0;i<info.length;i++){if(info[i]["status"]==sstr){rdata.push(_this.backupdata[i])}}console.log(rdata)},getCellValue:function(Row,Col){var _this=this;var p_row=Row;var p_col=Col;var p_value;if(isNaN(p_col)){if(p_col=="status"){p_value=_this.checkIndexInfo[p_row]["status"]}else{p_value=_this.backupdata[p_row][p_col]}}else{if(_this.bindingarray[p_row][p_col].tagName=="TD"){var dld=_this.bindingarray[p_row][p_col].getAttribute("data-field")}else{var dld=_this.bindingarray[p_row][p_col].template.getAttribute("data-field")}if(dld){p_value=_this.backupdata[p_row][dld]}else{return null}}return p_value},setCellValue:function(Row,Col,Value){var _this=this;var s_row=Row;var s_col=Col;var s_value=Value;if(isNaN(s_col)){if(s_col=="status"){this.checkIndexInfo[s_row]["status"]=s_value}else{_this.backupdata[s_row][s_col]=s_value}}else{if(_this.bindingarray[s_row][s_col].tagName=="TD"){var dld=_this.bindingarray[s_row][s_col].getAttribute("data-field")}else{var dld=_this.bindingarray[s_row][s_col].template.getAttribute("data-field")}if(dld){_this.backupdata[s_row][dld]=s_value}else{return null}}_this.onScroll()},getRowValue:function(Row){},setRowValue:function(Row,Value){},RowCount:function(status){var _this=this;var status_val=status;var rcount=0;if(status_val==undefined||status_val==null){rcount=_this.checkIndexInfo.length}else{for(var j=0;j<_this.checkIndexInfo.length;j++){if(status_val==_this.checkIndexInfo[j].status){rcount++}}}return rcount},setTableheaderByTree:function(nodes){var maxLevel=this.tableHeaderArray.length;var result=new Array(maxLevel);var newHeaderArray=new Array(maxLevel);for(var i=0;i<maxLevel;i++){result[i]=new Array;newHeaderArray[i]=new Array}this.recursiveTreeToTable(nodes,0,result);for(var i=0;i<result.length;i++){for(var j=0;j<result[i].length;j++){var rownum=parseInt(result[i][j].xmlRow);var colnum=parseInt(result[i][j].xmlCol);var bodyMappingIndex=result[i][j].lastHeadNum;this.tableHeaderArray[rownum][colnum].className="";newHeaderArray[i][j]=this.tableHeaderArray[rownum][colnum];newHeaderArray[i][j].setAttribute("text",result[i][j].text);newHeaderArray[i][j].setAttribute("before-body-mapping-index",bodyMappingIndex);newHeaderArray[i][j].setAttribute("colspan",result[i][j].colspan);newHeaderArray[i][j].setAttribute("rowspan",result[i][j].rowspan);newHeaderArray[i][j].setAttribute("layout-width",result[i][j].width)}}this.tableHeaderArray=newHeaderArray.slice(0);this.headerInfoArray=null;this.headerChangeByTree=true},openDialogEditingHeader:function(fn){var _this=this;var tree_option={node:{checkable:true,editable:true,deletable:true,draggable:true},view:{expand:true},event:{onNodedrop:function(event,treeview,node,target){if(node.parent==null&&target==null){return true}if(node.parent==target.index){return true}console.log("target is not same parent");return false}}};Top.App.openDialog({id:_this.id+"_dialog",title:_this.id+"_dialog","layout-width":"70%",content:'<top-linearlayout id="tableHeaderDialogMain" layout-width="100%" layout-height="100%">'+'<top-linearlayout class="openDialogTreeWrapper"><top-treeview id="'+_this.id+'_tableHeaderTree"></top-treeview></top-linearlayout>'+'<top-linearlayout class="openDialogBtnWrapper"><top-button id="tableHeaderSaveBtn"></top-button></top-linearlayout>'+"</top-linearlayout>",className:"popup_01",onOpen:function(event,widget){var treeView=Top.Dom.selectById(_this.id+"_tableHeaderTree");var nodes=_this.getTableHeaderInfoByTree();treeView.setProperties({nodes:nodes,option:tree_option});$("#incapable_header.top-treeview-item").parent().css("display","none");var saveBtn=Top.Dom.selectById("tableHeaderSaveBtn");saveBtn.setProperties({id:"tableHeaderSaveBtn",text:"save header",onClick:function(){var newNodes=Top.Dom.selectById(_this.id+"_tableHeaderTree").getNodes();_this.setTableheaderByTree(newNodes);if(fn)fn();Top.Dom.selectById(_this.id+"_dialog").close();if(_this.storeColumn){var name=_this.storeKey||_this.id;_this.setCookie(name,newNodes)}_this.__reRender()}})}})}};Top.Widget.Container.Tableview=function(){Tableview.prototype=Object.create(Top.Widget.Container.prototype);Tableview.prototype.constructor=Tableview;function Tableview(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-tableview");this.template.innerHTML='<div class="top-tableview"></div>'}this.id=this.template.id}Tableview.create=function(element){return new Tableview(element)};Tableview.prototype.sync=function(){this.template.sync()};Tableview.prototype.update=function(){if(this.template.dataModel){var dataName=Top.Util.getDataName(this.template.dataModel.items,this.template);var dataModel=Top.Util.namespace(dataName,this.template);var path=this.template.dataModel.items.replace(dataName+".","");path=path.split("+")[0];if(dataModel){var data=dataModel.getValue(path);this.template.items=data}}this.template.__updateItems()};Tableview.prototype.addRows=function(obj,index,movePage){this.template.virtualaddRows(obj,index,movePage)};Tableview.prototype.sort=function(key){this.template.virtualsort(key)};Tableview.prototype.virtualfilter=function(word,columnName){this.template.virtualfilter(word,columnName)};Tableview.prototype.removeRows=function(index,movePage){this.template.virtualremoveRows(index,movePage)};Tableview.prototype.getSelectedIndex=function(){return this.template.getSelectedIndex()};Tableview.prototype.getSelectedData=function(){return this.template.getSelectedData()};Tableview.prototype.getRowStatus=function(){return this.template.checkIndexInfo};Tableview.prototype.getCheckedIndex=function(){if(!this.template.timer){return this.template.getCheckedIndex()}else{var _this=this;this.template.__onRenderLayout(function(){return _this.template.getCheckedIndex()})}};Tableview.prototype.getCheckedData=function(){if(!this.template.timer){return this.template.getCheckedData()}else{var _this=this;this.template.__onRenderLayout(function(){return _this.template.getCheckedData()})}};Tableview.prototype.getClickedIndex=function(){return this.template.getClickedIndex()};Tableview.prototype.getClickedData=function(){return this.template.getClickedData()};Tableview.prototype.goToPage=function(page){var _this=this;if(!this.template.timer){this.template.virtualgoToPage(page-1)}else{var _this=this;this.template.__onRenderLayout(function(){_this.template.virtualgoToPage(page-1)})}};Tableview.prototype.adjustColumns=function(){};Tableview.prototype.swap=function(index1,index2){this.template.swap(index1,index2)};Tableview.prototype.check=function(index,checked){this.template.check(index,checked)};Tableview.prototype.checkAll=function(checked,paginate){if(!this.template.timer){this.template.checkAll(checked,paginate)}else{var _this=this;this.template.__onRenderLayout(function(){_this.template.checkAll(checked,paginate)})}};Tableview.prototype.setOnCheck=function(func){this.template.setOnCheck(func)};Tableview.prototype.getstatusdata=function(status){return this.template.getstatusdata(status)};Tableview.prototype.getHeaderChecked=function(){return Top.Dom.__selectImpl(this.template.querySelector(".checkable-head")).getProperties("checked")};Tableview.prototype.selectCells=function(row,column){this.template.selectCells(row,column)};Tableview.prototype.Cells=function(row,column){return this.template.Cells(row,column)};Tableview.prototype.selectData=function(index){this.template.selectData(index)};Tableview.prototype.deselectData=function(index){this.template.deselectData(index)};Tableview.prototype.getPageInfo=function(){return this.template.getPageInfo()};Tableview.prototype.filterColumns=function(columnObj){this.template.filterColumns(columnObj)};Tableview.prototype.src=function(htmlFile){this.template.src(htmlFile)};Tableview.prototype.html=function(htmlString){this.template.html(htmlString)};Tableview.prototype.setColumnsVisible=function(columnIndex,visible){var _this=this;if(visible==false||visible=="false"||visible=="none"){visible="none"}else{visible="visible"}if(columnIndex instanceof Array){}else{columnIndex=[columnIndex]}if(!_this.template.Columns_info){_this.template.Columns_info=[]}var cinfo=_this.template.Columns_info;var flag=true;for(var k=0;k<columnIndex.length;k++){for(var i=0;i<cinfo.length;i++){if(cinfo[i].index==columnIndex[k]){cinfo[i].visible=visible;flag=false;break}}if(flag){cinfo.push({index:columnIndex[k],visible:visible})}flag=true}if(this.template.timer){}else{_this.template.__reRender()}if(_this.template.storeColumn){_this.template.__storeCookieHeaderInfo()}};Tableview.prototype.__setTableHeaderStyle=function(obj){var tableHeaderElem=this.template.querySelector(".top-tableview .head-row");if(tableHeaderElem){for(var key in obj){if(key==="layoutHeight"&&!isNaN(parseFloat(obj[key]))){tableHeaderElem.style.height=obj[key]+"px"}}}};Tableview.prototype.__setHaderColumnStyle=function(obj){var id=obj["id"];for(var key in obj){var tableHeader=this.template.tableHeaderArray;for(var i=0;i<tableHeader.length;i++){for(var j=0;j<tableHeader[i].length;j++){if(tableheader[i][j].id===id){var value=isNaN(obj[key])?obj[key]:obj[key]+"px";tableheader[i][j].setAttribute(Top.Util.toDash(key),value)}}}}this.template.renderIDETableByItems()};Tableview.prototype.render=function(){this.template.__reRender()};Tableview.prototype.setRowLayout=function(rowIndex,layout){if(!this.template.timer){this.__setRowLayout(rowIndex,layout)}else{var _this=this;this.template.__onRenderLayout(function(){setTimeout(function(){_this.__setRowLayout(rowIndex,layout)})})}};Tableview.prototype.__setRowLayout=function(rowIndex,layout){this.template.setRowLayout(rowIndex,layout)};Tableview.prototype.setCellLayout=function(rowIndex,columnIndex,layout){this.template.setCellLayout(rowIndex,columnIndex,layout)};Tableview.prototype.complete=function(option){this.template.complete(option)};Tableview.prototype.setDataLength=function(dataLength){this.template.setDataLength(dataLength)};Tableview.prototype.setDragSelection=function(bool){this.template.setDragSelection(bool)};Tableview.prototype.getHeaders=function(){return this.template.getHeaders()};Tableview.prototype.onRender=function(fn){if(!this.template.timer){fn()}else{this.template.__onRenderLayout(function(){fn()})}};Tableview.prototype.getTableHeaderInfo=function(){return this.template.getTableHeaderInfo()};Tableview.prototype.setTableHeaderInfo=function(value){this.template.setTableHeaderInfo(value)};Tableview.prototype.setCookie=function(name,value){this.template.setCookie(name,value)};Tableview.prototype.getCookie=function(name){return this.template.getCookie(name)};Tableview.prototype.openDialogEditingHeader=function(fn){this.template.openDialogEditingHeader(fn)};Tableview.prototype.setTableheaderByTree=function(nodes){this.template.setTableheaderByTree(nodes)};Tableview.prototype.getCellValue=function(Row,Col){return this.template.getCellValue(Row,Col)};Tableview.prototype.setCellValue=function(Row,Col,Value){this.template.setCellValue(Row,Col,Value);
};Tableview.prototype.RowCount=function(status){return this.template.RowCount(status)};Tableview.prototype.getRowValue=function(Row){return this.template.getRowValue(Row)};Tableview.prototype.setRowValue=function(Row,Value){this.template.setRowValue(Row,Value)};return Tableview}();TopTextarea={is:"top-textarea",behaviors:[TopWidgetBehavior,TopTextBehavior,TopMaskBehavior],properties:{hint:String,rows:{type:String,value:"5"},cols:{type:String,value:"100"},maxLength:Number,maxBytes:Number,readonly:String,highlight:String,highlightConfig:String},__ready:function(){this.__updateId();this.__updateAutoComplete();this.__updateDisabled();this.__updateMaxLength();this.__updateMaxBytes();this.__updateReadonly();this.__updateHighlight();this.__updateTextSize();this.__controlTabKey();this.__initBindingEvent();this.__updateRowsCols();this.__updateHint();this.__updateName();this.__updateText()},appendTemplate:function(){this.innerHTML='<textarea class="top-textarea-root" spellcheck="false"></textarea>';this.__isTemplateAppended=true},shadowText:function(){return this.querySelector("textarea")},__eventBindingList:function(){var shadowTextarea=this.querySelector("textarea");return{__eventMouseClick:function(func){shadowTextarea.onclick=func},__eventMousePressed:function(func){shadowTextarea.onmousedown=func},__eventMouseReleased:function(func){shadowTextarea.onmouseup=func},__eventMouseDblclick:function(func){shadowTextarea.ondblclick=func},__eventKeyPressed:function(func){shadowTextarea.onkeydown=func},__eventKeyTyped:function(func){shadowTextarea.onkeypress=func},__eventKeyReleased:function(func){shadowTextarea.onkeyup=func},__eventMouseEnter:function(func){shadowTextarea.onmouseenter=func},__eventMouseExit:function(func){shadowTextarea.onmouseleave=func},__eventMouseMove:function(func){shadowTextarea.onmousemove=func},__eventSecondaryClick:function(func){shadowTextarea.oncontextmenu=func},__eventFocused:function(func){shadowTextarea.onfocus=func},__eventLostFocused:function(func){shadowTextarea.onblur=func}}},__updateId:function(){if(this.id){var shadowInput=this.querySelector("textarea");shadowInput.id=this.id}},__updateDisabled:function(){if(this.disabled===null)this.disabled=this.getAttribute("disabled");var disabled=this.calculateDerivedDisabled();var shadowInput=this.querySelector("textarea");if(disabled=="true"||disabled==true){shadowInput.setAttribute("disabled","true")}else{shadowInput.removeAttribute("disabled")}},setError:function(){var shadowInput=this.querySelector("textarea");if(!$(this).hasClass("error"))$(this).addClass("error")},removeError:function(){var shadowInput=this.querySelector("textarea");$(this).removeClass("error")},__updateMaxLength:function(){var textarea=this.querySelector("textarea");if(this.maxLength!=null)textarea.setAttribute("maxlength",this.maxLength)},__updateMaxBytes:function(){if(this.maxBytes!==undefined){this.__removeEventListener("keyup",this.__onKeyup);var _this=this;this.__onKeyup=function(){var utf8Str=_this.__getUTF8StrWithMaxBytes(this.value,_this.maxBytes);if(this.value!==utf8Str)this.value=utf8Str;_this.text=this.value};this.__addEventListener("keyup",this.__onKeyup);this.__removeEventListener("blur",this.__onKeyup);var _this=this;this.__onBlur=function(){var utf8Str=_this.__getUTF8StrWithMaxBytes(this.value,_this.maxBytes);if(this.value!==utf8Str)this.value=utf8Str;_this.text=this.value};this.__addEventListener("blur",this.__onKeyup)}},__getUTF8StrWithMaxBytes:function(str,maxBytes){var utf8Length=0;var utf8String="";for(var i=0,len=str.length;i<len;i++){var c=str.charCodeAt(i);if(c<128){utf8Length++}else if(c>127&&c<2048){utf8Length+=2}else{utf8Length+=3}if(utf8Length>maxBytes){break}}utf8String=str.substring(0,i);return utf8String},__updateReadonly:function(){var textarea=this.querySelector("textarea");if(this.readonly=="true"||this.readonly==true){textarea.setAttribute("readonly","")}else{textarea.removeAttribute("readonly")}},__updateHighlight:function(){if(this.highlight=="true"||this.highlight==true){this.__initHighlight()}else{this.__destroyHighlight()}},__updateHighlightConfig:function(){if(typeof this.highlightConfig=="string"){this.highlightConfigData=Top.Util.namespace(this.highlightConfig,this)}else if(typeof this.highlightConfig=="object"||typeof this.highlightConfig=="function"){this.highlightConfigData=this.highlightConfig}else{return}var textarea=this.querySelector("textarea");$(textarea).highlightWithinTextarea({highlight:this.highlightConfigData});this.__styleHighlight()},__initHighlight:function(){this.__updateHighlightConfig()},__styleHighlight:function(){this.__addHighlightClass();this.__adjustHighlightWidth();this.__adjustHighlightHeight();this.__adjustHighlightPadding();this.__adjustHighlightMargin();this.__adjustHighlightTextSize();this.__updateBackgroundColor()},__adjustHighlightWidth:function(){var borderRightWidth=this.borderRightWidth||0;var borderLeftWidth=this.borderLeftWidth||0;var layoutWidth=this.layoutWidth;var hwtInput=this.querySelector(".hwt-input");if(this.layoutWidth==="match_parent"){layoutWidth="100%";hwtInput.style.width="100%"}if(this.tagName!=="TOP-CHART"&&this.layoutWidth&&this.layoutWidth.endsWith("%")){layoutWidth="calc("+this.layoutWidth+" - "+(parseInt(this.marginRight)+parseInt(this.marginLeft)+parseInt(this.paddingRight)+parseInt(this.paddingLeft)+parseInt(borderRightWidth)+parseInt(borderLeftWidth))+"px)"}var hwt=this.querySelector(".hwt-container");if(hwt){hwt.style.width=layoutWidth}},__adjustHighlightHeight:function(){if(!this.layoutHeight)return;var layoutHeight=this.layoutHeight;if(layoutHeight.indexOf("%")!==-1){if(this.parentNode&&this.parentNode.nodeName==="DIV"&&this.layoutParent&&this.layoutParent.nodeName==="TOP-LINEARLAYOUT"&&this.layoutParent.orientation==="vertical"){this.parentNode.style.height=this.layoutHeight;layoutHeight="100%"}else if(this.layoutParent===undefined&&this.parentNode&&this.parentNode.nodeName==="DIV"&&this.parentNode.parentNode&&this.parentNode.parentNode.nodeName==="DIV"){var parent=this.parentNode;while(Top.Util.__isTopWidget(parent.tagName)){parent=parent.parentNode}if(parent.nodeName==="TOP-LINEARLAYOUT"&&parent.getAttribute("orientation")==="vertical"){this.parentNode.style.height=this.layoutHeight;layoutHeight="100%"}}}if(this.tagName!=="TOP-CHART"&&layoutHeight&&layoutHeight.endsWith("%")){var boxing=parseInt(this.marginTop)+parseInt(this.marginBottom)+parseInt(this.paddingTop)+parseInt(this.paddingBottom)+parseInt(this.borderTopWidth)+parseInt(this.borderBottomWidth);if(boxing>0)layoutHeight="calc("+this.layoutHeight+" - "+boxing+"px)"}var hwt=this.querySelector(".hwt-container");if(hwt){hwt.style.height=layoutHeight}},__adjustHighlightMargin:function(){var hwtContainer=this.querySelector(".hwt-container");var hwtInput=this.querySelector(".hwt-input");if(hwtContainer&&hwtInput){hwtContainer.style.margin=this.margin;this.marginBackup=this.margin;hwtInput.style.margin=""}},__adjustHighlightPadding:function(){var hwt=this.querySelectorAll(".hwt-content");if(hwt!==undefined){for(var i=0;i<hwt.length;i++){hwt[i].style.padding=this.padding}}},__addHighlightClass:function(){var hwt=this.querySelector(".hwt-highlights");if(hwt){hwt.classList.add("top-textarea-root")}hwt=this.querySelector(".hwt-background");if(hwt){hwt.classList.add("top-textarea-root")}},__removeHighlightClass:function(){var textarea=this.querySelector("textarea");textarea.classList.remove("hwt-content")},__destroyHighlight:function(){var hwt=this.querySelector(".hwt-container");if(hwt){var textarea=this.querySelector("textarea");$(textarea).highlightWithinTextarea("destroy");this.__removeHighlightClass();textarea.style.margin=this.marginBackup||this.margin}},__updateTextSize:function(){var textarea=this.querySelector("textarea");textarea.style.fontSize=this.textSize;if(this.highlight=="true"||this.highlight==true){this.__adjustHighlightTextSize()}},__adjustHighlightTextSize:function(){var hwt=this.querySelector(".hwt-highlights");if(hwt){hwt.style.fontSize=this.textSize}hwt=this.querySelector(".hwt-background");if(hwt){hwt.style.fontSize=this.textSize}},__updateText:function(){if(this.text||this.text===""){var shadowInput=this.querySelector("textarea");shadowInput.value=this.text;if(this.highlight=="true"||this.highlight==true){$(shadowInput).highlightWithinTextarea("update")}}},__updateBackgroundColor:function(){if(this.highlight=="true"||this.highlight==true){var hwtContainer=this.querySelector(".hwt-container");if(hwtContainer){hwtContainer.style.backgroundColor=this.backgroundColor}}},__updateRows:function(){var shadowInput=this.querySelector("textarea");if(this.rows!==undefined&&this.rows!==null){shadowInput.setAttribute("rows",this.rows)}},__updateCols:function(){var shadowInput=this.querySelector("textarea");if(this.cols!==undefined&&this.cols!==null){shadowInput.setAttribute("cols",this.cols)}},__updateRowsCols:function(){var shadowInput=this.querySelector("textarea");if(this.rows!==undefined&&this.rows!==null){shadowInput.setAttribute("rows",this.rows)}if(this.cols!==undefined&&this.cols!==null){shadowInput.setAttribute("cols",this.cols)}},__updateHint:function(){if(this.hint){var shadowInput=this.querySelector("textarea");shadowInput.setAttribute("placeholder",this.__i18n(this.hint))}},__updateName:function(){if(this.name){var shadowInput=this.querySelector("textarea");shadowInput.setAttribute("name",this.name)}},__controlTabKey:function(){var textarea=this.querySelector("textarea");$(textarea).keydown(function(e){if(e.keyCode===9){var start=this.selectionStart;var end=this.selectionEnd;var $this=$(this);var value=$this.val();$this.val(value.substring(0,start)+"\t"+value.substring(end));this.selectionStart=this.selectionEnd=start+1;e.preventDefault()}})},__initBindingEvent:function(){var _this=this;var textarea=this.querySelector("textarea");this.__addEventFnByCore("eventKeyReleased",function(){_this.text=textarea.value;_this.setAttribute("text",textarea.value);_this.updateData("text");_this.updateDevice("text")})},focus:function(){this.querySelector(".top-textarea-root").focus()},blur:function(){this.querySelector(".top-textarea-root").blur()},getTopStyle:function(){this.topstyle=this.querySelector(".top-textarea-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.querySelector(".top-textarea-root").style[key]=value;this.topstyle=this.querySelector(".top-textarea-root").style.cssText}},setAllTopStyle:function(){this.querySelector(".top-textarea-root").style.cssText=this.topstyle}};Top.Widget.Textarea=function(){Textarea.prototype=Object.create(Top.Widget.prototype);Textarea.prototype.constructor=Textarea;function Textarea(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-textarea");this.template.innerHTML='<textarea class="top-textarea-root" spellcheck="false"></textarea>'}this.id=this.template.id}Textarea.create=function(element){return new Textarea(element)};Textarea.prototype.openAutoComplete=function(){this.template.openAutoComplete()};Textarea.prototype.closeAutoComplete=function(){this.template.closeAutoComplete()};Textarea.prototype.getUnmaskedText=function(){return this.template.getUnmaskedText()};return Textarea}();TopTextfield={is:"top-textfield",behaviors:[TopWidgetBehavior,TopTextBehavior,TopMaskBehavior],properties:{password:String,hint:String,title:String,visible:String,maxLength:Number,readonly:String,icon:String,iconBackUp:String,onIconclick:String,clear:String,required:String,backgroundColor:String},__ready:function(){this.__updateId();this.__updatePassword();this.__updateAutoComplete();this.__updateBackgroundColor();this.__updateDisabled();this.__updateMaxLength();this.__updateTitle();this.__updateVisible();this.__updateIcon();this.__updateClear();this.__updateReadonly();this.__initBindingEvent();this.__initialClassname();this.__initI18n("hint");this.__initI18n("text");this.__updateText();this.__updateHint();this.__updateName();this.__updateRequired();this.__updateHorizontalAlignment();this.__updateVerticalAlignment()},appendTemplate:function(){this.innerHTML='<div class="top-textfield-root"><form autocomplete="off" onsubmit="return false;"><input class="top-textfield-text" type="text"><span class="top-textfield-icon" style="display:none;"></span></form></div>';this.__isTemplateAppended=true},__attached2:function(){this.setTitlePosition();this.setIconPosition();this.setClearPosition();if(this.classList.contains("error")){this.setError()}},shadowText:function(){return this.querySelector("input")},__eventBindingList:function(){var input=this.querySelector("input");var div=this.querySelector("div");return{__eventLostFocused:function(func){input.onblur=func},__eventMouseClick:function(func){div.onclick=func},__eventMouseEnter:function(func){div.onmouseenter=func},__eventMouseExit:function(func){div.onmouseleave=func},__eventMouseMove:function(func){div.onmousemove=func},__eventMousePressed:function(func){div.onmousedown=func},__eventMouseReleased:function(func){div.onmouseup=func},__eventMouseDblclick:function(func){div.ondblclick=func},__eventKeyTyped:function(func){input.onkeypress=func},__eventKeyReleased:function(func){input.onkeyup=func},__eventFocused:function(func){input.onfocus=func},__eventSecondaryClick:function(func){input.oncontextmenu=func}}},__initBindingEvent:function(){var _this=this;var shadowInput=this.querySelector("div input");this.__addEventFnByCore("eventKeyReleased",function(){_this.text=shadowInput.value;_this.setAttribute("text",shadowInput.value);_this.updateData("text");_this.updateDevice("text")});this.__addEventFnByCore("eventLostFocused",function(){_this.text=shadowInput.value;_this.setAttribute("text",shadowInput.value);_this.updateData("text");_this.updateDevice("text")})},__updateId:function(){if(this.id){var shadowInput=this.querySelector("input");shadowInput.id=this.id}},__updateBackgroundColor:function(){var shadowInput=this.querySelector("div input");shadowInput.style.backgroundColor=this.backgroundColor},__updateDisabled:function(){if(this.disabled===null)this.disabled=this.getAttribute("disabled");var disabled=this.calculateDerivedDisabled();var shadowInput=this.querySelector("div input");var shadowLabel=this.querySelector("div .top-textfield-title");if(disabled=="true"||disabled==true){this.setAttribute("disabled","true");shadowInput.setAttribute("disabled","true");if(shadowLabel)shadowLabel.setAttribute("disabled","true")}else{this.removeAttribute("disabled");shadowInput.removeAttribute("disabled");if(shadowLabel)shadowLabel.removeAttribute("disabled")}},__updateMaxLength:function(){var shadowInput=this.querySelector("div input");if(this.maxLength!=null)shadowInput.setAttribute("maxlength",this.maxLength)},__updatePassword:function(){var shadowInput=this.querySelector("div input");if(this.password=="true"||this.password==true){shadowInput.setAttribute("type","password")}else{shadowInput.setAttribute("type","text")}},__updateReadonly:function(){var shadowInput=this.querySelector("div input");if(this.readonly=="true"||this.readonly==true){shadowInput.setAttribute("readonly","")}else{shadowInput.removeAttribute("readonly")}},__updateTitle:function(){this.originTitle=this.title;var shadowInput=this.querySelector("div input");var shadowLabel=this.querySelector("div .top-textfield-title");if(shadowLabel){if(this.originTitle===""||this.originTitle===undefined||this.originTitle===null){shadowLabel.remove();shadowInput.style.paddingLeft=""}else{shadowLabel.innerText=this.__i18n(this.originTitle)}}else if(this.originTitle){shadowInput.insertAdjacentHTML("beforebegin","<label class='top-textfield-title'>"+this.__i18n(this.originTitle)+"</label>")}this.setTitlePosition();if(this.getAttribute("title")){this.setAttribute("title","")}},__updateVisible:function(){if(this.visible!=="none"){if(this.originTitle)this.setTitlePosition();this.setIconPosition()}var checkVisibility=/visibility:[a-z]+;/g;var checkDisplay=/display:[a-z-]+;/g;var temp=this.topstyle;temp=temp.replace(checkVisibility,"");temp=temp.replace(checkDisplay,"");this.topstyle=temp;if(this.display!=="none")this.prevDisplay=this.display;if(this.visible=="none"){this.display="none"}else if(this.visible==="visible"&&this.display==="none"){this.display=this.prevDisplay}if(this.display==null){this.display="inline-block"}this.setTopStyle("visibility",this.visible);this.setTopStyle("display",this.display);this._updateBorderWidth()},_updateBorderWidth:function(){if(this.borderWidth!==undefined){var shadowInput=this.querySelector("div input");shadowInput.style.borderWidth=this.borderWidth}},__updateIcon:function(){var _this=this;var shadowInput=this.querySelector("div input");var shadowIcon=this.querySelector("div span");var shadowForm=this.querySelector("div form");var shadowClear=shadowForm.querySelector(".top-textfield-clear");var iconSize=$(shadowIcon).css("font-size");var iconRight=$(shadowIcon).css("right");var clearSize=$(shadowClear).css("font-size");if(this.icon!==null&&this.icon!==""&&this.icon!==undefined){if(this.onIconclick&&typeof this.onIconclick==="string"){var fnIconClick=Top.Util.namespace(this.onIconclick,this);if(typeof fnIconClick==="function"){$(shadowIcon).css("cursor","pointer");$(shadowIcon).off("click").on("click",function(e){fnIconClick(e,Top.Dom.selectById(_this.id))})}}$(shadowIcon).removeClass(this.iconBackUp);$(shadowIcon).addClass(this.icon);if(this.clear===true||this.clear==="true"){$(shadowClear).css("right","30px");var clearRight=$(shadowClear).css("right");$(shadowInput).css("paddingRight",parseInt(clearSize)+parseInt(clearRight)+"px")}else{$(shadowInput).css("paddingRight",parseInt(iconSize)+parseInt(iconRight)+"px")}this.setIconPosition()}else{$(shadowIcon).removeClass(this.iconBackUp);if(this.clear===true||this.clear==="true"){if(this.text&&!this.text.match(this.pattern)){$(shadowClear).css("right","30px");var clearRight=$(shadowClear).css("right");$(shadowInput).css("paddingRight",parseInt(clearSize)+parseInt(clearRight)+"px")}else{$(shadowClear).css("right",parseInt(iconRight)+"px");$(shadowInput).css("paddingRight",parseInt(clearSize)+parseInt(iconRight)+"px")}}else{if(this.text&&!this.text.match(this.pattern)){$(shadowInput).css("paddingRight",parseInt(iconSize)+parseInt(iconRight)+"px")}else{$(shadowInput).css("paddingRight",parseInt(iconRight)+"px")}}}this.iconBackUp=this.icon},__updateOnIconclick:function(){var _this=this;var shadowIcon=this.querySelector("div span");if(this.onIconclick&&typeof this.onIconclick==="string"){var fnIconClick=Top.Util.namespace(this.onIconclick,this);if(typeof fnIconClick==="function"){$(shadowIcon).css("cursor","pointer");$(shadowIcon).off("click").on("click",function(e){fnIconClick(e,Top.Dom.selectById(_this.id))})}}},__updateClear:function(){var shadowForm=this.querySelector("div form");var shadowInput=this.querySelector("div input");var shadowIcon=this.querySelector("div .top-textfield-icon");var clear=this.querySelector(".top-textfield-clear");if(clear)clear.remove();var _this=this;this.removeEventListener("keyup",this.isBlank);if(this.clear===true||this.clear==="true"){$(shadowForm).append('<button class="top-textfield-clear" type="reset"></button>');var inputHeight=shadowInput.offsetHeight;var shadowClear=shadowForm.querySelector(".top-textfield-clear");$(shadowClear).css("line-height",inputHeight+"px");if(this.icon&&shadowIcon!==null&&$(shadowIcon).css("display")!=="none"){$(shadowClear).css("right","30px")}else{$(shadowClear).css("right",$(shadowIcon).css("right"))}$(shadowClear).on("click",function(e){_this.text="";_this.validation();isBlank();shadowInput.removeAttribute("value");_this.setAttribute("text","");_this.updateData("text");_this.updateDevice("text")});var clearSize=$(shadowClear).css("font-size");var clearRight=$(shadowClear).css("right");$(shadowInput).css("paddingRight",parseInt(clearSize)+parseInt(clearRight)+"px");Top.App.onWidgetAttach(this.id,function(){this.isBlank=function(){if(_this.text){if(_this.clear===true||_this.clear==="true"){_this.setClear();return true}}else{if(_this.clear===true||_this.clear==="true"){_this.removeClear();return false}}};this.addEventListener("keyup",this.isBlank);this.isBlank()})}else{if(shadowForm.querySelector(".top-textfield-clear"))shadowForm.removeChild(shadowForm.querySelector(".top-textfield-clear"));var iconSize=$(shadowIcon).css("font-size");var iconRight=$(shadowIcon).css("right");if(this.icon!==null&&this.icon!==""&&this.icon!==undefined){$(shadowInput).css("paddingRight",parseInt(iconRight)+parseInt(iconSize)+"px")}else{if(this.text&&!this.text.match(this.pattern)){$(shadowInput).css("paddingRight",parseInt(iconSize)+parseInt(iconRight)+"px")}else{$(shadowInput).css("paddingRight",parseInt(iconRight)+"px")}}}},__updateText:function(){this.text=this.__i18n(this.text);if(this.text!==undefined){var shadowInput=this.querySelector("div input");shadowInput.setAttribute("value",this.text);shadowInput.value=this.text}},__updateHint:function(){if(this.hint){var shadowInput=this.querySelector("div input");shadowInput.setAttribute("placeholder",this.hint)}},__updateName:function(){if(this.name){var shadowInput=this.querySelector("div input");shadowInput.setAttribute("name",this.name)}},__updateRequired:function(){var _this=this;var shadowInput=this.querySelector("input");this.removeEventListener("keyup",this.requiredTest);if(this.required==="true"||this.required===true){this.requiredTest=function(){if(_this.text){_this.removeError();return true}else{_this.setError();return false}};this.addEventListener("keyup",this.requiredTest);this.requiredTest()}},__updateHorizontalAlignment:function(){var input=this.querySelector("div input");input.style.textAlign=this.horizontalAlignment},__updateVerticalAlignment:function(){var input=this.querySelector("div input");if(!(this.layoutHeight==="wrap_content"||this.layoutHeight==="auto"||this.layoutHeight==="match_parent"||this.layoutHeight!==undefined&&this.layoutHeight!==null&&this.layoutHeight.includes("%"))){if(this.verticalAlignment==="top"){var computedStyle=getComputedStyle(input);var padding=input.offsetHeight-parseFloat(computedStyle.fontSize)-parseFloat(computedStyle.paddingTop)-parseFloat(computedStyle.paddingBottom);input.style.paddingBottom=padding+"px"}else if(this.verticalAlignment==="bottom"){var computedStyle=getComputedStyle(input);var padding=input.offsetHeight-parseFloat(computedStyle.fontSize)-parseFloat(computedStyle.paddingTop)-parseFloat(computedStyle.paddingBottom);input.style.paddingTop=padding+"px"}else{input.style.paddingTop="";input.style.paddingBottom=""}}else{input.style.paddingTop="";input.style.paddingBottom=""}},__setVerticalAlignment:function(){var input=this.querySelector("div input");if(this.layoutHeight==="match_parent"||this.layoutHeight!==undefined&&this.layoutHeight!==null&&this.layoutHeight.includes("%")){if(this.verticalAlignment==="top"){var computedStyle=getComputedStyle(input);var padding=input.offsetHeight-parseFloat(computedStyle.fontSize)-parseFloat(computedStyle.paddingTop)-parseFloat(computedStyle.paddingBottom);input.style.paddingBottom=padding+"px"}else if(this.verticalAlignment==="bottom"){var computedStyle=getComputedStyle(input);var padding=input.offsetHeight-parseFloat(computedStyle.fontSize)-parseFloat(computedStyle.paddingTop)-parseFloat(computedStyle.paddingBottom);input.style.paddingTop=padding+"px"}else{input.style.paddingTop="";input.style.paddingBottom=""}}},setClear:function(){var shadowForm=this.querySelector("div form");var shadowClear=shadowForm.querySelector(".top-textfield-clear");var shadowInput=this.querySelector("div input");var shadowIcon=this.querySelector("div .top-textfield-icon");shadowClear.style.display="inline-block";var iconSize=$(shadowIcon).css("font-size");if(this.text&&!this.text.match(this.pattern)){if(this.clear===true||this.clear==="true"){$(shadowClear).css("right","30px");var clearRight=$(shadowClear).css("right");$(shadowInput).css("paddingRight",parseInt(iconSize)+parseInt(clearRight)+"px")}}else{if(this.clear===true||this.clear==="true"){if(this.icon==null||this.icon==""||this.icon==undefined){var iconRight=$(shadowIcon).css("right");$(shadowClear).css("right",$(shadowIcon).css("right"));$(shadowInput).css("paddingRight",parseInt(iconSize)+parseInt(iconRight)+"px")}}}},removeClear:function(){var shadowForm=this.querySelector("div form");var shadowClear=shadowForm.querySelector(".top-textfield-clear");shadowClear.style.display="none"},setError:function(){var shadowForm=this.querySelector("div form");var shadowClear=shadowForm.querySelector(".top-textfield-clear");var shadowInput=this.querySelector("div input");var shadowIcon=this.querySelector("div span");var errorIcon=this.querySelector("div span");var inputHeight=shadowInput.offsetHeight;var iconSize=$(shadowIcon).css("font-size");if(!$(this).hasClass("error"))$(this).addClass("error");$(errorIcon).addClass("top-textfield-alert");$(errorIcon).css("display","inline");var iconRight=$(shadowIcon).css("padding-right");if(inputHeight!==0)$(errorIcon).css("line-height",inputHeight+"px");if(shadowClear){$(shadowClear).css("right","30px");var clearRight=$(shadowClear).css("right");$(shadowInput).css("paddingRight",parseInt(clearRight)+parseInt(iconRight)+"px")}else{$(shadowInput).css("paddingRight",parseInt(iconSize)+parseInt(iconRight)+"px")}},removeError:function(){var errorIcon=this.querySelector("div span");var shadowInput=this.querySelector("div input");var shadowIcon=this.querySelector("div span");var shadowForm=this.querySelector("div form");var shadowClear=shadowForm.querySelector(".top-textfield-clear");if(this.icon==null||this.icon==""||this.icon==undefined){$(shadowInput).css("paddingRight",$(shadowIcon).css("right"))}$(this).removeClass("error")},setTitlePosition:function(){if(!this.classList.contains("out_textfield")){var shadowLabel=this.querySelector("div .top-textfield-title");if(shadowLabel!=null){var shadowInput=this.querySelector("div input");var fontSize=shadowInput.style.fontSize;var inputHeight=shadowInput.offsetHeight;var labelwidth=shadowLabel.clientWidth+"px";shadowInput.style.paddingLeft="calc("+labelwidth+" + 10px)";shadowLabel.style.fontSize=fontSize;shadowLabel.style.lineHeight=inputHeight-8+"px"}}},setIconPosition:function(){if(this.icon!==null&&this.icon!==""&&this.icon!==undefined){var shadowInput=this.querySelector("div input");var shadowIcon=this.querySelector("div span");var fontSize=shadowInput.style.fontSize;var inputHeight=shadowInput.offsetHeight;shadowIcon.style.lineHeight=inputHeight+"px";shadowIcon.style.display="inline"}},setTimerPosition:function(){if(this.timer!==null&&this.timer!==""&&this.timer!==undefined){var input=this.getElementsByClassName("top-textfield-text")[0];var timer=this.getElementsByClassName("top-textfield-timer")[0];var fontSize=input.style.fontSize;var inputHeight=input.offsetHeight;timer.style.lineHeight=inputHeight+"px";timer.style.display="inline"}},setClearPosition:function(){if(this.clear!==null&&this.clear!==""&&this.clear!==undefined){var shadowInput=this.querySelector("div input");var shadowClear=this.querySelector("div .top-textfield-clear");var inputHeight=shadowInput.offsetHeight;$(shadowClear).css("line-height",inputHeight+"px")}},focus:function(){this.querySelector(".top-textfield-text").focus()},blur:function(){this.querySelector(".top-textfield-text").blur()},getTopStyle:function(){this.topstyle=this.querySelector(".top-textfield-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-textfield-root");if(key==="border-style"||key==="border-width"||key==="border-color"){styleNode=this.querySelector(".top-textfield-text")}styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-textfield-root").style.cssText=this.topstyle},__initTimer:function(settings){var span=this.getElementsByClassName("top-textfield-icon")[0];span.classList.remove(this.icon);span.classList.remove("top-textfield-icon");span.classList.add("top-textfield-timer");if(settings&&settings.textColor)span.style.color=settings.textColor;if(settings&&settings.textSize)span.style.fontSize=settings.textSize;this.timer=settings&&settings.timer?settings.timer:"05:00";this.__format=this.timer.replace(/[0-9]+/,"mm").replace(/[0-9]+/,"ss");this.onEndtimer=settings&&settings.onEndtimer?settings.onEndtimer:undefined;this.setTimerPosition();if(this.clear){this.clear=false;this.__updateClear()}span.innerText=this.timer},startTimer:function(){var span=this.getElementsByClassName("top-textfield-timer")[0];this.__setTimer(span)},stopTimer:function(){var span=this.getElementsByClassName("top-textfield-timer")[0];this.__stopTimer(span)},pauseTimer:function(){var span=this.getElementsByClassName("top-textfield-timer")[0];this.__pauseTimer(span)},resumeTimer:function(){var span=this.getElementsByClassName("top-textfield-timer")[0];this.__setTimer(span)}};Top.Widget.Textfield=function(){Textfield.prototype=Object.create(Top.Widget.prototype);Textfield.prototype.constructor=Textfield;function Textfield(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-textfield");this.template.innerHTML='<div class="top-textfield-root"><form autocomplete="off" onsubmit="return false;"><input class="top-textfield-text" type="text"><span class="top-textfield-icon" style="display:none;"></span></form></div>'}this.id=this.template.id}Textfield.create=function(element){return new Textfield(element)};Textfield.prototype.setError=function(){this.template.setError()};Textfield.prototype.removeError=function(){this.template.removeError()};Textfield.prototype.openAutoComplete=function(){this.template.openAutoComplete()};Textfield.prototype.closeAutoComplete=function(){this.template.closeAutoComplete()};Textfield.prototype.setTimer=function(settings){this.template.__initTimer(settings)};Textfield.prototype.startTimer=function(){this.template.startTimer()};Textfield.prototype.stopTimer=function(){this.template.stopTimer()};Textfield.prototype.pauseTimer=function(){this.template.pauseTimer()};Textfield.prototype.resumeTimer=function(){this.template.resumeTimer()};Textfield.prototype.getUnmaskedText=function(){return this.template.getUnmaskedText()};return Textfield}();TopTextview={is:"top-textview",behaviors:[TopWidgetBehavior,TopTextBehavior],properties:{url:String,ellipsis:{type:Boolean,value:false},multiLine:String},__ready:function(){this.__updateUrl();this.__updateId();this.__updateText();this.__eventBindingList();this.__updateName()},appendTemplate:function(){this.innerHTML='<span class="top-textview-root"><a class="top-textview-url"></a></span>';this.__isTemplateAppended=true},__eventBindingList:function(){var shadowSpan=this.querySelector("span");return{__eventMouseClick:function(func){shadowSpan.onclick=func},__eventMousePressed:function(func){shadowSpan.onmousedown=func},__eventMouseReleased:function(func){shadowSpan.onmouseup=func},__eventMouseDblclick:function(func){shadowSpan.ondblclick=func},__eventKeyPressed:function(func){shadowSpan.onkeydown=func},__eventKeyTyped:function(func){shadowSpan.onkeypress=func},__eventKeyReleased:function(func){shadowSpan.onkeyup=func},__eventMouseEnter:function(func){shadowSpan.onmouseenter=func},__eventMouseExit:function(func){shadowSpan.onmouseleave=func},__eventMouseMove:function(func){shadowSpan.onmousemove=func},__eventSecondaryClick:function(func){shadowSpan.oncontextmenu=func}}},__attached2:function(){this.__updateMultiLine();this.__updateVerticalAlignment();this.__initTooltip()},__updateId:function(){if(this.id){var shadowInput=this.querySelector("span");shadowInput.id=this.id}},__updateVerticalAlignment:function(){if(!this.lineHeight){var root=this.querySelector(".top-textview-root");var url=this.querySelector(".top-textview-url");if(this.verticalAlignment==="top"||this.verticalAlignment==="bottom"){root.style.display="inline-table";root.style.lineHeight="";url.style.display="table-cell";
url.style.verticalAlign=this.verticalAlignment}else{var checkHeightValue=/[0-9]+px/;root.style.display="inline-block";url.style.display="inline";url.style.verticalAlign="";if(checkHeightValue.test(this.layoutHeight))this.setTopStyle("line-height",this.layoutHeight);else if(this.layoutHeight&&(this.layoutHeight==="match_parent"||this.layoutHeight.includes("%"))){this.setTopStyle("line-height",root.offsetHeight+"px");var _this=this;this.__updateVerticalAlignmentForMatchparent=function(){_this.setTopStyle("line-height",root.offsetHeight+"px")}}}this.__updateVisible()}},__updateDisabled:function(){if(this.disabled===null)this.disabled=this.getAttribute("disabled");var disabled=this.calculateDerivedDisabled();var shadowInput=this.querySelector(".top-textview-root");if(disabled=="true"||disabled==true){shadowInput.setAttribute("disabled","true")}else{shadowInput.removeAttribute("disabled")}},__updateMultiLine:function(){var root=this.querySelector(".top-textview-root");var url=this.querySelector(".top-textview-url");if(this.multiLine==="true"||this.multiLine===true){root.style.whiteSpace="pre-wrap";root.style.wordWrap="break-word";url.style.position="relative";url.style.lineHeight="normal";url.style.display="block";url.style.top="calc(50% - "+url.offsetHeight/2+"px)"}else{root.style.whiteSpace="";root.style.wordWrap="";url.style.position="";url.style.lineHeight="";url.style.display="";url.style.top=""}},__updateText:function(){if(this.text||this.text===""){var url=this.querySelector(".top-textview-url");url.innerHTML=this.text}this.__initTooltip()},__updateUrl:function(){if(this.url){this.url=this.url.startsWith("/")?'javascript:Top.App.routeTo("'+this.url+'")':this.url;var url=this.querySelector(".top-textview-url");url.setAttribute("href",this.url)}},__updateName:function(){if(this.name){var shadowInput=this.querySelector("span");shadowInput.setAttribute("name",this.name)}},getTopStyle:function(){this.topstyle=this.querySelector("span").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector("span");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector("span").style.cssText=this.topstyle},__initTooltip:function(){if(this.__isOverflown()&&!Top.Util.__isBooleanTrue(this.multiLine)){this.tooltip=this.text}else{this.tooltip=""}this.__updateTooltip()},__isOverflown:function(){var root=this.getElementsByClassName("top-textview-root")[0];var rootStyle=window.getComputedStyle(root);var temp=root.cloneNode(true);temp.style.fontFamily=rootStyle.fontFamily;temp.style.fontSize=rootStyle.fontSize;temp.style.fontStyle=rootStyle.fontStyle;temp.style.fontWeight=rootStyle.fontWeight;temp.style.textTransform=rootStyle.textTransform;temp.style.display="inline";temp.style.width="auto";temp.style.visibility="hidden";document.body.appendChild(temp);if(Math.ceil(parseFloat(rootStyle.width))<temp.offsetWidth){temp.remove();return true}else{temp.remove();return false}},detachTooltip:function(){var thisPageId=Top.App.getCurrentPage().id;var $tooltipText=$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=$("#"+thisPageId+" .top-tooltip-arrow");$tooltipText.css("display","none");$tooltipArrow.css("display","none");if($tooltipArrow.hasClass("bottom"))$tooltipArrow.removeClass("bottom");else if($tooltipArrow.hasClass("top"))$tooltipArrow.removeClass("top")},__detached:function(){this.detachTooltip()}};Top.Widget.Textview=function(){Textview.prototype=Object.create(Top.Widget.prototype);Textview.prototype.constructor=Textview;function Textview(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-textview");this.template.innerHTML='<span class="top-textview-root"><a class="top-textview-url"></a></span>'}this.id=this.template.id}Textview.create=function(element){return new Textview(element)};return Textview}();TopTimer={is:"top-timer",behaviors:[TopWidgetBehavior,TopTextBehavior],properties:{timer:String,onEndtimer:String},appendTemplate:function(){this.innerHTML='<span class="top-timer-root"></span>';this.__isTemplateAppended=true},setAllTopStyle:function(){this.getElementsByClassName("top-timer-root")[0].style.cssText=this.topstyle},__attached2:function(){this.__initTimer()},__initTimer:function(){if(this.timer===undefined)this.timer="05:00";this.__format=this.timer.replace(/[0-9]+/,"mm").replace(/[0-9]+/,"ss");var span=this.getElementsByClassName("top-timer-root")[0];span.innerText=this.timer},__updateTimer:function(){this.__initTimer()},start:function(){var span=this.getElementsByClassName("top-timer-root")[0];this.__setTimer(span)},stop:function(){var span=this.getElementsByClassName("top-timer-root")[0];this.__stopTimer(span)},pause:function(){var span=this.getElementsByClassName("top-timer-root")[0];this.__pauseTimer(span)},resume:function(){var span=this.getElementsByClassName("top-timer-root")[0];this.__setTimer(span)}};Top.Widget.Timer=function(){Timer.prototype=Object.create(Top.Widget.prototype);Timer.prototype.constructor=Timer;function Timer(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-timer");this.template.innerHTML='<span class="top-timer-root"></span>'}this.id=this.template.id}Timer.create=function(element){return new Timer(element)};Timer.prototype.start=function(){this.template.start()};Timer.prototype.stop=function(){this.template.stop()};Timer.prototype.pause=function(){this.template.pause()};Timer.prototype.resume=function(){this.template.resume()};return Timer}();TopToggle={is:"top-toggle",behaviors:[TopWidgetBehavior,TopCheckBehavior],properties:{textOn:{type:String,value:"On"},textOff:{type:String,value:"Off"},onChange:String},__ready:function(){this.__updateId();this.__initialize()},appendTemplate:function(){this.innerHTML='<input type="checkbox"></input>';this.__isTemplateAppended=true},__attached2:function(){this.__addEventByAttr("click")},__initialize:function(){var shadowInput=this.querySelector("input");$(shadowInput).bootstrapToggle("destroy");if(this.disabled=="true"||this.disabled==true){$(shadowInput).bootstrapToggle({on:this.textOn,off:this.textOff,width:this.layoutWidth,height:this.layoutHeight,topstyle:this.topstyle,style:"disabled"})}else{$(shadowInput).bootstrapToggle({on:this.textOn,off:this.textOff,width:this.layoutWidth,height:this.layoutHeight,topstyle:this.topstyle})}this.__attachEvent()},__updateId:function(){if(this.id){var shadowInput=this.querySelector("input");shadowInput.id=this.id}},__initEventInternal:function(){this.__addEventByAttr("change")},on:function(){var shadowInput=this.querySelector("input");$(shadowInput).bootstrapToggle("on");this.checked=true},off:function(){var shadowInput=this.querySelector("input");$(shadowInput).bootstrapToggle("off");this.checked=false},toggle:function(){if(this.checked){this.off()}else{this.on()}},callEventChanged:function(){if(typeof this.eventChanged==="string")this.__eventChanged=Top.Util.namespace(this.eventChanged,this);if(typeof this.__eventChanged==="function"){this.__eventChanged(this.checked)}},__attachEvent:function(){var _this=this;var container=this.querySelector(".top-toggle-root");container.addEventListener("click",function(event){if(typeof _this.__eventMouseClick==="function")_this.__eventMouseClick();_this.checked=!_this.checked;_this.__initCheck();_this.callEventChanged(this.checked);_this.updateData("checked");_this.updateDevice("checked")},true)},__updateChecked:function(){if(this.checked=="true"){this.on()}else{this.off()}},__updateOnChange:function(){this.__addEventByAttr("change")},getTopStyle:function(){return this.topstyle},setAllTopStyle:function(){}};Top.Widget.Toggle=function(){Toggle.prototype=Object.create(Top.Widget.prototype);Toggle.prototype.constructor=Toggle;function Toggle(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-toggle");this.template.innerHTML='<input type="checkbox"></input>'}this.id=this.template.id}Toggle.create=function(element){return new Toggle(element)};Toggle.prototype.on=function(){this.template.on()};Toggle.prototype.off=function(){this.template.off()};Toggle.prototype.toggle=function(){this.template.toggle()};Toggle.prototype.getState=function(){return this.template["checked"]};return Toggle}();TopTreeview={is:"top-treeview",behaviors:[TopWidgetBehavior,TopGroupBehavior,TopContainerBehavior],properties:{eventNodeSelected:String,eventNodeHover:String,searchable:String,nodes:String,setting:{},zTree:Object,count:{type:Number,value:0},checkable:String,onCheck:String,expand:String,relationsId:String,groupIcon:String,childIcon:String,groupImage:String,childImage:String,draggable:String,onNodeclick:String,onNodecheck:String,onNodehover:String,onNodedblclick:String,option:String,toggleClickCount:String,virtualScroll:{type:String,value:"false"},onExpand:String,onCollapse:String,onScrollend:String},__ready:function(){this.__initialized=true;this.__updateId();this.initialLayout();this.initItems();this.__initialize()},__updateId:function(){if(this.id){this.childRoot.id=this.id}},appendTemplate:function(){this.innerHTML='<div class="top-treeview-root">'+this.innerHTML+"</div>";this.__isTemplateAppended=true},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-treeview-root");return{__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},attached:function(){if(this.querySelector(".top-treeview-container")){this.attachEventHandler()}},initializeChildRoot:function(){return this.querySelector(".top-treeview-root")},__initialize:function(){this.__initializeOption();if(this.relationsId){var path=this.relationsId.split(".");var data=Top.Util.namespace(path[0],this);var instanceId=data.getDataByRelations(path[1]);data.__addBoundWidget(instanceId,this.id,"items");this.items=path[0]+"."+instanceId}if(this.items){this.renderTreeViewByItems();return}else if(this.nodes){this.renderTreeViewByNodes()}else if(this.widgetItems){for(var i=0;i<this.widgetItems.length;i++){if(this.widgetItems[i].attributes["data-model"]){this.renderTreeViewByItems();return}}this.renderTreeViewByNodes()}},__initEventInternal:function(){this.__initializeOption();this.__addEventByAttr("expand");this.__addEventByAttr("collapse")},__updateOnExpand:function(){this.__addEventByAttr("expand")},__updateOnCollpase:function(){this.__addEventByAttr("collapse")},__updateOnScrollend:function(){this.__addEventByAttr("scrollend")},__initializeOption:function(){this.defaultOption={node:{draggable:false,editable:false,deletable:false,checkable:false,checkInherit:true,checkInheritParent:true,checkDisabled:false,toggleClickCount:"2"},view:{showIcon:true,groupIcon:"icon-folder",childIcon:"icon-file",showImage:false,groupImage:null,childImage:null,language:{delete:"Delete",edit:"Edit"},expand:false,menu:{order:["edit","delete"]},layout:null,autoNodeWidth:true},event:{onNodeclick:null,onNodecheck:null,onNodehover:null,onNodedblclick:null,onNodedrag:null,onNodedrop:null,onNodedragstart:null,onNodedragend:null,onNodedragenter:null,onNodedragover:null,onNodedragleave:null,onNodeedit:null,onNodedelete:null,onExpand:null,onCollapse:null,onNodecontextmenu:null,onScrollend:null}};if(typeof this.option=="string"){this.option=Top.Util.namespace(this.option,this)}this.option=$.extend(true,this.defaultOption,this.option);this.__matchOptionProperties()},__matchOptionProperties:function(){if(this.checkable){this.option.node.checkable=this.checkable}if(this.groupIcon){this.option.view.groupIcon=this.groupIcon}if(this.childIcon){this.option.view.childIcon=this.childIcon}if(this.groupImage){var groupImage=this.groupImage;if(groupImage.includes("@drawable")){groupImage=Top.DrawableManager.get(groupImage.replace("@drawable/",""))}this.option.view.groupImage=groupImage;this.option.view.showImage=true;this.option.view.showIcon=false}if(this.childImage){var childImage=this.childImage;if(childImage.includes("@drawable")){childImage=Top.DrawableManager.get(childImage.replace("@drawable/",""))}this.option.view.childImage=childImage;this.option.view.showImage=true;this.option.view.showIcon=false}if(this.expand){this.option.view.expand=this.expand==="true"||this.expand===true}if(this.toggleClickCount){this.option.node.toggleClickCount=this.toggleClickCount}if(this.eventNodeSelected||this.onNodeclick){this.option.event.onNodeclick=this.eventNodeSelected||this.onNodeclick}if(this.eventNodeHover||this.onNodehover){this.option.event.onNodehover=this.eventNodeHover||this.onNodehover}if(this.onCheck||this.onNodecheck){this.option.event.onNodecheck=this.onCheck||this.onNodecheck}if(this.onNodedblclick){this.option.event.onNodedblclick=this.onNodedblclick}if(this.option.event.onExpand){this.onExpand=this.option.event.onExpand;this.__addEventByAttr("expand")}if(this.option.event.onCollapse){this.onCollapse=this.option.event.onCollapse;this.__addEventByAttr("collapse")}if(this.option.event.onScrollend){this.onScrollend=this.option.event.onScrollend;this.__addEventByAttr("scrollend")}this.option.view.autoNodeWidth=this.option.view.autoNodeWidth==="true"||this.option.view.autoNodeWidth===true;if(this.option.view.autoNodeWidth&&(!this.layoutWidth||this.layoutWidth==="auto"))this.option.view.autoNodeWidth=false;if(typeof this.option.view.layout==="string")this.option.view.layout=Top.Util.namespace(this.option.view.layout,this);if(typeof this.option.event.onNodeclick==="string")this.option.event.onNodeclick=Top.Util.namespace(this.option.event.onNodeclick,this);if(typeof this.option.event.onNodehover==="string")this.option.event.onNodehover=Top.Util.namespace(this.option.event.onNodehover,this);if(typeof this.option.event.onNodecheck==="string")this.option.event.onNodecheck=Top.Util.namespace(this.option.event.onNodecheck,this);if(typeof this.option.event.onNodedblclick==="string")this.option.event.onNodedblclick=Top.Util.namespace(this.option.event.onNodedblclick,this);if(typeof this.option.event.onNodedrag==="string")this.option.event.onNodedrag=Top.Util.namespace(this.option.event.onNodedrag,this);if(typeof this.option.event.onNodedrop==="string")this.option.event.onNodedrop=Top.Util.namespace(this.option.event.onNodedrop,this);if(typeof this.option.event.onNodedragstart==="string")this.option.event.onNodedragstart=Top.Util.namespace(this.option.event.onNodedragstart,this);if(typeof this.option.event.onNodedragend==="string")this.option.event.onNodedragend=Top.Util.namespace(this.option.event.onNodedragend,this);if(typeof this.option.event.onNodedragenter==="string")this.option.event.onNodedragenter=Top.Util.namespace(this.option.event.onNodedragenter,this);if(typeof this.option.event.onNodedragover==="string")this.option.event.onNodedragover=Top.Util.namespace(this.option.event.onNodedragover,this);if(typeof this.option.event.onNodedragleave==="string")this.option.event.onNodedragleave=Top.Util.namespace(this.option.event.onNodedragleave,this);if(typeof this.option.event.onNodeedit==="string")this.option.event.onNodeedit=Top.Util.namespace(this.option.event.onNodeedit,this);if(typeof this.option.event.onNodedelete==="string")this.option.event.onNodedelete=Top.Util.namespace(this.option.event.onNodedelete,this);if(typeof this.onExpand==="string")this.onExpand=Top.Util.namespace(this.onExpand,this);if(typeof this.onCollapse==="string")this.onCollapse=Top.Util.namespace(this.onCollapse,this);if(typeof this.onScrollend==="string")this.onScrollend=Top.Util.namespace(this.onScrollend,this);if(typeof this.option.event.onNodecontextmenu==="string")this.option.event.onNodecontextmenu=Top.Util.namespace(this.option.event.onNodecontextmenu,this);if(typeof this.option.node.checkDisabled==="string")this.option.node.checkDisabled=Top.Util.namespace(this.option.node.checkDisabled,this)},makeNodes:function(parent){var len=parent.length;var node=[];for(var i=0;i<len;i++){var obj={};obj["id"]=parent[i].getAttribute("id");obj["text"]=parent[i].getAttribute("text");obj["value"]=parent[i].getAttribute("value");obj["image"]=parent[i].getAttribute("image");obj["icon"]=parent[i].getAttribute("icon");obj["editable"]=parent[i].getAttribute("editable");obj["deletable"]=parent[i].getAttribute("deletable");obj["checkable"]=parent[i].getAttribute("checkable");obj["checked"]=parent[i].getAttribute("checked");if(parent[i].children&&parent[i].children.length>0){obj["children"]=this.makeNodes(parent[i].children);if(obj["checked"]===true||obj["checked"]==="true"){for(var j=0;j<obj["children"].length;j++){obj["children"][j]=obj["checked"]}}}node[i]=obj}return node},makeNodesByObject:function(parent){if(parent===undefined){console.error("nodes not defined");return}if(this.__nodePath===undefined)this.__nodePath=[];var len=parent.length;var node=[];for(var i=0;i<len;i++){var obj={};for(var key in parent[i]){obj[key]=parent[i][key];if(key==="children"&&parent[i][key].length>0){this.__nodePath.push(parent[i].id);obj[key]=this.makeNodesByObject(parent[i].children);if(obj["checked"]===true||obj["checked"]==="true"){for(var j=0;j<obj["children"].length;j++){obj["children"][j]=obj["checked"]}}}}node[i]=obj;parent[i].path=this.__nodePath.join(".")}this.__nodePath.pop();return node},__findNodeById:function(nodes,id){if(!nodes||!id)return;var selectedNode;for(var i=0,len=nodes.length;i<len;i++){if(nodes[i].id==id){return nodes[i]}if(typeof nodes[i].children==="object"&&nodes[i].children.length>0){selectedNode=this.__findNodeById(nodes[i].children,id);if(selectedNode){return selectedNode}}}return selectedNode},__findItemByField:function(items,field,value,index){if(!this._index)this._index=0;if(!items||!field||!value)return;index=parseInt(index);var selectedNode;var calledByItself=false;if(this.__findItemByField.caller.name==="__findItemByField")calledByItself=true;if(items instanceof Array){for(var i=0,len=items.length;i<len;i++){if(calledByItself)this._index++;selectedNode=this.__findItemByField(items[i],field,value,index);if(selectedNode)return selectedNode}}else if(items instanceof Object){if(index==this._index&&items[field]===value){this._index=0;return items}for(var key in items){if(typeof items[key]==="object"&&items[key].length>0){selectedNode=this.__findItemByField(items[key],field,value,index);if(selectedNode)return selectedNode}}}return selectedNode},renderTreeViewByNodes:function(){if(this.nodes){this.clearItems();if(typeof this.nodes=="string"){this.nodes=Top.Util.namespace(this.nodes,this)}var nodes=this.makeNodesByObject(this.nodes);this.userNodes=this.nodes}else if(this.widgetItems){var nodes=this.makeNodes(this.widgetItems);this.userNodes=this.widgetItems}if(this.childRoot.getElementsByClassName("top-treeview-container")[0]){this.childRoot.getElementsByClassName("top-treeview-container")[0].remove()}var container_ul=document.createElement("ul");container_ul.classList.add("top-treeview-container");if(this.option.view.autoNodeWidth)container_ul.classList.add("auto-width");this.childRoot.appendChild(container_ul);if(this.virtualScroll===true||this.virtualScroll==="true"){if(nodes.length>0){this.isExpanded=this.option.view.expand;if(this.isExpanded===undefined)this.isExpanded=true;this.nodes=this.__setExpand(nodes,this.isExpanded,0);this.__setPath(this.nodes,"");this.__setId(this.nodes,0);this.flatNodes=this.__makeFlatNode(new Array,this.nodes);this.__createViewport(this.flatNodes.length,this.flatNodes);this.firstVirtualEventInit();if(this.userNodes)this.__setVirtualDataObjToItem(this.flatNodes);this.createdItemWidgetAttachedCallback();this.__setOptions()}}else{var appendString="";appendString=this.makeTreeNodes(nodes,0);var madeNodes=document.createElement("div");madeNodes.innerHTML=appendString;for(var k=0;k<madeNodes.children.length;k++){this.createHtmlObjects(madeNodes.children[k])}while(madeNodes.firstChild){this.getElementsByClassName("top-treeview-container")[0].appendChild(madeNodes.firstChild)}this.createdItemWidgetAttachedCallback();this.__setOptions();this.attachEventHandler();if(this.widgetItems){var widgetItemList=this.querySelectorAll("top-widgetitem");for(var i=0;i<widgetItemList.length;i++){var tmp=widgetItemList[i];$(tmp).remove()}}}},firstVirtualEventInit:function(){var _this=this;var allNodeHasChecked=$(_this.querySelectorAll(".top-treeview-check:checked")).parent().find("> .top-treeview-item");_this.checkedNode=[];for(var index=0;index<allNodeHasChecked.length;index++){var item=allNodeHasChecked[index];if(_this.userNodes){if(item.dataObj!==undefined){_this.checkedNode.push(item.dataObj)}else{_this.checkedNode.push(_this.__findNodeById(_this.flatNodes,item.id))}}else if(_this.items){_this._index=0;_this.checkedNode.push(_this.__findItemByField(_this.items,item.getAttribute("data-field"),item.innerText,item.getAttribute("data-index")))}}for(var k=0;k<_this.checkedNode.length;k++){var item=_this.checkedNode[k];item.checked=true}},renderTreeViewByItems:function(){this.clearItems();var isStaticDataIncluded=false;var switchedItem=[];var subItems=[];var switchedModel=[];var changedItems=[];var modelIdObj={};var _this=this;var makeChangedItems=function(item){var len=item.childNodes.length;var ret=[];for(var i=0;i<len;i++){ret[i]={};ret[i]["text"]=item.childNodes[i].attributes["text"].value;if(item.childNodes[i].children){ret[i]["children"]=makeChangedItems(item.childNodes[i])}}return ret.length===0?undefined:ret};var isStaticItem=function(item){if(item.attributes["text"]&&item.attributes["text"].value.startsWith("{"))return false;else if(item.attributes["data-model"]||item.attributes["text"])return true;else return false};if(typeof this.items=="string"){this.itemModel=Top.Util.namespace(Top.Util.getDataName(this.items),this);this.itemString=this.items.split(".");this.itemString=this.itemString[this.itemString.length-1];this.items=Top.Util.namespace(this.items,this);this.itemModelObj=this.itemModel.getModel()[this.itemString];this.itemData=this.items}else if(this.items===undefined){isStaticDataIncluded=true;this.items=[];this.itemModel=[];this.itemModelObj={};var tempArray=[];this.staticItemWithModel=[];this.itemString=[];for(var i=0;i<this.widgetItems.length;i++){if(this.widgetItems[i].attributes["data-model"]){var tempString=this.widgetItems[i].attributes["data-model"].value;tempArray.push(tempString.substring(tempString.indexOf('"',tempString.indexOf(":"))+1,tempString.lastIndexOf('"')));this.staticItemWithModel.push(this.widgetItems[i])}}for(var index=0;i<tempArray.length;index++){_this.itemModel.push(Top.Util.namespace(Top.Util.getDataName(tempArray[index]),_this));_this.itemString.push(tempArray[index].split(".")[tempArray[index].split(".").length-1]);_this.items.push(Top.Util.namespace(tempArray[index],_this));_this.itemModelObj["modelId"]=undefined;_this.itemModelObj[_this.itemString[index]]=_this.itemModel[index].getModel()[_this.itemString[index]]}}var container_ul=document.createElement("ul");container_ul.classList.add("top-treeview-container");container_ul.classList.add("generator");this.childRoot.appendChild(container_ul);var appendString="";if(isStaticDataIncluded){for(var i=0;i<this.widgetItems.length;i++){if(isStaticItem(this.widgetItems[i])){changedItems[i]={};changedItems[i]["text"]=this.widgetItems[i].attributes["text"]?this.widgetItems[i].attributes["text"].value:"";var trigger=false;for(var j=0;j<this.staticItemWithModel.length;j++){if(this.widgetItems[i]===this.staticItemWithModel[j]){trigger=true;changedItems[i][this.itemString[j]]=this.items[j].slice()}}if(!trigger)changedItems[i]["children"]=makeChangedItems(this.widgetItems[i])}}appendString=this.makeTreeItems(changedItems,0)}else appendString=this.makeTreeItems(this.items,0);this.getElementsByClassName("top-treeview-container")[0].innerHTML=appendString;if(this.headerItem.length>0){$(this).prepend("<label class='top-treeview-header'></label>");if(this.headerItem[0].attributes["text"])this.querySelector(".top-treeview-header").innerText=this.headerItem[0].attributes.text.nodeValue;if(this.headerItem[0].childElementCount>0)this.querySelector(".top-treeview-header").innerHTML=this.headerItem[0].innerHTML}if(this.option.view.groupImage||this.option.view.childImage){this.option.view.showImage=true;if(this.option.view.groupImage){var parentItems=this.querySelectorAll("label.top-treeview-item");for(var i=0;i<parentItems.length;i++){if(parentItems.getElementsByClassName("top-treeview-image")[0].length===0){var image_span=document.createElement("span");image_span.classList.add("top-treeview-image");image_span.style.background="url("+this.option.view.groupImage+") 0 0 no-repeat";image_span.style.backgroundSize="contain";image_span.setAttribute("i-type","union");parentItems.insertBefore(image_span,parentItems.firstChild)}}}if(this.option.view.childImage){var childItems=this.querySelectorAll("a.top-treeview-item");for(var i=0;i<parentItems.length;i++){if(childItems.getElementsByClassName("top-treeview-image")[0].length===0){var image_span=document.createElement("span");image_span.classList.add("top-treeview-image");image_span.style.background="url("+this.option.view.groupImage+") 0 0 no-repeat";image_span.style.backgroundSize="contain";image_span.setAttribute("i-type","union");childItems.insertBefore(image_span,childItems.firstChild)}}}}this.__setOptions();this.count=0;this.attachEventHandler()},getTreeItem:function(instance,modelId,modelFieldName){var _this=this;var defaultItem;var rightItem;var switchedWidgetItems=this.widgetItems;var isStaticItem=function(item){if(item.attributes["text"]&&item.attributes["text"].value.startsWith("{"))return false;else if(item.attributes["data-model"]||item.attributes["text"])return true;else return false};for(var i=0;i<this.widgetItems.length;i++){if(isStaticItem(this.widgetItems[i])){var modelFieldinItem=this.widgetItems[i].getAttribute("data-model");if(modelFieldinItem){modelFieldinItem=modelFieldinItem.substring(modelFieldinItem.lastIndexOf(".")+1,modelFieldinItem.lastIndexOf('"'));if(modelFieldinItem==modelFieldName){switchedWidgetItems=[];switchedWidgetItems=[this.widgetItems[i]]}}}}for(var i=0;i<switchedWidgetItems.length;i++){var widgetItems;var treeItem;if(isStaticItem(switchedWidgetItems[i])){if(switchedWidgetItems[i].getAttribute("item-switch-logic")){this.itemSwitchLogic=switchedWidgetItems[i].getAttribute("item-switch-logic");if(switchedWidgetItems[i].attributes["item-switch-logic"].value.startsWith("{")){this.itemSwitchField=switchedWidgetItems[i].attributes["item-switch-logic"].value.substring(1,switchedWidgetItems[i].attributes["item-switch-logic"].value.indexOf("}"))}else this.itemSwitchFunc=Top.Util.namespace(switchedWidgetItems[i].attributes["item-switch-logic"].value,this)}widgetItems=Array.prototype.slice.call($(switchedWidgetItems[i]).children("top-widgetitem"));for(var j=0;j<widgetItems.length;j++){treeItem=widgetItems[j];if(!treeItem.getAttribute("model-id")){if(treeItem.getAttribute("item-switch-case")){if(isRightItem(treeItem))defaultItem=treeItem}else defaultItem=treeItem}else if(treeItem.getAttribute("model-id")===modelId){if(!treeItem.getAttribute("item-switch-case"))defaultItem=treeItem;if(isRightItem(treeItem))rightItem=treeItem}}}else{treeItem=switchedWidgetItems[i];if(!treeItem.getAttribute("model-id")){if(treeItem.getAttribute("item-switch-case")){if(isRightItem(treeItem))defaultItem=treeItem}else defaultItem=treeItem}else if(treeItem.getAttribute("model-id")===modelId){if(!treeItem.getAttribute("item-switch-case"))defaultItem=treeItem;if(isRightItem(treeItem))rightItem=treeItem}}}if(!rightItem&&modelId)rightItem=defaultItem;return rightItem;function isRightItem(item,type){if(_this.itemSwitchLogic&&item.getAttribute("item-switch-case")){return itemSwitchLogicCall(item)}else return true}function itemSwitchLogicCall(item){var regex1=/^.*\>+.*|.*\<+.*|.*\=+.*$/;var regex2=/^[-+.]?[0-9,]*[.]?[0-9]+$/;if(_this.itemSwitchField){var itemCase;var fieldValue;var fieldArray=_this.itemSwitchField.split(".");if(fieldArray.length>1){var fieldModel=fieldArray[0];var fieldName=fieldArray[1]}else{var fieldName=fieldArray[0]}if(fieldModel&&fieldModel!==modelId){return false}fieldValue=instance[fieldName];var bool=regex2.test(fieldValue);var caseValue=item.attributes["item-switch-case"].value;if(bool===true||typeof fieldValue==="number"){if(caseValue.startsWith("lt"))caseValue=caseValue.replace("lt","<");if(caseValue.startsWith("gt"))caseValue=caseValue.replace("gt",">");if(caseValue.startsWith("le"))caseValue=caseValue.replace("le","<=");if(caseValue.startsWith("ge"))caseValue=caseValue.replace("ge",">=");if(caseValue.startsWith("eq"))caseValue=caseValue.replace("eq","==");if(caseValue.startsWith("ne"))caseValue=caseValue.replace("ne","!=");itemCase=fieldValue+caseValue}else if(bool===false){if(caseValue.startsWith("ne")){caseValue=caseValue.replace("ne ","").replace("ne","");itemCase='"'+caseValue+'"';itemCase+=' != "'+fieldValue+'"'}else{caseValue=caseValue.replace("eq ","").replace("eq","");itemCase='"'+caseValue+'"';itemCase+=' == "'+fieldValue+'"'}}if(eval(itemCase))return true;else return false}else if(_this.itemSwitchFunc){if(typeof _this.itemSwitchFunc==="function")var ret=_this.itemSwitchFunc(instance);var caseValue=item.attributes["item-switch-case"].value;if(caseValue==ret)return true;else return false}}},makeTreeItems:function(treeObj,level,thisModelIdObj,modelFieldName){var len=treeObj.length;var ret="";var isArray=false;var checkable=this.option.node.checkable;var checkString="";var checked=false;var imageString="";var innerElement="";var field="";var modelIdObj=!thisModelIdObj?this.itemModelObj:thisModelIdObj;var modelId=modelIdObj["modelId"];var isExpanded=this.option.view.expand;if(len>0){for(var i=0;i<len;i++){innerElement="";imageString="";var keys=Object.keys(treeObj[i]);var arrayKey=[];ret+="<li tabindex='-1' class='top-treeview-list level"+level;for(var j=0;j<keys.length;j++){if(treeObj[i][keys[j]]instanceof Array){isArray=true;arrayKey.push(keys[j])}}if(treeObj[i]["checked"]==="true"||treeObj[i]["checked"]===true){checked=true}if(checkable==="true"||checkable===true){checkString="<input type='checkbox' id='"+this.id+"_check_"+i+"' class='top-treeview-check' "+(checked?"checked":"")+"><label for='"+this.id+"_check_"+i+"'></label>"}var treeitem=this.getTreeItem(treeObj[i],modelId,modelFieldName);if(treeitem){if(treeitem.attributes["text"]){var modelField=treeitem.attributes["text"].value;modelField=modelField.substring(1,modelField.indexOf("}"));var innerElement=treeObj[i][modelField];field=modelField}else{var topWidget=/^TOP-[a-zA-Z]*/;var treeChildren=treeitem.querySelectorAll("*");var topWidgets=[];for(var j=0;j<treeChildren.length;j++)if(topWidget.test(treeChildren[j].tagName))topWidgets.push(treeChildren[j]);for(var index=0;index<topWidgets.length;index++){var attr=topWidgets[index].attributes;for(var j=0;j<attr.length;j++){for(var key in treeObj[i]){if(attr[j].value==="{"+key+"}"){innerElement=treeitem.children[0].outerHTML.replace(new RegExp(attr[j].nodeName+'="'+attr[j].nodeValue+'" | '+attr[j].nodeName+"='"+attr[j].nodeValue+"'"),attr[j].nodeName+'="'+treeObj[i][key]+'" ');field=key}}}}}var imageSrc=treeitem.getAttribute("image");if(imageSrc){if(imageSrc.startsWith("{")){imageSrc=imageSrc.replace("{","").replace("}","");imageSrc=treeObj[i][imageSrc]}if(imageSrc.startsWith("@drawable")){imageSrc=Top.DrawableManager.get(imageSrc.replace("@drawable/",""))}}imageString=treeitem.attributes["image"]?"<span class='top-treeview-image' style=' background:url("+imageSrc+") 0 0 no-repeat; background-size:contain;'></span>":""}else{for(var j=0;j<treeObj[j];j++){var key=treeObj[i][j];if(typeof treeObj[i][key]==="string"){innerElement+=treeObj[i][key];field=key}}}if(isArray){ret+=" parent "+(isExpanded?"expand":"collapse")+"'><input type='checkbox' class='top-treeview-button'"+(isExpanded?"":"checked")+"><i></i>"+checkString+"<label id='"+this.id+"_"+this.count+"' class='top-treeview-item' data-field='"+field+"'>"+imageString+innerElement+"</label><ul class='top-treeview-children_nav' style='display:"+(isExpanded?"block":"none")+";'>";this.count++;for(var j=0;j<arrayKey.length;j++){
if(modelId){ret+=this.makeTreeItems(treeObj[i][arrayKey[j]],level+1,modelIdObj[arrayKey[j]],modelFieldName)}else{ret+=this.makeTreeItems(treeObj[i][arrayKey[j]],level+1,modelIdObj[arrayKey[j]],arrayKey[j])}}ret+="</ul>"}else{ret+=" child'>"+checkString+"<a id='"+this.id+"_"+this.count+"'class='top-treeview-item' data-field='"+field+"'>"+imageString+innerElement+"</a>";this.count++}ret+="</li>";checked=false}}else{var keys=Object.keys(treeObj);var arrayKey=[];innerElement="";imageString="";ret+="<li tabindex='-1' class='top-treeview-list level"+level;for(var j=0;j<keys.length;j++){if(treeObj[keys[j]]instanceof Array){isArray=true;arrayKey.push(keys[j])}}if(treeObj["checked"]==="true"||treeObj["checked"]===true){checked=true}if(checkable==="true"||checkable===true){checkString="<input type='checkbox' id='"+this.id+"_check_"+i+"' class='top-treeview-check' "+(checked?"checked":"")+"><label for='"+this.id+"_check_"+i+"'></label>"}var treeitem=this.getTreeItem(treeObj,modelId,modelFieldName);if(treeitem){if(treeitem.attributes["text"]){var modelField=treeitem.attributes["text"].value;modelField=modelField.substring(1,modelField.indexOf("}"));var innerElement=treeObj[modelField];field=modelField}else{var topWidget=/^TOP-[a-zA-Z]*/;var treeChildren=treeitem.querySelectorAll("*");var topWidgets=[];for(var j=0;j<treeChildren.length;j++)if(topWidget.test(treeChildren[j].tagName))topWidgets.push(treeChildren[j]);for(var index=0;index<topWidgets.length;index++){var attr=topWidgets[index].attributes;for(var j=0;j<attr.length;j++){for(var l=0;l<treeObj.length;l++){var key=treeObj[l];if(attr[j].value==="{"+key+"}"){innerElement=treeitem.children[0].outerHTML.replace(new RegExp(attr[j].nodeName+'="'+attr[j].nodeValue+'" | '+attr[j].nodeName+"='"+attr[j].nodeValue+"'"),attr[j].nodeName+'="'+treeObj[key]+'" ');field=key}}}}}var imageSrc=treeitem.getAttribute("image");if(imageSrc){if(imageSrc.startsWith("{")){imageSrc=imageSrc.replace("{","").replace("}","");imageSrc=treeObj[imageSrc]}if(imageSrc.startsWith("@drawable")){imageSrc=Top.DrawableManager.get(imageSrc.replace("@drawable/",""))}}imageString=treeitem.attributes["image"]?"<span class='top-treeview-image' style=' background:url("+imageSrc+") 0 0 no-repeat; background-size:contain;'></span>":""}else{for(var key in treeObj){if(typeof treeObj[key]==="string"){innerElement+=treeObj[key];field=key}}}if(isArray){ret+=" parent "+(isExpanded?"expand":"collapse")+"'><input type='checkbox' class='top-treeview-button'"+(isExpanded?"":"checked")+"><i></i>"+checkString+"<label id='"+this.id+"_"+this.count+"' class='top-treeview-item' data-field='"+field+"'>"+imageString+innerElement+"</label><ul class='top-treeview-children_nav' style='display:"+(isExpanded?"block":"none")+";'>";this.count++;for(var j=0;j<arrayKey.length;j++){if(modelId){ret+=this.makeTreeItems(treeObj[arrayKey[j]],level+1,modelIdObj[arrayKey[j]],modelFieldName)}else{ret+=this.makeTreeItems(treeObj[arrayKey[j]],level+1,modelIdObj[arrayKey[j]],arrayKey[j])}}ret+="</ul>"}else{ret+=" child'>"+checkString+"<a id='"+this.id+"_"+this.count+"'class='top-treeview-item' data-field='"+field+"'>"+imageString+innerElement+"</a>";this.count++}ret+="</li>";checked=false}return ret},makeTreeNodes:function(treeObj,level){var len=treeObj.length;var _this=this;var ret="";var isParent=false;var icon,iconClass,image;var iString="";var isSetUnionI=false;var checkable=this.option.node.checkable;var editable=this.option.node.editable;var deletable=this.option.node.deletable;var checked=false;var isCheckDisabled=false;var checkString="";var editMenuString="";var isIncludedCustomMenu=false;var customMenuList={};var innerElement="";var isExpanded=this.option.view.expand;for(var key in this.option.view.menu){if(key!=="order"){isIncludedCustomMenu=true;var fnSelect=typeof this.option.view.menu[key]==="function"?this.option.view.menu[key]:Top.Util.namespace(this.option.view.menu[key],this);customMenuList[key]=fnSelect;if(this.option.view.menu.order.indexOf(key)<0){this.option.view.menu.order.push(key)}}}for(var i=0;i<len;i++){ret+="<li tabindex='-1' class='top-treeview-list level"+level;if(treeObj[i]["children"]!==undefined&&treeObj[i]["children"].length>0){isParent=true}var id=treeObj[i]["id"]!==null&&treeObj[i]["id"]!==undefined&&treeObj[i]["id"].toString()||treeObj[i]["value"]||treeObj[i]["text"];icon=treeObj[i]["icon"];iconClass=treeObj[i]["iconClass"];image=treeObj[i]["image"];if(treeObj[i]["checkable"]!==undefined&&treeObj[i]["checkable"]!==null){checkable=treeObj[i]["checkable"]}if(treeObj[i]["editable"]!==undefined&&treeObj[i]["editable"]!==null){editable=treeObj[i]["editable"]}if(treeObj[i]["deletable"]!==undefined&&treeObj[i]["deletable"]!==null){deletable=treeObj[i]["deletable"]}for(var key in customMenuList){if(treeObj[i][key]!==undefined&&treeObj[i][key]!==null){customMenuList[key]=treeObj[i][key]}}customMenuList["edit"]=editable;customMenuList["delete"]=deletable;if(treeObj[i]["checked"]==="true"||treeObj[i]["checked"]===true){checked=true}if(this.option.node.checkDisabled!==false){if(typeof this.option.node.checkDisabled==="function"){isCheckDisabled=this.option.node.checkDisabled(treeObj[i])}else if(this.option.node.checkDisabled instanceof Array){for(var z=0;z<this.option.node.checkDisabled.length;z++){if(id===this.option.node.checkDisabled[z])isCheckDisabled=true}}else if(this.option.node.checkDisabled==="true"||this.option.node.checkDisabled===true){isCheckDisabled=true}}if(isParent){if(this.option.view.showIcon||this.option.view.showImage){if(!icon&&!image){if(this.option.view.showIcon)icon=this.option.view.groupIcon;else if(this.option.view.showImage)image=this.option.view.groupImage;isSetUnionI=true}if(isSetUnionI){iString=icon?"<span class='top-treeview-icon "+icon+" "+iconClass+"' i-type='union'></span>":"<span class='top-treeview-image' style=' background:url("+image+") 0 0 no-repeat; background-size:contain;' i-type='union'></span>"}else{iString=icon?"<span class='top-treeview-icon "+icon+" "+iconClass+"'></span>":"<span class='top-treeview-image' style=' background:url("+image+") 0 0 no-repeat; background-size:contain;'></span>"}}if(checkable==="true"||checkable===true){checkString="<input type='checkbox' id='"+this.id+"_check_"+i+"' class='top-treeview-check' "+(checked?"checked":"")+(isCheckDisabled?" disabled":"")+"><label for='"+this.id+"_check_"+i+"'></label>"}if(typeof this.option.view.layout==="function")editable=false;if(editable==="true"||editable===true||deletable==="true"||deletable===true||isIncludedCustomMenu===true){editMenuString="<span class='top-treeview-edit_btn' style='visibility:hidden;'><ul class='top-treeview-edit_nav'>";for(var index=0;index<this.option.view.menu.order.length;index++){var item=this.option.view.menu.order[index];if(customMenuList[item]!==false&&customMenuList[item]!=="false"){var language=_this.__i18n(_this.option.view.language[item]);if(item!=="edit"&&item!=="delete"){editMenuString+='<li class="top-treeview-'+item+'">'+language+"</li>"}else if(item==="edit"&&typeof this.option.view.layout==="function"){}else{editMenuString+='<li class="top-treeview-'+item+'">'+language+"</li>"}}}editMenuString+="</ul></span>"}if(typeof this.option.view.layout==="function"){innerElement=this.option.view.layout(treeObj[i])}else innerElement=treeObj[i]["text"];if(innerElement==="")innerElement=" ";ret+=" parent "+(isExpanded?"expand":"collapse")+"'><input type='checkbox' class='top-treeview-button' "+(isExpanded?"":"checked")+"><i></i>"+checkString+"<label  id='"+id+"' class='top-treeview-item'>"+iString+editMenuString+innerElement+"</label><ul class='top-treeview-children_nav' style='display:"+(isExpanded?"block":"none")+";'>";ret+=this.makeTreeNodes(treeObj[i]["children"],level+1);ret+="</ul>";checkable=this.option.node.checkable;editable=this.option.node.editable;deletable=this.option.node.deletable;checked=false;isCheckDisabled=false;checkString="";editMenuString=""}else{if(this.option.view.showIcon||this.option.view.showImage){if(!icon&&!image){if(this.option.view.showIcon)icon=this.option.view.childIcon;else if(this.option.view.showImage)image=this.option.view.childImage;isSetUnionI=true}if(isSetUnionI){iString=icon?"<span class='top-treeview-icon "+icon+" "+iconClass+"' i-type='union'></span>":"<span class='top-treeview-image' style=' background:url("+image+") 0 0 no-repeat; background-size:contain;' i-type='union'></span>"}else{iString=icon?"<span class='top-treeview-icon "+icon+" "+iconClass+"'></span>":"<span class='top-treeview-image' style=' background:url("+image+") 0 0 no-repeat; background-size:contain;'></span>"}}if(checkable==="true"||checkable===true){checkString="<input type='checkbox' id='"+this.id+"_check_"+i+"' class='top-treeview-check' "+(checked?"checked":"")+(isCheckDisabled?" disabled":"")+" ><label for='"+this.id+"_check_"+i+"'></label>"}if(editable==="true"||editable===true||deletable==="true"||deletable===true||isIncludedCustomMenu===true){editMenuString="<span class='top-treeview-edit_btn'  style='visibility:hidden;'><ul class='top-treeview-edit_nav'>";for(var index=0;index<this.option.view.menu.order.length;index++){var item=this.option.view.menu.order[index];if(customMenuList[item]!==false&&customMenuList[item]!=="false"){var language=_this.__i18n(_this.option.view.language[item]);if(item!=="edit"&&item!=="delete"){editMenuString+='<li class="top-treeview-'+item+'">'+language+"</li>"}else{editMenuString+='<li class="top-treeview-'+item+'">'+language+"</li>"}}}editMenuString+="</ul></span>"}if(typeof this.option.view.layout==="function"){innerElement=this.option.view.layout(treeObj[i])}else innerElement=treeObj[i]["text"];if(innerElement==="")innerElement=" ";ret+=" child'>"+checkString+"<a id='"+id+"' class='top-treeview-item'>"+iString+editMenuString+innerElement+"</a>";checkable=this.option.node.checkable;editable=this.option.node.editable;deletable=this.option.node.deletable;checked=false;isCheckDisabled=false;checkString="";editMenuString=""}ret+="</li>";isParent=false}return ret},appendItems:function(treeObj,level,index){if(treeObj instanceof Array){var len=treeObj.length;if(index){if(typeof index==="number")var itemTag=this.querySelectorAll(".level"+level+" > .top-treeview-item")[index];else{var parentElem=index instanceof NodeList?index[0].parentNode:index.parentNode;var itemTag=parentElem.querySelectorAll(".level"+level+" > .top-treeview-item")}}else var itemTag=this.querySelectorAll(".level"+level+" > .top-treeview-item");var availableTag=[];for(var i=0;i<itemTag.length;i++){if(itemTag[i].childNodes.length===0||itemTag.childNodes&&itemTag.childNodes[0].tagName==="SPAN")availableTag.push(itemTag[i])}for(var i=0;i<len;i++){for(var j=0;j<treeObj[i].length;j++){var key=treeObj[i][j];if(treeObj[i][key]instanceof Array){this.appendItems(treeObj[i][key],level+1)}else{if(key==="includedIcon"){var image_span=document.createElement("span");image_span.classList.add("top-treeview-image");image_span.style.background="url("+treeObj[i].includedIcon+") 0 0 no-repeat";image_span.style.backgroundSize="contain";availableTag[i].insertBefore(image_span,availableTag[i].firstChild)}if(treeObj[i].includedLayout){var cloneNode=treeObj[i].includedLayout.cloneNode(true);if(availableTag[i].childNodes.length===0||availableTag[i].childElementCount==="1"&&availableTag[i].childNodes[0].tagName==="SPAN"){availableTag[i].appendChild(cloneNode)}var topWidget=/^TOP-[a-zA-Z]*/;var treeChildren=availableTag[i].querySelectorAll("*");var topWidgets=[];for(var j=0;j<treeChildren.length;j++)if(topWidget.test(treeChildren[j].tagName))topWidgets.push(treeChildren[j]);$.each(topWidgets,function(index){var attr=topWidgets[index].attributes;for(var j=0;j<attr.length;j++){if(attr[j].value==="{"+key+"}"){topWidgets[index].setAttribute(attr[j].name,treeObj[i][key]);topWidgets[index].__updateProperties(attr[j].name)}}})}else if(key!=="includedIcon"){availableTag[i].appendChild(treeObj[i][key])}}}}}else{if(index!==null||index!==undefined){if(typeof index==="number"){var itemTag=this.querySelectorAll(".level"+level+" > .top-treeview-item")[index]}else{var parentElem=index instanceof NodeList?index[0].parentNode:index.parentNode;var itemTag=parentElem.querySelectorAll(".level"+level+" > .top-treeview-item")}}else var itemTag=this.querySelectorAll(".level"+level+" > .top-treeview-item");for(var k=0;k<treeObj.length;k++){var key=treeObj[k];if(treeObj[key]instanceof Array){this.appendItems(treeObj[key],level+1,itemTag)}else{if(key==="includedIcon"){var image_span=document.createElement("span");image_span.classList.add("top-treeview-image");image_span.style.background="url("+treeObj.includedIcon+") 0 0 no-repeat";image_span.style.backgroundSize="contain";itemTag.insertBefore(image_span,itemTag.firstChild)}if(treeObj.includedLayout){var cloneNode=treeObj.includedLayout.cloneNode(true);if(itemTag.childNodes.length===0||itemTag.childElementCount==="1"&&itemTag.childNodes[0].tagName==="SPAN"){itemTag.appendChild(cloneNode)}var topWidget=/^TOP-[a-zA-Z]*/;var treeChildren=itemTag.querySelectorAll("*");var topWidgets=[];for(var j=0;j<treeChildren.length;j++)if(topWidget.test(treeChildren[j].tagName))topWidgets.push(treeChildren[j]);$.each(topWidgets,function(index){var attr=topWidgets[index].attributes;for(var j=0;j<attr.length;j++){if(attr[j].value==="{"+key+"}"){topWidgets[index].setAttribute(attr[j].name,treeObj[key]);topWidgets[index].__updateProperties(attr[j].name)}}})}else if(key!=="includedIcon"){itemTag.appendChild(treeObj[key])}}}}},attachEventHandler:function(){var _this=this;var fnNodeSelected=this.option.event.onNodeclick;var fnNodeHover=this.option.event.onNodehover;var fnNodeCheck=this.option.event.onNodecheck;var fnNodeDblclick=this.option.event.onNodedblclick;$(this).find(" .top-treeview-container .top-treeview-button").off("change").on("change",function(e){var parent_li=this.parentNode;var thisItem=parent_li.getElementsByClassName("top-treeview-item")[0];var children_ul=thisItem.nextSibling;var thisNodeData=thisItem.dataObj;this.setAttribute("checked",this.checked);if(this.checked){children_ul.style.display="none";children_ul.classList.add("collapse");children_ul.classList.remove("expand");_this.__dispatchEvent(new CustomEvent("collapse",{detail:{data:thisNodeData}}))}else{children_ul.style.display="block";children_ul.classList.add("expand");children_ul.classList.remove("collapse");_this.__dispatchEvent(new CustomEvent("expand",{detail:{data:thisNodeData}}))}e.preventDefault()});$(this).find(" .top-treeview-container .top-treeview-button+i").off("click").on("click",function(e){if(this.previousSibling.checked){this.previousSibling.checked=false}else{this.previousSibling.checked=true}$(this.previousSibling).change();e.preventDefault()});var isDblclickAction;$(this).find(" .top-treeview-container .top-treeview-item").off("dblclick").on("dblclick",function(e){_this.clickedItemIndex=this.getAttribute("data-index");if(_this.userNodes){_this.dblclickedNode=this.dataObj;if(typeof fnNodeDblclick==="function"){fnNodeDblclick(e.originalEvent,Top.Dom.selectById(_this.id),_this.dblclickedNode)}}else if(_this.items){_this._index=0;_this.dblclickedNode=_this.__findItemByField(_this.items,this.getAttribute("data-field"),this.innerText,_this.clickedItemIndex);if(typeof fnNodeDblclick==="function")fnNodeDblclick(event,Top.Dom.selectById(_this.id))}if(this.parentNode&&this.parentNode.classList.contains("parent")&&(_this.option.node.toggleClickCount===2||_this.option.node.toggleClickCount==="2")){var button_input=this.parentNode.getElementsByClassName("top-treeview-button")[0];if(button_input.checked)button_input.checked=false;else button_input.checked=true;$(button_input).change()}e.preventDefault()});var lastClickedIndex,lastClickedType,firstClickedIndex;$(this).find(" .top-treeview-container .top-treeview-item").off("click").on("click",function(e){var thisClickedIndex=this.getAttribute("data-index");if(_this.itemClicktype==="select"){if(e.shiftKey||e.ctrlKey){if(e.shiftKey){if(!lastClickedIndex)lastClickedIndex=0;if(!firstClickedIndex)firstClickedIndex=0;if(lastClickedType=="ctrl"||parseInt(lastClickedIndex)>parseInt(firstClickedIndex)&&parseInt(thisClickedIndex)<parseInt(firstClickedIndex)||parseInt(lastClickedIndex)<parseInt(firstClickedIndex)&&parseInt(thisClickedIndex)>parseInt(firstClickedIndex)){var selectedList=_this.querySelectorAll(".top-treeview-list.selected");for(var tmp=0;tmp<selectedList.length;tmp++){selectedList[tmp].classList.remove("selected")}var selectedItem=_this.querySelectorAll(".top-treeview-item.selected");for(var tmp=0;tmp<selectedItem.length;tmp++){selectedItem[tmp].classList.remove("selected")}lastClickedIndex=firstClickedIndex}var selectedElement=_this.querySelector(".top-treeview-item[data-index='"+lastClickedIndex+"']");if(thisClickedIndex!==lastClickedIndex){var dataIndex=lastClickedIndex;while(true){if(selectedElement!==undefined&&selectedElement!==null){selectedElement.parentNode.classList.add("selected");selectedElement.classList.add("selected")}if(selectedElement.getAttribute("data-index")===thisClickedIndex)break;if(parseInt(thisClickedIndex)>parseInt(lastClickedIndex)){dataIndex++;selectedElement=_this.querySelector(".top-treeview-item[data-index='"+dataIndex+"']")}else{dataIndex--;selectedElement=_this.querySelector(".top-treeview-item[data-index='"+dataIndex+"']")}}}else if(thisClickedIndex===lastClickedIndex){if(selectedElement!==undefined&&selectedElement!==null){selectedElement.parentNode.classList.add("selected");selectedElement.classList.add("selected")}}lastClickedType="shift"}else if(e.ctrlKey){this.parentNode.classList.toggle("selected");this.classList.toggle("selected");lastClickedType="ctrl";firstClickedIndex=thisClickedIndex}var allNodeHasSelected=_this.querySelectorAll(".top-treeview-item.selected");_this.selectedNode=[];for(var l=0;l<allNodeHasSelected.length;l++){var item=allNodeHasSelected[l];if(_this.userNodes){_this.selectedNode.push(item.dataObj)}else if(_this.items){_this._index=0;_this.selectedNode.push(_this.__findItemByField(_this.items,item.getAttribute("data-field"),item.innerText,item.getAttribute("data-index")))}}lastClickedIndex=thisClickedIndex}else{var treeviewList=_this.querySelectorAll(".top-treeview-list.selected");for(var l=0;l<treeviewList.length;l++){if(treeviewList[l]!==null&&treeviewList[l]!==undefined)treeviewList[l].classList.remove("selected")}var treeviewItem=_this.querySelectorAll(".top-treeview-item.selected");for(var l=0;l<treeviewItem.length;l++){if(treeviewItem[l]!==null&&treeviewItem[l]!==undefined)treeviewItem[l].classList.remove("selected")}this.parentNode.classList.add("selected");this.classList.add("selected");_this._index=0;_this.selectedNode=this.dataObj||_this.__findItemByField(_this.items,this.getAttribute("data-field"),this.innerText,this.getAttribute("data-index"));lastClickedIndex=thisClickedIndex;lastClickedType="";firstClickedIndex=thisClickedIndex}_this.selectedItemIndex=lastClickedIndex}else if(_this.itemClicktype==="click"){_this.clickedItemIndex=this.getAttribute("data-index");_this._index=0;_this.clickedNode=this.dataObj||_this.__findItemByField(_this.items,this.getAttribute("data-field"),this.innerText,this.getAttribute("data-index"))}if(_this.userNodes){if(typeof fnNodeSelected==="function"){if(_this.itemClicktype==="select"){fnNodeSelected(e.originalEvent,Top.Dom.selectById(_this.id),_this.selectedNode)}else if(_this.itemClicktype==="click"){fnNodeSelected(e.originalEvent,Top.Dom.selectById(_this.id),_this.clickedNode)}}}else if(_this.items){if(typeof fnNodeSelected==="function")fnNodeSelected(event,Top.Dom.selectById(_this.id))}if(this.parentNode!==undefined){if(this.parentNode.classList.contains("parent")&&(_this.option.node.toggleClickCount===1||_this.option.node.toggleClickCount==="1")){var button_input=this.parentNode.querySelector(".top-treeview-button");if(button_input.checked)button_input.checked=false;else button_input.checked=true;$(button_input).change()}}});$(this).find(" .top-treeview-container .top-treeview-item").off("mouseenter").on("mouseenter",function(e){if(this.querySelector(".top-treeview-edit_btn")){this.querySelector(".top-treeview-edit_btn").style.visibility="visible"}_this._index=0;_this.hoverNode=this.dataObj||_this.__findItemByField(_this.items,this.getAttribute("data-field"),this.innerText,this.getAttribute("data-index"));if(typeof fnNodeHover==="function")fnNodeHover(e.originalEvent,Top.Dom.selectById(_this.id),_this.hoverNode);e.preventDefault()});$(this).find(" .top-treeview-container .top-treeview-item").off("mouseleave").on("mouseleave",function(e){if(this.getElementsByClassName("top-treeview-edit_btn")[0]){this.getElementsByClassName("top-treeview-edit_btn")[0].style.visibility="hidden";this.getElementsByClassName("top-treeview-edit_btn")[0].classList.remove("selected");this.querySelector(".top-treeview-edit_btn .top-treeview-edit_nav").style.display="none"}e.preventDefault()});if(this.option.event.onNodecontextmenu){$(this).find(" .top-treeview-container .top-treeview-item").off("contextmenu").on("contextmenu",function(e){var result=true;if(typeof _this.option.event.onNodecontextmenu==="function"){result=_this.option.event.onNodecontextmenu(e.originalEvent,Top.Dom.selectById(_this.id),this.dataObj)}if(result===false){e.preventDefault()}})}var allNodeHasChecked=$(_this.querySelectorAll(".top-treeview-check:checked")).parent().find("> .top-treeview-item");_this.checkedNode=[];for(var index=0;index<allNodeHasChecked.length;index++){var item=allNodeHasChecked[index];if(_this.userNodes){if(item.dataObj!==undefined){_this.checkedNode.push(item.dataObj)}else{_this.checkedNode.push(_this.__findNodeById(_this.nodes,item.id))}}else if(_this.items){_this._index=0;_this.checkedNode.push(_this.__findItemByField(_this.items,item.getAttribute("data-field"),item.innerText,item.getAttribute("data-index")))}}for(var k=0;k<_this.checkedNode.length;k++){var item=_this.checkedNode[k];item.checked=true}$(this).find(" .top-treeview-list .top-treeview-check:not([disabled])").off("change").on("change",function(e){if(_this.option.node.checkInherit){var parent_list=this.parentNode;if(parent_list.classList.contains("parent")){var children_check=parent_list.querySelectorAll("ul.top-treeview-children_nav .top-treeview-check:not([disabled])");for(var i=0;i<children_check.length;i++){if(children_check[i].parentNode.parentNode.parentNode.querySelector(".top-treeview-check").getAttribute("disabled")==null){if(this.checked){$(children_check[i]).prop("checked",true)}else{$(children_check[i]).prop("checked",false)}}var checkedNode=children_check[i].nextSibling.nextSibling.dataObj;if(checkedNode)checkedNode.checked=this.checked}}if(!parent_list.classList.contains("level0")&&_this.option.node.checkInheritParent){var parents_list=$(this).parents("li.top-treeview-list.parent");if(this.checked){for(var i=0;i<parents_list.length;i++){var level=parents_list[i].className.match(/[0-9]+/g)[0];level=parseInt(level);var sibling_check=parents_list[i].querySelectorAll("ul.top-treeview-children_nav > li.level"+(level+1)+"> .top-treeview-check");for(var j=0;j<sibling_check.length;j++){if(sibling_check[j].checked)continue;else break}if(j===sibling_check.length){var parent_check=$(parents_list[i]).find("> .top-treeview-check:not([disabled])")[0];if(parent_check&&!parent_check.checked){parent_check.checked=true;var checkedNode=parent_check.nextSibling.nextSibling.id.dataObj;if(checkedNode)checkedNode.checked=true}}}}else{for(var i=0;i<parents_list.length;i++){var parent_check=$(parents_list[i]).find("> .top-treeview-check:not([disabled])")[0];if(parent_check&&parent_check.checked){parent_check.checked=false;var checkedNode=parent_check.nextSibling.nextSibling.dataObj;if(checkedNode)checkedNode.checked=false}}}}}var allNodeHasChecked=$(_this.querySelectorAll(".top-treeview-check:checked")).parent().find("> .top-treeview-item");_this.checkedNode=[];for(var index=0;index<allNodeHasChecked.length;index++){var item=allNodeHasChecked[index];if(_this.userNodes){_this.checkedNode.push(item.dataObj)}else if(_this.items){_this._index=0;_this.checkedNode.push(_this.__findItemByField(_this.items,item.getAttribute("data-field"),item.innerText,item.getAttribute("data-index")))}}var thisCheckedNode=this.nextSibling.nextSibling.dataObj;if(thisCheckedNode)thisCheckedNode.checked=this.checked;if(typeof fnNodeCheck==="function")fnNodeCheck(e.originalEvent,Top.Dom.selectById(_this.id),thisCheckedNode);e.preventDefault()});$(this).find(" .top-treeview-item .top-treeview-edit_btn").off("mouseenter").on("mouseenter",function(e){e.stopPropagation()});$(this).find(" .top-treeview-item .top-treeview-edit_btn .top-treeview-edit_nav").off("mouseenter").on("mouseenter",function(e){e.stopPropagation()});$(this).find(" .top-treeview-item .top-treeview-edit_btn").off("click").on("click",function(e){e.preventDefault();var navElem=this.querySelector(".top-treeview-edit_nav");if(this.classList.contains("selected")){this.classList.remove("selected");navElem.style.display="none";navElem.style.top="";navElem.style.left="";navElem.style.right=""}else{this.classList.add("selected");navElem.style.display="block";navElem.style.top=this.getBoundingClientRect().top+this.getBoundingClientRect().height+"px";navElem.style.left=this.getBoundingClientRect().left+"px";var calcedRight=navElem.getBoundingClientRect().right-document.documentElement.width;if(calcedRight>0){calcedRight=Math.abs(this.getBoundingClientRect().right-document.documentElement.width);navElem.style.left="";navElem.style.right=calcedRight+"px"}}e.stopPropagation()});$(this).find(" .top-treeview-item .top-treeview-edit_btn").off("dblclick").on("dblclick",function(e){e.stopPropagation()});$(this).find(" .top-treeview-item .top-treeview-edit_btn .top-treeview-edit").off("click").on("click",function(e){e.preventDefault();if(_this.option.view.layout===null){var thisItem=this.parentNode.parentNode.parentNode;for(var i=0;i<thisItem.childNodes.length;i++){if(thisItem.childNodes[i].nodeName==="#text"){var thisItemText=thisItem.childNodes[i].nodeValue}}var editBtn=this.parentNode.parentNode;var textElement=editBtn.nextSibling;textElement.parentNode.removeChild(textElement);var itemInput=document.createElement("input");itemInput.classList.add("top-treeview-edit_input");itemInput.setAttribute("type","text");itemInput.setAttribute("value",thisItemText);thisItem.appendChild(itemInput);var $inputElement=$(thisItem).find(".top-treeview-edit_input");var inputLength=$inputElement.val().length||5;$inputElement.attr("size",inputLength);$inputElement.focus();$inputElement.on("dblclick",function(e){e.stopPropagation()}).on("mousedown",function(e){e.stopPropagation()}).on("keypress",function(e){if(e.keyCode===13){_this.editNodeText(thisItem.id,$(this).val())}}).on("focusout",function(e){_this.editNodeText(thisItem.id,$(this).val())})}});if(_this.option.node.deletable===true||_this.option.node.deletable==="true")$(this).find(" .top-treeview-item .top-treeview-edit_btn .top-treeview-delete").off("click").on("click",function(e){var thisItem=this.parentNode.parentNode.parentNode;var toBeRemovedData=thisItem.dataObj;var result=true;if(typeof _this.option.event.onNodedelete==="function"){result=_this.option.event.onNodedelete(Top.Dom.selectById(_this.id),toBeRemovedData)}if(result!==false){_this.removeNodes(thisItem.id)}});$(this).find(" .top-treeview-item .top-treeview-edit_btn li:not(.top-treeview-delete):not(.top-treeview-edit)").off("click").on("click",function(e){var thisCustomMenuKey=this.className.replace("top-treeview-","");var nodeItem=$(this).closest(".top-treeview-item")[0];var fnSelect=typeof _this.option.view.menu[thisCustomMenuKey]==="function"?_this.option.view.menu[thisCustomMenuKey]:Top.Util.namespace(_this.option.view.menu[thisCustomMenuKey],_this);if(typeof fnSelect==="function"){fnSelect(Top.Dom.selectById(_this.id),nodeItem.dataObj)}});if(this.option.node.draggable==="true"||this.option.node.draggable===true){var fnNodeDrag=this.option.event.onNodedrag;var fnNodeDrop=this.option.event.onNodedrop;var fnNodeDragstart=this.option.event.onNodedragstart;var fnNodeDragend=this.option.event.onNodedragend;var fnNodeDragenter=this.option.event.onNodedragenter;var fnNodeDragover=this.option.event.onNodedragover;var fnNodeDragleave=this.option.event.onNodedragleave;var selected=null;var coordinates=[],mousex,mousey;var droppedElement=null;var afterElement=null;var treeContainer=_this.querySelector(" .top-treeview-container");var shadowRoot=this.querySelector(".top-treeview-root");$(document).on("dragover","#"+this.id+" *",function(e){if(e.originalEvent.preventDefault){e.originalEvent.preventDefault()}e.originalEvent.dataTransfer.dropEffect="move";if(typeof fnNodeDragover==="function")fnNodeDragover(e.originalEvent,Top.Dom.selectById(_this.id))});$(document).off("dragleave","#"+this.id+" .top-treeview-list").on("dragleave","#"+this.id+" .top-treeview-list",function(e){if(e.originalEvent.preventDefault){e.originalEvent.preventDefault()}e.stopPropagation();if(typeof fnNodeDragleave==="function")fnNodeDragleave(e.originalEvent,Top.Dom.selectById(_this.id))});$(document).off("dragenter","#"+this.id+" .top-treeview-list").on("dragenter","#"+this.id+" .top-treeview-list",function(e){if(e.originalEvent.preventDefault){e.originalEvent.preventDefault()}e.stopPropagation();if(typeof fnNodeDragenter==="function")fnNodeDragenter(e.originalEvent,Top.Dom.selectById(_this.id))});$(document).off("dragstart","#"+this.id+" .top-treeview-list").on("dragstart","#"+this.id+" .top-treeview-list",function(e){this.ondrag=_moveElem;this.ondragend=_destroy;selected=this;$(_this.querySelectorAll(" .top-treeview-item")).each(function(){var lefttop=$(this).offset();coordinates.push({dom:$(this),left:lefttop.left,top:lefttop.top,right:lefttop.left+$(this).width(),bottom:lefttop.top+$(this).height()})});var thisInnerHTML=this.querySelector(".top-treeview-item").innerHTML;var draggedNode_span=document.querySelector(".top-treeview-draggedNode");draggedNode_span.innerHTML=thisInnerHTML;draggedNode_span.style.width=this.querySelector(".top-treeview-item").offsetWidth+"px";if(!Top.Util.Browser.isIE())e.originalEvent.dataTransfer.setDragImage(draggedNode_span,0,0);e.originalEvent.dataTransfer.effectAllowed="move";e.stopPropagation();if(typeof fnNodeDragstart==="function"){var event=e.originalEvent;event.targetNode=this.querySelector(".top-treeview-item").dataObj;fnNodeDragstart(event,Top.Dom.selectById(_this.id),event.targetNode)}});function getItemOffset(elem,type){var offset=0;do{if(elem===shadowRoot)break;if(type==="top"){if(!isNaN(elem.offsetTop)){offset+=elem.offsetTop}}else if(type==="left"){if(!isNaN(elem.offsetLeft)){offset+=elem.offsetLeft}}}while(elem=elem.offsetParent);return offset}function _moveElem(e){if(selected==null)return;var draggedNode_span=document.querySelector(".top-treeview-draggedNode");var dropLine_span=_this.querySelector(" .top-treeview-dropline");if(Top.Util.Browser.isIE())draggedNode_span.style.display="none";else draggedNode_span.style.display="inline-block";draggedNode_span.style.top=e.pageY+5+"px";draggedNode_span.style.left=e.pageX+5+"px";for(var i=0;i<coordinates.length;i++){if(mousex>=coordinates[i].left&&mousex<=coordinates[i].right){if(mousey>=coordinates[i].top&&mousey<=coordinates[i].bottom){coordinates[i].dom.addClass("over");dropLine_span.style.display="none"}else{coordinates[i].dom.removeClass("over");if(mousey<coordinates[i].top){if(coordinates[i-1]&&coordinates[i-1].top===0){var parentBottom=coordinates[i-1].dom.parent().parent().parent().offset().top+coordinates[i-1].dom.parent().parent().parent().height();if(parentBottom<mousey){afterElement=coordinates[i].dom;dropLine_span.style.display="inline-block";dropLine_span.style.width=afterElement.width()+"px";dropLine_span.style.top=getItemOffset(coordinates[i].dom[0],"top")-2+"px";dropLine_span.style.left=getItemOffset(coordinates[i].dom[0],"left")+"px"}}else if(coordinates[i-1]&&mousey>coordinates[i-1].bottom){afterElement=coordinates[i].dom;dropLine_span.style.display="inline-block";
dropLine_span.style.width=afterElement.width()+"px";dropLine_span.style.top=getItemOffset(coordinates[i].dom[0],"top")-2+"px";dropLine_span.style.left=getItemOffset(coordinates[i].dom[0],"left")+"px"}}}}if(coordinates[i].dom.hasClass("over")&&selected.querySelector(".top-treeview-item")!==coordinates[i].dom[0]){droppedElement=coordinates[i].dom}}var overItem=document.querySelector("#"+_this.id+" .top-treeview-item.over");if(overItem===null)droppedElement=null;if(droppedElement!==null)afterElement=null;mousex=e.pageX;mousey=e.pageY;if(typeof fnNodeDrag==="function")fnNodeDrag(e.originalEvent,Top.Dom.selectById(_this.id),this.querySelector(".top-treeview-item").dataObj);if(!Top.Util.Browser.isIE())e.preventDefault()}function _destroy(e){if(selected==null)return;var tempElement=null;for(var i=0;i<coordinates.length;i++){coordinates[i].dom.removeClass("over")}var selectedDataObj=selected.querySelector(".top-treeview-item").dataObj;var dropReturn;var targetNode=null;if(typeof fnNodeDrop==="function"){if(droppedElement){targetNode=droppedElement[0].dataObj}else if(afterElement){targetNode=afterElement.closest("ul").prev()[0]===undefined?null:afterElement.closest("ul").prev()[0].dataObj}dropReturn=fnNodeDrop(e,Top.Dom.selectById(_this.id),selectedDataObj,targetNode)}if(dropReturn===false||dropReturn==="false"){document.querySelector(".top-treeview-draggedNode").style.display="none";_this.querySelector(".top-treeview-dropline").style.display="none";return false}if(droppedElement!==null||afterElement!==null){var selectedChildrenItem=selected.querySelectorAll(".top-treeview-item");for(var i=0;i<selectedChildrenItem.length;i++){if(droppedElement&&selectedChildrenItem[i]===droppedElement[0]){droppedElement=null;break}if(afterElement&&selectedChildrenItem[i]===afterElement[0]){afterElement=null;break}}}if(droppedElement!==null){if(droppedElement.parent().hasClass("child")){var droppedElementDataobj=droppedElement[0].dataObj;droppedElement.parent().removeClass("child");droppedElement.parent().addClass("parent");droppedElement.parent().prepend('<input type="checkbox" class="top-treeview-button"><i></i>');droppedElement.parent().find("> .top-treeview-button").prop("checked",false);droppedElement.parent().append("<ul class='top-treeview-children_nav'></ul>");tempElement=droppedElement.parent();droppedElement.replaceWith("<label id='"+droppedElement.attr("id")+"' class='top-treeview-item'>"+droppedElement.html()+"</label>");droppedElement=tempElement.find("> .top-treeview-item");droppedElement[0].dataObj=droppedElementDataobj;var droppedIcon=droppedElement.find("> .top-treeview-icon");var droppedImage=droppedElement.find("> .top-treeview-image");if(droppedIcon&&droppedIcon.attr("i-type")==="union"){droppedIcon.removeClass(_this.option.view.childIcon).addClass(_this.option.view.groupIcon)}else if(droppedImage&&droppedImage.attr("i-type")==="union"){droppedImage[0].style="background:url("+_this.option.view.groupImage+") 0 0 no-repeat; background-size:contain;"}}if(selected.parentNode.childElementCount===1&&selected.parentNode.previousSibling!==droppedElement[0]){tempElement=selected.parentNode.parentNode;var tempElementDataobj=tempElement.querySelector(".top-treeview-item").dataObj;tempElement.classList.remove("parent");tempElement.classList.add("child");$(tempElement).find("> .top-treeview-button").remove();$(tempElement).find("> i").remove();$(tempElement).find("> ul").remove();$(tempElement).find("> .top-treeview-item").replaceWith("<a id='"+$(tempElement).find("> .top-treeview-item").attr("id")+"' class='top-treeview-item'>"+$(tempElement).find("> .top-treeview-item").html()+"</a>");tempElement.querySelector(".top-treeview-item").dataObj=tempElementDataobj;var tempIcon=$(tempElement).find("> .top-treeview-item .top-treeview-icon");var tempImage=$(tempElement).find("> .top-treeview-item .top-treeview-image");if(tempIcon&&tempIcon.attr("i-type")==="union"){tempIcon.removeClass(_this.option.view.groupIcon).addClass(_this.option.view.childIcon)}else if(tempImage&&tempImage.attr("i-type")==="union"){tempImage[0].style="background:url("+_this.option.view.childImage+") 0 0 no-repeat; background-size:contain;"}tempElement=null}var copySelected=selected.cloneNode(true);var selectedDataObj=selected.querySelector(".top-treeview-item").dataObj;selected.parentNode.removeChild(selected);var level=droppedElement.parent()[0].className.match(/[0-9]+/g)[0];level=parseInt(level)+1;copySelected.className=copySelected.className.replace(/[0-9]+/g,level);var childrenList=copySelected.querySelectorAll(".top-treeview-list");for(var k=0;k<childrenList.length;k++){level=childrenList[k].parentNode.parentNode.className.match(/[0-9]+/g)[0];level=parseInt(level)+1;childrenList[k].className=childrenList[k].className.replace(/[0-9]+/g,level)}droppedElement.parent().find("> ul").append(copySelected);_this.__setNodeIndex();_this.attachEventHandler();$(copySelected).find(".top-treeview-item").mouseleave();copySelected.querySelector(".top-treeview-item").dataObj=selectedDataObj;if(_this.nodes){var selectedId=copySelected.querySelector(".top-treeview-item").id;var parentId=droppedElement[0].id;_this.__changeNodesObjectByDragging(_this.nodes,selectedId,parentId,null);_this.updateData("nodes")}}else if(afterElement!==null){var isAfterElementChagned=false;if(selected.parentNode.childElementCount===1){tempElement=selected.parentNode.parentNode;var tempElementDataobj=tempElement.querySelector(".top-treeview-item").dataObj;if(tempElement===afterElement[0].parentNode){isAfterElementChagned=true}tempElement.classList.remove("parent");tempElement.classList.add("child");$(tempElement).find("> .top-treeview-button").remove();$(tempElement).find("> i").remove();$(tempElement).find("> ul").remove();$(tempElement).find("> .top-treeview-item").replaceWith("<a id='"+$(tempElement).find("> .top-treeview-item").attr("id")+"' class='top-treeview-item'>"+$(tempElement).find("> .top-treeview-item").html()+"</a>");tempElement.querySelector(".top-treeview-item").dataObj=tempElementDataobj;var tempIcon=$(tempElement).find("> .top-treeview-item .top-treeview-icon");var tempImage=$(tempElement).find("> .top-treeview-item .top-treeview-image");if(tempIcon&&tempIcon.attr("i-type")==="union"){tempIcon.removeClass(_this.option.view.groupIcon).addClass(_this.option.view.childIcon)}else if(tempImage&&tempImage.attr("i-type")==="union"){tempImage[0].style="background:url("+_this.option.view.childImage+") 0 0 no-repeat; background-size:contain;"}if(isAfterElementChagned)afterElement=$(tempElement).find(" > .top-treeview-item");tempElement=null}var copySelected=selected.cloneNode(true);var selectedDataObj=selected.querySelector(".top-treeview-item").dataObj;selected.parentNode.removeChild(selected);var level=afterElement[0].parentNode.className.match(/[0-9]+/g)[0];copySelected.className=copySelected.className.replace(/[0-9]+/g,level);var childrenList=copySelected.querySelectorAll(".top-treeview-list");for(var k=0;k<childrenList.length;k++){level=childrenList[k].parentNode.parentNode.className.match(/[0-9]+/g)[0];level=parseInt(level)+1;childrenList[k].className=childrenList[k].className.replace(/[0-9]+/g,level)}$(copySelected).insertBefore(afterElement.parent());_this.__setNodeIndex();_this.attachEventHandler();$(copySelected).find(".top-treeview-item").mouseleave();copySelected.querySelector(".top-treeview-item").dataObj=selectedDataObj;if(_this.nodes){var selectedId=copySelected.querySelector(".top-treeview-item").id;if(afterElement.parent().parent()[0].previousSibling)var parentId=afterElement.parent().parent()[0].previousSibling.id;var nextSId=afterElement[0].id;_this.__changeNodesObjectByDragging(_this.nodes,selectedId,parentId,nextSId);_this.updateData("nodes")}}selected=null;mousex=0;mousey=0;coordinates=[];droppedElement=null;tempElement=null;afterElement=null;document.querySelector(".top-treeview-draggedNode").style.display="none";_this.querySelector(".top-treeview-dropline").style.display="none";e.preventDefault()}}},__setOptions:function(){if(this.option.node.draggable==="true"||this.option.node.draggable===true){var allListItem=this.querySelectorAll(".top-treeview-list");for(var o=0;o<allListItem.length;o++){allListItem[o].draggable=true}var draggedNode_span=document.querySelector(".top-treeview-draggedNode");if(!draggedNode_span){var dragedNode=document.createElement("span");dragedNode.classList.add("top-treeview-draggedNode");document.body.appendChild(dragedNode)}var tmp_dropline=document.createElement("span");tmp_dropline.classList.add("top-treeview-dropline");this.childRoot.appendChild(tmp_dropline)}if(this.userNodes)this.__setDataObjToItem();this.__setNodeIndex()},__setDataObjToItem:function(parentNode,level,parentElement){if(!parentNode)parentNode=this.userNodes;if(!level)level=0;if(!parentElement)parentElement=this;var items=parentElement.querySelectorAll(".top-treeview-list.level"+level+" > .top-treeview-item");for(var i=0;i<items.length;i++){items[i].dataObj=this.__findNodeById(parentNode,items[i].id);if(parentNode[i]&&parentNode[i].children){this.__setDataObjToItem(parentNode[i].children,level+1,items[i].parentNode)}}},__changeNodesObjectByDragging:function(nodes,childId,parentId,nextSId){var selectedNode,parentNode,nextSIndex;selectedNode=findNodeById(nodes,childId,true);parentNode=findNodeById(nodes,parentId,false);nextSIndex=findIndexById(nodes,nextSId)||null;if(parentNode&&selectedNode){setChildrenInParentNode(parentNode,selectedNode,nextSIndex);return}if(parentNode===undefined){setRootSiblingNode(selectedNode,nextSIndex)}function setRootSiblingNode(selectedNode,nextSIndex){nodes.splice(nextSIndex,0,selectedNode)}function findNodeById(obj,id,isFromChild){var node;for(var i=0,len=obj.length;i<len;i++){if(obj[i].id===id){node=obj[i];if(isFromChild){obj.splice(i,1)}return node}else if(!obj[i].id&&obj[i].value===id){node=obj[i];if(isFromChild){obj.splice(i,1)}return node}else if(!obj[i].id&&!obj[i].value&&obj[i].text===id){node=obj[i];if(isFromChild){obj.splice(i,1)}return node}else{if(obj[i].children){node=findNodeById(obj[i].children,id,isFromChild);if(node)return node}}}return node}function findIndexById(obj,id){var index;for(var i=0,len=obj.length;i<len;i++){if(obj[i].id===id){index=i;return index}else if(!obj[i].id&&obj[i].value===id){index=i;return index}else if(!obj[i].id&&!obj[i].value&&obj[i].text===id){index=i;return index}else{if(obj[i].children){index=findIndexById(obj[i].children,id);if(index)return index}}}return index}function setChildrenInParentNode(parentNode,childNode,nextSIndex){if(parentNode.children===undefined)parentNode.children=[];if(nextSIndex!==null){parentNode.children.splice(nextSIndex,0,childNode)}else{parentNode.children.push(childNode)}if(childNode.path!==undefined){childNode.path=parentNode.path?parentNode.path+"."+parentNode.id:parentNode.id}}},__setNodeIndex:function(){var items=this.querySelectorAll(".top-treeview-item");var topWidget=/^TOP-[a-zA-Z]*/;for(var i=0;i<items.length;i++){items[i].setAttribute("data-index",i);var treeChildren=items[i].querySelectorAll("*");var topWidgets=[];for(var j=0;j<treeChildren.length;j++){if(topWidget.test(treeChildren[j].tagName))topWidgets.push(treeChildren[j])}for(var j=0;j<topWidgets.length;j++){var _item=topWidgets[j];_item.id=_item.id+"_"+i;if(_item.tagName==="TOP-RADIOBUTTON"){if(_item.getAttribute("group-id")){_item.setAttribute("group-id",_item.getAttribute("group-id")+"_"+i)}}}if(items[i].previousSibling&&items[i].previousSibling.tagName==="LABEL"){var checkIndexReg=new RegExp(i+"$","g");if(!checkIndexReg.test(items[i].previousSibling.getAttribute("for"))){items[i].previousSibling.previousSibling.setAttribute("id",this.id+"_check_"+i);items[i].previousSibling.setAttribute("for",this.id+"_check_"+i)}}}},__reRender:function(){if(this.__initialized!==true)return;this.__initialize();if(this.selectedNode){if(this.selectedNode instanceof Array&&this.checkedNode.length>0){var selectedNodeIdArray=[];for(var i=0;i<this.selectedNode.length;i++){selectedNodeIdArray.push(this.selectedNode[i].id)}this.__selectNode(selectedNodeIdArray)}else{this.__selectNode(this.selectedNode.id)}}if(this.checkedNode){if(this.checkedNode instanceof Array&&this.checkedNode.length>0){var checkedNodeIdArray=[];for(var i=0;i<this.checkedNode.length;i++){checkedNodeIdArray.push(this.checkedNode[i].id)}this.__checkNode(selectedNodeIdArray)}else{this.__checkNode(this.checkedNode.id)}}},expandNode:function(nodeId,notRender){if(this.virtualScroll===true||this.virtualScroll==="true"){findExpand(this.nodes);function findExpand(node){for(var i=0;i<node.length;i++){if(node[i].children!==undefined){findExpand(node[i].children,nodeId)}if(node[i].id===nodeId){node[i].isExpanded=true;if(node[i].children!==undefined)for(var j=0;j<node[i].children.length;j++){node[i].children[j].isExpanded=true}}}}if(notRender!==true){this.flatNodes=this.__makeFlatNode(new Array,this.nodes);this.__createViewport(this.flatNodes.length,this.flatNodes)}}else{var selectedNode=$(this).find("#"+nodeId+".top-treeview-item")[0];if(selectedNode===undefined)return;var button_input=selectedNode.parentNode.querySelector(".top-treeview-button");var thisNodeData=selectedNode.dataObj;selectedNode.parentNode.classList.remove("collapse");selectedNode.parentNode.classList.add("expand");if(selectedNode.nextSibling)selectedNode.nextSibling.style.display="block";$(button_input).prop("checked",false);this.__dispatchEvent(new CustomEvent("expand",{detail:{data:thisNodeData}}))}},collapseNode:function(nodeId,notRender){if(this.virtualScroll===true||this.virtualScroll==="true"){findCollapse(this.nodes);function findCollapse(node){for(var i=0;i<node.length;i++){if(node[i].children!==undefined){findCollapse(node[i].children,nodeId)}if(node[i].id===nodeId){if(node[i].children!==undefined)setCollapse(node[i].children)}}}function setCollapse(node){for(var i=0;i<node.length;i++){node[i].isExpanded=false;if(node[i].children!==undefined)setCollapse(node[i].children)}}if(notRender!==true){this.flatNodes=this.__makeFlatNode(new Array,this.nodes);this.__createViewport(this.flatNodes.length,this.flatNodes)}}else{var selectedNode=$(this).find("#"+nodeId+".top-treeview-item")[0];if(selectedNode===undefined)return;var button_input=selectedNode.parentNode.querySelector(".top-treeview-button");var thisNodeData=selectedNode.dataObj;selectedNode.parentNode.classList.remove("expand");selectedNode.parentNode.classList.add("collapse");if(selectedNode.nextSibling)selectedNode.nextSibling.style.display="none";$(button_input).prop("checked",true);this.__dispatchEvent(new CustomEvent("collapse",{detail:{data:thisNodeData}}))}},expandAll:function(){if(this.virtualScroll===true||this.virtualScroll==="true"){expandVirtualNode(this.nodes);function expandVirtualNode(node){for(var i=0;i<node.length;i++){node[i].isExpanded=true;if(node[i].children!==undefined)expandVirtualNode(node[i].children)}}this.flatNodes=this.__makeFlatNode(new Array,this.nodes);this.__createViewport(this.flatNodes.length,this.flatNodes)}else{$(this.querySelectorAll(".top-treeview-list.parent")).removeClass("collapse");$(this.querySelectorAll(".top-treeview-list.parent")).addClass("expand");$(this.querySelectorAll(".top-treeview-list > ul")).css("display","block");$(this.querySelectorAll(".top-treeview-button")).prop("checked",false)}this.__dispatchEvent(new CustomEvent("expand",{detail:{data:this.userNodes}}))},collapseAll:function(){if(this.virtualScroll===true||this.virtualScroll==="true"){collapseVirtualNode(this.nodes,true);function collapseVirtualNode(node,isRoot){for(var i=0;i<node.length;i++){if(isRoot===false)node[i].isExpanded=false;else node[i].isExpanded=true;if(node[i].children!==undefined)collapseVirtualNode(node[i].children,false)}}this.flatNodes=this.__makeFlatNode(new Array,this.nodes);this.__createViewport(this.flatNodes.length,this.flatNodes)}else{$(this.querySelectorAll(".top-treeview-list.parent")).removeClass("expand");$(this.querySelectorAll(".top-treeview-list.parent")).addClass("collapse");$(this.querySelectorAll(".top-treeview-list ul")).css("display","none");$(this.querySelectorAll(".top-treeview-button")).prop("checked",true)}this.__dispatchEvent(new CustomEvent("collapse",{detail:{data:this.userNodes}}))},getItemData:function(){return this.itemData},getClickedItemIndex:function(){return this.clickedItemIndex},getSelectedItemIndex:function(){return this.selectedItemIndex},addNodes:function(parentId,newNodes,index){if(parentId===undefined){console.error("parameters is not defined!");return-1}if(newNodes===undefined){console.error("new node is not defined!");return-2}if(parentId!==null){var parentElem=$(this).find("#"+parentId+".top-treeview-item")[0];var parentLevel=parseInt(parentElem.parentNode.className.match(/[0-9]+/g)[0]);var parentElemDataObj=parentElem.dataObj;var appenString="";if(newNodes instanceof Array)appendString=this.makeTreeNodes(newNodes,parentLevel+1);else{var nodesArray=[];nodesArray.push(newNodes);appendString=this.makeTreeNodes(nodesArray,parentLevel+1)}var madeNodes=document.createElement("div");madeNodes.innerHTML=appendString;for(var k=0;k<madeNodes.children.length;k++){this.createHtmlObjects(madeNodes.children[k])}parentElem.parentNode.classList.contains("parent");if(parentElem.parentNode.classList.contains("parent")){var parent_nav=parentElem.parentNode.querySelector("ul.top-treeview-children_nav");if(index!==undefined&&parseInt(index)>=parent_nav.childElementCount)index=undefined;if(index===undefined){while(madeNodes.firstChild){parent_nav.appendChild(madeNodes.firstChild)}}else{while(madeNodes.firstChild){parent_nav.insertBefore(madeNodes.firstChild,parent_nav.children[index])}}}else{index=undefined;if(parentElem.parentNode!==undefined||parentElem.parentNode!==null){parentElem.parentNode.classList.add("parent");parentElem.parentNode.classList.remove("child");var tmp_input=document.createElement("input");tmp_input.setAttribute("type","checkbox");tmp_input.classList.add("top-treeview-button");var tmp_i=document.createElement("i");tmp_input.appendChild(tmp_i);parentElem.parentNode.insertBefore(tmp_input,parentElem.parentNode.firstChild);$(parentElem.parentNode).find("> .top-treeview-button").prop("checked",false);var tmp_ul=document.createElement("ul");tmp_ul.classList.add("top-treeview-children_nav");parentElem.parentNode.appendChild(tmp_ul);while(madeNodes.firstChild){tmp_ul.appendChild(madeNodes.firstChild)}}var tempElement=parentElem.parentNode;$(parentElem).replaceWith("<label id='"+$(parentElem).attr("id")+"' class='top-treeview-item'>"+$(parentElem).html()+"</label>");parentElem=$(tempElement).find("> .top-treeview-item")[0];parentElem.dataObj=parentElemDataObj;var parentElemIcon=$(parentElem).find("> .top-treeview-icon");var parentElemImage=$(parentElem).find("> .top-treeview-image");if(parentElemIcon&&parentElemIcon.attr("i-type")==="union"){parentElemIcon.removeClass(this.option.view.childIcon).addClass(this.option.view.groupIcon)}else if(parentElemImage&&parentElemImage.attr("i-type")==="union"){parentElemImage[0].style="background:url("+this.option.view.groupImage+") 0 0 no-repeat; background-size:contain;"}}this.createdItemWidgetAttachedCallback()}if(this.nodes){if(parentId!==null)this.__changeNodesObjectByAdding(this.nodes,newNodes,parentId,index);else this.nodes.push(newNodes);this.updateData("nodes")}if(this.userNodes){if(parentId!==null)setDataObjToNewNodes(newNodes,parentElemDataObj);function setDataObjToNewNodes(thisData,parentObj){if(thisData instanceof Array){for(var i=0;i<thisData.length;i++){setDataObjToNewNodes(thisData[i],parentObj)}}else{var childrenNode=$(parentElem.parentNode).find("#"+thisData.id)[0];if(!thisData.hasOwnProperty("path")){thisData.path=parentObj.path?parentObj.path+"."+parentObj.id:parentObj.id}childrenNode.dataObj=thisData;if(thisData.children){setDataObjToNewNodes(thisData.children,thisData)}}}}this.__setNodeIndex();this.__initialize();this.attachEventHandler()},removeNodes:function(nodeId){if(nodeId===undefined){console.error("node id is not defined!");return false}if(nodeId instanceof Array){for(var i=0;i<nodeId.length;i++){this.removeNodes(nodeId[i])}}else{var removedNode=$(this).find("#"+nodeId+".top-treeview-item")[0];if(removedNode===undefined){console.warn("cannot found node("+nodeId+") in treeview");return false}if(removedNode.parentNode.parentNode.childElementCount===1){tempElement=removedNode.parentNode.parentNode.parentNode;var parentElemDataObj=tempElement.querySelector(".top-treeview-item").dataObj;$(tempElement).removeClass("parent");$(tempElement).addClass("child");$(tempElement).find("> .top-treeview-button").remove();$(tempElement).find("> i").remove();$(tempElement).find("> ul").remove();$(tempElement).find("> .top-treeview-item").replaceWith("<a id='"+$(tempElement).find("> .top-treeview-item").attr("id")+"' class='top-treeview-item' data-field='"+$(tempElement).find("> .top-treeview-item").attr("data-field")+"'>"+$(tempElement).find("> .top-treeview-item").html()+"</a>");var parentElem=$(tempElement).find("> .top-treeview-item")[0];if(parentElem)parentElem.dataObj=parentElemDataObj;var tempIcon=$(tempElement).find("> .top-treeview-item .top-treeview-icon");var tempImage=$(tempElement).find("> .top-treeview-item .top-treeview-image");if(tempIcon&&tempIcon.attr("i-type")==="union"){tempIcon.removeClass(this.option.view.groupIcon).addClass(this.option.view.childIcon)}else if(tempImage&&tempImage.attr("i-type")==="union"){tempImage[0].style="background:url("+this.option.view.childImage+") 0 0 no-repeat; background-size:contain;"}tempElement=null}removedNode.parentNode.parentNode.removeChild(removedNode.parentNode)}if(this.nodes){this.__changeNodesObjectByRemoving(this.nodes,nodeId);this.updateData("nodes")}this.__setNodeIndex();this.attachEventHandler();return true},editNodeText:function(nodeId,text){if(this.virtualScroll===true||this.virtualScroll==="true"){findNode(this.nodes);function findNode(node){for(var i=0;i<node.length;i++){if(node[i].children!==undefined){findNode(node[i].children)}if(node[i].id===nodeId){node[i].text=text}}}}else{var editedNode=$(this).find("#"+nodeId+".top-treeview-item")[0];if(editedNode===undefined)return;for(var i=0;i<editedNode.childNodes.length;i++){if(editedNode.childNodes[i].nodeName==="#text"){editedNode.childNodes[i].nodeValue=text}else if(editedNode.childNodes[i].tagName==="INPUT"&&editedNode.childNodes[i].className==="top-treeview-edit_input"){$(editedNode.childNodes[i]).remove();var newTextElement=document.createTextNode(text);editedNode.appendChild(newTextElement)}}if(this.nodes){this.__changeNodesObjectByEditing(this.nodes,nodeId,text,"text");this.updateData("nodes")}var editedData=editedNode.dataObj;if(editedData&&editedData.text)editedData.text=text;if(typeof this.option.event.onNodeedit==="function")this.option.event.onNodeedit(Top.Dom.selectById(this.id),editedData,"text")}},editNodeId:function(nodeId,newId){var editedNode=$(this).find("#"+nodeId+".top-treeview-item")[0];if(editedNode){editedNode.id=newId}if(this.nodes){this.__changeNodesObjectByEditing(this.nodes,nodeId,newId,"id");this.updateData("nodes")}var editedData=editedNode.dataObj;if(editedData&&editedData.id)editedData.id=newId;if(typeof this.option.event.onNodeedit==="function")this.option.event.onNodeedit(Top.Dom.selectById(this.id),editedData,"id")},__changeNodesObjectByAdding:function(nodes,newNodes,parentId,addedIndex){for(var i=0,len=nodes.length;i<len;i++){if(nodes[i].id==parentId){if(nodes[i].children&&nodes[i].children.length>0){var path=nodes[i].children[0].path;newNodes.path=path;if(newNodes instanceof Array){for(var j=0;j<newNodes.length;j++){if(addedIndex===undefined)nodes[i].children.push(newNodes[j]);else nodes[i].children.splice(addedIndex,0,newNodes[j])}}else{if(addedIndex===undefined)nodes[i].children.push(newNodes);else nodes[i].children.splice(addedIndex,0,newNodes)}}else{nodes[i].children=[];var path=nodes[i].path?nodes[i].path+"."+nodes[i].id:nodes[i].id;newNodes.path=path;if(newNodes instanceof Array){for(var j=0;j<newNodes.length;j++){if(addedIndex===undefined)nodes[i].children.push(newNodes[j]);else nodes[i].children.splice(addedIndex,0,newNodes[j])}}else{if(addedIndex===undefined)nodes[i].children.push(newNodes);else nodes[i].children.splice(addedIndex,0,newNodes)}}}else{if(nodes[i].children){this.__changeNodesObjectByAdding(nodes[i].children,newNodes,parentId,addedIndex)}}}},__changeNodesObjectByRemoving:function(nodes,nodeId){for(var i=0,len=nodes.length;i<len;i++){if(nodes[i].id==nodeId){nodes.splice(i,1);return}else{if(nodes[i].children){this.__changeNodesObjectByRemoving(nodes[i].children,nodeId)}}}},__changeNodesObjectByEditing:function(nodes,nodeId,newValue,type){for(var i=0,len=nodes.length;i<len;i++){if(nodes[i].id==nodeId){if(type==="text"){nodes[i].text=newValue}else if(type==="id"){nodes[i].id=newValue}}else{if(nodes[i].children){this.__changeNodesObjectByEditing(nodes[i].children,nodeId,newValue,type)}}}},getNodesByFilter:function(filter,parentNodeId,nodes){var ret=[];if(parentNodeId){var parentObj=this.__findNodeById(this.nodes,parentNodeId);if(parentObj&&!nodes){var nodes=parentObj.children}}else{if(!nodes)var nodes=this.nodes}if(nodes===undefined)return ret;if(typeof filter==="function"){for(var i=0;i<nodes.length;i++){if(filter(nodes[i])){ret.push(nodes[i])}if(nodes[i].children){var tempRet;tempRet=this.getNodesByFilter(filter,parentNodeId,nodes[i].children);if(tempRet&&tempRet.length>0){ret=ret.concat(tempRet)}}}}return ret},getItemsByFilter:function(filter,items){var ret=[];if(!items)var items=typeof this.items==="string"?Top.Util.namespace(this.items,this):this.items;if(typeof filter==="function"){if(items instanceof Array){for(var i=0,len=items.length;i<len;i++){if(filter(items[i])){ret.push(items[i])}for(var key in items[i]){if(typeof items[i][key]==="object"&&items[i][key].length>0){var tempRet;tempRet=this.getItemsByFilter(filter,items[i][key]);if(tempRet&&tempRet.length>0){ret=ret.concat(tempRet)}}}}}else if(items instanceof Object){if(filter(items)){ret.push(items)}for(var key in items){if(typeof items[key]==="object"&&items[key].length>0){var tempRet;tempRet=this.getItemsByFilter(filter,items[key]);if(tempRet&&tempRet.length>0){ret=ret.concat(tempRet)}}}}}return ret},__getNode:function(nodeId){var selectedNode;if(typeof nodeId==="string"){selectedNode=$(this).find("#"+nodeId+".top-treeview-item")[0]}else if(typeof nodeId==="number"){selectedNode=this.querySelector(".top-treeview-item[data-index='"+nodeId+"']")}return selectedNode},__selectNode:function(node){var selectedNode;if(node instanceof Array){for(var i=0;i<node.length;i++){if(typeof node[i]==="string"){if(this.virtualScroll===true||this.virtualScroll==="true"){selectedNode=this.__findselectedId(this.nodes,node[i],null,"select");this.flatNodes=this.__makeFlatNode(new Array,this.nodes);this.__createViewport(this.flatNodes.length,this.flatNodes)}else{selectedNode=$(this).find("#"+node[i]+".top-treeview-item")[0]}}else if(typeof node[i]==="number"){selectedNode=this.querySelector(".top-treeview-item[data-index='"+node[i]+"']")}if(this.virtualScroll!==true&&this.virtualScroll!=="true")$(selectedNode).trigger($.Event("click",{ctrlKey:true}))}}else{if(typeof node==="string"){if(this.virtualScroll===true||this.virtualScroll==="true"){selectedNode=this.__findselectedId(this.nodes,node,null,"select");this.flatNodes=this.__makeFlatNode(new Array,this.nodes);this.__createViewport(this.flatNodes.length,this.flatNodes)}else{selectedNode=$(this).find("#"+node+".top-treeview-item")[0]}}else if(typeof node==="number"){selectedNode=this.querySelector(".top-treeview-item[data-index='"+node+"']")}if(this.virtualScroll!==true&&this.virtualScroll!=="true"){$(selectedNode).click()}}return selectedNode},__deselectNode:function(node){var _this=this;var selectedNode;if(node===undefined){var treeviewList=_this.querySelectorAll(".top-treeview-list.selected");for(var l=0;l<treeviewList.length;l++){if(treeviewList[l]!==null&&treeviewList[l]!==undefined)treeviewList[l].classList.remove("selected")}var treeviewItem=_this.querySelectorAll(".top-treeview-item.selected");for(var l=0;l<treeviewItem.length;l++){if(treeviewItem[l]!==null&&treeviewItem[l]!==undefined)treeviewItem[l].classList.remove("selected")}if(_this.selectedNode){_this.selectedNode=[]}}else{if(node instanceof Array){for(var i=0;i<node.length;i++){if(typeof node[i]==="string"){selectedNode=$(this).find("#"+node[i]+".top-treeview-item.selected")[0]}else if(typeof node[i]==="number"){selectedNode=this.querySelector(".top-treeview-item.selected[data-index='"+node[i]+"']")}if(selectedNode){selectedNode.classList.remove("selected");selectedNode.parentNode.classList.remove("selected");if(_this.selectedNode){if(_this.selectedNode instanceof Array){for(var j=0;j<_this.selectedNode.length;j++){if(_this.selectedNode[j]===selectedNode.dataObj){_this.selectedNode.splice(j,1)}}}else{_this.selectedNode=[]}}}}}else{if(typeof node==="string"){selectedNode=$(this).find("#"+node+".top-treeview-item.selected")[0]}else if(typeof node==="number"){selectedNode=this.querySelector(".top-treeview-item.selected[data-index='"+node+"']")}if(selectedNode){selectedNode.classList.remove("selected");selectedNode.parentNode.classList.remove("selected");if(_this.selectedNode){if(_this.selectedNode instanceof Array){for(var j=0;j<_this.selectedNode.length;j++){if(_this.selectedNode[j]===selectedNode.dataObj){_this.selectedNode.splice(j,1)}}}else{_this.selectedNode=[]}}}}}},__getCheckedNode:function(){if(this.virtualScroll==="true"||this.virtualScroll===true){var checkNodes=new Array;childGetCheckNode(this.nodes);return checkNodes;function childGetCheckNode(node){for(var i=0;i<node.length;i++){if(node[i].checked===true||node[i].checked==="true")checkNodes.push(node[i]);if(node[i].children!==undefined&&node[i].children.length>0)childGetCheckNode(node[i].children)}}}else{return this.checkedNode}},__checkAll:function(checked){var nodes=$(this).find(".top-treeview-item");for(var i=0;i<nodes.length;i++){var node=nodes[i];checkElement=node.parentNode.querySelector(".top-treeview-check");if(checked!==checkElement.checked){$(checkElement).click()}}},__checkNode:function(nodeId,checked){if(checked===undefined)checked=true;if(nodeId===undefined)return;var _this=this;var toBeCheckedNode,checkElement,checkStatus;if(nodeId instanceof Array){for(var i=0;i<nodeId.length;i++){if(typeof nodeId[i]==="string"){toBeCheckedNode=$(this).find("#"+nodeId[i]+".top-treeview-item")[0]}else if(typeof nodeId[i]==="number"){toBeCheckedNode=this.querySelector(".top-treeview-item[data-index='"+nodeId[i]+"']")}checkElement=toBeCheckedNode.parentNode.querySelector(".top-treeview-check");checkStatus=checkElement.checked;if(checked!==checkStatus)$(checkElement).click()}}else{if(typeof nodeId==="string"){if(this.virtualScroll==="true"||this.virtualScroll===true){findId(this.nodes,nodeId,checked);this.flatNodes=this.__makeFlatNode(new Array,this.nodes);this.__createViewport(this.flatNodes.length,this.flatNodes)}else toBeCheckedNode=$(this).find("#"+nodeId+".top-treeview-item")[0]}else if(typeof nodeId==="number"){toBeCheckedNode=this.querySelector(".top-treeview-item[data-index='"+nodeId+"']")}if(this.virtualScroll!==true&&this.virtualScroll!=="true"){checkElement=toBeCheckedNode.parentNode.querySelector(".top-treeview-check");checkStatus=checkElement.checked;if(checked!==checkStatus)$(checkElement).click()}}function findId(node,nodeId,checked){for(var i=0;i<node.length;i++){if(node[i].id===nodeId)childCheck(node[i],checked);else{if(node[i].children!==undefined&&node[i].children.length>0)findId(node[i].children,nodeId,checked)}}}function childCheck(node,checked){if(node.checked!==checked){var fnNodeCheck=_this.option.event.onNodecheck;node.checked=checked;if(typeof fnNodeCheck==="function")fnNodeCheck(null,Top.Dom.selectById(_this.id),node)}if(node.children!==undefined&&node.children.length>0){for(var i=0;i<node.children.length;i++){node.children[i].checked=checked;childCheck(node.children[i],checked)}}}},__selectItem:function(p1,value){
var selectedItem;switch(this.__selectItem.caller.name){case"selectItemByIndex":{var index=p1;if(index instanceof Array){for(var i=0;i<index.length;i++){selectedItem=this.querySelector(".top-treeview-item[data-index='"+index[i]+"']");$(selectedItem).trigger($.Event("click",{ctrlKey:true}))}}else{selectedItem=this.querySelector(".top-treeview-item[data-index='"+index+"']");$(selectedItem).click()}break}case"selectItemByField":{var field=p1;break}}},__updateToggleClickCount:function(){this.option.node.toggleClickCount=this.toggleClickCount},__setItemField:function(field,index){var _this=this;if(index){var item=this.querySelector(".top-treeview-item[data-index='"+index+"']");var selectedItem=this.__findItemByField(this.items,item.getAttribute("data-field"),item.innerText,index);var value=selectedItem[field];item.setAttribute("data-field",field);item.innerText=value||""}else{var allItems=Array.prototype.slice.call(this.querySelectorAll(".top-treeview-item"));for(var i=0;i<allItems.length;i++){var _item=allItems[i];var items=typeof _this.items==="string"?Top.Util.namespace(_this.items):_this.items;var selectedItem=_this.__findItemByField(items,_item.getAttribute("data-field"),_item.innerText,_item.getAttribute("data-index"));if(selectedItem!==undefined){var value=selectedItem[field];_item.setAttribute("data-field",field);_item.innerText=value||""}}}},__addItems:function(parentIndex,newItems,toField){var parentElem=this.querySelector(".top-treeview-item[data-index='"+parentIndex+"']");var parentLevel=parseInt(parentElem.parentNode.className.match(/[0-9]+/g)[0]);var appenString="";var field=parentElem.getAttribute("data-field");var value=parentElem.innerText;var isParentGroup=false;appendString=this.makeTreeItems(newItems,parentLevel+1);if(parentElem.parentNode.classList.contains("parent")){isParentGroup=true;$(parentElem.parentNode.querySelector("ul.top-treeview-children_nav")).append(appendString)}else{parentElem.parentNode.classList.add("parent");parentElem.parentNode.classList.remove("child");var button_checkbox=document.createElement("input");button_checkbox.setAttribute("type","checkbox");button_checkbox.classList.add("top-treeview-button");$(parentElem.parentNode).prepend('<input type="checkbox" class="top-treeview-button"><i></i>');$(parentElem.parentNode).find("> .top-treeview-button").prop("checked",false);$(parentElem.parentNode).append("<ul class='top-treeview-children_nav'>"+appendString+"</ul>");var tempElement=parentElem.parentNode;$(parentElem).replaceWith("<label id='"+$(parentElem).attr("id")+"' class='top-treeview-item' data-field='"+field+"'>"+$(parentElem).html()+"</label>");parentElem=$(tempElement).find("> .top-treeview-item")[0];var parentElemIcon=$(parentElem).find("> .top-treeview-icon");var parentElemImage=$(parentElem).find("> .top-treeview-image");if(parentElemIcon&&parentElemIcon.attr("i-type")==="union"){parentElemIcon.removeClass(this.childIcon).addClass(this.groupIcon)}else if(parentElemImage&&parentElemImage.attr("i-type")==="union"){parentElemImage[0].style="background:url("+this.groupImage+") 0 0 no-repeat; background-size:contain;"}}if(this.items){var items=typeof this.items==="string"?Top.Util.namespace(this.items,this):this.items;this._index=0;var parentObj=this.__findItemByField(items,field,value,parentIndex);var newField=toField;if(isParentGroup){for(var key in parentObj){if(parentObj[key]instanceof Array){if(!toField)newField=key}}}else{if(!toField)newField="top_tempFieldName"}if(!parentObj[newField])parentObj[newField]=[];parentObj[newField].push(newItems);this.updateData("items")}this.__setNodeIndex();this.attachEventHandler()},__removeItems:function(itemIndex){if(itemIndex instanceof Array){for(var i=0;i<itemIndex.length;i++){this.__removeItems(itemIndex[i])}}else{var removedNode=this.querySelector(".top-treeview-item[data-index='"+itemIndex+"']");if(removedNode===null)return;var field=removedNode.getAttribute("data-field");var value=removedNode.innerText;if(removedNode.parentNode.parentNode.childElementCount===1){tempElement=removedNode.parentNode.parentNode.parentNode;$(tempElement).removeClass("parent");$(tempElement).addClass("child");$(tempElement).find("> .top-treeview-button").remove();$(tempElement).find("> i").remove();$(tempElement).find("> ul").remove();$(tempElement).find("> .top-treeview-item").replaceWith("<a id='"+$(tempElement).find("> .top-treeview-item").attr("id")+"' class='top-treeview-item' data-field='"+$(tempElement).find("> .top-treeview-item").attr("data-field")+"'>"+$(tempElement).find("> .top-treeview-item").html()+"</a>");var tempIcon=$(tempElement).find("> .top-treeview-item .top-treeview-icon");var tempImage=$(tempElement).find("> .top-treeview-item .top-treeview-image");if(tempIcon&&tempIcon.attr("i-type")==="union"){tempIcon.removeClass(_this.option.view.groupIcon).addClass(_this.option.view.childIcon)}else if(tempImage&&tempImage.attr("i-type")==="union"){tempImage[0].style="background:url("+_this.option.view.childImage+") 0 0 no-repeat; background-size:contain;"}tempElement=null}removedNode.parentNode.parentNode.removeChild(removedNode.parentNode)}if(this.items){var items=typeof this.items==="string"?Top.Util.namespace(this.items,this):this.items;this._index=0;this.__changeItemsToThis({items:items,field:field,value:value,index:itemIndex,changedData:undefined});if(itemIndex!==0)this.updateData("items")}this.__setNodeIndex();this.attachEventHandler()},__editItemValue:function(itemIndex,newValue){var editedNode=this.querySelector(".top-treeview-item[data-index='"+itemIndex+"']");var field=editedNode.getAttribute("data-field");var value=editedNode.innerText;$(editedNode).contents().last().replaceWith(newValue);if(this.items){var items=typeof this.items==="string"?Top.Util.namespace(this.items,this):this.items;this._index=0;this.__changeItemsToThis({items:items,field:field,value:value,index:itemIndex,changedData:newValue});this.updateData("items")}},__changeItemsToThis:function(parameter){var items=parameter["items"];var field=parameter["field"];var value=parameter["value"];var index=parseInt(parameter["index"]);var changedData=parameter["changedData"];var parent=parameter["parent"];var parentIndex=parameter["parentIndex"];if(!this._index)this._index=0;if(!items)return;var calledByItself=false;if(this.__changeItemsToThis.caller.name==="__changeItemsToThis")calledByItself=true;if(items instanceof Array){for(var i=0,len=items.length;i<len;i++){if(calledByItself)this._index++;if(!parent)parent=items;if(!parentIndex)parentIndex=i;this.__changeItemsToThis({items:items[i],field:field,value:value,index:index,changedData:changedData,parent:parent,parentIndex:parentIndex})}}else if(items instanceof Object){if(index==this._index&&items[field]===value){if(!parent){parent=this.itemModel;parentIndex=this.itemString}if(changedData){items[field]=changedData}else{if(parent instanceof Array){parent.splice(parentIndex,1)}else{parent[parentIndex]=undefined;if(parent==this.itemModel)this.items=undefined}}this._index=0;return}for(var key in items){if(typeof items[key]==="object"&&items[key].length>0){this.__changeItemsToThis({items:items[key],field:field,value:value,index:index,changedData:changedData})}}}},__setPath:function(nodes,path){if(nodes.length!==undefined){for(var i=0;i<nodes.length;i++){nodes[i].path=path;if(nodes[i].children!==undefined){if(path==="")this.__setPath(nodes[i].children,nodes[i].id);else this.__setPath(nodes[i].children,path+"."+nodes[i].id)}}}else{nodes.path="";if(nodes.children!==undefined){if(path==="")this.__setPath(nodes[i].children,nodes[i].id);else this.__setPath(nodes[i].children,path+"."+nodes[i].id)}}},__setId:function(nodes,len){if(nodes.length===undefined){if(nodes.children!==undefined){for(var j=0;j<nodes.children.length;j++){if(nodes.children[j].id===undefined||nodes.children[j].id===null){nodes.children[j].id=len.toString();len+=1;len=this.__setId(nodes.children[j],len)}}}}else{for(var i=0;i<nodes.length;i++){if(nodes[i].id===undefined||nodes[i].id===null){nodes[i].id=len.toString();len+=1}if(nodes.children!==undefined){for(var j=0;j<nodes[i].children.length;j++){if(nodes[i].children[j].id===undefined||nodes[i].children[j].id===null){nodes[i].children[j].id=len.toString();len+=1;len=this.__setId(nodes[i].children[j],len)}}}}}return len},__makeFlatNode:function(tmpNodes,nodes){for(var i=0;i<nodes.length;i++){if(nodes[i].isExpanded===true||nodes[i].isExpanded==="true")tmpNodes.push(nodes[i]);if(nodes[i].children!==undefined){tmpNodes=this.__makeFlatNode(tmpNodes,nodes[i].children)}}return tmpNodes},__getIndex:function(id){var ret=0;for(var i=0;i<this.flatNodes.length;i++){if(this.flatNodes[i].isExpanded===true||flatNodes[i].isExpanded==="true")ret++;if(this.flatNodes[i].id===id)return ret}return ret},__createViewport:function(len,flatNodes){var _this=this;var viewport,content;viewport=$(this.querySelector(".top-treeview-root"));content=$(this.querySelector(".top-treeview-container"));var paddingTop=parseInt($(content).css("padding-top"));if(_this.rh!==undefined||_this.rh!==null){var sample=_this.makeVirtualNodes(flatNodes[0],0);var tmpDiv=document.createElement("div");tmpDiv.innerHTML=sample;content.append(tmpDiv);_this.rh=parseInt($(tmpDiv).css("height"))}if(_this.rh===0){_this.rh=33}content.empty();var h=_this.rh*len;var vp=parseInt(this.layoutHeight);var rows={};content.css("height",h);onScroll();viewport.unbind("scroll");viewport.scroll($.throttle(200,false,onScroll));function attachTopElement(scrollTop){var top=Math.floor(scrollTop/_this.rh);var bottom=top+h/_this.rh;if(bottom>flatNodes.length)bottom=flatNodes.length;var tmp=new Array;for(var i=top,child=content[0].children[i-top];i<bottom;i++,child=content[0].children[i-top]){if(flatNodes[i].isExpanded===true||flatNodes[i].isExpanded==="true"){child.innerHTML=_this.makeVirtualNodes(flatNodes[i],i);for(var k=0;k<child.children.length;k++){_this.createHtmlObjects(child.children[k])}child.style.paddingLeft=flatNodes[i].depth*15+"px";child.id="_"+flatNodes[i].id;tmp.push(flatNodes[i])}}_this.__setVirtualDataObjToItem(tmp);_this.attachVirtualEventHandler();if(typeof _this.onScrollend==="function"){_this.onScrollend()}}function onScroll(){content.empty();var scrollTop=viewport.scrollTop();var top=Math.floor(scrollTop/_this.rh);var bottom=Math.ceil((scrollTop+h)/_this.rh);if(bottom>len)bottom=len;for(var i=top;i<bottom;i++){rows[i]=renderRow(i)}attachTopElement(scrollTop)}function removeAllRows(){for(var i in rows){rows[i].remove();delete rows[i]}}function renderRow(row){return $("<div class='row' />").css({top:row*_this.rh+paddingTop,height:_this.rh,width:"100%",border:"0px",backgroundColor:"transparent",position:"absolute"}).appendTo(content)}},attachVirtualEventHandler:function(){var _this=this;var fnNodeSelected=this.option.event.onNodeclick;var fnNodeHover=this.option.event.onNodehover;var fnNodeCheck=this.option.event.onNodecheck;var fnNodeDblclick=this.option.event.onNodedblclick;$(this).find(" .top-treeview-container .top-treeview-button").off("change").on("change",function(e){var parent_li=this.parentNode;var thisItem=parent_li.getElementsByClassName("top-treeview-item")[0].parentNode.parentNode;var children_ul=thisItem.nextSibling;var thisNodeData=thisItem.dataObj;_this.__findselectedId(_this.nodes,thisNodeData.id,null,"expand");_this.flatNodes=_this.__makeFlatNode(new Array,_this.nodes);_this.__createViewport(_this.flatNodes.length,_this.flatNodes);if(thisNodeData.children[0].isExpanded===true){_this.__dispatchEvent(new CustomEvent("expand",{detail:{data:thisNodeData}}))}else{_this.__dispatchEvent(new CustomEvent("collapse",{detail:{data:thisNodeData}}))}e.preventDefault()});$(this.childRoot).find(" .top-treeview-container .top-treeview-button+i").off("click").on("click",function(e){$(this.previousSibling).change();e.preventDefault()});$(this).find(" .top-treeview-container .top-treeview-item").off("click").on("click",function(e){var thisClickedIndex=this.getAttribute("data-index");if(_this.itemClicktype==="select"){if(e.shiftKey||e.ctrlKey){if(e.shiftKey){if(!lastClickedIndex)lastClickedIndex=0;if(!firstClickedIndex)firstClickedIndex=0;if(lastClickedType=="ctrl"||parseInt(lastClickedIndex)>parseInt(firstClickedIndex)&&parseInt(thisClickedIndex)<parseInt(firstClickedIndex)||parseInt(lastClickedIndex)<parseInt(firstClickedIndex)&&parseInt(thisClickedIndex)>parseInt(firstClickedIndex)){var selectedList=_this.querySelectorAll(".top-treeview-list.selected");for(var tmp=0;tmp<selectedList.length;tmp++){selectedList[tmp].classList.remove("selected")}var selectedItem=_this.querySelectorAll(".top-treeview-item.selected");for(var tmp=0;tmp<selectedItem.length;tmp++){selectedItem[tmp].classList.remove("selected")}lastClickedIndex=firstClickedIndex}var selectedElement=_this.querySelector(".top-treeview-item[data-index='"+lastClickedIndex+"']");if(thisClickedIndex!==lastClickedIndex){var dataIndex=lastClickedIndex;while(true){if(selectedElement!==undefined&&selectedElement!==null){selectedElement.parentNode.classList.add("selected");selectedElement.classList.add("selected")}if(selectedElement.getAttribute("data-index")===thisClickedIndex)break;if(parseInt(thisClickedIndex)>parseInt(lastClickedIndex)){dataIndex++;selectedElement=_this.querySelector(".top-treeview-item[data-index='"+dataIndex+"']")}else{dataIndex--;selectedElement=_this.querySelector(".top-treeview-item[data-index='"+dataIndex+"']")}}}else if(thisClickedIndex===lastClickedIndex){if(selectedElement!==undefined&&selectedElement!==null){selectedElement.parentNode.classList.add("selected");selectedElement.classList.add("selected")}}lastClickedType="shift"}else if(e.ctrlKey){this.parentNode.classList.toggle("selected");this.classList.toggle("selected");lastClickedType="ctrl";firstClickedIndex=thisClickedIndex}var allNodeHasSelected=_this.querySelectorAll(".top-treeview-item.selected");_this.selectedNode=[];for(var l=0;l<allNodeHasSelected.length;l++){var item=allNodeHasSelected[l];if(_this.userNodes){_this.selectedNode.push(item.parentNode.parentNode.dataObj)}else if(_this.items){_this._index=0;_this.selectedNode.push(_this.__findItemByField(_this.items,item.getAttribute("data-field"),item.innerText,item.getAttribute("data-index")))}}lastClickedIndex=thisClickedIndex}else{var treeviewList=_this.querySelectorAll(".top-treeview-list.selected");for(var l=0;l<treeviewList.length;l++){if(treeviewList[l]!==null&&treeviewList[l]!==undefined)treeviewList[l].classList.remove("selected")}var treeviewItem=_this.querySelectorAll(".top-treeview-item.selected");for(var l=0;l<treeviewItem.length;l++){if(treeviewItem[l]!==null&&treeviewItem[l]!==undefined)treeviewItem[l].classList.remove("selected")}this.parentNode.classList.add("selected");this.classList.add("selected");_this._index=0;_this.selectedNode=this.parentNode.parentNode.dataObj||_this.__findItemByField(_this.items,this.getAttribute("data-field"),this.innerText,this.getAttribute("data-index"));lastClickedIndex=thisClickedIndex;lastClickedType="";firstClickedIndex=thisClickedIndex}_this.selectedItemIndex=lastClickedIndex}else if(_this.itemClicktype==="click"){_this.clickedItemIndex=this.getAttribute("data-index");_this._index=0;_this.clickedNode=this.parentNode.parentNode.dataObj||_this.__findItemByField(_this.items,this.getAttribute("data-field"),this.innerText,this.getAttribute("data-index"))}if(_this.userNodes){if(typeof fnNodeSelected==="function"){if(_this.itemClicktype==="select"){fnNodeSelected(e.originalEvent,Top.Dom.selectById(_this.id),_this.selectedNode)}else if(_this.itemClicktype==="click"){fnNodeSelected(e.originalEvent,Top.Dom.selectById(_this.id),_this.clickedNode)}}}else if(_this.items){if(typeof fnNodeSelected==="function")fnNodeSelected(event,Top.Dom.selectById(_this.id))}if(this.parentNode.classList.contains("parent")&&(_this.option.node.toggleClickCount===1||_this.option.node.toggleClickCount==="1")){var button_input=this.parentNode.querySelector(".top-treeview-button");if(button_input.checked)button_input.checked=false;else button_input.checked=true;$(button_input).change()}});$(this).find(" .top-treeview-container .top-treeview-item").off("dblclick").on("dblclick",function(e){_this.clickedItemIndex=this.getAttribute("data-index");if(_this.userNodes){_this.dblclickedNode=this.dataObj;_this.dblclickedNode=this.parentNode.parentNode.dataObj;_this.selectedNode=_this.dblclickedNode;if(typeof fnNodeDblclick==="function"){fnNodeDblclick(e.originalEvent,Top.Dom.selectById(_this.id),_this.dblclickedNode)}}else if(_this.items){_this._index=0;_this.dblclickedNode=_this.__findItemByField(_this.items,this.getAttribute("data-field"),this.innerText,_this.clickedItemIndex);if(typeof fnNodeDblclick==="function")fnNodeDblclick(event,Top.Dom.selectById(_this.id))}if(this.parentNode.classList.contains("parent")&&(_this.option.node.toggleClickCount===2||_this.option.node.toggleClickCount==="2")){var button_input=this.parentNode.getElementsByClassName("top-treeview-button")[0];if(button_input.checked)button_input.checked=false;else button_input.checked=true;$(button_input).change()}e.preventDefault()});$(this).find(" .top-treeview-container .top-treeview-button+i").off("click").on("click",function(e){if(this.previousSibling.checked){this.previousSibling.checked=false}else{this.previousSibling.checked=true}$(this.previousSibling).change();e.preventDefault()});$(this.childRoot).find(" .top-treeview-container .top-treeview-item").off("mouseenter").on("mouseenter",function(e){if(this.querySelector(".top-treeview-edit_btn")){this.querySelector(".top-treeview-edit_btn").style.visibility="visible";$(this).parents("li.top-treeview-list").css("z-index","2")}_this._index=0;_this.hoverNode=this.dataObj||_this.__findItemByField(_this.items,this.getAttribute("data-field"),this.innerText,this.getAttribute("data-index"));if(typeof fnNodeHover==="function")fnNodeHover(e.originalEvent,Top.Dom.selectById(_this.id),_this.hoverNode);e.preventDefault()});$(this.childRoot).find(" .top-treeview-container .top-treeview-item").off("mouseleave").on("mouseleave",function(e){if(this.querySelector(".top-treeview-edit_btn")){this.querySelector(".top-treeview-edit_btn").style.visibility="hidden";$(this.querySelector(".top-treeview-edit_btn")).removeClass("selected");this.querySelector(".top-treeview-edit_btn .top-treeview-edit_nav").style.display="none";$(this).parents("li.top-treeview-list").css("z-index","")}e.preventDefault()});if(this.option.event.onNodecontextmenu){$(this.childRoot).find(" .top-treeview-container .top-treeview-item").off("contextmenu").on("contextmenu",function(e){var result=true;if(typeof _this.option.event.onNodecontextmenu==="function"){result=_this.option.event.onNodecontextmenu(e.originalEvent,Top.Dom.selectById(_this.id),this.parentNode.parentNode.dataObj)}if(result===false){e.preventDefault()}})}$(this.childRoot).find(" .top-treeview-list .top-treeview-check:not([disabled])").off("change").on("change",function(e){if(_this.option.node.checkInherit){var parent_list=this.parentNode;var thisItem=this.parentNode.parentNode;var thisNodeData=thisItem.dataObj;findNode(_this.nodes,thisNodeData.id);function findNode(node,nodeId){for(var i=0;i<node.length;i++){if(node[i].id===nodeId){node[i].checked=!node[i].checked;if(node[i].children!==undefined)childCheck(node[i].children,node[i].checked);if(node[i].parentId!==undefined)parentCheck(_this.nodes,node[i].parentId,node[i].checked)}else{if(node[i].children!==undefined)findNode(node[i].children,nodeId)}}}function childCheck(node,flag){for(var i=0;i<node.length;i++){node[i].checked=flag;if(node[i].children!==undefined)childCheck(node[i].children,flag)}}function parentCheck(node,nodeId,flag){for(var i=0;i<node.length;i++){if(node[i].id===nodeId){if(flag===false)node[i].checked=flag;else{var tmp_flag=false;for(var j=0;j<node[i].children.length;j++){if(node[i].children[j].checked===false||node[i].children[j].checked===undefined){tmp_flag=true;break}}if(tmp_flag===false)node[i].checked=flag}if(node[i].parentId!==undefined)parentCheck(_this.nodes,node[i].parentId,node[i].checked);break}else if(node[i].children!==undefined){parentCheck(node[i].children,nodeId,flag)}}}_this.flatNodes=_this.__makeFlatNode(new Array,_this.nodes);_this.__createViewport(_this.flatNodes.length,_this.flatNodes)}_this.checkedNode=[];_this.checkedNode=getVirtualCheckedNode(_this.nodes,_this.checkedNode);function getVirtualCheckedNode(nodes,array){for(var i=0;i<nodes.length;i++){if(nodes[i].isChecked===true)array.push(nodes[i]);if(nodes[i].children!==undefined)getVirtualCheckedNode(nodes[i].children,array)}return array}var thisCheckedNode=this.parentNode.parentNode.dataObj;if(thisCheckedNode)thisCheckedNode.checked=this.checked;if(typeof fnNodeCheck==="function")fnNodeCheck(e.originalEvent,Top.Dom.selectById(_this.id),thisCheckedNode);e.preventDefault()});$(this.childRoot).find(" .top-treeview-item .top-treeview-edit_btn").off("mouseenter").on("mouseenter",function(e){e.stopPropagation()});$(this.childRoot).find(" .top-treeview-item .top-treeview-edit_btn .top-treeview-edit_nav").off("mouseenter").on("mouseenter",function(e){e.stopPropagation()});$(this.childRoot).find(" .top-treeview-item .top-treeview-edit_btn").off("click").on("click",function(e){var navElem=this.querySelector(".top-treeview-edit_nav");if($(this).hasClass("selected")){$(this).removeClass("selected");navElem.style.display="none";navElem.style.top="";navElem.style.left="";navElem.style.right=""}else{$(this).addClass("selected");navElem.style.display="block";navElem.style.top=this.getBoundingClientRect().top+this.getBoundingClientRect().height+"px";navElem.style.left=this.getBoundingClientRect().left+"px";var calcedRight=navElem.getBoundingClientRect().right-$(document).width();if(calcedRight>0){calcedRight=Math.abs(this.getBoundingClientRect().right-$(document).width());navElem.style.left="";navElem.style.right=calcedRight+"px"}}e.stopPropagation()});$(this.childRoot).find(" .top-treeview-item .top-treeview-edit_btn").off("dblclick").on("dblclick",function(e){e.stopPropagation()});$(this.childRoot).find(" .top-treeview-item .top-treeview-edit_btn .top-treeview-edit").off("click").on("click",function(e){var thisItem=this.parentNode.parentNode.parentNode;for(var i=0;i<thisItem.childNodes.length;i++){if(thisItem.childNodes[i].nodeName==="#text"){var thisItemText=thisItem.childNodes[i].nodeValue}}var editBtn=this.parentNode.parentNode;var textElement=editBtn.nextSibling;$(textElement).remove();$(thisItem).append("<input class='top-treeview-edit_input' type='text' value='"+thisItemText+"'/>");var $inputElement=$(thisItem).find(".top-treeview-edit_input");var inputLength=$inputElement.val().length||5;$inputElement.attr("size",inputLength);$inputElement.focus();$inputElement.on("dblclick",function(e){e.stopPropagation()}).on("mousedown",function(e){e.stopPropagation()}).on("keypress",function(e){if(e.keyCode===13){_this.editNodeText(thisItem.id,$(this).val())}}).on("focusout",function(e){_this.editNodeText(thisItem.id,$(this).val())})});if(_this.option.node.deletable===true||this.option.node.deletable==="true"){$(this.childRoot).find(" .top-treeview-item .top-treeview-edit_btn .top-treeview-delete").off("click").on("click",function(e){var thisItem=this.parentNode.parentNode.parentNode;var toBeRemovedData=thisItem.dataObj;var result=true;if(typeof _this.option.event.onNodedelete==="function"){result=_this.option.event.onNodedelete(Top.Dom.selectById(_this.id),toBeRemovedData)}if(result!==false){_this.removeNodes(thisItem.id)}})}$(this.childRoot).find(" .top-treeview-item .top-treeview-edit_btn li:not(.top-treeview-delete):not(.top-treeview-edit)").off("click").on("click",function(e){var thisCustomMenuKey=this.className.replace("top-treeview-","");var nodeItem=$(this).closest(".top-treeview-item")[0];var fnSelect=typeof _this.option.view.menu[thisCustomMenuKey]==="function"?_this.option.view.menu[thisCustomMenuKey]:Top.Util.namespace(_this.option.view.menu[thisCustomMenuKey],_this);if(typeof fnSelect==="function"){fnSelect(Top.Dom.selectById(_this.id),nodeItem.dataObj)}})},makeVirtualNodes:function(treeObj,i){var _this=this;var icon,iconClass,image;var iString="";var isSetUnionI=false;var checkable=this.option.node.checkable;var editable=this.option.node.editable;var deletable=this.option.node.deletable;var checked=false;var isCheckDisabled=false;var checkString="";var editMenuString="";var isIncludedCustomMenu=false;var customMenuList={};var innerElement="";var level=treeObj["depth"];var isExpanded=treeObj["isExpanded"];var isSelected=treeObj["isSelected"];var isFocused=treeObj["isFocused"];var isSearched=treeObj["isSearched"];for(var key in this.option.view.menu){if(key!=="order"){isIncludedCustomMenu=true;var fnSelect=typeof this.option.view.menu[key]==="function"?this.option.view.menu[key]:Top.Util.namespace(this.option.view.menu[key],this);customMenuList[key]=fnSelect;if(this.option.view.menu.order.indexOf(key)<0){this.option.view.menu.order.push(key)}}}var childExpanded=false;if(treeObj.children!==undefined){if(treeObj.children[0].isExpanded===true||treeObj.children[0].isExpanded===true){childExpanded=true}}var ret="";ret+="<li tabindex='-1' class='top-treeview-list level"+level+" virtual";if(treeObj["children"]!==undefined&&treeObj["children"].length>0){isParent=true}var id=treeObj["id"]!==null&&treeObj["id"]!==undefined&&treeObj["id"].toString()||treeObj["value"]||treeObj["text"];icon=treeObj["icon"];iconClass=treeObj["iconClass"];image=treeObj["image"];if(treeObj["checkable"]!==undefined&&treeObj["checkable"]!==null){checkable=treeObj["checkable"]}if(treeObj["editable"]!==undefined&&treeObj["editable"]!==null){editable=treeObj["editable"]}if(treeObj["deletable"]!==undefined&&treeObj["deletable"]!==null){deletable=treeObj["deletable"]}for(var key in customMenuList){if(treeObj[key]!==undefined&&treeObj[key]!==null){customMenuList[key]=treeObj[key]}}customMenuList["edit"]=editable;customMenuList["delete"]=deletable;if(treeObj["checked"]==="true"||treeObj["checked"]===true){checked=true}if(treeObj["checked"]==="false"||treeObj["checked"]===false){checked=false}if(this.option.node.checkDisabled!==false){if(typeof this.option.node.checkDisabled==="function"){isCheckDisabled=this.option.node.checkDisabled(treeObj)}else if(this.option.node.checkDisabled instanceof Array){for(var z=0;z<this.option.node.checkDisabled.length;z++){if(id===this.option.node.checkDisabled[z])isCheckDisabled=true}}else if(this.option.node.checkDisabled==="true"||this.option.node.checkDisabled===true){isCheckDisabled=true}}if(treeObj["hasChild"]===true){if(this.option.view.showIcon||this.option.view.showImage){if(!icon&&!image){if(this.option.view.showIcon)icon=this.option.view.groupIcon;else if(this.option.view.showImage)image=this.option.view.groupImage;isSetUnionI=true}if(isSetUnionI){iString=icon?"<span class='top-treeview-icon "+icon+" "+iconClass+"' i-type='union'></span>":"<span class='top-treeview-image' style=' background:url("+image+") 0 0 no-repeat; background-size:contain;' i-type='union'></span>"}else{iString=icon?"<span class='top-treeview-icon "+icon+" "+iconClass+"'></span>":"<span class='top-treeview-image' style=' background:url("+image+") 0 0 no-repeat; background-size:contain;'></span>"}}if(checkable==="true"||checkable===true){checkString="<input type='checkbox' id='"+this.id+"_check_"+i+"' class='top-treeview-check' "+(checked?"checked":"")+(isCheckDisabled?" disabled":"")+"><label for='"+this.id+"_check_"+i+"'></label>"}if(editable==="true"||editable===true||deletable==="true"||deletable===true||isIncludedCustomMenu===true){editMenuString="<span class='top-treeview-edit_btn' style='visibility:hidden;'><ul class='top-treeview-edit_nav'>";for(var index=0;index<this.option.view.menu.order.length;index++){var item=this.option.view.menu.order[index];if(customMenuList[item]!==false&&customMenuList[item]!=="false"){var language=_this.__i18n(_this.option.view.language[item]);if(item!=="edit"&&item!=="delete"){editMenuString+='<li class="top-treeview-'+item+'">'+language+"</li>"}else{editMenuString+='<li class="top-treeview-'+item+'">'+language+"</li>"}}}editMenuString+="</ul></span>"}if(typeof this.option.view.layout==="function"){innerElement=this.option.view.layout(treeObj)}else innerElement=treeObj["text"];ret+=" parent "+(isExpanded?"expand":"collapse")+"'><input type='checkbox' class='top-treeview-button' "+(childExpanded?"":"checked")+"><i></i>"+checkString+"<label  id='"+id+"' class='top-treeview-item "+(isSelected?"selected":"")+" "+(isFocused?"focused":"")+" "+(isSearched?"searched":"")+"' data-index='"+i+"'>"+iString+editMenuString+innerElement+"</label>";checkable=this.option.node.checkable;editable=this.option.node.editable;deletable=this.option.node.deletable;checked=false;isCheckDisabled=false;checkString="";editMenuString=""}else{if(this.option.view.showIcon||this.option.view.showImage){if(!icon&&!image){if(this.option.view.showIcon)icon=this.option.view.childIcon;else if(this.option.view.showImage)image=this.option.view.childImage;isSetUnionI=true}if(isSetUnionI){iString=icon?"<span class='top-treeview-icon "+icon+" "+iconClass+"' i-type='union'></span>":"<span class='top-treeview-image' style=' background:url("+image+") 0 0 no-repeat; background-size:contain;' i-type='union'></span>"}else{iString=icon?"<span class='top-treeview-icon "+icon+" "+iconClass+"'></span>":"<span class='top-treeview-image' style=' background:url("+image+") 0 0 no-repeat; background-size:contain;'></span>"}}if(checkable==="true"||checkable===true){checkString="<input type='checkbox' id='"+this.id+"_check_"+i+"' class='top-treeview-check' "+(checked?"checked":"")+(isCheckDisabled?" disabled":"")+" ><label for='"+this.id+"_check_"+i+"'></label>"}if(editable==="true"||editable===true||deletable==="true"||deletable===true||isIncludedCustomMenu===true){editMenuString="<span class='top-treeview-edit_btn'  style='visibility:hidden;'><ul class='top-treeview-edit_nav'>";for(var index=0;index<this.option.view.menu.order.length;index++){var item=this.option.view.menu.order[index];if(customMenuList[item]!==false&&customMenuList[item]!=="false"){var language=_this.__i18n(_this.option.view.language[item]);if(item!=="edit"&&item!=="delete"){editMenuString+='<li class="top-treeview-'+item+'">'+language+"</li>"}else{editMenuString+='<li class="top-treeview-'+item+'">'+language+"</li>"}}}editMenuString+="</ul></span>"}if(typeof this.option.view.layout==="function"){innerElement=this.option.view.layout(treeObj)}else innerElement=treeObj["text"];ret+=" child'>"+checkString+"<a id='"+id+"' class='top-treeview-item"+(isSelected?"selected":"")+" "+(isFocused?"focused":"")+" "+(isSearched?"searched":"")+"'>"+iString+editMenuString+innerElement+"</a>";checkable=this.option.node.checkable;editable=this.option.node.editable;deletable=this.option.node.deletable;checked=false;isCheckDisabled=false;checkString="";editMenuString=""}ret+="</li>";isParent=false;return ret},__setExpand:function(nodes,isExpanded,depth,id){for(var i=0;i<nodes.length;i++){if(depth===0)nodes[i].isExpanded=true;else nodes[i].isExpanded=isExpanded;nodes[i].depth=depth;if(nodes[i].children!==undefined){nodes[i].hasChild=true;this.__setExpand(nodes[i].children,isExpanded,depth+1,id)}else{nodes[i].hasChild=false}}return nodes},__findselectedId:function(nodes,id,flag,expand,ret){for(var i=0;i<nodes.length;i++){if(nodes[i].id===id){ret=nodes[i];if(expand==="checked"){if(nodes[i].checked===undefined||nodes[i].checked===false){nodes[i].checked=true}else nodes[i].checked=false}else if(expand==="select"){nodes[i].isSelected=true}if(nodes[i].children!==undefined){if(expand==="expand")this.__setFlag(nodes[i].children,flag);else if(expand==="checked")this.__setChecked(nodes[i].children,nodes[i].isChecked);else ret=this.__findselectedId(nodes[i].children,id,flag,expand,ret)}}else{if(expand==="select")nodes[i].isSelected=false;if(nodes[i].children!==undefined)ret=this.__findselectedId(nodes[i].children,id,flag,expand,ret)}}return ret},__setFlag:function(nodes,flag){for(var i=0;i<nodes.length;i++){
if(nodes[i].children!==undefined&&nodes[i].children.length>0){if(nodes[i].children[0].isExpanded!==undefined&&nodes[i].children[0].isExpanded===true)this.__setFlag(nodes[i].children,false)}if(flag===false)nodes[i].isExpanded=false;else nodes[i].isExpanded=!nodes[i].isExpanded}return true},__setChecked:function(nodes,flag){for(var i=0;i<nodes.length;i++){if(nodes[i].children!==undefined){this.__setChecked(nodes[i].children,flag)}if(flag===false)nodes[i].checked=false;else nodes[i].checked=true}return true},__setVirtualDataObjToItem:function(flatNodes){var items=this.querySelector(".top-treeview-container");var labels=this.getElement(".top-treeview-item");for(var i=0;i<items.children.length;i++){labels[i].dataObj=this.__findNodeById(flatNodes,labels[i].id);items.children[i].dataObj=this.__findNodeById(flatNodes,items.children[i].id.substring(1,items.children[i].id.length))}},getTopStyle:function(){this.topstyle=this.querySelector("div").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.querySelector("div").style[key]=value;this.topstyle=this.querySelector("div").style.cssText}},setAllTopStyle:function(){this.querySelector("div").style.cssText=this.topstyle},__searchNode:function(id){var viewport=$(this.querySelector(".top-treeview-root"));for(var i=0;i<this.flatNodes.length;i++){if(id===this.flatNodes[i].id){viewport.scrollTop(this.rh*i-100);viewport.scroll();return}}},__virtualScrollRerender:function(){this.flatNodes=this.__makeFlatNode(new Array,this.nodes);this.__createViewport(this.flatNodes.length,this.flatNodes);return true},__getNodes:function(ul,new_nodes){for(var i=0;i<ul.children.length;i++){var li=ul.children[i];var this_node=li.querySelector(".top-treeview-item").dataObj;if(this_node.children!==undefined){this_node.children=[];for(var j=0;j<li.children.length;j++){if(li.children[j].tagName==="UL"){this.__getNodes(li.children[j],this_node.children)}}}new_nodes.push(this_node)}return new_nodes}};Top.Widget.Group.Treeview=function(){Treeview.prototype=Object.create(Top.Widget.Group.prototype);Treeview.prototype.constructor=Treeview;function Treeview(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-treeview");this.template.innerHTML='<div class="top-treeview-root"></div>'}this.id=this.template.id}Treeview.create=function(element){return new Treeview(element)};Treeview.prototype.getNodes=function(){var new_nodes=new Array;var ul=this.template.querySelector(".top-treeview-container");return this.template.__getNodes(ul,new_nodes)};Treeview.prototype.expandNode=function(nodeId,notRender){this.template.expandNode(nodeId,notRender)};Treeview.prototype.collapseNode=function(nodeId,notRender){this.template.collapseNode(nodeId,notRender)};Treeview.prototype.expandAll=function(){this.template.expandAll()};Treeview.prototype.collapseAll=function(){this.template.collapseAll()};Treeview.prototype.getSelectedNode=function(){return this.template.selectedNode};Treeview.prototype.getClickedNode=function(){return this.template.clickedNode};Treeview.prototype.getHoveredNode=function(){return this.template.hoverNode};Treeview.prototype.getCheckedNode=function(){return this.template.__getCheckedNode()};Treeview.prototype.getNode=function(nodeId){return this.template.__getNode(nodeId)};Treeview.prototype.getDblclickedNode=function(){return this.template.dblclickedNode};Treeview.prototype.addNodes=function(parentNodeId,newNodes,index){return this.template.addNodes(parentNodeId,newNodes,index)};Treeview.prototype.removeNodes=function(nodeId){return this.template.removeNodes(nodeId)};Treeview.prototype.editNodeText=function(nodeId,newText){return this.template.editNodeText(nodeId,newText)};Treeview.prototype.editNodeId=function(nodeId,newId){return this.template.editNodeId(nodeId,newId)};Treeview.prototype.getNodesByFilter=function(filter,parentNodeId){return this.template.getNodesByFilter(filter,parentNodeId)};Treeview.prototype.getItemsByFilter=function(filter){return this.template.getItemsByFilter(filter)};Treeview.prototype.selectNode=function(node){return this.template.__selectNode(node)};Treeview.prototype.deselectNode=function(node){this.template.__deselectNode(node)};Treeview.prototype.checkNode=function(nodeId,checked){this.template.__checkNode(nodeId,checked)};Treeview.prototype.checkAll=function(checked){this.template.__checkAll(checked)};Treeview.prototype.searchNode=function(id){this.template.__searchNode(id)};Treeview.prototype.getVirtualIndex=function(id){return this.template.__getIndex(id)};Treeview.prototype.getClickedIndex=function(){return this.template.getClickedItemIndex()};Treeview.prototype.getSelectedIndex=function(){return this.template.getSelectedItemIndex()};Treeview.prototype.selectItemByIndex=function selectItemByIndex(index){this.template.__selectItem(index)};Treeview.prototype.selectItemByField=function selectItemByField(field,value){this.template.__selectItem(field,value)};Treeview.prototype.setToggleClickCount=function(count){this.template.toggleClickCount=count;this.template.__updateToggleClickCount()};Treeview.prototype.setItemField=function(field,index){this.template.__setItemField(field,index)};Treeview.prototype.addItems=function(parentIndex,newItems,toField){this.template.__addItems(parentIndex,newItems,toField)};Treeview.prototype.removeItems=function(itemIndex){this.template.__removeItems(itemIndex)};Treeview.prototype.editItemValue=function(itemIndex,newValue){this.template.__editItemValue(itemIndex,newValue)};Treeview.prototype.virtualScrollRerender=function(){return this.template.__virtualScrollRerender()};return Treeview}();TopVideoview={is:"top-videoview",behaviors:[TopWidgetBehavior,TopResourceBehavior],properties:{autoPlay:{type:String,value:"false"},control:{type:String,value:"false"},loop:{type:String,value:"false"}},__ready:function(){this.updateStyle();this.__initialize();this.__updateId();this.__updateName();this.__updateAutoPlay();this.__updateSrc()},appendTemplate:function(){this.innerHTML='<video class="top-videoview-root" type="video/mp4"></video>';this.__isTemplateAppended=true},__eventBindingList:function(){var shadowDiv=this.querySelector("video");return{__eventMouseClick:function(func){shadowDiv.onclick=func},__eventMousePressed:function(func){shadowDiv.onmousedown=func},__eventMouseReleased:function(func){shadowDiv.onmouseup=func},__eventMouseDblclick:function(func){shadowDiv.ondblclick=func},__eventKeyPressed:function(func){shadowDiv.onkeydown=func},__eventKeyTyped:function(func){shadowDiv.onkeypress=func},__eventKeyReleased:function(func){shadowDiv.onkeyup=func},__eventMouseEnter:function(func){shadowDiv.onmouseenter=func},__eventMouseExit:function(func){shadowDiv.onmouseleave=func},__eventMouseMove:function(func){shadowDiv.onmousemove=func},__eventFocused:function(func){shadowDiv.onfocus=func},__eventLostFocused:function(func){shadowDiv.onblur=func},__eventSecondaryClick:function(func){shadowDiv.oncontextmenu=func}}},__initialize:function(){if(this.autoPlay==="true"){this.autoPlay=true}else{this.autoPlay=false}var shadowRoot=this.querySelector("video");if(this.control==="true"){shadowRoot.setAttribute("controls",true)}else{shadowRoot.removeAttribute("controls")}if(this.loop==="true"){shadowRoot.setAttribute("loop",true)}else{shadowRoot.removeAttribute("loop")}},__updateId:function(){if(this.id){var shadowInput=this.querySelector("video");shadowInput.id=this.id}},__updateName:function(){if(this.name){var shadowInput=this.querySelector("video");shadowInput.setAttribute("name",this.name)}},getPlayState:function(){var shadowVideo=this.querySelector("video");return!shadowVideo.paused},play:function(){var shadowVideo=this.querySelector("video");if(shadowVideo.paused){shadowVideo.play()}},stop:function(){var shadowVideo=this.querySelector("video");if(!shadowVideo.paused){shadowVideo.pause()}},__updateAutoPlay:function(){var shadowInput=this.querySelector("video");if(this.autoPlay==="true"||this.autoPlay===true){this.autoPlay=true;shadowInput.setAttribute("autoplay","")}else{this.autoPlay=false;shadowInput.removeAttribute("autoplay")}},__updateSrc:function(){if(this.src){var shadowInput=this.querySelector("video");if(this.src.startsWith("@raw")){this.src=Top.RawManager.get(this.src.replace("@raw/",""))}shadowInput.setAttribute("src",this.src)}},__updateControl:function(){var shadowRoot=this.querySelector("video");if(this.control==="true"){shadowRoot.setAttribute("controls",true)}else{shadowRoot.removeAttribute("controls")}},__updateLoop:function(){var shadowRoot=this.querySelector("video");if(this.loop==="true"){shadowRoot.setAttribute("loop",true)}else{shadowRoot.removeAttribute("loop")}},getTopStyle:function(){this.topstyle=this.querySelector(".top-videoview-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.querySelector(".top-videoview-root").style[key]=value;this.topstyle=this.querySelector(".top-videoview-root").style.cssText}},setAllTopStyle:function(){this.querySelector(".top-videoview-root").style.cssText=this.topstyle}};Top.Widget.Videoview=function(){Videoview.prototype=Object.create(Top.Widget.prototype);Videoview.prototype.constructor=Videoview;function Videoview(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-videoview");this.template.innerHTML='<video class="top-videoview-root" type="video/mp4"></video>'}this.id=this.template.id}Videoview.create=function(element){return new Videoview(element)};Videoview.prototype.getPlayState=function(){return this.template.getPlayState()};Videoview.prototype.play=function(){this.template.play()};Videoview.prototype.stop=function(){this.template.stop()};return Videoview}();TopWebview={is:"top-webview",behaviors:[TopWidgetBehavior],properties:{url:String},__ready:function(){this.updateStyle();this.__updateId();this.__updateName();this.__updateUrl()},appendTemplate:function(){this.innerHTML='<iframe class="top-webview-root" scrolling="yes"></iframe>';this.__isTemplateAppended=true},__eventBindingList:function(){var shadowDiv=this.querySelector(".top-webview-root");return{__eventMouseClick:function(func){shadowDiv.onclick=func},__eventMousePressed:function(func){shadowDiv.onmousedown=func},__eventMouseReleased:function(func){shadowDiv.onmouseup=func},__eventMouseDblclick:function(func){shadowDiv.ondblclick=func},__eventKeyPressed:function(func){shadowDiv.onkeydown=func},__eventKeyTyped:function(func){shadowDiv.onkeypress=func},__eventKeyReleased:function(func){shadowDiv.onkeyup=func},__eventMouseEnter:function(func){shadowDiv.onmouseenter=func},__eventMouseExit:function(func){shadowDiv.onmouseleave=func},__eventMouseMove:function(func){shadowDiv.onmousemove=func},__eventFocused:function(func){shadowDiv.onfocus=func},__eventLostFocused:function(func){shadowDiv.onblur=func},__eventSecondaryClick:function(func){shadowDiv.oncontextmenu=func}}},__updateId:function(){if(this.id){var iFrameElement=this.querySelector(".top-webview-root");iFrameElement.id=this.id}},__updateUrl:function(){var iFrameElement=this.querySelector(".top-webview-root");iFrameElement.src=this.url},__updateName:function(){if(this.name){var iFrameElement=this.querySelector(".top-webview-root");iFrameElement.name=this.name;iFrameElement.alt=this.name}},getTopStyle:function(){this.topstyle=this.querySelector(".top-webview-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.querySelector(".top-webview-root").style[key]=value;this.topstyle=this.querySelector(".top-webview-root").style.cssText}},setAllTopStyle:function(){this.querySelector(".top-webview-root").style.cssText=this.topstyle}};Top.Widget.Webview=function(){Webview.prototype=Object.create(Top.Widget.prototype);Webview.prototype.constructor=Webview;function Webview(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-webview");this.template.innerHTML='<iframe class="top-webview-root" scrolling="yes"></iframe>'}this.id=this.template.id}Webview.create=function(element){return new Webview(element)};return Webview}();TopWidgetitem={is:"top-widgetitem",behaviors:[TopWidgetBehavior,TopI18nBehavior],properties:{id:{type:String,reflectToAttribute:true},caption:String,src:{type:String,reflectToAttribute:true},text:{type:Object,reflectToAttribute:true},tooltip:String,href:{type:String,reflectToAttribute:true},subItems:[],parentWidget:Object,eventMouseClick:{type:Function,reflectToAttribute:true},value:String},appendTemplate:function(){this.__isTemplateAppended=true},ready:function(){if(!this.id){this.id=Top.Util.guid()}this.parent=this.getParent();this.initSubItem();this.updateSubItem();this.__initI18n("text")},initSubItem:function(){this.subItems=$(this).children();for(var i=0;i<this.subItems.length;i++){this.subItems[i].parentWidget=this.parentWidget}},getSubItem:function(){return this.subItems},clearSubItem:function(){var myNode=this;while(myNode.firstChild){myNode.removeChild(myNode.firstChild)}},updateSubItem:function(){this.clearSubItem();this.childText="";for(var i=0;i<this.subItems.length;i++){this.appendChild(this.subItems[i])}},__initText:function(){if(typeof this.text==="string"){var matches=this.text.match(/\{\{(.*?)\}\}/);if(matches){var _this=this;if(Top.i18n.isLoaded()){_this.text=eval(matches[1])}else{Top.i18n.onLoad(function(){_this.text=eval(matches[1])})}}}},__updateText:function(){if(this.parent&&this.parent.localName==="top-selectbox"){this.parent.__updateNodes()}},getTopStyle:function(){return this.topstyle},setTopStyle:function(key,value){if(value){this.topstyle+=key+":"+value+";"}},setAllTopStyle:function(){},__detached:function(){this.parentWidget=null}};Top.Widget.Group.Widgetitem=function(){Widgetitem.prototype=Object.create(Top.Widget.Group.prototype);Widgetitem.prototype.constructor=Widgetitem;function Widgetitem(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-widgetitem")}this.id=this.template.id}Widgetitem.create=function(element){return new Widgetitem(element)};Widgetitem.prototype.addItem=function(widget){this.template.subItems.push(widget.template)};Widgetitem.prototype.removeItem=function(widget){var childsArray=this.template.subItems;for(var i=0;i<childsArray.length;i++){if(widget.id==childsArray[i].id){this.template.childs.splice(i,1)}}};Widgetitem.prototype.complete=function(){this.template.updateSubItem()};return Widgetitem}();